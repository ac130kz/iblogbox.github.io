var gdocumentType,ghyperlinkTooltipView,clicktimer,gstyleParseUtils,godfcontainer,historylist=[];window.addEventListener&&window.addEventListener("hashchange",function(){var e=window.location.hash;if(e)for(var g=0;g<=historylist.length-1;g++)if(historylist[g].url==e){clearTimeout(clicktimer);clicktimer=setTimeout(function(){try{historylist[g].node.scrollIntoView(!0)}catch(a){}},100);break}});var g_errmsg=function(e){proc_g_errmsg&&proc_g_errmsg(e)},webodf_version="0.5.4";function Runtime(){}
Runtime.prototype.getVariable=function(e){};Runtime.prototype.toJson=function(e){};Runtime.prototype.fromJson=function(e){};Runtime.prototype.byteArrayFromString=function(e,g){};Runtime.prototype.byteArrayToString=function(e,g){};Runtime.prototype.read=function(e,g,a,d){};Runtime.prototype.readFile=function(e,g,a){};Runtime.prototype.readFileSync=function(e,g){};Runtime.prototype.loadXML=function(e,g){};Runtime.prototype.writeFile=function(e,g,a){};Runtime.prototype.deleteFile=function(e,g){};
Runtime.prototype.log=function(e,g){};Runtime.prototype.setTimeout=function(e,g){};Runtime.prototype.clearTimeout=function(e){};Runtime.prototype.libraryPaths=function(){};Runtime.prototype.currentDirectory=function(){};Runtime.prototype.setCurrentDirectory=function(e){};Runtime.prototype.type=function(){};Runtime.prototype.getDOMImplementation=function(){};Runtime.prototype.parseXML=function(e){};Runtime.prototype.exit=function(e){};Runtime.prototype.getWindow=function(){};
Runtime.prototype.requestAnimationFrame=function(e){};Runtime.prototype.cancelAnimationFrame=function(e){};Runtime.prototype.assert=function(e,g){};var IS_COMPILED_CODE=!0;
Runtime.byteArrayToString=function(e,g){function a(d){var a="",h,b=d.length;for(h=0;h<b;h+=1)a+=String.fromCharCode(d[h]&255);return a}function d(d){var a="",h,b=d.length,m=[],q,c,f,r;for(h=0;h<b;h+=1)q=d[h],128>q?m.push(q):(h+=1,c=d[h],194<=q&&224>q?m.push((q&31)<<6|c&63):(h+=1,f=d[h],224<=q&&240>q?m.push((q&15)<<12|(c&63)<<6|f&63):(h+=1,r=d[h],240<=q&&245>q&&(q=(q&7)<<18|(c&63)<<12|(f&63)<<6|r&63,q-=65536,m.push((q>>10)+55296,(q&1023)+56320))))),1E3<=m.length&&(a+=String.fromCharCode.apply(null,
m),m.length=0);return a+String.fromCharCode.apply(null,m)}var b;"utf8"===g?b=d(e):("binary"!==g&&this.log("Unsupported encoding: "+g),b=a(e));return b};Runtime.getVariable=function(e){try{return eval(e)}catch(g){}};Runtime.toJson=function(e){return JSON.stringify(e)};Runtime.fromJson=function(e){return JSON.parse(e)};Runtime.getFunctionName=function(e){return void 0===e.name?(e=/function\s+(\w+)/.exec(e))&&e[1]:e.name};
Runtime.assert=function(e,g){if(!e)throw this.log("alert","ASSERTION FAILED:\n"+g),Error(g);};
function BrowserRuntime(e){function g(d){var a=d.length,c,f,r=0;for(c=0;c<a;c+=1)f=d.charCodeAt(c),r+=1+(128<f)+(2048<f),55040<f&&57344>f&&(r+=1,c+=1);return r}function a(d,a,c){var f=d.length,r,k;a=new Uint8Array(new ArrayBuffer(a));c?(a[0]=239,a[1]=187,a[2]=191,k=3):k=0;for(c=0;c<f;c+=1)r=d.charCodeAt(c),128>r?(a[k]=r,k+=1):2048>r?(a[k]=192|r>>>6,a[k+1]=128|r&63,k+=2):55040>=r||57344<=r?(a[k]=224|r>>>12&15,a[k+1]=128|r>>>6&63,a[k+2]=128|r&63,k+=3):(c+=1,r=(r-55296<<10|d.charCodeAt(c)-56320)+65536,
a[k]=240|r>>>18&7,a[k+1]=128|r>>>12&63,a[k+2]=128|r>>>6&63,a[k+3]=128|r&63,k+=4);return a}function d(a){var d=a.length,c=new Uint8Array(new ArrayBuffer(d)),f;for(f=0;f<d;f+=1)c[f]=a.charCodeAt(f)&255;return c}function b(a,d){var c,f,r;void 0!==d?r=a:d=a;e?(f=e.ownerDocument,r&&(c=f.createElement("span"),c.className=r,c.appendChild(f.createTextNode(r)),e.appendChild(c),e.appendChild(f.createTextNode(" "))),c=f.createElement("span"),0<d.length&&"<"===d[0]?c.innerHTML=d:c.appendChild(f.createTextNode(d)),
e.appendChild(c),e.appendChild(f.createElement("br"))):console&&console.log(d);p.enableAlerts&&"alert"===r&&alert(d)}function l(m,h,c){if(0!==c.status||c.responseText)if(200===c.status||0===c.status){if(c.response&&"string"!==typeof c.response)"binary"===h?(c=c.response,c=new Uint8Array(c)):c=String(c.response);else if("binary"===h)if(null!==c.responseBody&&"undefined"!==String(typeof VBArray)){c=(new VBArray(c.responseBody)).toArray();var f=c.length;h=new Uint8Array(new ArrayBuffer(f));for(m=0;m<
f;m+=1)h[m]=c[m];c=h}else{(m=c.getResponseHeader("Content-Length"))&&(m=parseInt(m,10));if(m&&m!==c.responseText.length)a:{f=c.responseText;h=!1;var r=g(f);if("number"===typeof m){if(m!==r&&m!==r+3){f=void 0;break a}h=r+3===m;r=m}f=a(f,r,h)}void 0===f&&(f=d(c.responseText));c=f}else c=c.responseText;c={err:null,data:c}}else c={err:c.responseText||c.statusText,data:null};else c={err:"File "+m+" is empty.",data:null};return c}function n(d,a,c){var f=new XMLHttpRequest;f.open("GET",d,c);f.overrideMimeType&&
("binary"!==a?f.overrideMimeType("text/plain; charset="+a):f.overrideMimeType("text/plain; charset=x-user-defined"));return f}function h(d,a,c){function f(c){var k=document.getElementById("canvas");k&&(k.innerHTML='<div style="font-size:14px;padding:5px">'+c+'<span id="inner_progress"></span></div>')}var r=n(d,a,!0);r.onreadystatechange=function(){var k;4===r.readyState&&(f("Loading the file... Please wait..."),setTimeout(function(){k=l(d,a,r);c(k.err,k.data)},10))};if(d)if(0==d.toLowerCase().indexOf("blob"))f("Loading the file... Please wait...");
else{f("Downloading the file... Please wait...");var k=(new Date).getTime();r.onprogress=function(c){if(k){var f=new Date;if(300>f.getTime()-k)return;k=f.getTime()}f=c.totalSize||c.total||0;0==f&&"undefined"!==typeof g_docsize&&(f=g_docsize||0);1.8446744073709552E19<=f&&(f=0);c=c.position||c.loaded||0;var r=document.getElementById("inner_progress");r&&(r.innerHTML=" ("+number_format(c)+"/"+number_format(f)+")")}}try{r.send(null)}catch(h){f("Loading..."),c(h.message,null)}}var p=this;this.byteArrayFromString=
function(h,b){var c;"utf8"===b?c=a(h,g(h),!1):("binary"!==b&&p.log("unknown encoding: "+b),c=d(h));return c};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.readFile=h;this.read=function(d,a,c,f){h(d,"binary",function(r,k){var d=null;if(k){if("string"===typeof k)throw"This should not happen.";d=k.subarray(a,a+c)}f(r,d)})};this.readFileSync=function(d,a){var c=n(d,a,!1),f;try{c.send(null);f=l(d,a,c);
if(f.err)throw f.err;if(null===f.data)throw"No data read from "+d+".";}catch(r){throw r;}return f.data};this.writeFile=function(d,a,c){var f=new XMLHttpRequest,r;f.open("PUT",d,!0);f.onreadystatechange=function(){4===f.readyState&&(0!==f.status||f.responseText?200<=f.status&&300>f.status||0===f.status?c(null):c("Status "+String(f.status)+": "+f.responseText||f.statusText):c("File "+d+" is empty."))};r=a.buffer&&!f.sendAsBinary?a.buffer:p.byteArrayToString(a,"binary");try{f.sendAsBinary?f.sendAsBinary(r):
f.send(r)}catch(k){p.log("HUH? "+k+" "+a),c(k.message)}};this.deleteFile=function(d,a){var c=new XMLHttpRequest;c.open("DELETE",d,!0);c.onreadystatechange=function(){4===c.readyState&&(200>c.status&&300<=c.status?a(c.responseText):a(null))};c.send(null)};this.loadXML=function(d,a){var c=new XMLHttpRequest;c.open("GET",d,!0);c.overrideMimeType&&c.overrideMimeType("text/xml");c.onreadystatechange=function(){4===c.readyState&&(0!==c.status||c.responseText?200===c.status||0===c.status?a(null,c.responseXML):
a(c.responseText,null):a("File "+d+" is empty.",null))};try{c.send(null)}catch(f){a(f.message,null)}};this.log=b;this.enableAlerts=!0;this.assert=Runtime.assert;this.setTimeout=function(d,a){return setTimeout(function(){d()},a)};this.clearTimeout=function(d){clearTimeout(d)};this.libraryPaths=function(){return["lib"]};this.setCurrentDirectory=function(){};this.currentDirectory=function(){return""};this.type=function(){return"BrowserRuntime"};this.getDOMImplementation=function(){return window.document.implementation};
this.parseXML=function(d){var a=new DOMParser;d&&(d=d.trim());return a.parseFromString(d,"text/xml")};this.exit=function(d){b("Calling exit with code "+String(d)+", but exit() is not implemented.")};this.getWindow=function(){return window};this.requestAnimationFrame=function(d){var a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,c=0;if(a)a.bind(window),c=a(d);else return setTimeout(d,15);return c};this.cancelAnimationFrame=
function(d){var a=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame;a?(a.bind(window),a(d)):clearTimeout(d)}}
function NodeJSRuntime(){function e(d){var a=d.length,h,c=new Uint8Array(new ArrayBuffer(a));for(h=0;h<a;h+=1)c[h]=d[h];return c}function g(a,h,n){function c(c,r){if(c)return n(c,null);if(!r)return n("No data for "+a+".",null);if("string"===typeof r)return n(c,r);n(c,e(r))}a=b.resolve(l,a);"binary"!==h?d.readFile(a,h,c):d.readFile(a,null,c)}var a=this,d=require("fs"),b=require("path"),l="",n,h;this.byteArrayFromString=function(d,a){var h=new Buffer(d,a),c,f=h.length,r=new Uint8Array(new ArrayBuffer(f));
for(c=0;c<f;c+=1)r[c]=h[c];return r};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.readFile=g;this.loadXML=function(d,h){g(d,"utf-8",function(b,c){if(b)return h(b,null);if(!c)return h("No data for "+d+".",null);h(null,a.parseXML(c))})};this.writeFile=function(a,h,n){h=new Buffer(h);a=b.resolve(l,a);d.writeFile(a,h,"binary",function(c){n(c||null)})};this.deleteFile=function(a,h){a=b.resolve(l,a);
d.unlink(a,h)};this.read=function(a,h,n,c){a=b.resolve(l,a);d.open(a,"r+",666,function(f,r){if(f)c(f,null);else{var k=new Buffer(n);d.read(r,k,0,n,h,function(f){d.close(r);c(f,e(k))})}})};this.readFileSync=function(a,h){var b;b=d.readFileSync(a,"binary"===h?null:h);if(null===b)throw"File "+a+" could not be read.";"binary"===h&&(b=e(b));return b};this.log=function(a,d){var h;void 0!==d?h=a:d=a;"alert"===h&&process.stderr.write("\n!!!!! ALERT !!!!!\n");process.stderr.write(d+"\n");"alert"===h&&process.stderr.write("!!!!! ALERT !!!!!\n")};
this.assert=Runtime.assert;this.setTimeout=function(a,d){return setTimeout(function(){a()},d)};this.clearTimeout=function(a){clearTimeout(a)};this.libraryPaths=function(){return[__dirname]};this.setCurrentDirectory=function(a){l=a};this.currentDirectory=function(){return l};this.type=function(){return"NodeJSRuntime"};this.getDOMImplementation=function(){return h};this.parseXML=function(a){a&&(a=a.trim());return n.parseFromString(a,"text/xml")};this.exit=process.exit;this.getWindow=function(){return null};
this.requestAnimationFrame=function(a){return setTimeout(a,15)};this.cancelAnimationFrame=function(a){clearTimeout(a)};n=new (require("xmldom").DOMParser);h=a.parseXML("<a/>").implementation}
function RhinoRuntime(){var e=this,g={},a=g.javax.xml.parsers.DocumentBuilderFactory.newInstance(),d,b,l="";a.setValidating(!1);a.setNamespaceAware(!0);a.setExpandEntityReferences(!1);a.setSchema(null);b=g.org.xml.sax.EntityResolver({resolveEntity:function(a,d){var b=new g.java.io.FileReader(d);return new g.org.xml.sax.InputSource(b)}});d=a.newDocumentBuilder();d.setEntityResolver(b);this.byteArrayFromString=function(a,d){var b,l=a.length,e=new Uint8Array(new ArrayBuffer(l));for(b=0;b<l;b+=1)e[b]=
a.charCodeAt(b)&255;return e};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.loadXML=function(a,h){var b=new g.java.io.File(a),l=null;try{l=d.parse(b)}catch(e){return print(e),h(e,null)}h(null,l)};this.readFile=function(a,d,b){l&&(a=l+"/"+a);var m=new g.java.io.File(a),q="binary"===d?"latin1":d;m.isFile()?((a=readFile(a,q))&&"binary"===d&&(a=e.byteArrayFromString(a,"binary")),b(null,a)):b(a+" is not a file.",
null)};this.writeFile=function(a,d,b){l&&(a=l+"/"+a);a=new g.java.io.FileOutputStream(a);var e,q=d.length;for(e=0;e<q;e+=1)a.write(d[e]);a.close();b(null)};this.deleteFile=function(a,d){l&&(a=l+"/"+a);var b=new g.java.io.File(a),e=a+Math.random(),e=new g.java.io.File(e);b.rename(e)?(e.deleteOnExit(),d(null)):d("Could not delete "+a)};this.read=function(a,d,b,e){l&&(a=l+"/"+a);var q;q=a;var c="binary";(new g.java.io.File(q)).isFile()?("binary"===c&&(c="latin1"),q=readFile(q,c)):q=null;q?e(null,this.byteArrayFromString(q.substring(d,
d+b),"binary")):e("Cannot read "+a,null)};this.readFileSync=function(a,d){if(!d)return"";var b=readFile(a,d);if(null===b)throw"File could not be read.";return b};this.log=function(a,d){var b;void 0!==d?b=a:d=a;"alert"===b&&print("\n!!!!! ALERT !!!!!");print(d);"alert"===b&&print("!!!!! ALERT !!!!!")};this.assert=Runtime.assert;this.setTimeout=function(a){a();return 0};this.clearTimeout=function(){};this.libraryPaths=function(){return["lib"]};this.setCurrentDirectory=function(a){l=a};this.currentDirectory=
function(){return l};this.type=function(){return"RhinoRuntime"};this.getDOMImplementation=function(){return d.getDOMImplementation()};this.parseXML=function(a){a=new g.java.io.StringReader(a);a=new g.org.xml.sax.InputSource(a);return d.parse(a)};this.exit=quit;this.getWindow=function(){return null};this.requestAnimationFrame=function(a){a();return 0};this.cancelAnimationFrame=function(){}}
Runtime.create=function(){return"undefined"!==String(typeof window)?new BrowserRuntime(window.document.getElementById("logoutput")):"undefined"!==String(typeof require)?new NodeJSRuntime:new RhinoRuntime};var runtime=Runtime.create(),core={},gui={},xmldom={},odf={},ops={},webodf={};(function(){webodf.Version="undefined"!==String(typeof webodf_version)?webodf_version:"From Source"})();
(function(){function e(a,d,b){var e=a+"/manifest.json",c,f;runtime.log("Loading manifest: "+e);try{c=runtime.readFileSync(e,"utf-8")}catch(r){if(b)runtime.log("No loadable manifest found.");else throw console.log(String(r)),r;return}b=JSON.parse(c);for(f in b)b.hasOwnProperty(f)&&(d[f]={dir:a,deps:b[f]})}function g(a,d,b){function e(k){if(!r[k]&&!b(k)){if(f[k])throw"Circular dependency detected for "+k+".";f[k]=!0;if(!d[k])throw"Missing dependency information for class "+k+".";var a=d[k],h=a.deps,
l,g=h.length;for(l=0;l<g;l+=1)e(h[l]);f[k]=!1;r[k]=!0;c.push(a.dir+"/"+k.replace(".","/")+".js")}}var c=[],f={},r={};a.forEach(e);return c}function a(a,d){return d+("\n//# sourceURL="+a)}function d(d){var b,e;for(b=0;b<d.length;b+=1)e=runtime.readFileSync(d[b],"utf-8"),e=a(d[b],e),eval(e)}function b(a){a=a.split(".");var d,b=n,e=a.length;for(d=0;d<e;d+=1){if(!b.hasOwnProperty(a[d]))return!1;b=b[a[d]]}return!0}var l,n={core:core,gui:gui,xmldom:xmldom,odf:odf,ops:ops};runtime.loadClasses=function(a,
n){if(IS_COMPILED_CODE||0===a.length)return n&&n();var m;if(!(m=l)){m=[];var q=runtime.libraryPaths(),c;runtime.currentDirectory()&&-1===q.indexOf(runtime.currentDirectory())&&e(runtime.currentDirectory(),m,!0);for(c=0;c<q.length;c+=1)e(q[c],m)}l=m;a=g(a,l,b);if(0===a.length)return n&&n();if("BrowserRuntime"===runtime.type()&&n){m=a;q=document.currentScript||document.documentElement.lastChild;c=document.createDocumentFragment();var f,r;for(r=0;r<m.length;r+=1)f=document.createElement("script"),f.type=
"text/javascript",f.charset="utf-8",f.async=!1,f.setAttribute("src",m[r]),c.appendChild(f);n&&(f.onload=n);q.parentNode.insertBefore(c,q)}else d(a),n&&n()};runtime.loadClass=function(a,d){runtime.loadClasses([a],d)}})();(function(){var e=function(e){return e};runtime.getTranslator=function(){return e};runtime.setTranslator=function(g){e=g};runtime.tr=function(g){var a=e(g);return a&&"string"===String(typeof a)?a:g}})();
(function(e){function g(a){if(a.length){var d=a[0];runtime.readFile(d,"utf8",function(b,e){function g(){var a;(a=eval(p))&&runtime.exit(a)}var h="",h=d.lastIndexOf("/"),p=e,h=-1!==h?d.substring(0,h):".";runtime.setCurrentDirectory(h);b?(runtime.log(b),runtime.exit(1)):null===p?(runtime.log("No code found for "+d),runtime.exit(1)):g.apply(null,a)})}}e=e?Array.prototype.slice.call(e):[];"NodeJSRuntime"===runtime.type()?g(process.argv.slice(2)):"RhinoRuntime"===runtime.type()?g(e):g(e.slice(1))})("undefined"!==
String(typeof arguments)&&arguments);(function(){core.Async=function(){return{forEach:function(e,g,a){function d(d){n!==l&&(d?(n=l,a(d)):(n+=1,n===l&&a(null)))}var b,l=e.length,n=0;for(b=0;b<l;b+=1)g(e[b],d)},destroyAll:function(e,g){function a(d,b){if(b)g(b);else if(d<e.length)e[d](function(b){a(d+1,b)});else g()}a(0,void 0)}}}()})();
function makeBase64(){function e(c){var k,f=c.length,r=new Uint8Array(new ArrayBuffer(f));for(k=0;k<f;k+=1)r[k]=c.charCodeAt(k)&255;return r}function g(c){var k,f="",r,a=c.length-2;for(r=0;r<a;r+=3)k=c[r]<<16|c[r+1]<<8|c[r+2],f+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k>>>18],f+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k>>>12&63],f+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k>>>6&63],f+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k&
63];r===a+1?(k=c[r]<<4,f+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k>>>6],f+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k&63],f+="=="):r===a&&(k=c[r]<<10|c[r+1]<<2,f+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k>>>12],f+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k>>>6&63],f+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k&63],f+="=");return f}function a(c){c=c.replace(/[^A-Za-z0-9+\/]+/g,
"");var f=c.length,r=new Uint8Array(new ArrayBuffer(3*f)),a=c.length%4,d=0,b,e;for(b=0;b<f;b+=4)e=(k[c.charAt(b)]||0)<<18|(k[c.charAt(b+1)]||0)<<12|(k[c.charAt(b+2)]||0)<<6|(k[c.charAt(b+3)]||0),r[d]=e>>16,r[d+1]=e>>8&255,r[d+2]=e&255,d+=3;f=3*f-[0,0,2,1][a];return r.subarray(0,f)}function d(c){var k,f,r=c.length,a=0,d=new Uint8Array(new ArrayBuffer(3*r));for(k=0;k<r;k+=1)f=c[k],128>f?d[a++]=f:(2048>f?d[a++]=192|f>>>6:(d[a++]=224|f>>>12&15,d[a++]=128|f>>>6&63),d[a++]=128|f&63);return d.subarray(0,
a)}function b(c){var k,f,r,a,d=c.length,b=new Uint8Array(new ArrayBuffer(d)),e=0;for(k=0;k<d;k+=1)f=c[k],128>f?b[e++]=f:(k+=1,r=c[k],224>f?b[e++]=(f&31)<<6|r&63:(k+=1,a=c[k],b[e++]=(f&15)<<12|(r&63)<<6|a&63));return b.subarray(0,e)}function l(c){return g(e(c))}function n(c){return String.fromCharCode.apply(String,a(c))}function h(c){return b(e(c))}function p(c){c=b(c);for(var k="",f=0;f<c.length;)k+=String.fromCharCode.apply(String,c.subarray(f,f+45E3)),f+=45E3;return k}function m(c,k,f){var r,a,
d,b="";for(d=k;d<f;d+=1)k=c.charCodeAt(d)&255,128>k?b+=String.fromCharCode(k):(d+=1,r=c.charCodeAt(d)&255,224>k?b+=String.fromCharCode((k&31)<<6|r&63):(d+=1,a=c.charCodeAt(d)&255,b+=String.fromCharCode((k&15)<<12|(r&63)<<6|a&63)));return b}function q(c,k){function f(){var d=a+1E5;d>c.length&&(d=c.length);r+=m(c,a,d);a=d;d=a===c.length;k(r,d)&&!d&&runtime.setTimeout(f,0)}var r="",a=0;1E5>c.length?k(m(c,0,c.length),!0):("string"!==typeof c&&(c=c.slice()),f())}function c(c){return d(e(c))}function f(c){return String.fromCharCode.apply(String,
d(c))}function r(c){return String.fromCharCode.apply(String,d(e(c)))}var k=function(c){var k={},f,r;f=0;for(r=c.length;f<r;f+=1)k[c.charAt(f)]=f;return k}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),u,v,z=runtime.getWindow(),w,t;z&&z.btoa?(w=z.btoa,u=function(c){return w(r(c))}):(w=l,u=function(k){return g(c(k))});z&&z.atob?(t=z.atob,v=function(c){c=t(c);return m(c,0,c.length)}):(t=n,v=function(c){return p(a(c))});core.Base64=function(){this.convertByteArrayToBase64=this.convertUTF8ArrayToBase64=
g;this.convertBase64ToByteArray=this.convertBase64ToUTF8Array=a;this.convertUTF16ArrayToByteArray=this.convertUTF16ArrayToUTF8Array=d;this.convertByteArrayToUTF16Array=this.convertUTF8ArrayToUTF16Array=b;this.convertUTF8StringToBase64=l;this.convertBase64ToUTF8String=n;this.convertUTF8StringToUTF16Array=h;this.convertByteArrayToUTF16String=this.convertUTF8ArrayToUTF16String=p;this.convertUTF8StringToUTF16String=q;this.convertUTF16StringToByteArray=this.convertUTF16StringToUTF8Array=c;this.convertUTF16ArrayToUTF8String=
f;this.convertUTF16StringToUTF8String=r;this.convertUTF16StringToBase64=u;this.convertBase64ToUTF16String=v;this.fromBase64=n;this.toBase64=l;this.atob=t;this.btoa=w;this.utob=r;this.btou=q;this.encode=u;this.encodeURI=function(c){return u(c).replace(/[+\/]/g,function(c){return"+"===c?"-":"_"}).replace(/\\=+$/,"")};this.decode=function(c){return v(c.replace(/[\-_]/g,function(c){return"-"===c?"+":"/"}))};return this};return core.Base64}core.Base64=makeBase64();
core.ByteArray=function(e){this.pos=0;this.data=e;this.readUInt32LE=function(){this.pos+=4;var e=this.data,a=this.pos;return e[--a]<<24|e[--a]<<16|e[--a]<<8|e[--a]};this.readUInt16LE=function(){this.pos+=2;var e=this.data,a=this.pos;return e[--a]<<8|e[--a]}};
core.ByteArrayWriter=function(e){function g(a){a>b-d&&(b=Math.max(2*b,d+a),a=new Uint8Array(new ArrayBuffer(b)),a.set(l),l=a)}var a=this,d=0,b=1024,l=new Uint8Array(new ArrayBuffer(b));this.appendByteArrayWriter=function(d){a.appendByteArray(d.getByteArray())};this.appendByteArray=function(a){var b=a.length;g(b);l.set(a,d);d+=b};this.appendArray=function(a){var b=a.length;g(b);l.set(a,d);d+=b};this.appendUInt16LE=function(d){a.appendArray([d&255,d>>8&255])};this.appendUInt32LE=function(d){a.appendArray([d&
255,d>>8&255,d>>16&255,d>>24&255])};this.appendString=function(d){a.appendByteArray(runtime.byteArrayFromString(d,e))};this.getLength=function(){return d};this.getByteArray=function(){var a=new Uint8Array(new ArrayBuffer(d));a.set(l.subarray(0,d));return a}};
core.CSSUnits=function(){var e=this,g={"in":1,cm:2.54,mm:25.4,pt:72,pc:12,px:96};this.convert=function(a,d,b){return a*g[b]/g[d]};this.convertMeasure=function(a,d){var b,l;a&&d&&(b=parseFloat(a),l=a.replace(b.toString(),""),b=e.convert(b,l,d));return b};this.getUnits=function(a){return a.substr(a.length-2,a.length)}};
(function(){function e(){var d,b,e,g,h,p,m,q,c;void 0===a&&(b=(d=runtime.getWindow())&&d.document,p=b.documentElement,m=b.body,a={rangeBCRIgnoresElementBCR:!1,unscaledRangeClientRects:!1,elementBCRIgnoresBodyScroll:!1},b&&(g=b.createElement("div"),g.style.position="absolute",g.style.left="-99999px",g.style.transform="scale(2)",g.style["-webkit-transform"]="scale(2)",h=b.createElement("div"),g.appendChild(h),m.appendChild(g),d=b.createRange(),d.selectNode(h),a.rangeBCRIgnoresElementBCR=0===d.getClientRects().length,
h.appendChild(b.createTextNode("Rect transform test")),b=h.getBoundingClientRect(),e=d.getBoundingClientRect(),a.unscaledRangeClientRects=2<Math.abs(b.height-e.height),g.style.transform="",g.style["-webkit-transform"]="",b=p.style.overflow,e=m.style.overflow,q=m.style.height,c=m.scrollTop,p.style.overflow="visible",m.style.overflow="visible",m.style.height="200%",m.scrollTop=m.scrollHeight,a.elementBCRIgnoresBodyScroll=d.getBoundingClientRect().top!==h.getBoundingClientRect().top,m.scrollTop=c,m.style.height=
q,m.style.overflow=e,p.style.overflow=b,d.detach(),m.removeChild(g),d=Object.keys(a).map(function(c){return c+":"+String(a[c])}).join(", "),runtime.log("Detected browser quirks - "+d)));return a}function g(a,b,e){for(a=a?a.firstElementChild:null;a;){if(a.localName===e&&a.namespaceURI===b)return a;a=a.nextElementSibling}return null}var a;core.DomUtilsImpl=function(){function a(c,k){for(var f=0,d;c.parentNode!==k;)runtime.assert(null!==c.parentNode,"parent is null"),c=c.parentNode;for(d=k.firstChild;d!==
c;)f+=1,d=d.nextSibling;return f}function b(c,k){return 0>=c.compareBoundaryPoints(Range.START_TO_START,k)&&0<=c.compareBoundaryPoints(Range.END_TO_END,k)}function l(c,k){return 0>=c.compareBoundaryPoints(Range.END_TO_START,k)&&0<=c.compareBoundaryPoints(Range.START_TO_END,k)}function n(c,k){var f=null;c.nodeType===Node.TEXT_NODE&&(0===c.length?(c.parentNode.removeChild(c),k.nodeType===Node.TEXT_NODE&&(f=k)):(k.nodeType===Node.TEXT_NODE&&(c.appendData(k.data),k.parentNode.removeChild(k)),f=c));return f}
function h(c){for(var k=c.parentNode;c.firstChild;)k.insertBefore(c.firstChild,c);k.removeChild(c);return k}function p(c,k){for(var f=c.parentNode,a=c.firstChild,d;a;)d=a.nextSibling,p(a,k),a=d;f&&k(c)&&h(c);return f}function m(c,k){return c===k||Boolean(c.compareDocumentPosition(k)&Node.DOCUMENT_POSITION_CONTAINED_BY)}function q(c,k){return e().unscaledRangeClientRects?c:c/k}function c(f,k,a){Object.keys(k).forEach(function(d){var b=d.split(":"),e=b[1],h=a(b[0]),b=k[d],l=typeof b;"object"===l?Object.keys(b).length&&
(d=h?f.getElementsByTagNameNS(h,e)[0]||f.ownerDocument.createElementNS(h,d):f.getElementsByTagName(e)[0]||f.ownerDocument.createElement(d),f.appendChild(d),c(d,b,a)):h&&(runtime.assert("number"===l||"string"===l,"attempting to map unsupported type '"+l+"' (key: "+d+")"),f.setAttributeNS(h,d,String(b)))})}var f=null;this.splitBoundaries=function(c){var k,f=[],b,e,h;if(c.startContainer.nodeType===Node.TEXT_NODE||c.endContainer.nodeType===Node.TEXT_NODE){b=c.endContainer;e=c.endContainer.nodeType!==
Node.TEXT_NODE?c.endOffset===c.endContainer.childNodes.length:!1;h=c.endOffset;k=c.endContainer;if(h<k.childNodes.length)for(k=k.childNodes.item(h),h=0;k.firstChild;)k=k.firstChild;else for(;k.lastChild;)k=k.lastChild,h=k.nodeType===Node.TEXT_NODE?k.textContent.length:k.childNodes.length;k===b&&(b=null);c.setEnd(k,h);h=c.endContainer;0!==c.endOffset&&h.nodeType===Node.TEXT_NODE&&(k=h,c.endOffset!==k.length&&(f.push(k.splitText(c.endOffset)),f.push(k)));h=c.startContainer;0!==c.startOffset&&h.nodeType===
Node.TEXT_NODE&&(k=h,c.startOffset!==k.length&&(h=k.splitText(c.startOffset),f.push(k),f.push(h),c.setStart(h,0)));if(null!==b){for(h=c.endContainer;h.parentNode&&h.parentNode!==b;)h=h.parentNode;e=e?b.childNodes.length:a(h,b);c.setEnd(b,e)}}return f};this.containsRange=b;this.rangesIntersect=l;this.rangeIntersection=function(c,f){var a;l(c,f)&&(a=c.cloneRange(),-1===c.compareBoundaryPoints(Range.START_TO_START,f)&&a.setStart(f.startContainer,f.startOffset),1===c.compareBoundaryPoints(Range.END_TO_END,
f)&&a.setEnd(f.endContainer,f.endOffset));return a};this.getNodesInRange=function(c,f,a){var d=[],b=c.commonAncestorContainer,b=b.nodeType===Node.TEXT_NODE?b.parentNode:b;a=c.startContainer.ownerDocument.createTreeWalker(b,a,f,!1);var e,h;c.endContainer.childNodes[c.endOffset-1]?(e=c.endContainer.childNodes[c.endOffset-1],h=Node.DOCUMENT_POSITION_PRECEDING|Node.DOCUMENT_POSITION_CONTAINED_BY):(e=c.endContainer,h=Node.DOCUMENT_POSITION_PRECEDING);if(c.startContainer.childNodes[c.startOffset])c=c.startContainer.childNodes[c.startOffset],
a.currentNode=c;else{var l=c.startContainer;c.startOffset===(l.nodeType===Node.TEXT_NODE?l.length:l.childNodes.length)?(c=c.startContainer,a.currentNode=c,a.lastChild(),c=a.nextNode()):(c=c.startContainer,a.currentNode=c)}if(c){c=a.currentNode;if(c!==b)for(c=c.parentNode;c&&c!==b;)f(c)===NodeFilter.FILTER_REJECT&&(a.currentNode=c),c=c.parentNode;c=a.currentNode;switch(f(c)){case NodeFilter.FILTER_REJECT:for(c=a.nextSibling();!c&&a.parentNode();)c=a.nextSibling();break;case NodeFilter.FILTER_SKIP:c=
a.nextNode()}for(;c;){f=e.compareDocumentPosition(c);if(0!==f&&0===(f&h))break;d.push(c);c=a.nextNode()}}return d};this.normalizeTextNodes=function(c){c&&c.nextSibling&&(c=n(c,c.nextSibling));c&&c.previousSibling&&n(c.previousSibling,c)};this.rangeContainsNode=function(c,f){var a=f.ownerDocument.createRange(),d=f.ownerDocument.createRange(),e;a.setStart(c.startContainer,c.startOffset);a.setEnd(c.endContainer,c.endOffset);d.selectNodeContents(f);e=b(a,d);a.detach();d.detach();return e};this.mergeIntoParent=
h;this.removeUnwantedNodes=p;this.getElementsByTagNameNS=function(c,f,a){var d=[];c=c.getElementsByTagNameNS(f,a);d.length=a=c.length;for(f=0;f<a;f+=1)d[f]=c.item(f);return d};this.getElementsByTagName=function(c,f){var a=[],d,b,e;d=c.getElementsByTagName(f);a.length=e=d.length;for(b=0;b<e;b+=1)a[b]=d.item(b);return a};this.containsNode=function(c,f){return c===f||c.contains(f)};this.comparePoints=function(c,f,b,e){if(c===b)return e-f;var h=c.compareDocumentPosition(b);2===h?h=-1:4===h?h=1:10===h?
(f=a(c,b),h=f<e?1:-1):(e=a(b,c),h=e<f?-1:1);return h};this.adaptRangeDifferenceToZoomLevel=q;this.translateRect=function(c,f,a){return{top:q(c.top-f.top,a),left:q(c.left-f.left,a),bottom:q(c.bottom-f.top,a),right:q(c.right-f.left,a),width:q(c.width,a),height:q(c.height,a)}};this.getBoundingClientRect=function(c){var k=c.ownerDocument,a=e(),d=k.body;if((!1===a.unscaledRangeClientRects||a.rangeBCRIgnoresElementBCR)&&c.nodeType===Node.ELEMENT_NODE)return c=c.getBoundingClientRect(),a.elementBCRIgnoresBodyScroll?
{left:c.left+d.scrollLeft,right:c.right+d.scrollLeft,top:c.top+d.scrollTop,bottom:c.bottom+d.scrollTop,width:c.width,height:c.height}:c;var b;f?b=f:f=b=k.createRange();a=b;a.selectNode(c);return a.getBoundingClientRect()};this.mapKeyValObjOntoNode=function(c,f,a){Object.keys(f).forEach(function(d){var b=d.split(":"),e=b[1],b=a(b[0]),h=f[d];b?(e=c.getElementsByTagNameNS(b,e)[0],e||(e=c.ownerDocument.createElementNS(b,d),c.appendChild(e)),e.textContent=h):runtime.log("Key ignored: "+d)})};this.removeKeyElementsFromNode=
function(c,f,a){f.forEach(function(f){var k=f.split(":"),d=k[1];(k=a(k[0]))?(d=c.getElementsByTagNameNS(k,d)[0])?d.parentNode.removeChild(d):runtime.log("Element for "+f+" not found."):runtime.log("Property Name ignored: "+f)})};this.getKeyValRepresentationOfNode=function(c,f){for(var a={},d=c.firstElementChild,b;d;){if(b=f(d.namespaceURI))a[b+":"+d.localName]=d.textContent;d=d.nextElementSibling}return a};this.mapObjOntoNode=c;this.cloneEvent=function(c){var f=Object.create(null);Object.keys(c.constructor.prototype).forEach(function(a){f[a]=
c[a]});null==f.clientX&&(f=Object.create(null),Object.keys(c).forEach(function(a){f[a]=c[a]}));f.prototype=c.constructor.prototype;return f};this.getDirectChild=g;(function(c){var f,a;a=runtime.getWindow();null!==a&&(f=a.navigator.appVersion.toLowerCase(),a=-1===f.indexOf("chrome")&&(-1!==f.indexOf("applewebkit")||-1!==f.indexOf("safari")),f=-1!==f.indexOf("msie")||-1!==f.indexOf("trident"),a||f)&&(c.containsNode=m)})(this)};core.DomUtils=new core.DomUtilsImpl})();
core.Cursor=function(e,g){function a(c){c.parentNode&&(h.push(c.previousSibling),h.push(c.nextSibling),c.parentNode.removeChild(c))}function d(c,f,a){if(f.nodeType===Node.TEXT_NODE){runtime.assert(Boolean(f),"putCursorIntoTextNode: invalid container");var k=f.parentNode;runtime.assert(Boolean(k),"putCursorIntoTextNode: container without parent");runtime.assert(0<=a&&a<=f.length,"putCursorIntoTextNode: offset is out of bounds");0===a?k.insertBefore(c,f):(a!==f.length&&f.splitText(a),k.insertBefore(c,
f.nextSibling))}else f.nodeType===Node.ELEMENT_NODE&&f.insertBefore(c,f.childNodes.item(a));h.push(c.previousSibling);h.push(c.nextSibling)}var b=e.createElementNS("urn:webodf:names:cursor","cursor"),l=e.createElementNS("urn:webodf:names:cursor","anchor"),n,h=[],p=e.createRange(),m,q=core.DomUtils;this.getNode=function(){return b};this.getAnchorNode=function(){return l.parentNode?l:b};this.getSelectedRange=function(){m?(p.setStartBefore(b),p.collapse(!0)):(p.setStartAfter(n?l:b),p.setEndBefore(n?
b:l));return p};this.setSelectedRange=function(c,f){p&&p!==c&&p.detach();p=c;n=!1!==f;(m=c.collapsed)?(a(l),a(b),d(b,c.startContainer,c.startOffset)):(a(l),a(b),d(n?b:l,c.endContainer,c.endOffset),d(n?l:b,c.startContainer,c.startOffset));h.forEach(q.normalizeTextNodes);h.length=0};this.hasForwardSelection=function(){return n};this.remove=function(){a(b);h.forEach(q.normalizeTextNodes);h.length=0};b.setAttributeNS("urn:webodf:names:cursor","memberId",g);l.setAttributeNS("urn:webodf:names:cursor","memberId",
g)};core.Destroyable=function(){};core.Destroyable.prototype.destroy=function(e){};core.EventSource=function(){};core.EventSource.prototype.subscribe=function(e,g){};core.EventSource.prototype.unsubscribe=function(e,g){};
core.EventNotifier=function(e){function g(d){runtime.assert(!a.hasOwnProperty(d),'Duplicated event ids: "'+d+'" registered more than once.');a[d]=[]}var a={};this.emit=function(d,b){var e,g;runtime.assert(a.hasOwnProperty(d),'unknown event fired "'+d+'"');g=a[d];for(e=0;e<g.length;e+=1)g[e](b)};this.subscribe=function(d,b){runtime.assert(a.hasOwnProperty(d),'tried to subscribe to unknown event "'+d+'"');a[d].push(b)};this.unsubscribe=function(d,b){var e;runtime.assert(a.hasOwnProperty(d),'tried to unsubscribe from unknown event "'+
d+'"');e=a[d].indexOf(b);runtime.assert(-1!==e,'tried to unsubscribe unknown callback from event "'+d+'"');-1!==e&&a[d].splice(e,1)};this.register=g;e&&e.forEach(g)};
core.ScheduledTask=function(e,g,a){function d(){n&&(a(l),n=!1)}function b(){d();e.apply(void 0,h);h=null}var l,n=!1,h=[],p=!1;this.trigger=function(){runtime.assert(!1===p,"Can't trigger destroyed ScheduledTask instance");h=Array.prototype.slice.call(arguments);n||(n=!0,l=g(b))};this.triggerImmediate=function(){runtime.assert(!1===p,"Can't trigger destroyed ScheduledTask instance");h=Array.prototype.slice.call(arguments);b()};this.processRequests=function(){n&&b()};this.cancel=d;this.restart=function(){runtime.assert(!1===
p,"Can't trigger destroyed ScheduledTask instance");d();n=!0;l=g(b)};this.destroy=function(a){d();p=!0;a()}};
(function(){var e;core.Task={};core.Task.SUPPRESS_MANUAL_PROCESSING=!1;core.Task.processTasks=function(){core.Task.SUPPRESS_MANUAL_PROCESSING||e.performRedraw()};core.Task.createRedrawTask=function(g){return new core.ScheduledTask(g,e.requestRedrawTask,e.cancelRedrawTask)};core.Task.createTimeoutTask=function(e,a){return new core.ScheduledTask(e,function(d){return runtime.setTimeout(d,a)},runtime.clearTimeout)};e=new function(){var e={};this.requestRedrawTask=function(a){var d=runtime.requestAnimationFrame(function(){a();
delete e[d]});e[d]=a;return d};this.performRedraw=function(){Object.keys(e).forEach(function(a){e[a]();runtime.cancelAnimationFrame(parseInt(a,10))});e={}};this.cancelRedrawTask=function(a){runtime.cancelAnimationFrame(a);delete e[a]}}})();
core.EventSubscriptions=function(){function e(d,b,e){d.subscribe(b,e);a.push({eventSource:d,eventid:b,callback:e})}function g(){var e=[];a.forEach(function(a){a.eventSource.unsubscribe(a.eventid,a.callback)});a.length=0;Object.keys(b).forEach(function(a){b[a].forEach(function(a){e.push(a.task.destroy)});delete b[a]});core.Async.destroyAll(e,function(){});d=new core.EventNotifier}var a=[],d=new core.EventNotifier,b={},l=0;this.addSubscription=e;this.addFrameSubscription=function(a,h,g){var m,q,c,f;
b.hasOwnProperty(h)||(b[h]=[]);c=b[h];for(f=0;f<c.length;f+=1)if(c[f].eventSource===a){m=c[f];break}m||(q="s"+l,l+=1,d.register(q),m={frameEventId:q,eventSource:a,task:core.Task.createRedrawTask(function(){d.emit(q,void 0)})},c.push(m),e(a,h,m.task.trigger));d.subscribe(m.frameEventId,g)};this.unsubscribeAll=g;this.destroy=function(a){g();a()}};core.LazyProperty=function(e){var g,a=!1;this.value=function(){a||(g=e(),a=!0);return g};this.reset=function(){a=!1}};
core.LoopWatchDog=function(e,g){var a=Date.now(),d=0;this.check=function(){var b;if(e&&(b=Date.now(),b-a>e))throw runtime.log("alert","watchdog timeout"),"timeout!";if(0<g&&(d+=1,d>g))throw runtime.log("alert","watchdog loop overflow"),"loop overflow";}};core.NodeFilterChain=function(e){var g=NodeFilter.FILTER_REJECT,a=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(d){var b;for(b=0;b<e.length;b+=1)if(e[b].acceptNode(d)===g)return g;return a}};
core.PositionIterator=function(e,g,a,d){function b(){this.acceptNode=function(c){return!c||c.nodeType===r&&0===c.length?v:u}}function l(c){this.acceptNode=function(f){return!f||f.nodeType===r&&0===f.length?v:c.acceptNode(f)}}function n(){var f=q.currentNode,a=f.nodeType;c=a===r?f.length-1:a===k?1:0}function h(){if(null===q.previousSibling()){if(!q.parentNode()||q.currentNode===e)return q.firstChild(),!1;c=0}else n();return!0}function p(){var a=q.currentNode,k;k=f(a);if(a!==e)for(a=a.parentNode;a&&
a!==e;)f(a)===v&&(q.currentNode=a,k=v),a=a.parentNode;k===v?(c=q.currentNode.nodeType===r?a.length:1,a=m.nextPosition()):a=k===u?!0:m.nextPosition();a&&runtime.assert(f(q.currentNode)===u,"moveToAcceptedNode did not result in walker being on an accepted node");return a}var m=this,q,c,f,r=Node.TEXT_NODE,k=Node.ELEMENT_NODE,u=NodeFilter.FILTER_ACCEPT,v=NodeFilter.FILTER_REJECT;this.nextPosition=function(){var f=q.currentNode,a=f.nodeType;if(f===e)return!1;if(0===c&&a===k)null===q.firstChild()&&(c=1);
else if(a===r&&c+1<f.length)c+=1;else if(null!==q.nextSibling())c=0;else if(q.parentNode())c=1;else return!1;return!0};this.previousPosition=function(){var f=!0,a=q.currentNode;0===c?f=h():a.nodeType===r?c-=1:null!==q.lastChild()?n():a===e?f=!1:c=0;return f};this.previousNode=h;this.container=function(){var f=q.currentNode,a=f.nodeType;0===c&&a!==r&&(f=f.parentNode);return f};this.rightNode=function(){var a=q.currentNode,d=a.nodeType;if(d===r&&c===a.length)for(a=a.nextSibling;a&&f(a)!==u;)a=a.nextSibling;
else d===k&&1===c&&(a=null);return a};this.leftNode=function(){var a=q.currentNode;if(0===c)for(a=a.previousSibling;a&&f(a)!==u;)a=a.previousSibling;else if(a.nodeType===k)for(a=a.lastChild;a&&f(a)!==u;)a=a.previousSibling;return a};this.getCurrentNode=function(){return q.currentNode};this.unfilteredDomOffset=function(){if(q.currentNode.nodeType===r)return c;for(var f=0,a=q.currentNode,a=1===c?a.lastChild:a.previousSibling;a;)f+=1,a=a.previousSibling;return f};this.getPreviousSibling=function(){var c=
q.currentNode,f=q.previousSibling();q.currentNode=c;return f};this.getNextSibling=function(){var c=q.currentNode,f=q.nextSibling();q.currentNode=c;return f};this.setPositionBeforeElement=function(f){runtime.assert(Boolean(f),"setPositionBeforeElement called without element");q.currentNode=f;c=0;return p()};this.setUnfilteredPosition=function(f,a){runtime.assert(Boolean(f),"PositionIterator.setUnfilteredPosition called without container");q.currentNode=f;f.nodeType===r?(c=a,runtime.assert(a<=f.length,
"Error in setPosition: "+a+" > "+f.length),runtime.assert(0<=a,"Error in setPosition: "+a+" < 0"),a===f.length&&(q.nextSibling()?c=0:q.parentNode()?c=1:runtime.assert(!1,"Error in setUnfilteredPosition: position not valid."))):a<f.childNodes.length?(q.currentNode=f.childNodes.item(a),c=0):c=1;return p()};this.moveToEnd=function(){q.currentNode=e;c=1};this.moveToEndOfNode=function(f){f.nodeType===r?m.setUnfilteredPosition(f,f.length):(q.currentNode=f,c=1)};this.isBeforeNode=function(){return 0===c};
this.getNodeFilter=function(){return f};f=(a?new l(a):new b).acceptNode;f.acceptNode=f;g=g||NodeFilter.SHOW_ALL;runtime.assert(e.nodeType!==Node.TEXT_NODE,"Internet Explorer doesn't allow tree walker roots to be text nodes");q=e.ownerDocument.createTreeWalker(e,g,f,d);c=0;null===q.firstChild()&&(c=1)};core.PositionFilter=function(){};core.PositionFilter.FilterResult={FILTER_ACCEPT:1,FILTER_REJECT:2,FILTER_SKIP:3};core.PositionFilter.prototype.acceptPosition=function(e){};
core.PositionFilterChain=function(){var e=[],g=core.PositionFilter.FilterResult.FILTER_ACCEPT,a=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(d){var b;for(b=0;b<e.length;b+=1)if(e[b].acceptPosition(d)===a)return a;return g};this.addFilter=function(a){e.push(a)}};
(function(){core.RawInflate=function(){var e;(function(g){e=g()})(function(){return function a(d,b,e){function n(h,m){if(!b[h]){if(!d[h])throw Error("Cannot find module '"+h+"'");var q=b[h]={exports:{}};d[h][0].call(q.exports,function(c){var f=d[h][1][c];return n(f?f:c)},q,q.exports,a,d,b,e)}return b[h].exports}for(var h=0;h<e.length;h++)n(e[h]);return n}({1:[function(a,d,b){function e(c,f){var a=new r(f);a.push(c,!0);if(a.err)throw a.msg;return a.result}var n=a("./zlib/inflate.js"),h=a("./utils/common"),
p=a("./utils/strings"),m=a("./zlib/constants"),q=a("./zlib/messages"),c=a("./zlib/zstream"),f=a("./zlib/gzheader"),r=function(a){var d=this.options=h.assign({chunkSize:16384,windowBits:0,to:""},a||{});d.raw&&0<=d.windowBits&&16>d.windowBits&&(d.windowBits=-d.windowBits,0===d.windowBits&&(d.windowBits=-15));!(0<=d.windowBits&&16>d.windowBits)||a&&a.windowBits||(d.windowBits+=32);15<d.windowBits&&48>d.windowBits&&0===(d.windowBits&15)&&(d.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=
[];this.strm=new c;this.strm.avail_out=0;a=n.inflateInit2(this.strm,d.windowBits);if(a!==m.Z_OK)throw Error(q[a]);this.header=new f;n.inflateGetHeader(this.strm,this.header)};r.prototype.push=function(c,f){var a=this.strm,d=this.options.chunkSize,r,b,e,x,l;if(this.ended)return!1;b=f===~~f?f:!0===f?m.Z_FINISH:m.Z_NO_FLUSH;a.input="string"===typeof c?p.binstring2buf(c):c;a.next_in=0;a.avail_in=a.input.length;do{0===a.avail_out&&(a.output=new h.Buf8(d),a.next_out=0,a.avail_out=d);r=n.inflate(a,m.Z_NO_FLUSH);
if(r!==m.Z_STREAM_END&&r!==m.Z_OK)return this.onEnd(r),this.ended=!0,!1;if(a.next_out&&(0===a.avail_out||r===m.Z_STREAM_END||0===a.avail_in&&b===m.Z_FINISH))if("string"===this.options.to)e=p.utf8border(a.output,a.next_out),x=a.next_out-e,l=p.buf2string(a.output,e),a.next_out=x,a.avail_out=d-x,x&&h.arraySet(a.output,a.output,e,x,0),this.onData(l);else this.onData(h.shrinkBuf(a.output,a.next_out))}while((0<a.avail_in||0===a.avail_out)&&r!==m.Z_STREAM_END);r===m.Z_STREAM_END&&(b=m.Z_FINISH);return b===
m.Z_FINISH?(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===m.Z_OK):!0};r.prototype.onData=function(c){this.chunks.push(c)};r.prototype.onEnd=function(c){c===m.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):h.flattenChunks(this.chunks));this.chunks=[];this.err=c;this.msg=this.strm.msg};b.Inflate=r;b.inflate=e;b.inflateRaw=function(c,f){f=f||{};f.raw=!0;return e(c,f)};b.ungzip=e},{"./utils/common":2,"./utils/strings":3,"./zlib/constants":5,"./zlib/gzheader":7,"./zlib/inflate.js":9,
"./zlib/messages":11,"./zlib/zstream":12}],2:[function(a,d,b){a="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;b.assign=function(a){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var b=d.shift();if(b){if("object"!==typeof b)throw new TypeError(b+"must be non-object");for(var e in b)b.hasOwnProperty(e)&&(a[e]=b[e])}}return a};b.shrinkBuf=function(a,d){if(a.length===d)return a;if(a.subarray)return a.subarray(0,d);a.length=d;return a};
var e={arraySet:function(a,d,b,e,c){if(d.subarray&&a.subarray)a.set(d.subarray(b,b+e),c);else for(var f=0;f<e;f++)a[c+f]=d[b+f]},flattenChunks:function(a){var d,b,e,c,f;d=e=0;for(b=a.length;d<b;d++)e+=a[d].length;f=new Uint8Array(e);d=e=0;for(b=a.length;d<b;d++)c=a[d],f.set(c,e),e+=c.length;return f}},n={arraySet:function(a,d,b,e,c){for(var f=0;f<e;f++)a[c+f]=d[b+f]},flattenChunks:function(a){return[].concat.apply([],a)}};b.setTyped=function(a){a?(b.Buf8=Uint8Array,b.Buf16=Uint16Array,b.Buf32=Int32Array,
b.assign(b,e)):(b.Buf8=Array,b.Buf16=Array,b.Buf32=Array,b.assign(b,n))};b.setTyped(a)},{}],3:[function(a,d,b){function e(c,a){if(65537>a&&(c.subarray&&p||!c.subarray&&h))return String.fromCharCode.apply(null,n.shrinkBuf(c,a));for(var d="",b=0;b<a;b++)d+=String.fromCharCode(c[b]);return d}var n=a("./common"),h=!0,p=!0;try{String.fromCharCode.apply(null,[0])}catch(m){h=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(q){p=!1}var c=new n.Buf8(256);for(a=0;256>a;a++)c[a]=252<=a?6:248<=
a?5:240<=a?4:224<=a?3:192<=a?2:1;c[254]=c[254]=1;b.string2buf=function(c){var a,d,b,e,h,l=c.length,q=0;for(e=0;e<l;e++)d=c.charCodeAt(e),55296===(d&64512)&&e+1<l&&(b=c.charCodeAt(e+1),56320===(b&64512)&&(d=65536+(d-55296<<10)+(b-56320),e++)),q+=128>d?1:2048>d?2:65536>d?3:4;a=new n.Buf8(q);for(e=h=0;h<q;e++)d=c.charCodeAt(e),55296===(d&64512)&&e+1<l&&(b=c.charCodeAt(e+1),56320===(b&64512)&&(d=65536+(d-55296<<10)+(b-56320),e++)),128>d?a[h++]=d:(2048>d?a[h++]=192|d>>>6:(65536>d?a[h++]=224|d>>>12:(a[h++]=
240|d>>>18,a[h++]=128|d>>>12&63),a[h++]=128|d>>>6&63),a[h++]=128|d&63);return a};b.buf2binstring=function(c){return e(c,c.length)};b.binstring2buf=function(c){for(var a=new n.Buf8(c.length),d=0,b=a.length;d<b;d++)a[d]=c.charCodeAt(d);return a};b.buf2string=function(a,d){var k,b,h,q,n=d||a.length,m=Array(2*n);for(k=b=0;k<n;)if(h=a[k++],128>h)m[b++]=h;else if(q=c[h],4<q)m[b++]=65533,k+=q-1;else{for(h&=2===q?31:3===q?15:7;1<q&&k<n;)h=h<<6|a[k++]&63,q--;1<q?m[b++]=65533:65536>h?m[b++]=h:(h-=65536,m[b++]=
55296|h>>10&1023,m[b++]=56320|h&1023)}return e(m,b)};b.utf8border=function(a,d){var k;d=d||a.length;d>a.length&&(d=a.length);for(k=d-1;0<=k&&128===(a[k]&192);)k--;return 0>k||0===k?d:k+c[a[k]]>d?k:d}},{"./common":2}],4:[function(a,d,b){d.exports=function(a,d,b,e){var m=a&65535|0;a=a>>>16&65535|0;for(var q=0;0!==b;){q=2E3<b?2E3:b;b-=q;do m=m+d[e++]|0,a=a+m|0;while(--q);m%=65521;a%=65521}return m|a<<16|0}},{}],5:[function(a,d,b){d.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,
Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],6:[function(a,d,b){var e=function(){for(var a,d=[],b=0;256>b;b++){a=b;for(var e=0;8>e;e++)a=a&1?3988292384^a>>>1:a>>>1;d[b]=a}return d}();d.exports=function(a,d,b,m){b=m+b;for(a^=
-1;m<b;m++)a=a>>>8^e[(a^d[m])&255];return a^-1}},{}],7:[function(a,d,b){d.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],8:[function(a,d,b){d.exports=function(a,d){var b,e,m,q,c,f,r,k,u,v,z,w,t,A,x,E,N,I,H,F,G,s,y,D;b=a.state;e=a.next_in;y=a.input;m=e+(a.avail_in-5);q=a.next_out;D=a.output;c=q-(d-a.avail_out);f=q+(a.avail_out-257);r=b.dmax;k=b.wsize;u=b.whave;v=b.wnext;z=b.window;w=b.hold;t=b.bits;
A=b.lencode;x=b.distcode;E=(1<<b.lenbits)-1;N=(1<<b.distbits)-1;a:do b:for(15>t&&(w+=y[e++]<<t,t+=8,w+=y[e++]<<t,t+=8),I=A[w&E];;){H=I>>>24;w>>>=H;t-=H;H=I>>>16&255;if(0===H)D[q++]=I&65535;else if(H&16){F=I&65535;if(H&=15)t<H&&(w+=y[e++]<<t,t+=8),F+=w&(1<<H)-1,w>>>=H,t-=H;15>t&&(w+=y[e++]<<t,t+=8,w+=y[e++]<<t,t+=8);I=x[w&N];c:for(;;){H=I>>>24;w>>>=H;t-=H;H=I>>>16&255;if(H&16){I&=65535;H&=15;t<H&&(w+=y[e++]<<t,t+=8,t<H&&(w+=y[e++]<<t,t+=8));I+=w&(1<<H)-1;if(I>r){a.msg="invalid distance too far back";
b.mode=30;break a}w>>>=H;t-=H;H=q-c;if(I>H){H=I-H;if(H>u&&b.sane){a.msg="invalid distance too far back";b.mode=30;break a}G=0;s=z;if(0===v){if(G+=k-H,H<F){F-=H;do D[q++]=z[G++];while(--H);G=q-I;s=D}}else if(v<H){if(G+=k+v-H,H-=v,H<F){F-=H;do D[q++]=z[G++];while(--H);G=0;if(v<F){H=v;F-=H;do D[q++]=z[G++];while(--H);G=q-I;s=D}}}else if(G+=v-H,H<F){F-=H;do D[q++]=z[G++];while(--H);G=q-I;s=D}for(;2<F;)D[q++]=s[G++],D[q++]=s[G++],D[q++]=s[G++],F-=3;F&&(D[q++]=s[G++],1<F&&(D[q++]=s[G++]))}else{G=q-I;do D[q++]=
D[G++],D[q++]=D[G++],D[q++]=D[G++],F-=3;while(2<F);F&&(D[q++]=D[G++],1<F&&(D[q++]=D[G++]))}}else if(0===(H&64)){I=x[(I&65535)+(w&(1<<H)-1)];continue c}else{a.msg="invalid distance code";b.mode=30;break a}break}}else if(0===(H&64)){I=A[(I&65535)+(w&(1<<H)-1)];continue b}else{H&32?b.mode=12:(a.msg="invalid literal/length code",b.mode=30);break a}break}while(e<m&&q<f);F=t>>3;e-=F;t-=F<<3;a.next_in=e;a.next_out=q;a.avail_in=e<m?5+(m-e):5-(e-m);a.avail_out=q<f?257+(f-q):257-(q-f);b.hold=w&(1<<t)-1;b.bits=
t}},{}],9:[function(a,d,b){function e(c){return(c>>>24&255)+(c>>>8&65280)+((c&65280)<<8)+((c&255)<<24)}function n(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new c.Buf16(320);this.work=
new c.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function h(a){var f;if(!a||!a.state)return-2;f=a.state;a.total_in=a.total_out=f.total=0;a.msg="";f.wrap&&(a.adler=f.wrap&1);f.mode=1;f.last=0;f.havedict=0;f.dmax=32768;f.head=null;f.hold=0;f.bits=0;f.lencode=f.lendyn=new c.Buf32(852);f.distcode=f.distdyn=new c.Buf32(592);f.sane=1;f.back=-1;return 0}function p(c){var a;if(!c||!c.state)return-2;a=c.state;a.wsize=0;a.whave=0;a.wnext=0;return h(c)}function m(c,a){var f,d;if(!c||
!c.state)return-2;d=c.state;0>a?(f=0,a=-a):(f=(a>>4)+1,48>a&&(a&=15));if(a&&(8>a||15<a))return-2;null!==d.window&&d.wbits!==a&&(d.window=null);d.wrap=f;d.wbits=a;return p(c)}function q(c,a){var f;if(!c)return-2;f=new n;c.state=f;f.window=null;f=m(c,a);0!==f&&(c.state=null);return f}var c=a("../utils/common"),f=a("./adler32"),r=a("./crc32"),k=a("./inffast"),u=a("./inftrees"),v=!0,z,w;b.inflateReset=p;b.inflateReset2=m;b.inflateResetKeep=h;b.inflateInit=function(c){return q(c,15)};b.inflateInit2=q;
b.inflate=function(a,d){var b,h,q,m,n,p,G,s,y,D,T,C,B,P,O=0,ba,ca,da,W=new c.Buf8(4),J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!a||!a.state||!a.output||!a.input&&0!==a.avail_in)return-2;b=a.state;12===b.mode&&(b.mode=13);n=a.next_out;q=a.output;G=a.avail_out;m=a.next_in;h=a.input;p=a.avail_in;s=b.hold;y=b.bits;D=p;T=G;da=0;a:for(;;)switch(b.mode){case 1:if(0===b.wrap){b.mode=13;break}for(;16>y;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}if(b.wrap&2&&35615===s){b.check=0;W[0]=s&255;W[1]=s>>>
8&255;b.check=r(b.check,W,2,0);y=s=0;b.mode=2;break}b.flags=0;b.head&&(b.head.done=!1);if(!(b.wrap&1)||(((s&255)<<8)+(s>>8))%31){a.msg="incorrect header check";b.mode=30;break}if(8!==(s&15)){a.msg="unknown compression method";b.mode=30;break}s>>>=4;y-=4;B=(s&15)+8;if(0===b.wbits)b.wbits=B;else if(B>b.wbits){a.msg="invalid window size";b.mode=30;break}b.dmax=1<<B;a.adler=b.check=1;b.mode=s&512?10:12;y=s=0;break;case 2:for(;16>y;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}b.flags=s;if(8!==(b.flags&255)){a.msg=
"unknown compression method";b.mode=30;break}if(b.flags&57344){a.msg="unknown header flags set";b.mode=30;break}b.head&&(b.head.text=s>>8&1);b.flags&512&&(W[0]=s&255,W[1]=s>>>8&255,b.check=r(b.check,W,2,0));y=s=0;b.mode=3;case 3:for(;32>y;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}b.head&&(b.head.time=s);b.flags&512&&(W[0]=s&255,W[1]=s>>>8&255,W[2]=s>>>16&255,W[3]=s>>>24&255,b.check=r(b.check,W,4,0));y=s=0;b.mode=4;case 4:for(;16>y;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}b.head&&(b.head.xflags=s&255,
b.head.os=s>>8);b.flags&512&&(W[0]=s&255,W[1]=s>>>8&255,b.check=r(b.check,W,2,0));y=s=0;b.mode=5;case 5:if(b.flags&1024){for(;16>y;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}b.length=s;b.head&&(b.head.extra_len=s);b.flags&512&&(W[0]=s&255,W[1]=s>>>8&255,b.check=r(b.check,W,2,0));y=s=0}else b.head&&(b.head.extra=null);b.mode=6;case 6:if(b.flags&1024&&(C=b.length,C>p&&(C=p),C&&(b.head&&(B=b.head.extra_len-b.length,b.head.extra||(b.head.extra=Array(b.head.extra_len)),c.arraySet(b.head.extra,h,m,C,B)),
b.flags&512&&(b.check=r(b.check,h,C,m)),p-=C,m+=C,b.length-=C),b.length))break a;b.length=0;b.mode=7;case 7:if(b.flags&2048){if(0===p)break a;C=0;do B=h[m+C++],b.head&&B&&65536>b.length&&(b.head.name+=String.fromCharCode(B));while(B&&C<p);b.flags&512&&(b.check=r(b.check,h,C,m));p-=C;m+=C;if(B)break a}else b.head&&(b.head.name=null);b.length=0;b.mode=8;case 8:if(b.flags&4096){if(0===p)break a;C=0;do B=h[m+C++],b.head&&B&&65536>b.length&&(b.head.comment+=String.fromCharCode(B));while(B&&C<p);b.flags&
512&&(b.check=r(b.check,h,C,m));p-=C;m+=C;if(B)break a}else b.head&&(b.head.comment=null);b.mode=9;case 9:if(b.flags&512){for(;16>y;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}if(s!==(b.check&65535)){a.msg="header crc mismatch";b.mode=30;break}y=s=0}b.head&&(b.head.hcrc=b.flags>>9&1,b.head.done=!0);a.adler=b.check=0;b.mode=12;break;case 10:for(;32>y;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}a.adler=b.check=e(s);y=s=0;b.mode=11;case 11:if(0===b.havedict)return a.next_out=n,a.avail_out=G,a.next_in=m,a.avail_in=
p,b.hold=s,b.bits=y,2;a.adler=b.check=1;b.mode=12;case 12:if(5===d||6===d)break a;case 13:if(b.last){s>>>=y&7;y-=y&7;b.mode=27;break}for(;3>y;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}b.last=s&1;s>>>=1;y-=1;switch(s&3){case 0:b.mode=14;break;case 1:C=b;if(v){B=void 0;z=new c.Buf32(512);w=new c.Buf32(32);for(B=0;144>B;)C.lens[B++]=8;for(;256>B;)C.lens[B++]=9;for(;280>B;)C.lens[B++]=7;for(;288>B;)C.lens[B++]=8;u(1,C.lens,0,288,z,0,C.work,{bits:9});for(B=0;32>B;)C.lens[B++]=5;u(2,C.lens,0,32,w,0,C.work,
{bits:5});v=!1}C.lencode=z;C.lenbits=9;C.distcode=w;C.distbits=5;b.mode=20;if(6===d){s>>>=2;y-=2;break a}break;case 2:b.mode=17;break;case 3:a.msg="invalid block type",b.mode=30}s>>>=2;y-=2;break;case 14:s>>>=y&7;for(y-=y&7;32>y;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}if((s&65535)!==(s>>>16^65535)){a.msg="invalid stored block lengths";b.mode=30;break}b.length=s&65535;y=s=0;b.mode=15;if(6===d)break a;case 15:b.mode=16;case 16:if(C=b.length){C>p&&(C=p);C>G&&(C=G);if(0===C)break a;c.arraySet(q,h,m,
C,n);p-=C;m+=C;G-=C;n+=C;b.length-=C;break}b.mode=12;break;case 17:for(;14>y;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}b.nlen=(s&31)+257;s>>>=5;y-=5;b.ndist=(s&31)+1;s>>>=5;y-=5;b.ncode=(s&15)+4;s>>>=4;y-=4;if(286<b.nlen||30<b.ndist){a.msg="too many length or distance symbols";b.mode=30;break}b.have=0;b.mode=18;case 18:for(;b.have<b.ncode;){for(;3>y;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}b.lens[J[b.have++]]=s&7;s>>>=3;y-=3}for(;19>b.have;)b.lens[J[b.have++]]=0;b.lencode=b.lendyn;b.lenbits=7;C={bits:b.lenbits};
da=u(0,b.lens,0,19,b.lencode,0,b.work,C);b.lenbits=C.bits;if(da){a.msg="invalid code lengths set";b.mode=30;break}b.have=0;b.mode=19;case 19:for(;b.have<b.nlen+b.ndist;){for(;;){O=b.lencode[s&(1<<b.lenbits)-1];C=O>>>24;O&=65535;if(C<=y)break;if(0===p)break a;p--;s+=h[m++]<<y;y+=8}if(16>O)s>>>=C,y-=C,b.lens[b.have++]=O;else{if(16===O){for(B=C+2;y<B;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}s>>>=C;y-=C;if(0===b.have){a.msg="invalid bit length repeat";b.mode=30;break}B=b.lens[b.have-1];C=3+(s&3);s>>>=
2;y-=2}else if(17===O){for(B=C+3;y<B;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}s>>>=C;y-=C;B=0;C=3+(s&7);s>>>=3;y-=3}else{for(B=C+7;y<B;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}s>>>=C;y-=C;B=0;C=11+(s&127);s>>>=7;y-=7}if(b.have+C>b.nlen+b.ndist){a.msg="invalid bit length repeat";b.mode=30;break}for(;C--;)b.lens[b.have++]=B}}if(30===b.mode)break;if(0===b.lens[256]){a.msg="invalid code -- missing end-of-block";b.mode=30;break}b.lenbits=9;C={bits:b.lenbits};da=u(1,b.lens,0,b.nlen,b.lencode,0,b.work,C);
b.lenbits=C.bits;if(da){a.msg="invalid literal/lengths set";b.mode=30;break}b.distbits=6;b.distcode=b.distdyn;C={bits:b.distbits};da=u(2,b.lens,b.nlen,b.ndist,b.distcode,0,b.work,C);b.distbits=C.bits;if(da){a.msg="invalid distances set";b.mode=30;break}b.mode=20;if(6===d)break a;case 20:b.mode=21;case 21:if(6<=p&&258<=G){a.next_out=n;a.avail_out=G;a.next_in=m;a.avail_in=p;b.hold=s;b.bits=y;k(a,T);n=a.next_out;q=a.output;G=a.avail_out;m=a.next_in;h=a.input;p=a.avail_in;s=b.hold;y=b.bits;12===b.mode&&
(b.back=-1);break}for(b.back=0;;){O=b.lencode[s&(1<<b.lenbits)-1];C=O>>>24;B=O>>>16&255;O&=65535;if(C<=y)break;if(0===p)break a;p--;s+=h[m++]<<y;y+=8}if(B&&0===(B&240)){P=C;ba=B;for(ca=O;;){O=b.lencode[ca+((s&(1<<P+ba)-1)>>P)];C=O>>>24;B=O>>>16&255;O&=65535;if(P+C<=y)break;if(0===p)break a;p--;s+=h[m++]<<y;y+=8}s>>>=P;y-=P;b.back+=P}s>>>=C;y-=C;b.back+=C;b.length=O;if(0===B){b.mode=26;break}if(B&32){b.back=-1;b.mode=12;break}if(B&64){a.msg="invalid literal/length code";b.mode=30;break}b.extra=B&15;
b.mode=22;case 22:if(b.extra){for(B=b.extra;y<B;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}b.length+=s&(1<<b.extra)-1;s>>>=b.extra;y-=b.extra;b.back+=b.extra}b.was=b.length;b.mode=23;case 23:for(;;){O=b.distcode[s&(1<<b.distbits)-1];C=O>>>24;B=O>>>16&255;O&=65535;if(C<=y)break;if(0===p)break a;p--;s+=h[m++]<<y;y+=8}if(0===(B&240)){P=C;ba=B;for(ca=O;;){O=b.distcode[ca+((s&(1<<P+ba)-1)>>P)];C=O>>>24;B=O>>>16&255;O&=65535;if(P+C<=y)break;if(0===p)break a;p--;s+=h[m++]<<y;y+=8}s>>>=P;y-=P;b.back+=P}s>>>=
C;y-=C;b.back+=C;if(B&64){a.msg="invalid distance code";b.mode=30;break}b.offset=O;b.extra=B&15;b.mode=24;case 24:if(b.extra){for(B=b.extra;y<B;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}b.offset+=s&(1<<b.extra)-1;s>>>=b.extra;y-=b.extra;b.back+=b.extra}if(b.offset>b.dmax){a.msg="invalid distance too far back";b.mode=30;break}b.mode=25;case 25:if(0===G)break a;C=T-G;if(b.offset>C){C=b.offset-C;if(C>b.whave&&b.sane){a.msg="invalid distance too far back";b.mode=30;break}C>b.wnext?(C-=b.wnext,B=b.wsize-
C):B=b.wnext-C;C>b.length&&(C=b.length);P=b.window}else P=q,B=n-b.offset,C=b.length;C>G&&(C=G);G-=C;b.length-=C;do q[n++]=P[B++];while(--C);0===b.length&&(b.mode=21);break;case 26:if(0===G)break a;q[n++]=b.length;G--;b.mode=21;break;case 27:if(b.wrap){for(;32>y;){if(0===p)break a;p--;s|=h[m++]<<y;y+=8}T-=G;a.total_out+=T;b.total+=T;T&&(a.adler=b.check=b.flags?r(b.check,q,T,n-T):f(b.check,q,T,n-T));T=G;if((b.flags?s:e(s))!==b.check){a.msg="incorrect data check";b.mode=30;break}y=s=0}b.mode=28;case 28:if(b.wrap&&
b.flags){for(;32>y;){if(0===p)break a;p--;s+=h[m++]<<y;y+=8}if(s!==(b.total&4294967295)){a.msg="incorrect length check";b.mode=30;break}y=s=0}b.mode=29;case 29:da=1;break a;case 30:da=-3;break a;case 31:return-4;default:return-2}a.next_out=n;a.avail_out=G;a.next_in=m;a.avail_in=p;b.hold=s;b.bits=y;if(b.wsize||T!==a.avail_out&&30>b.mode&&(27>b.mode||4!==d))h=a.output,m=a.next_out,n=T-a.avail_out,G=a.state,null===G.window&&(G.wsize=1<<G.wbits,G.wnext=0,G.whave=0,G.window=new c.Buf8(G.wsize)),n>=G.wsize?
(c.arraySet(G.window,h,m-G.wsize,G.wsize,0),G.wnext=0,G.whave=G.wsize):(p=G.wsize-G.wnext,p>n&&(p=n),c.arraySet(G.window,h,m-n,p,G.wnext),(n-=p)?(c.arraySet(G.window,h,m-n,n,0),G.wnext=n,G.whave=G.wsize):(G.wnext+=p,G.wnext===G.wsize&&(G.wnext=0),G.whave<G.wsize&&(G.whave+=p)));D-=a.avail_in;T-=a.avail_out;a.total_in+=D;a.total_out+=T;b.total+=T;b.wrap&&T&&(a.adler=b.check=b.flags?r(b.check,q,T,a.next_out-T):f(b.check,q,T,a.next_out-T));a.data_type=b.bits+(b.last?64:0)+(12===b.mode?128:0)+(20===b.mode||
15===b.mode?256:0);(0===D&&0===T||4===d)&&0===da&&(da=-5);return da};b.inflateEnd=function(a){if(!a||!a.state)return-2;var c=a.state;c.window&&(c.window=null);a.state=null;return 0};b.inflateGetHeader=function(a,c){var b;if(!a||!a.state)return-2;b=a.state;if(0===(b.wrap&2))return-2;b.head=c;c.done=!1;return 0};b.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":2,"./adler32":4,"./crc32":6,"./inffast":8,"./inftrees":10}],10:[function(a,d,b){var e=a("../utils/common"),n=[3,4,5,6,
7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],h=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],m=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];d.exports=function(a,c,b,d,k,u,v,z){for(var w=z.bits,t=0,A=0,x=0,E=0,N=0,I=0,H=0,F=0,G=0,s=0,y,D,T=null,
C=0,B,P=new e.Buf16(16),I=new e.Buf16(16),O=null,ba=0,ca,da,W,t=0;15>=t;t++)P[t]=0;for(A=0;A<d;A++)P[c[b+A]]++;N=w;for(E=15;1<=E&&0===P[E];E--);N>E&&(N=E);if(0===E)return k[u++]=20971520,k[u++]=20971520,z.bits=1,0;for(x=1;x<E&&0===P[x];x++);N<x&&(N=x);for(t=F=1;15>=t;t++)if(F<<=1,F-=P[t],0>F)return-1;if(0<F&&(0===a||1!==E))return-1;I[1]=0;for(t=1;15>t;t++)I[t+1]=I[t]+P[t];for(A=0;A<d;A++)0!==c[b+A]&&(v[I[c[b+A]]++]=A);switch(a){case 0:T=O=v;B=19;break;case 1:T=n;C-=257;O=h;ba-=257;B=256;break;default:T=
p,O=m,B=-1}A=s=0;t=x;w=u;I=N;H=0;D=-1;G=1<<N;d=G-1;if(1===a&&852<G||2===a&&592<G)return 1;for(var J=0;;){J++;ca=t-H;v[A]<B?(da=0,W=v[A]):v[A]>B?(da=O[ba+v[A]],W=T[C+v[A]]):(da=96,W=0);F=1<<t-H;x=y=1<<I;do y-=F,k[w+(s>>H)+y]=ca<<24|da<<16|W|0;while(0!==y);for(F=1<<t-1;s&F;)F>>=1;0!==F?(s&=F-1,s+=F):s=0;A++;if(0===--P[t]){if(t===E)break;t=c[b+v[A]]}if(t>N&&(s&d)!==D){0===H&&(H=N);w+=x;I=t-H;for(F=1<<I;I+H<E;){F-=P[I+H];if(0>=F)break;I++;F<<=1}G+=1<<I;if(1===a&&852<G||2===a&&592<G)return 1;D=s&d;k[D]=
N<<24|I<<16|w-u|0}}0!==s&&(k[w+s]=t-H<<24|4194304);z.bits=N;return 0}},{"../utils/common":2}],11:[function(a,d,b){d.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],12:[function(a,d,b){d.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=
2;this.adler=0}},{}]},{},[1])(1)});return{inflate:function(g,a){return e.inflateRaw(g)}}}()})();core.StepDirection={PREVIOUS:1,NEXT:2};
core.StepIterator=function(e,g){function a(){c=null;r=f=void 0}function d(){void 0===r&&(r=e.acceptPosition(g)===m);return r}function b(c,b){a();return g.setUnfilteredPosition(c,b)}function l(){c||(c=g.container());return c}function n(){void 0===f&&(f=g.unfilteredDomOffset());return f}function h(){for(a();g.nextPosition();)if(a(),d())return!0;return!1}function p(){for(a();g.previousPosition();)if(a(),d())return!0;return!1}var m=core.PositionFilter.FilterResult.FILTER_ACCEPT,q=core.StepDirection.NEXT,
c,f,r;this.isStep=d;this.setPosition=b;this.container=l;this.offset=n;this.nextStep=h;this.previousStep=p;this.advanceStep=function(a){return a===q?h():p()};this.roundToClosestStep=function(){var a,c,f=d();f||(a=l(),c=n(),f=p(),f||(b(a,c),f=h()));return f};this.roundToPreviousStep=function(){var a=d();a||(a=p());return a};this.roundToNextStep=function(){var a=d();a||(a=h());return a};this.leftNode=function(){return g.leftNode()};this.snapshot=function(){return new core.StepIterator.StepSnapshot(l(),
n())};this.restore=function(a){b(a.container,a.offset)}};core.StepIterator.StepSnapshot=function(e,g){this.container=e;this.offset=g};core.TestData;core.AsyncTestData;core.UnitTest=function(){};core.UnitTest.prototype.setUp=function(){};core.UnitTest.prototype.tearDown=function(){};core.UnitTest.prototype.description=function(){};core.UnitTest.prototype.tests=function(){};core.UnitTest.prototype.asyncTests=function(){};
core.UnitTest.provideTestAreaDiv=function(){var e=runtime.getWindow().document,g=e.getElementById("testarea");runtime.assert(!g,'Unclean test environment, found a div with id "testarea".');g=e.createElement("div");g.setAttribute("id","testarea");e.body.appendChild(g);return g};
core.UnitTest.cleanupTestAreaDiv=function(){var e=runtime.getWindow().document,g=e.getElementById("testarea");runtime.assert(!!g&&g.parentNode===e.body,'Test environment broken, found no div with id "testarea" below body.');e.body.removeChild(g)};core.UnitTest.createXmlDocument=function(e,g,a){var d="<?xml version='1.0' encoding='UTF-8'?>",d=d+("<"+e);Object.keys(a).forEach(function(b){d+=" xmlns:"+b+'="'+a[b]+'"'});d+=">";d+=g;d+="</"+e+">";return runtime.parseXML(d)};
core.UnitTest.createOdtDocument=function(e,g){return core.UnitTest.createXmlDocument("office:document",e,g)};
core.UnitTestLogger=function(){var e=[],g=0,a=0,d="",b="";this.startTest=function(l,n){e=[];g=0;d=l;b=n;a=Date.now()};this.endTest=function(){var l=Date.now();return{description:b,suite:[d,b],success:0===g,log:e,time:l-a}};this.debug=function(a){e.push({category:"debug",message:a})};this.fail=function(a){g+=1;e.push({category:"fail",message:a})};this.pass=function(a){e.push({category:"pass",message:a})}};
core.UnitTestRunner=function(e,g){function a(a){m+=1;f?g.debug(a):g.fail(a)}function d(c,b){var f;try{if(c.length!==b.length)return a("array of length "+c.length+" should be "+b.length+" long"),!1;for(f=0;f<c.length;f+=1)if(c[f]!==b[f])return a(c[f]+" should be "+b[f]+" at array index "+f),!1}catch(d){return!1}return!0}function b(c,f,d){var e=c.attributes,h=e.length,g,l,m;for(g=0;g<h;g+=1)if(l=e.item(g),"xmlns"!==l.prefix&&"urn:webodf:names:steps"!==l.namespaceURI){m=f.getAttributeNS(l.namespaceURI,
l.localName);if(!f.hasAttributeNS(l.namespaceURI,l.localName))return a("Attribute "+l.localName+" with value "+l.value+" was not present"),!1;if(m!==l.value)return a("Attribute "+l.localName+" was "+m+" should be "+l.value),!1}return d?!0:b(f,c,!0)}function l(c,f){var d,e;d=c.nodeType;e=f.nodeType;if(d!==e)return a("Nodetype '"+d+"' should be '"+e+"'"),!1;if(d===Node.TEXT_NODE){if(c.data===f.data)return!0;a("Textnode data '"+c.data+"' should be '"+f.data+"'");return!1}runtime.assert(d===Node.ELEMENT_NODE,
"Only textnodes and elements supported.");if(c.namespaceURI!==f.namespaceURI)return a("namespace '"+c.namespaceURI+"' should be '"+f.namespaceURI+"'"),!1;if(c.localName!==f.localName)return a("localName '"+c.localName+"' should be '"+f.localName+"'"),!1;if(!b(c,f,!1))return!1;d=c.firstChild;for(e=f.firstChild;d;){if(!e)return a("Nodetype '"+d.nodeType+"' is unexpected here."),!1;if(!l(d,e))return!1;d=d.nextSibling;e=e.nextSibling}return e?(a("Nodetype '"+e.nodeType+"' is missing here."),!1):!0}function n(a,
b,f){if(0===b)return a===b&&1/a===1/b;if(a===b)return!0;if(null===a||null===b)return!1;if("number"===typeof b&&isNaN(b))return"number"===typeof a&&isNaN(a);if("number"===typeof b&&"number"===typeof a){if(a===b)return!0;void 0===f&&(f=1E-4);runtime.assert("number"===typeof f,"Absolute tolerance not given as number.");runtime.assert(0<=f,"Absolute tolerance should be given as positive number, was "+f);a=Math.abs(a-b);return a<=f}return Object.prototype.toString.call(b)===Object.prototype.toString.call([])?
d(a,b):"object"===typeof b&&"object"===typeof a?b.constructor===Element||b.constructor===Node?l(a,b):c(a,b):!1}function h(a){if(0===a&&0>1/a)return"-0";if("object"===typeof a)try{return JSON.stringify(a)}catch(c){}return String(a)}function p(c,b,f,d){"string"===typeof b&&"string"===typeof f||g.debug("WARN: shouldBe() expects string arguments");var e,l;try{l=eval(b)}catch(m){e=m}c=eval(f);e?a(b+" should be "+c+". Threw exception "+e):n(l,c,d)?g.pass(b+" is "+f):String(typeof l)===String(typeof c)?
a(b+" should be "+h(c)+". Was "+h(l)+"."):a(b+" should be "+c+" (of type "+typeof c+"). Was "+l+" (of type "+typeof l+").")}var m=0,q,c,f=!1;this.resourcePrefix=function(){return e};this.beginExpectFail=function(){q=m;f=!0};this.endExpectFail=function(){var a=q===m;f=!1;m=q;a&&(m+=1,g.fail("Expected at least one failed test, but none registered."))};c=function(c,b){var f=Object.keys(c),e=Object.keys(b);f.sort();e.sort();return d(f,e)&&Object.keys(c).every(function(f){var d=c[f],e=b[f];return n(d,
e)?!0:(a(d+" should be "+e+" for key "+f),!1)})};this.areNodesEqual=l;this.shouldBeNull=function(a,c){p(a,c,"null")};this.shouldBeNonNull=function(c,b){var f,d;try{d=eval(b)}catch(e){f=e}f?a(b+" should be non-null. Threw exception "+f):null!==d?g.pass(b+" is non-null."):a(b+" should be non-null. Was "+d)};this.shouldBe=p;this.testFailed=a;this.countFailedTests=function(){return m};this.name=function(a){var c,b,f=[],d=a.length;f.length=d;for(c=0;c<d;c+=1){b=Runtime.getFunctionName(a[c])||"";if(""===
b)throw"Found a function without a name.";f[c]={f:a[c],name:b}}return f}};
core.UnitTester=function(){function e(a,b){return"<span style='color:blue;cursor:pointer' onclick='"+b+"'>"+a+"</span>"}function g(b){a.reporter&&a.reporter(b)}var a=this,d=0,b=new core.UnitTestLogger,l={},n="BrowserRuntime"===runtime.type();this.resourcePrefix="";this.reporter=function(a){var b,d;n?runtime.log("<span>Running "+e(a.description,'runTest("'+a.suite[0]+'","'+a.description+'")')+"</span>"):runtime.log("Running "+a.description);if(!a.success)for(b=0;b<a.log.length;b+=1)d=a.log[b],runtime.log(d.category,
d.message)};this.runTests=function(h,p,m){function q(a){function e(){n&&f.endExpectFail();g(b.endTest());r.tearDown();k[h]=t===f.countFailedTests();q(a.slice(1))}var h,n;if(0===a.length)l[c]=k,d+=f.countFailedTests(),p();else if(v=a[0].f,h=a[0].name,n=!0===a[0].expectFail,t=f.countFailedTests(),m.length&&-1===m.indexOf(h))q(a.slice(1));else{r.setUp();b.startTest(c,h);n&&f.beginExpectFail();try{v(e)}catch(u){f.testFailed("Unexpected exception encountered: "+u.toString()+"\n"+u.stack),e()}}}var c=Runtime.getFunctionName(h)||
"",f=new core.UnitTestRunner(a.resourcePrefix,b),r=new h(f),k={},u,v,z,w,t;if(l.hasOwnProperty(c))runtime.log("Test "+c+" has already run.");else{n?runtime.log("<span>Running "+e(c,'runSuite("'+c+'");')+": "+r.description()+"</span>"):runtime.log("Running "+c+": "+r.description);z=r.tests();for(u=0;u<z.length;u+=1)if(v=z[u].f,h=z[u].name,w=!0===z[u].expectFail,!m.length||-1!==m.indexOf(h)){t=f.countFailedTests();r.setUp();b.startTest(c,h);w&&f.beginExpectFail();try{v()}catch(A){f.testFailed("Unexpected exception encountered: "+
A.toString()+"\n"+A.stack)}w&&f.endExpectFail();g(b.endTest());r.tearDown();k[h]=t===f.countFailedTests()}q(r.asyncTests())}};this.failedTestsCount=function(){return d};this.results=function(){return l}};
core.Utils=function(){function e(g,a){if(a&&Array.isArray(a)){g=g||[];if(!Array.isArray(g))throw"Destination is not an array.";g=g.concat(a.map(function(a){return e(null,a)}))}else if(a&&"object"===typeof a){g=g||{};if("object"!==typeof g)throw"Destination is not an object.";Object.keys(a).forEach(function(d){g[d]=e(g[d],a[d])})}else g=a;return g}this.hashString=function(e){var a=0,d,b;d=0;for(b=e.length;d<b;d+=1)a=(a<<5)-a+e.charCodeAt(d),a|=0;return a};this.mergeObjects=function(g,a){Object.keys(a).forEach(function(d){g[d]=
e(g[d],a[d])});return g}};
core.Zip=function(e,g){function a(a,c,b){u?b(null,u.subarray(a,a+c)):b("File data not loaded",null)}function d(a){var c=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,
1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,
1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,
1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,
628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,
3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],b,f,d=a.length,e=0,e=0;b=-1;for(f=0;f<d;f+=1)e=(b^a[f])&255,e=c[e],b=b>>>8^e;return b^-1}function b(a){return new Date((a>>25&127)+1980,(a>>21&15)-1,a>>16&31,a>>11&15,
a>>5&63,(a&31)<<1)}function l(a){var c=a.getFullYear();return 1980>c?0:c-1980<<25|a.getMonth()+1<<21|a.getDate()<<16|a.getHours()<<11|a.getMinutes()<<5|a.getSeconds()>>1}function n(c,f){var d,e,k,r,h,s,y,l=this;this.load=function(b){if(null!==l.data)b(null,l.data);else{var f=h+34+e+k+256;f+y>v&&(f=v-y);a(y,f,function(a,f){if(a||null===f)b(a,f);else a:{var d=f,e=new core.ByteArray(d),k=e.readUInt32LE(),y;if(67324752!==k)b("File entry signature is wrong."+k.toString()+" "+d.length.toString(),null);
else{e.pos+=22;k=e.readUInt16LE();y=e.readUInt16LE();e.pos+=k+y;if(r){d=d.subarray(e.pos,e.pos+h);if(h!==d.length){b("The amount of compressed bytes read was "+d.length.toString()+" instead of "+h.toString()+" for "+l.filename+" in "+c+".",null);break a}d=w(d,s)}else d=d.subarray(e.pos,e.pos+s);s!==d.length?b("The amount of bytes read was "+d.length.toString()+" instead of "+s.toString()+" for "+l.filename+" in "+c+".",null):(l.data=d,b(null,d))}}})}};this.set=function(a,c,b,f){l.filename=a;l.data=
c;l.compressed=b;l.date=f};this.error=null;f&&(d=f.readUInt32LE(),33639248!==d?this.error="Central directory entry has wrong signature at position "+(f.pos-4).toString()+' for file "'+c+'": '+f.data.length.toString():(f.pos+=6,r=f.readUInt16LE(),this.date=b(f.readUInt32LE()),f.readUInt32LE(),h=f.readUInt32LE(),s=f.readUInt32LE(),e=f.readUInt16LE(),k=f.readUInt16LE(),d=f.readUInt16LE(),f.pos+=8,y=f.readUInt32LE(),this.filename=runtime.byteArrayToString(f.data.subarray(f.pos,f.pos+e),"utf8"),this.data=
null,f.pos+=e+k+d))}function h(c,b){if(22!==c.length)b("Central directory length should be 22.",t);else{var f=new core.ByteArray(c),d;d=f.readUInt32LE();101010256!==d?b("Central directory signature is wrong: "+d.toString(),t):(d=f.readUInt16LE(),0!==d?b("Zip files with non-zero disk numbers are not supported.",t):(d=f.readUInt16LE(),0!==d?b("Zip files with non-zero disk numbers are not supported.",t):(d=f.readUInt16LE(),z=f.readUInt16LE(),d!==z?b("Number of entries is inconsistent.",t):(d=f.readUInt32LE(),
f=f.readUInt16LE(),f=v-22-d,a(f,v-f,function(a,c){if(a||null===c)b(a,t);else a:{var f=new core.ByteArray(c),d,r;k=[];for(d=0;d<z;d+=1){r=new n(e,f);if(r.error){b(r.error,t);break a}k[k.length]=r}b(null,t)}})))))}}function p(a,c){var b=null,f,d;a&&0==a.indexOf("./")&&(a=a.substring(2));for(d=0;d<k.length;d+=1)if(f=k[d],f.filename===a){b=f;break}b?b.data?c(null,b.data):b.load(c):c(a+" not found.",null)}function m(a){var c=new core.ByteArrayWriter("utf8"),b=0;c.appendArray([80,75,3,4,20,0,0,0,0,0]);
a.data&&(b=a.data.length);c.appendUInt32LE(l(a.date));c.appendUInt32LE(a.data?d(a.data):0);c.appendUInt32LE(b);c.appendUInt32LE(b);c.appendUInt16LE(a.filename.length);c.appendUInt16LE(0);c.appendString(a.filename);a.data&&c.appendByteArray(a.data);return c}function q(a,c){var b=new core.ByteArrayWriter("utf8"),f=0;b.appendArray([80,75,1,2,20,0,20,0,0,0,0,0]);a.data&&(f=a.data.length);b.appendUInt32LE(l(a.date));b.appendUInt32LE(a.data?d(a.data):0);b.appendUInt32LE(f);b.appendUInt32LE(f);b.appendUInt16LE(a.filename.length);
b.appendArray([0,0,0,0,0,0,0,0,0,0,0,0]);b.appendUInt32LE(c);b.appendString(a.filename);return b}function c(a,b){if(a===k.length)b(null);else{var f=k[a];null!==f.data?c(a+1,b):f.load(function(f){f?b(f):c(a+1,b)})}}function f(a,b){c(0,function(c){if(c)b(c);else{var f,d,e=new core.ByteArrayWriter("utf8"),r=[0];for(f=0;f<k.length;f+=1)e.appendByteArrayWriter(m(k[f])),r.push(e.getLength());c=e.getLength();for(f=0;f<k.length;f+=1)d=k[f],e.appendByteArrayWriter(q(d,r[f]));f=e.getLength()-c;e.appendArray([80,
75,5,6,0,0,0,0]);e.appendUInt16LE(k.length);e.appendUInt16LE(k.length);e.appendUInt32LE(f);e.appendUInt32LE(c);e.appendArray([0,0]);a(e.getByteArray())}})}function r(a,c){f(function(b){runtime.writeFile(a,b,function(a){a||(u=b,v=u.length);c(a)})},c)}var k,u,v,z,w=core.RawInflate.inflate,t=this,A=new core.Base64;this.load=p;this.save=function(a,c,b,f){var d,r;for(d=0;d<k.length;d+=1)if(r=k[d],r.filename===a){r.set(a,c,b,f);return}r=new n(e);r.set(a,c,b,f);k.push(r)};this.remove=function(a){var c,b;
for(c=0;c<k.length;c+=1)if(b=k[c],b.filename===a)return k.splice(c,1),!0;return!1};this.write=function(a){r(e,a)};this.writeAs=r;this.createByteArray=f;this.loadContentXmlAsFragments=function(a,c){t.loadAsString(a,function(a,b){if(a)return c.rootElementReady(a);c.rootElementReady(null,b,!0)})};this.loadAsString=function(a,c){p(a,function(a,b){if(a||null===b)return c(a,null);var f=runtime.byteArrayToString(b,"utf8");c(null,f)})};this.loadAsDOM=function(a,c){t.loadAsString(a,function(a,b){if(a||null===
b)c(a,null);else if(6291456<b.length)g_errmsg("Sorry, It takes too much time to run.");else{var f=(new DOMParser).parseFromString(b.trim(),"text/xml");c(null,f)}})};this.loadAsDataURL=function(a,c,b){if(a&&1E3>a.length){var f=(a||"").toLowerCase().trim();if(0==f.indexOf("http://")||0==f.indexOf("https://")){b(null,a);return}}p(a,function(a,f){if(a||!f)return b(a,null);var d=0,e;c||(c=80===f[1]&&78===f[2]&&71===f[3]?"image/png":255===f[0]&&216===f[1]&&255===f[2]?"image/jpeg":71===f[0]&&73===f[1]&&
70===f[2]?"image/gif":"");for(e="data:"+c+";base64,";d<f.length;)e+=A.convertUTF8ArrayToBase64(f.subarray(d,Math.min(d+45E3,f.length))),d+=45E3;b(null,e)})};this.getEntries=function(){return k.slice()};v=-1;null===g?k=[]:runtime.readFile(e,"binary",function(c,b){"string"===typeof b&&(c="file was read as a string. Should be Uint8Array.");c||!b||0===b.length?g("File '"+e+"' cannot be read. Err: "+(c||"[none]"),t):(u=b,v=u.length,a(v-22,22,function(a,c){a||null===c?g(a,t):h(c,g)}))})};
core.SimpleClientRect=null;gui.CommonConstraints={EDIT:{ANNOTATIONS:{ONLY_DELETE_OWN:"onlyDeleteOwn"},REVIEW_MODE:"reviewMode"}};
gui.SessionConstraints=function(){function e(d){g.hasOwnProperty(d)||(g[d]=!1,a.register(d))}var g={},a=new core.EventNotifier;this.registerConstraint=e;this.subscribe=function(d,b){e(d);a.subscribe(d,b)};this.unsubscribe=function(d,b){a.unsubscribe(d,b)};this.setState=function(d,b){runtime.assert(!0===g.hasOwnProperty(d),"No such constraint");g[d]!==b&&(g[d]=b,a.emit(d,b))};this.getState=function(a){runtime.assert(!0===g.hasOwnProperty(a),"No such constraint");return g[a]}};
gui.BlacklistNamespaceNodeFilter=function(e){var g={},a=NodeFilter.FILTER_REJECT,d=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(b){return!b||g.hasOwnProperty(b.namespaceURI)?a:d};(function(){e.forEach(function(a){g[a]=!0})})()};
odf.Namespaces={namespaceMap:{config:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",db:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dc:"http://purl.org/dc/elements/1.1/",dr3d:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",draw:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chart:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fo:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",form:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",math:"http://www.w3.org/1998/Math/MathML",
meta:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",number:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",office:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentation:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",style:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svg:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",table:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",text:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",xforms:"http://www.w3.org/2002/xforms",
xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},prefixMap:{},configns:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",dbns:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dcns:"http://purl.org/dc/elements/1.1/",dr3dns:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",drawns:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chartns:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fons:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",formns:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",
mathns:"http://www.w3.org/1998/Math/MathML",metans:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",numberns:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",officens:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentationns:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",stylens:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svgns:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",tablens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",textns:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",
xformsns:"http://www.w3.org/2002/xforms",xlinkns:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/XML/1998/namespace"};(function(){var e=odf.Namespaces.namespaceMap,g=odf.Namespaces.prefixMap,a;for(a in e)e.hasOwnProperty(a)&&(g[e[a]]=a)})();odf.Namespaces.forEachPrefix=function(e){var g=odf.Namespaces.namespaceMap,a;for(a in g)g.hasOwnProperty(a)&&e(a,g[a])};
odf.Namespaces.lookupNamespaceURI=function(e){var g=null;odf.Namespaces.namespaceMap.hasOwnProperty(e)&&(g=odf.Namespaces.namespaceMap[e]);return g};odf.Namespaces.lookupPrefix=function(e){var g=odf.Namespaces.prefixMap;return g.hasOwnProperty(e)?g[e]:null};odf.Namespaces.lookupNamespaceURI.lookupNamespaceURI=odf.Namespaces.lookupNamespaceURI;
(function(){odf.OdfSchemaImpl=function(){var e=[["config:config-item","uncategorized"],["form:item","object"],["form:option","uncategorized"],["math:math","field"],["meta:user-defined","uncategorized"],["number:currency-symbol","uncategorized"],["number:embedded-text","uncategorized"],["number:text","uncategorized"],["presentation:date-time-decl","uncategorized"],["presentation:footer-decl","uncategorized"],["presentation:header-decl","uncategorized"],["svg:desc","text"],["svg:title","text"],["table:desc",
"uncategorized"],["table:title","uncategorized"],["text:a","text"],["text:author-initials","field"],["text:author-name","field"],["text:bibliography-mark","field"],["text:bookmark-ref","field"],["text:chapter","field"],["text:character-count","field"],["text:conditional-text","field"],["text:creation-date","field"],["text:creation-time","field"],["text:creator","field"],["text:database-display","field"],["text:database-name","field"],["text:database-row-number","field"],["text:date","field"],["text:dde-connection",
"field"],["text:description","field"],["text:editing-cycles","field"],["text:editing-duration","field"],["text:execute-macro","uncategorized"],["text:expression","uncategorized"],["text:file-name","field"],["text:h","text"],["text:hidden-paragraph","text"],["text:hidden-text","text"],["text:image-count","field"],["text:index-entry-span","uncategorized"],["text:index-title-template","uncategorized"],["text:initial-creator","field"],["text:keywords","field"],["text:linenumbering-separator","style"],
["text:measure","uncategorized"],["text:meta","uncategorized"],["text:meta-field","uncategorized"],["text:modification-date","field"],["text:modification-time","field"],["text:note-citation","field"],["text:note-continuation-notice-backward","style"],["text:note-continuation-notice-forward","style"],["text:note-ref","field"],["text:object-count","field"],["text:p","text"],["text:page-continuation","uncategorized"],["text:page-count","field"],["text:page-number","field"],["text:page-variable-get",
"field"],["text:page-variable-set","field"],["text:paragraph-count","field"],["text:placeholder","field"],["text:print-date","field"],["text:print-time","field"],["text:printed-by","field"],["text:reference-ref","field"],["text:ruby-base","text"],["text:ruby-text","text"],["text:script","text"],["text:sender-city","field"],["text:sender-company","field"],["text:sender-country","field"],["text:sender-email","field"],["text:sender-fax","field"],["text:sender-firstname","field"],["text:sender-initials",
"field"],["text:sender-lastname","field"],["text:sender-phone-private","field"],["text:sender-phone-work","field"],["text:sender-position","field"],["text:sender-postal-code","field"],["text:sender-state-or-province","field"],["text:sender-street","field"],["text:sender-title","field"],["text:sequence","uncategorized"],["text:sequence-ref","uncategorized"],["text:sheet-name","uncategorized"],["text:span","text"],["text:subject","field"],["text:table-count","field"],["text:table-formula","deprecated"],
["text:template-name","uncategorized"],["text:text-input","field"],["text:time","field"],["text:title","field"],["text:user-defined","field"],["text:user-field-get","field"],["text:user-field-input","field"],["text:variable-get","field"],["text:variable-input","field"],["text:variable-set","field"],["text:word-count","field"],["xforms:model","uncategorized"]],g={};this.isTextContainer=function(a,d){return"text"===g[a+":"+d]};this.isField=function(a,d){return"field"===g[a+":"+d]};this.getFields=function(){return e.filter(function(a){return"field"===
a[1]}).map(function(a){return a[0]})};(function(){e.forEach(function(a){var d=a[1],b=a[0].split(":");a=b[0];var b=b[1],e=odf.Namespaces.lookupNamespaceURI(a);e?g[e+":"+b]=d:runtime.log("DEBUG: OdfSchema - unknown prefix '"+a+"'")})})()};odf.OdfSchema=new odf.OdfSchemaImpl})();
odf.OdfUtilsImpl=function(){function e(a){return"image"===(a&&a.localName)&&a.namespaceURI===B}function g(a){return null!==a&&a.nodeType===Node.ELEMENT_NODE&&"frame"===a.localName&&a.namespaceURI===B&&"as-char"===a.getAttributeNS(C,"anchor-type")}function a(a){var c;(c="annotation"===(a&&a.localName)&&a.namespaceURI===odf.Namespaces.officens)||(c="div"===(a&&a.localName)&&"annotationWrapper"===a.className);return c}function d(a){return"a"===(a&&a.localName)&&a.namespaceURI===C}function b(a){var c=
a&&a.localName;return("p"===c||"h"===c)&&a.namespaceURI===C}function l(a,c){for(a&&void 0!==c&&!b(a)&&a.childNodes.item(c)&&(a=a.childNodes.item(c));a&&!b(a);)a=a.parentNode;return a}function n(a,c){for(;a&&a!==c;){if(a.namespaceURI===odf.Namespaces.officens&&"annotation"===a.localName)return a;a=a.parentNode}return null}function h(a){return/^[ \t\r\n]+$/.test(a)}function p(a){if(null===a||a.nodeType!==Node.ELEMENT_NODE)return!1;var c=a.localName;return ca.isTextContainer(a.namespaceURI,c)||"span"===
c&&"webodf-annotationHighlight"===a.className}function m(a){return null===a||a.nodeType!==Node.ELEMENT_NODE?!1:ca.isField(a.namespaceURI,a.localName)}function q(a){var c=a&&a.localName,b=!1;c&&(a=a.namespaceURI,a===C&&(b="s"===c||"tab"===c||"line-break"===c));return b}function c(c){return q(c)||m(c)||g(c)||a(c)}function f(a){var c=a&&a.localName,b=!1;c&&(a=a.namespaceURI,a===C&&(b="s"===c));return b}function r(a){return-1!==ba.indexOf(a.namespaceURI)}function k(a){if(q(a)||m(a))return!1;if(p(a.parentNode)&&
a.nodeType===Node.TEXT_NODE)return 0===a.textContent.length;for(a=a.firstChild;a;){if(r(a)||!k(a))return!1;a=a.nextSibling}return!0}function u(a){for(;null!==a.firstChild&&p(a);)a=a.firstChild;return a}function v(a){for(;null!==a.lastChild&&p(a);)a=a.lastChild;return a}function z(a){for(;!b(a)&&null===a.previousSibling;)a=a.parentNode;return b(a)?null:v(a.previousSibling)}function w(a){for(;!b(a)&&null===a.nextSibling;)a=a.parentNode;return b(a)?null:u(a.nextSibling)}function t(a){for(var b=!1;a;)if(a.nodeType===
Node.TEXT_NODE)if(0===a.length)a=z(a);else return!h(a.data.substr(a.length-1,1));else c(a)?(b=!1===f(a),a=null):a=z(a);return b}function A(a){var b=!1,f;for(a=a&&u(a);a;){f=a.nodeType===Node.TEXT_NODE?a.length:0;if(0<f&&!h(a.data)){b=!0;break}if(c(a)){b=!0;break}a=w(a)}return b}function x(a,c){return h(a.data.substr(c))?!A(w(a)):!1}function E(a,b){var f=a.data,d;if(!h(f[b])||c(a.parentNode))return!1;0<b?h(f[b-1])||(d=!0):t(z(a))&&(d=!0);return!0===d?x(a,b)?!1:!0:!1}function N(a){return(a=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px)|(%))/.exec(a))?
{value:parseFloat(a[1]),unit:a[3]}:null}function I(a){return(a=N(a))&&(0>a.value||"%"===a.unit)?null:a}function H(a){return(a=N(a))&&"%"!==a.unit?null:a}function F(a){switch(a.namespaceURI){case odf.Namespaces.drawns:case odf.Namespaces.svgns:case odf.Namespaces.dr3dns:return!1;case odf.Namespaces.textns:switch(a.localName){case "note-body":case "ruby-text":return!1}break;case odf.Namespaces.officens:switch(a.localName){case "annotation":case "binary-data":case "event-listeners":return!1}break;default:switch(a.localName){case "cursor":case "editinfo":return!1}}return!0}
function G(a){return Boolean(l(a)&&(!h(a.textContent)||E(a,0)))}function s(a,c){for(;0<c.length&&!O.rangeContainsNode(a,c[0]);)c.shift();for(;0<c.length&&!O.rangeContainsNode(a,c[c.length-1]);)c.pop()}function y(b,f,d){var e;e=O.getNodesInRange(b,function(b){var f=NodeFilter.FILTER_REJECT;if(q(b.parentNode)||m(b.parentNode)||a(b))f=NodeFilter.FILTER_REJECT;else if(b.nodeType===Node.TEXT_NODE){if(d||G(b))f=NodeFilter.FILTER_ACCEPT}else if(c(b))f=NodeFilter.FILTER_ACCEPT;else if(F(b)||p(b))f=NodeFilter.FILTER_SKIP;
return f},NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);f||s(b,e);return e}function D(c,b,f){for(;c;){if(f(c)){b[0]!==c&&b.unshift(c);break}if(a(c))break;c=c.parentNode}}function T(a,c){var b=a;if(c<b.childNodes.length-1)b=b.childNodes[c+1];else{for(;!b.nextSibling;)b=b.parentNode;b=b.nextSibling}for(;b.firstChild;)b=b.firstChild;return b}var C=odf.Namespaces.textns,B=odf.Namespaces.drawns,P=odf.Namespaces.xlinkns,O=core.DomUtils,ba=[odf.Namespaces.dbns,odf.Namespaces.dcns,odf.Namespaces.dr3dns,odf.Namespaces.drawns,
odf.Namespaces.chartns,odf.Namespaces.formns,odf.Namespaces.numberns,odf.Namespaces.officens,odf.Namespaces.presentationns,odf.Namespaces.stylens,odf.Namespaces.svgns,odf.Namespaces.tablens,odf.Namespaces.textns],ca=odf.OdfSchema;this.isImage=e;this.isCharacterFrame=g;this.isInlineRoot=a;this.isTextSpan=function(a){return"span"===(a&&a.localName)&&a.namespaceURI===C};this.isHyperlink=d;this.getHyperlinkTarget=function(a){return a.getAttributeNS(P,"href")||""};this.isParagraph=b;this.getParagraphElement=
l;this.getParentAnnotation=n;this.isWithinAnnotation=function(a,c){return Boolean(n(a,c))};this.getAnnotationCreator=function(a){return(a=a.getElementsByTagNameNS(odf.Namespaces.dcns,"creator")[0])?a.textContent:""};this.isListItem=function(a){return"list-item"===(a&&a.localName)&&a.namespaceURI===C};this.isLineBreak=function(a){return"line-break"===(a&&a.localName)&&a.namespaceURI===C};this.isODFWhitespace=h;this.isGroupingElement=p;this.isFieldElement=m;this.isCharacterElement=q;this.isAnchoredAsCharacterElement=
c;this.isSpaceElement=f;this.isODFNode=r;this.hasNoODFContent=k;this.firstChild=u;this.lastChild=v;this.previousNode=z;this.nextNode=w;this.scanLeftForNonSpace=t;this.lookLeftForCharacter=function(a){var b,f=b=0;a.nodeType===Node.TEXT_NODE&&(f=a.length);0<f?(b=a.data,b=h(b.substr(f-1,1))?1===f?t(z(a))?2:0:h(b.substr(f-2,1))?0:2:1):c(a)&&(b=1);return b};this.lookRightForCharacter=function(a){var b=!1,f=0;a&&a.nodeType===Node.TEXT_NODE&&(f=a.length);0<f?b=!h(a.data.substr(0,1)):c(a)&&(b=!0);return b};
this.scanLeftForAnyCharacter=function(a){var b=!1,f;for(a=a&&v(a);a;){f=a.nodeType===Node.TEXT_NODE?a.length:0;if(0<f&&!h(a.data)){b=!0;break}if(c(a)){b=!0;break}a=z(a)}return b};this.scanRightForAnyCharacter=A;this.isTrailingWhitespace=x;this.isSignificantWhitespace=E;this.isDowngradableSpaceElement=function(a){return f(a)?t(z(a))&&A(w(a)):!1};this.parseLength=N;this.parseNonNegativeLength=I;this.parseFoFontSize=function(a){var c;c=(c=N(a))&&(0>=c.value||"%"===c.unit)?null:c;return c||H(a)};this.parseFoLineHeight=
function(a){return I(a)||H(a)};this.isTextContentContainingNode=F;this.getTextNodes=function(a,c){var b;b=O.getNodesInRange(a,function(a){var c=NodeFilter.FILTER_REJECT;a.nodeType===Node.TEXT_NODE?G(a)&&(c=NodeFilter.FILTER_ACCEPT):F(a)&&(c=NodeFilter.FILTER_SKIP);return c},NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);c||s(a,b);return b};this.getTextElements=y;this.getParagraphElements=function(a){var c;c=O.getNodesInRange(a,function(a){var c=NodeFilter.FILTER_REJECT;if(b(a))c=NodeFilter.FILTER_ACCEPT;
else if(F(a)||p(a))c=NodeFilter.FILTER_SKIP;return c},NodeFilter.SHOW_ELEMENT);D(a.startContainer,c,b);return c};this.getImageElements=function(a){var c;c=O.getNodesInRange(a,function(a){var c=NodeFilter.FILTER_SKIP;e(a)&&(c=NodeFilter.FILTER_ACCEPT);return c},NodeFilter.SHOW_ELEMENT);D(a.startContainer,c,e);return c};this.getHyperlinkElements=function(a){var c=[],f=a.cloneRange();a.collapsed&&a.endContainer.nodeType===Node.ELEMENT_NODE&&(a=T(a.endContainer,a.endOffset),a.nodeType===Node.TEXT_NODE&&
f.setEnd(a,1));y(f,!0,!1).forEach(function(a){for(a=a.parentNode;!b(a);){if(d(a)&&-1===c.indexOf(a)){c.push(a);break}a=a.parentNode}});f.detach();return c};this.getNormalizedFontFamilyName=function(a){/^(["'])(?:.|[\n\r])*?\1$/.test(a)||(a=a.replace(/^[ \t\r\n\f]*((?:.|[\n\r])*?)[ \t\r\n\f]*$/,"$1"),/[ \t\r\n\f]/.test(a)&&(a="'"+a.replace(/[ \t\r\n\f]+/g," ")+"'"));return a}};odf.OdfUtils=new odf.OdfUtilsImpl;
gui.OdfTextBodyNodeFilter=function(){var e=odf.OdfUtils,g=Node.TEXT_NODE,a=NodeFilter.FILTER_REJECT,d=NodeFilter.FILTER_ACCEPT,b=odf.Namespaces.textns;this.acceptNode=function(l){if(l.nodeType===g){if(!e.isGroupingElement(l.parentNode))return a}else if(l.namespaceURI===b&&"tracked-changes"===l.localName)return a;return d}};xmldom.LSSerializerFilter=function(){};xmldom.LSSerializerFilter.prototype.acceptNode=function(e){};
odf.OdfNodeFilter=function(){this.acceptNode=function(e){return"http://www.w3.org/1999/xhtml"===e.namespaceURI?NodeFilter.FILTER_SKIP:e.namespaceURI&&e.namespaceURI.match(/^urn:webodf:/)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}};xmldom.XPathIterator=function(){};xmldom.XPathIterator.prototype.next=function(){};xmldom.XPathIterator.prototype.reset=function(){};xmldom.XPathAtom;
function createXPathSingleton(){function e(a,c,b){return-1!==a&&(a<c||-1===c)&&(a<b||-1===b)}function g(a){for(var c=[],b=0,d=a.length,k;b<d;){var h=a,l=d,g=c,n="",p=[],A=h.indexOf("[",b),x=h.indexOf("/",b),E=h.indexOf("=",b);e(x,A,E)?(n=h.substring(b,x),b=x+1):e(A,x,E)?(n=h.substring(b,A),b=m(h,A,p)):e(E,x,A)?(n=h.substring(b,E),b=E):(n=h.substring(b,l),b=l);g.push({location:n,predicates:p});if(b<d&&"="===a[b]){k=a.substring(b+1,d);if(2<k.length&&("'"===k[0]||'"'===k[0]))k=k.slice(1,k.length-1);
else try{k=parseInt(k,10)}catch(N){}b=d}}return{steps:c,value:k}}function a(){var a=null,c=!1;this.setNode=function(c){a=c};this.reset=function(){c=!1};this.next=function(){var b=c?null:a;c=!0;return b}}function d(a,c,b){this.reset=function(){a.reset()};this.next=function(){for(var d=a.next();d;){d.nodeType===Node.ELEMENT_NODE&&(d=d.getAttributeNodeNS(c,b));if(d)break;d=a.next()}return d}}function b(a,c){var b=a.next(),d=null;this.reset=function(){a.reset();b=a.next();d=null};this.next=function(){for(;b;){if(d)if(c&&
d.firstChild)d=d.firstChild;else{for(;!d.nextSibling&&d!==b;)d=d.parentNode;d===b?b=a.next():d=d.nextSibling}else{do(d=b.firstChild)||(b=a.next());while(b&&!d)}if(d&&d.nodeType===Node.ELEMENT_NODE)return d}return null}}function l(a,c){this.reset=function(){a.reset()};this.next=function(){for(var b=a.next();b&&!c(b);)b=a.next();return b}}function n(a,c,b){c=c.split(":",2);var d=b(c[0]),e=c[1];return new l(a,function(a){return a.localName===e&&a.namespaceURI===d})}function h(b,c,f){var d=new a,e=p(d,
c,f),h=c.value;return void 0===h?new l(b,function(a){d.setNode(a);e.reset();return null!==e.next()}):new l(b,function(a){d.setNode(a);e.reset();return(a=e.next())?a.nodeValue===h:!1})}var p,m;m=function(a,c,b){for(var d=c,e=a.length,h=0;d<e;)"]"===a[d]?(h-=1,0>=h&&b.push(g(a.substring(c,d)))):"["===a[d]&&(0>=h&&(c=d+1),h+=1),d+=1;return d};p=function(a,c,f){var e,k,l,g;for(e=0;e<c.steps.length;e+=1){l=c.steps[e];k=l.location;if(""===k)a=new b(a,!1);else if("@"===k[0]){k=k.substr(1).split(":",2);g=
f(k[0]);if(!g)throw"No namespace associated with the prefix "+k[0];a=new d(a,g,k[1])}else"."!==k&&(a=new b(a,!1),-1!==k.indexOf(":")&&(a=n(a,k,f)));for(k=0;k<l.predicates.length;k+=1)g=l.predicates[k],a=h(a,g,f)}return a};return{getODFElementsWithXPath:function(b,c,f){var d=b.ownerDocument,e=[],h=null;if(d&&"function"===typeof d.evaluate)for(f=d.evaluate(c,b,f,XPathResult.UNORDERED_NODE_ITERATOR_TYPE,null),h=f.iterateNext();null!==h;)h.nodeType===Node.ELEMENT_NODE&&e.push(h),h=f.iterateNext();else{e=
new a;e.setNode(b);b=g(c);e=p(e,b,f);b=[];for(f=e.next();f;)b.push(f),f=e.next();e=b}return e}}}xmldom.XPath=createXPathSingleton();
odf.StyleInfo=function(){function e(a,c){var b,f,d,k,h,r=0;if(b=I[a.localName])if(d=b[a.namespaceURI])r=d.length;for(b=0;b<r;b+=1)f=d[b],k=f.ns,h=f.localname,(f=a.getAttributeNS(k,h))&&a.setAttributeNS(k,E[k]+h,c+f);for(d=a.firstElementChild;d;)e(d,c),d=d.nextElementSibling}function g(a,c){var b,f,d,e,k,h=0;if(b=I[a.localName])if(d=b[a.namespaceURI])h=d.length;for(b=0;b<h;b+=1)if(f=d[b],e=f.ns,k=f.localname,f=a.getAttributeNS(e,k))f=f.replace(c,""),a.setAttributeNS(e,E[e]+k,f);for(d=a.firstElementChild;d;)g(d,
c),d=d.nextElementSibling}function a(a,c){var b,f,d,e,k,h=0;if(b=I[a.localName])if(d=b[a.namespaceURI])h=d.length;for(b=0;b<h;b+=1)if(e=d[b],f=e.ns,k=e.localname,f=a.getAttributeNS(f,k))c=c||{},e=e.keyname,c.hasOwnProperty(e)?c[e][f]=1:(k={},k[f]=1,c[e]=k);return c}function d(c,b){var f,e;a(c,b);for(f=c.firstChild;f;)f.nodeType===Node.ELEMENT_NODE&&(e=f,d(e,b)),f=f.nextSibling}function b(a,c,b){this.key=a;this.name=c;this.family=b;this.requires={}}function l(a,c,f){var d=a+'"'+c,e=f[d];e||(e=f[d]=
new b(d,a,c));return e}function n(a,c,b){var f,d,e,k,h,r=0;f=a.getAttributeNS(t,"name");k=a.getAttributeNS(t,"family");f&&k&&(c=l(f,k,b));if(c){if(f=I[a.localName])if(e=f[a.namespaceURI])r=e.length;for(f=0;f<r;f+=1)if(k=e[f],d=k.ns,h=k.localname,d=a.getAttributeNS(d,h))k=k.keyname,k=l(d,k,b),c.requires[k.key]=k}for(a=a.firstElementChild;a;)n(a,c,b),a=a.nextElementSibling;return b}function h(a,c){var b=c[a.family];b||(b=c[a.family]={});b[a.name]=1;Object.keys(a.requires).forEach(function(b){h(a.requires[b],
c)})}function p(a,c){var b=n(a,null,{});Object.keys(b).forEach(function(a){a=b[a];var f=c[a.family];f&&f.hasOwnProperty(a.name)&&h(a,c)})}function m(a,c){function b(c){(c=e.getAttributeNS(t,c))&&(a[c]=!0)}var f=["font-name","font-name-asian","font-name-complex"],d,e;for(d=c&&c.firstElementChild;d;)e=d,f.forEach(b),m(a,e),d=d.nextElementSibling}function q(a,c){function b(a){var f=e.getAttributeNS(t,a);f&&c.hasOwnProperty(f)&&e.setAttributeNS(t,"style:"+a,c[f])}var f=["font-name","font-name-asian",
"font-name-complex"],d,e;for(d=a&&a.firstElementChild;d;)e=d,f.forEach(b),q(e,c),d=d.nextElementSibling}var c=odf.Namespaces.chartns,f=odf.Namespaces.dbns,r=odf.Namespaces.dr3dns,k=odf.Namespaces.drawns,u=odf.Namespaces.formns,v=odf.Namespaces.numberns,z=odf.Namespaces.officens,w=odf.Namespaces.presentationns,t=odf.Namespaces.stylens,A=odf.Namespaces.tablens,x=odf.Namespaces.textns,E={"urn:oasis:names:tc:opendocument:xmlns:chart:1.0":"chart:","urn:oasis:names:tc:opendocument:xmlns:database:1.0":"db:",
"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0":"dr3d:","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":"draw:","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":"fo:","urn:oasis:names:tc:opendocument:xmlns:form:1.0":"form:","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":"number:","urn:oasis:names:tc:opendocument:xmlns:office:1.0":"office:","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0":"presentation:","urn:oasis:names:tc:opendocument:xmlns:style:1.0":"style:","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0":"svg:",
"urn:oasis:names:tc:opendocument:xmlns:table:1.0":"table:","urn:oasis:names:tc:opendocument:xmlns:text:1.0":"chart:","http://www.w3.org/XML/1998/namespace":"xml:"},N={text:[{ens:t,en:"tab-stop",ans:t,a:"leader-text-style"},{ens:t,en:"drop-cap",ans:t,a:"style-name"},{ens:x,en:"notes-configuration",ans:x,a:"citation-body-style-name"},{ens:x,en:"notes-configuration",ans:x,a:"citation-style-name"},{ens:x,en:"a",ans:x,a:"style-name"},{ens:x,en:"alphabetical-index",ans:x,a:"style-name"},{ens:x,en:"linenumbering-configuration",
ans:x,a:"style-name"},{ens:x,en:"list-level-style-number",ans:x,a:"style-name"},{ens:x,en:"ruby-text",ans:x,a:"style-name"},{ens:x,en:"span",ans:x,a:"style-name"},{ens:x,en:"a",ans:x,a:"visited-style-name"},{ens:t,en:"text-properties",ans:t,a:"text-line-through-text-style"},{ens:x,en:"alphabetical-index-source",ans:x,a:"main-entry-style-name"},{ens:x,en:"index-entry-bibliography",ans:x,a:"style-name"},{ens:x,en:"index-entry-chapter",ans:x,a:"style-name"},{ens:x,en:"index-entry-link-end",ans:x,a:"style-name"},
{ens:x,en:"index-entry-link-start",ans:x,a:"style-name"},{ens:x,en:"index-entry-page-number",ans:x,a:"style-name"},{ens:x,en:"index-entry-span",ans:x,a:"style-name"},{ens:x,en:"index-entry-tab-stop",ans:x,a:"style-name"},{ens:x,en:"index-entry-text",ans:x,a:"style-name"},{ens:x,en:"index-title-template",ans:x,a:"style-name"},{ens:x,en:"list-level-style-bullet",ans:x,a:"style-name"},{ens:x,en:"outline-level-style",ans:x,a:"style-name"}],paragraph:[{ens:k,en:"caption",ans:k,a:"text-style-name"},{ens:k,
en:"circle",ans:k,a:"text-style-name"},{ens:k,en:"connector",ans:k,a:"text-style-name"},{ens:k,en:"control",ans:k,a:"text-style-name"},{ens:k,en:"custom-shape",ans:k,a:"text-style-name"},{ens:k,en:"ellipse",ans:k,a:"text-style-name"},{ens:k,en:"frame",ans:k,a:"text-style-name"},{ens:k,en:"line",ans:k,a:"text-style-name"},{ens:k,en:"measure",ans:k,a:"text-style-name"},{ens:k,en:"path",ans:k,a:"text-style-name"},{ens:k,en:"polygon",ans:k,a:"text-style-name"},{ens:k,en:"polyline",ans:k,a:"text-style-name"},
{ens:k,en:"rect",ans:k,a:"text-style-name"},{ens:k,en:"regular-polygon",ans:k,a:"text-style-name"},{ens:z,en:"annotation",ans:k,a:"text-style-name"},{ens:u,en:"column",ans:u,a:"text-style-name"},{ens:t,en:"style",ans:t,a:"next-style-name"},{ens:A,en:"body",ans:A,a:"paragraph-style-name"},{ens:A,en:"even-columns",ans:A,a:"paragraph-style-name"},{ens:A,en:"even-rows",ans:A,a:"paragraph-style-name"},{ens:A,en:"first-column",ans:A,a:"paragraph-style-name"},{ens:A,en:"first-row",ans:A,a:"paragraph-style-name"},
{ens:A,en:"last-column",ans:A,a:"paragraph-style-name"},{ens:A,en:"last-row",ans:A,a:"paragraph-style-name"},{ens:A,en:"odd-columns",ans:A,a:"paragraph-style-name"},{ens:A,en:"odd-rows",ans:A,a:"paragraph-style-name"},{ens:x,en:"notes-configuration",ans:x,a:"default-style-name"},{ens:x,en:"alphabetical-index-entry-template",ans:x,a:"style-name"},{ens:x,en:"bibliography-entry-template",ans:x,a:"style-name"},{ens:x,en:"h",ans:x,a:"style-name"},{ens:x,en:"illustration-index-entry-template",ans:x,a:"style-name"},
{ens:x,en:"index-source-style",ans:x,a:"style-name"},{ens:x,en:"object-index-entry-template",ans:x,a:"style-name"},{ens:x,en:"p",ans:x,a:"style-name"},{ens:x,en:"table-index-entry-template",ans:x,a:"style-name"},{ens:x,en:"table-of-content-entry-template",ans:x,a:"style-name"},{ens:x,en:"table-index-entry-template",ans:x,a:"style-name"},{ens:x,en:"user-index-entry-template",ans:x,a:"style-name"},{ens:t,en:"page-layout-properties",ans:t,a:"register-truth-ref-style-name"}],chart:[{ens:c,en:"axis",ans:c,
a:"style-name"},{ens:c,en:"chart",ans:c,a:"style-name"},{ens:c,en:"data-label",ans:c,a:"style-name"},{ens:c,en:"data-point",ans:c,a:"style-name"},{ens:c,en:"equation",ans:c,a:"style-name"},{ens:c,en:"error-indicator",ans:c,a:"style-name"},{ens:c,en:"floor",ans:c,a:"style-name"},{ens:c,en:"footer",ans:c,a:"style-name"},{ens:c,en:"grid",ans:c,a:"style-name"},{ens:c,en:"legend",ans:c,a:"style-name"},{ens:c,en:"mean-value",ans:c,a:"style-name"},{ens:c,en:"plot-area",ans:c,a:"style-name"},{ens:c,en:"regression-curve",
ans:c,a:"style-name"},{ens:c,en:"series",ans:c,a:"style-name"},{ens:c,en:"stock-gain-marker",ans:c,a:"style-name"},{ens:c,en:"stock-loss-marker",ans:c,a:"style-name"},{ens:c,en:"stock-range-line",ans:c,a:"style-name"},{ens:c,en:"subtitle",ans:c,a:"style-name"},{ens:c,en:"title",ans:c,a:"style-name"},{ens:c,en:"wall",ans:c,a:"style-name"}],section:[{ens:x,en:"alphabetical-index",ans:x,a:"style-name"},{ens:x,en:"bibliography",ans:x,a:"style-name"},{ens:x,en:"illustration-index",ans:x,a:"style-name"},
{ens:x,en:"index-title",ans:x,a:"style-name"},{ens:x,en:"object-index",ans:x,a:"style-name"},{ens:x,en:"section",ans:x,a:"style-name"},{ens:x,en:"table-of-content",ans:x,a:"style-name"},{ens:x,en:"table-index",ans:x,a:"style-name"},{ens:x,en:"user-index",ans:x,a:"style-name"}],ruby:[{ens:x,en:"ruby",ans:x,a:"style-name"}],table:[{ens:f,en:"query",ans:f,a:"style-name"},{ens:f,en:"table-representation",ans:f,a:"style-name"},{ens:A,en:"background",ans:A,a:"style-name"},{ens:A,en:"table",ans:A,a:"style-name"}],
"table-column":[{ens:f,en:"column",ans:f,a:"style-name"},{ens:A,en:"table-column",ans:A,a:"style-name"}],"table-row":[{ens:f,en:"query",ans:f,a:"default-row-style-name"},{ens:f,en:"table-representation",ans:f,a:"default-row-style-name"},{ens:A,en:"table-row",ans:A,a:"style-name"}],"table-cell":[{ens:f,en:"column",ans:f,a:"default-cell-style-name"},{ens:A,en:"table-column",ans:A,a:"default-cell-style-name"},{ens:A,en:"table-row",ans:A,a:"default-cell-style-name"},{ens:A,en:"body",ans:A,a:"style-name"},
{ens:A,en:"covered-table-cell",ans:A,a:"style-name"},{ens:A,en:"even-columns",ans:A,a:"style-name"},{ens:A,en:"covered-table-cell",ans:A,a:"style-name"},{ens:A,en:"even-columns",ans:A,a:"style-name"},{ens:A,en:"even-rows",ans:A,a:"style-name"},{ens:A,en:"first-column",ans:A,a:"style-name"},{ens:A,en:"first-row",ans:A,a:"style-name"},{ens:A,en:"last-column",ans:A,a:"style-name"},{ens:A,en:"last-row",ans:A,a:"style-name"},{ens:A,en:"odd-columns",ans:A,a:"style-name"},{ens:A,en:"odd-rows",ans:A,a:"style-name"},
{ens:A,en:"table-cell",ans:A,a:"style-name"}],graphic:[{ens:r,en:"cube",ans:k,a:"style-name"},{ens:r,en:"extrude",ans:k,a:"style-name"},{ens:r,en:"rotate",ans:k,a:"style-name"},{ens:r,en:"scene",ans:k,a:"style-name"},{ens:r,en:"sphere",ans:k,a:"style-name"},{ens:k,en:"caption",ans:k,a:"style-name"},{ens:k,en:"circle",ans:k,a:"style-name"},{ens:k,en:"connector",ans:k,a:"style-name"},{ens:k,en:"control",ans:k,a:"style-name"},{ens:k,en:"custom-shape",ans:k,a:"style-name"},{ens:k,en:"ellipse",ans:k,a:"style-name"},
{ens:k,en:"frame",ans:k,a:"style-name"},{ens:k,en:"g",ans:k,a:"style-name"},{ens:k,en:"line",ans:k,a:"style-name"},{ens:k,en:"measure",ans:k,a:"style-name"},{ens:k,en:"page-thumbnail",ans:k,a:"style-name"},{ens:k,en:"path",ans:k,a:"style-name"},{ens:k,en:"polygon",ans:k,a:"style-name"},{ens:k,en:"polyline",ans:k,a:"style-name"},{ens:k,en:"rect",ans:k,a:"style-name"},{ens:k,en:"regular-polygon",ans:k,a:"style-name"},{ens:z,en:"annotation",ans:k,a:"style-name"}],presentation:[{ens:r,en:"cube",ans:w,
a:"style-name"},{ens:r,en:"extrude",ans:w,a:"style-name"},{ens:r,en:"rotate",ans:w,a:"style-name"},{ens:r,en:"scene",ans:w,a:"style-name"},{ens:r,en:"sphere",ans:w,a:"style-name"},{ens:k,en:"caption",ans:w,a:"style-name"},{ens:k,en:"circle",ans:w,a:"style-name"},{ens:k,en:"connector",ans:w,a:"style-name"},{ens:k,en:"control",ans:w,a:"style-name"},{ens:k,en:"custom-shape",ans:w,a:"style-name"},{ens:k,en:"ellipse",ans:w,a:"style-name"},{ens:k,en:"frame",ans:w,a:"style-name"},{ens:k,en:"g",ans:w,a:"style-name"},
{ens:k,en:"line",ans:w,a:"style-name"},{ens:k,en:"measure",ans:w,a:"style-name"},{ens:k,en:"page-thumbnail",ans:w,a:"style-name"},{ens:k,en:"path",ans:w,a:"style-name"},{ens:k,en:"polygon",ans:w,a:"style-name"},{ens:k,en:"polyline",ans:w,a:"style-name"},{ens:k,en:"rect",ans:w,a:"style-name"},{ens:k,en:"regular-polygon",ans:w,a:"style-name"},{ens:z,en:"annotation",ans:w,a:"style-name"}],"drawing-page":[{ens:k,en:"page",ans:k,a:"style-name"},{ens:w,en:"notes",ans:k,a:"style-name"},{ens:t,en:"handout-master",
ans:k,a:"style-name"},{ens:t,en:"master-page",ans:k,a:"style-name"}],"list-style":[{ens:x,en:"list",ans:x,a:"style-name"},{ens:x,en:"numbered-paragraph",ans:x,a:"style-name"},{ens:x,en:"list-item",ans:x,a:"style-override"},{ens:t,en:"style",ans:t,a:"list-style-name"}],data:[{ens:t,en:"style",ans:t,a:"data-style-name"},{ens:t,en:"style",ans:t,a:"percentage-data-style-name"},{ens:w,en:"date-time-decl",ans:t,a:"data-style-name"},{ens:x,en:"creation-date",ans:t,a:"data-style-name"},{ens:x,en:"creation-time",
ans:t,a:"data-style-name"},{ens:x,en:"database-display",ans:t,a:"data-style-name"},{ens:x,en:"date",ans:t,a:"data-style-name"},{ens:x,en:"editing-duration",ans:t,a:"data-style-name"},{ens:x,en:"expression",ans:t,a:"data-style-name"},{ens:x,en:"meta-field",ans:t,a:"data-style-name"},{ens:x,en:"modification-date",ans:t,a:"data-style-name"},{ens:x,en:"modification-time",ans:t,a:"data-style-name"},{ens:x,en:"print-date",ans:t,a:"data-style-name"},{ens:x,en:"print-time",ans:t,a:"data-style-name"},{ens:x,
en:"table-formula",ans:t,a:"data-style-name"},{ens:x,en:"time",ans:t,a:"data-style-name"},{ens:x,en:"user-defined",ans:t,a:"data-style-name"},{ens:x,en:"user-field-get",ans:t,a:"data-style-name"},{ens:x,en:"user-field-input",ans:t,a:"data-style-name"},{ens:x,en:"variable-get",ans:t,a:"data-style-name"},{ens:x,en:"variable-input",ans:t,a:"data-style-name"},{ens:x,en:"variable-set",ans:t,a:"data-style-name"}],"page-layout":[{ens:w,en:"notes",ans:t,a:"page-layout-name"},{ens:t,en:"handout-master",ans:t,
a:"page-layout-name"},{ens:t,en:"master-page",ans:t,a:"page-layout-name"}]},I,H=xmldom.XPath;this.collectUsedFontFaces=m;this.changeFontFaceNames=q;this.UsedStyleList=function(a,c){var b={};this.uses=function(a){var c=a.localName,f=a.getAttributeNS(k,"name")||a.getAttributeNS(t,"name");a="style"===c?a.getAttributeNS(t,"family"):a.namespaceURI===v?"data":c;return(a=b[a])?0<a[f]:!1};d(a,b);c&&p(c,b)};this.getStyleName=function(a,c){var b,f,d=I[c.localName];if(d&&(d=d[c.namespaceURI]))for(f=0;f<d.length;f+=
1)if(d[f].keyname===a&&(d=d[f],c.hasAttributeNS(d.ns,d.localname))){b=c.getAttributeNS(d.ns,d.localname);break}return b};this.hasDerivedStyles=function(a,c,b){var f=b.getAttributeNS(t,"name");b=b.getAttributeNS(t,"family");return H.getODFElementsWithXPath(a,"//style:*[@style:parent-style-name='"+f+"'][@style:family='"+b+"']",c).length?!0:!1};this.prefixStyleNames=function(a,c,b){var f;if(a){for(f=a.firstChild;f;){if(f.nodeType===Node.ELEMENT_NODE){var d=f,h=c,r=d.getAttributeNS(k,"name"),l=void 0;
r?l=k:(r=d.getAttributeNS(t,"name"))&&(l=t);l&&d.setAttributeNS(l,E[l]+"name",h+r)}f=f.nextSibling}e(a,c);b&&e(b,c)}};this.removePrefixFromStyleNames=function(a,c,b){var f=new RegExp("^"+c);if(a){for(c=a.firstChild;c;){if(c.nodeType===Node.ELEMENT_NODE){var d=c,e=f,h=d.getAttributeNS(k,"name"),r=void 0;h?r=k:(h=d.getAttributeNS(t,"name"))&&(r=t);r&&(h=h.replace(e,""),d.setAttributeNS(r,E[r]+"name",h))}c=c.nextSibling}g(a,f);b&&g(b,f)}};this.determineStylesForNode=a;I=function(){var a,c,b,f,d,e={},
k,h,r,l;for(b in N)if(N.hasOwnProperty(b))for(f=N[b],c=f.length,a=0;a<c;a+=1)d=f[a],r=d.en,l=d.ens,e.hasOwnProperty(r)?k=e[r]:e[r]=k={},k.hasOwnProperty(l)?h=k[l]:k[l]=h=[],h.push({ns:d.ans,localname:d.a,keyname:b});return e}()};"function"!==typeof Object.create&&(Object.create=function(e){var g=function(){};g.prototype=e;return new g});
xmldom.LSSerializer=function(){function e(a){var d=a||{},e=function(a){var c={},b;for(b in a)a.hasOwnProperty(b)&&(c[a[b]]=b);return c}(a),h=[d],g=[e],m=0;this.push=function(){m+=1;d=h[m]=Object.create(d);e=g[m]=Object.create(e)};this.pop=function(){h.pop();g.pop();m-=1;d=h[m];e=g[m]};this.getLocalNamespaceDefinitions=function(){return e};this.getQName=function(a){var c=a.namespaceURI,b=0,h;if(!c)return a.localName;if(h=e[c])return h+":"+a.localName;do{h||!a.prefix?(h="ns"+b,b+=1):h=a.prefix;if(d[h]===
c)break;if(!d[h]){d[h]=c;e[c]=h;break}h=null}while(null===h);return h+":"+a.localName}}function g(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")}function a(b,e){var n="",h=d.filter?d.filter.acceptNode(e):NodeFilter.FILTER_ACCEPT,p;if(h===NodeFilter.FILTER_ACCEPT&&e.nodeType===Node.ELEMENT_NODE){b.push();p=b.getQName(e);var m,q=e.attributes,c,f,r,k="",u;m="<"+p;c=q.length;for(f=0;f<c;f+=1)r=q.item(f),"http://www.w3.org/2000/xmlns/"!==
r.namespaceURI&&(u=d.filter?d.filter.acceptNode(r):NodeFilter.FILTER_ACCEPT,u===NodeFilter.FILTER_ACCEPT&&(u=b.getQName(r),r="string"===typeof r.value?g(r.value):r.value,k+=" "+(u+'="'+r+'"')));c=b.getLocalNamespaceDefinitions();for(f in c)c.hasOwnProperty(f)&&((q=c[f])?"xmlns"!==q&&(m+=" xmlns:"+c[f]+'="'+f+'"'):m+=' xmlns="'+f+'"');n+=m+(k+">")}if(h===NodeFilter.FILTER_ACCEPT||h===NodeFilter.FILTER_SKIP){for(h=e.firstChild;h;)n+=a(b,h),h=h.nextSibling;e.nodeValue&&(n+=g(e.nodeValue))}p&&(n+="</"+
p+">",b.pop());return n}var d=this;this.filter=null;this.writeToString=function(b,d){if(!b)return"";var g=new e(d);return a(g,b)}};
(function(){function e(a){var c,b=h.length;for(c=0;c<b;c+=1)if("urn:oasis:names:tc:opendocument:xmlns:office:1.0"===a.namespaceURI&&a.localName===h[c])return c;return-1}function g(a,c){var f=new b.UsedStyleList(a,c),d=new odf.OdfNodeFilter;this.acceptNode=function(a){var b=d.acceptNode(a);b===NodeFilter.FILTER_ACCEPT&&a.parentNode===c&&a.nodeType===Node.ELEMENT_NODE&&(b=f.uses(a)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT);return b}}function a(a,c){var b=new g(a,c);this.acceptNode=function(a){var c=
b.acceptNode(a);c!==NodeFilter.FILTER_ACCEPT||!a.parentNode||a.parentNode.namespaceURI!==odf.Namespaces.textns||"s"!==a.parentNode.localName&&"tab"!==a.parentNode.localName||(c=NodeFilter.FILTER_REJECT);return c}}function d(a,c){if(c){var b=e(c),d,k=a.firstChild;if(-1!==b){for(;k;){d=e(k);if(-1!==d&&d>b)break;k=k.nextSibling}a.insertBefore(c,k)}}}var b=new odf.StyleInfo,l=core.DomUtils,n=odf.Namespaces.stylens,h="meta settings scripts font-face-decls styles automatic-styles master-styles body".split(" "),
p=Date.now()+"_webodf_",m=new core.Base64;odf.ODFElement=function(){};odf.ODFDocumentElement=function(){};odf.ODFDocumentElement.prototype=new odf.ODFElement;odf.ODFDocumentElement.prototype.constructor=odf.ODFDocumentElement;odf.ODFDocumentElement.prototype.automaticStyles;odf.ODFDocumentElement.prototype.body;odf.ODFDocumentElement.prototype.fontFaceDecls=null;odf.ODFDocumentElement.prototype.manifest=null;odf.ODFDocumentElement.prototype.masterStyles;odf.ODFDocumentElement.prototype.meta;odf.ODFDocumentElement.prototype.settings=
null;odf.ODFDocumentElement.prototype.styles;odf.ODFDocumentElement.namespaceURI="urn:oasis:names:tc:opendocument:xmlns:office:1.0";odf.ODFDocumentElement.localName="document";odf.AnnotationElement=function(){};odf.AnnotationElement.prototype.annotationEndElement;odf.OdfPart=function(a,c,b,d){var e=this;this.size=0;this.type=null;this.name=a;this.container=b;this.url=null;this.mimetype=c;this.onstatereadychange=this.document=null;this.onchange;this.EMPTY=0;this.LOADING=1;this.DONE=2;this.state=this.EMPTY;
this.data="";this.load=function(){null!==d&&(this.mimetype=c,d.loadAsDataURL(a,c,function(a,c){a&&runtime.log(a);e.url=c;if(e.onchange)e.onchange(e,a);if(e.onstatereadychange)e.onstatereadychange(e)}))}};odf.OdfPart.prototype.load=function(){};odf.OdfPart.prototype.getUrl=function(){return this.data?"data:;base64,"+m.toBase64(this.data):null};odf.OdfContainer=function c(f,e){function k(a){for(var c=a.firstChild,b;c;)b=c.nextSibling,c.nodeType===Node.ELEMENT_NODE?k(c):c.nodeType===Node.PROCESSING_INSTRUCTION_NODE&&
a.removeChild(c),c=b}function h(a){var c={},b,f,d=a.ownerDocument.createNodeIterator(a,NodeFilter.SHOW_ELEMENT,null,!1);for(a=d.nextNode();a;)"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===a.namespaceURI&&("annotation"===a.localName?(b=a.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","name"))&&(c.hasOwnProperty(b)?runtime.log("Warning: annotation name used more than once with <office:annotation/>: '"+b+"'"):c[b]=a):"annotation-end"===a.localName&&((b=a.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"name"))?c.hasOwnProperty(b)?(f=c[b],f.annotationEndElement?runtime.log("Warning: annotation name used more than once with <office:annotation-end/>: '"+b+"'"):f.annotationEndElement=a):runtime.log("Warning: annotation end without an annotation start, name: '"+b+"'"):runtime.log("Warning: annotation end without a name found"))),a=d.nextNode()}function v(a,c){for(var b=a&&a.firstChild;b;)b.nodeType===Node.ELEMENT_NODE&&b.setAttributeNS("urn:webodf:names:scope","scope",c),b=b.nextSibling}function z(a,
c){for(var b=K.rootElement.meta,b=b&&b.firstChild;b&&(b.namespaceURI!==a||b.localName!==c);)b=b.nextSibling;for(b=b&&b.firstChild;b&&b.nodeType!==Node.TEXT_NODE;)b=b.nextSibling;return b?b.data:null}function w(a){var c={},b;for(a=a.firstChild;a;)a.nodeType===Node.ELEMENT_NODE&&a.namespaceURI===n&&"font-face"===a.localName&&(b=a.getAttributeNS(n,"name"),c[b]=a),a=a.nextSibling;return c}function t(a,c){var b=null,f,d,e;if(a)for(b=a.cloneNode(!0),f=b.firstElementChild;f;)d=f.nextElementSibling,(e=f.getAttributeNS("urn:webodf:names:scope",
"scope"))&&e!==c&&b.removeChild(f),f=d;return b}function A(a,c){var f,d,e,k=null,h={};if(a)for(c.forEach(function(a){b.collectUsedFontFaces(h,a)}),k=a.cloneNode(!0),f=k.firstElementChild;f;)d=f.nextElementSibling,e=f.getAttributeNS(n,"name"),h[e]||k.removeChild(f),f=d;return k}function x(a){var c=K.rootElement.ownerDocument,b;if(a){k(a.documentElement);try{b=c.importNode(a.documentElement,!0)}catch(f){}}return b}function E(a){K.state=a;if(K.onchange)K.onchange(K);if(K.onstatereadychange)K.onstatereadychange(K)}
function N(a){R=null;K.rootElement=a;a.fontFaceDecls=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls");a.styles=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles");a.automaticStyles=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles");a.masterStyles=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles");a.body=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"body");a.meta=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta");a.settings=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","settings");a.scripts=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","scripts");h(a)}function I(a){var f=x(a),e=K.rootElement,k;f&&"document-styles"===f.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===f.namespaceURI?(e.fontFaceDecls=l.getDirectChild(f,"urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"font-face-decls"),d(e,e.fontFaceDecls),k=l.getDirectChild(f,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles"),e.styles=k||a.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles"),d(e,e.styles),k=l.getDirectChild(f,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),e.automaticStyles=k||a.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),v(e.automaticStyles,"document-styles"),d(e,e.automaticStyles),f=l.getDirectChild(f,
"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),e.masterStyles=f||a.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),d(e,e.masterStyles),b.prefixStyleNames(e.automaticStyles,p,e.masterStyles)):E(c.INVALID)}function H(a){a=x(a);var f,e,k,h;if(a&&"document-content"===a.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===a.namespaceURI){f=K.rootElement;k=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls");
if(f.fontFaceDecls&&k){h=f.fontFaceDecls;var r,g,y,s,m={};e=w(h);s=w(k);for(k=k.firstElementChild;k;){r=k.nextElementSibling;if(k.namespaceURI===n&&"font-face"===k.localName)if(g=k.getAttributeNS(n,"name"),e.hasOwnProperty(g)){if(!k.isEqualNode(e[g])){y=g;for(var p=e,u=s,C=0,D=void 0,D=y=y.replace(/\d+$/,"");p.hasOwnProperty(D)||u.hasOwnProperty(D);)C+=1,D=y+C;y=D;k.setAttributeNS(n,"style:name",y);h.appendChild(k);e[y]=k;delete s[g];m[g]=y}}else h.appendChild(k),e[g]=k,delete s[g];k=r}h=m}else k&&
(f.fontFaceDecls=k,d(f,k));e=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles");v(e,"document-content");h&&b.changeFontFaceNames(e,h);if(f.automaticStyles&&e)for(h=e.firstChild;h;)f.automaticStyles.appendChild(h),h=e.firstChild;else e&&(f.automaticStyles=e,d(f,e));a=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","body");if(null===a)throw"<office:body/> tag is mising.";f.body=a;d(f,f.body)}else E(c.INVALID)}function F(a){a=x(a);var c;a&&
"document-meta"===a.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===a.namespaceURI&&(c=K.rootElement,c.meta=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),d(c,c.meta))}function G(a){a=x(a);var c;a&&"document-settings"===a.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===a.namespaceURI&&(c=K.rootElement,c.settings=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","settings"),d(c,c.settings))}function s(a){a=x(a);var c;
if(a&&"manifest"===a.localName&&"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"===a.namespaceURI)for(c=K.rootElement,c.manifest=a,a=c.manifest.firstElementChild;a;)"file-entry"===a.localName&&"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"===a.namespaceURI&&(U[a.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","full-path")]=a.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","media-type")),a=a.nextElementSibling}function y(a,c,b){a=l.getElementsByTagName(a,
c);var f;for(f=0;f<a.length;f+=1)c=a[f],b.hasOwnProperty(c.namespaceURI)||c.parentNode.removeChild(c)}function D(a){y(a,"script",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:office:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:table:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:text:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":!0});y(a,"style",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":!0,
"urn:oasis:names:tc:opendocument:xmlns:style:1.0":!0})}function T(a){var c=a.firstElementChild,b=[],f,d,e,k=a.attributes,h=k.length;for(f=0;f<h;f+=1)e=k.item(f),d=e.localName.substr(0,2).toLowerCase(),null===e.namespaceURI&&"on"===d&&b.push(e);h=b.length;for(f=0;f<h;f+=1)a.removeAttributeNode(b[f]);for(;c;)T(c),c=c.nextElementSibling}function C(a){var b=a.shift();if(b){var f=(new Date).getTime();aa.loadAsDOM(b.path,function(d,e){e&&(D(e),T(e.documentElement));b.handler(e);if(5E3<(new Date).getTime()-
f)g_errmsg("Sorry, It takes too much time to run.");else{if(K.state===c.INVALID){d?runtime.log("ERROR: Unable to load "+b.path+" - "+d):runtime.log("ERROR: Unable to load "+b.path);if("content.xml"==b.path)return;C(a)}d&&runtime.log("DEBUG: Unable to load "+b.path+" - "+d);C(a)}})}else h(K.rootElement),E(c.DONE)}function B(a){var c="";odf.Namespaces.forEachPrefix(function(a,b){c+=" xmlns:"+a+'="'+b+'"'});return'<?xml version="1.0" encoding="UTF-8"?><office:'+a+" "+c+' office:version="1.2">'}function P(){var a=
new xmldom.LSSerializer,c=B("document-meta");a.filter=new odf.OdfNodeFilter;c+=a.writeToString(K.rootElement.meta,odf.Namespaces.namespaceMap);return c+"</office:document-meta>"}function O(a,c){var b=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:file-entry");b.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:full-path",a);b.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:media-type",c);return b}function ba(){var a=
runtime.parseXML('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2"></manifest:manifest>'),c=a.documentElement,b=new xmldom.LSSerializer,f;for(f in U)U.hasOwnProperty(f)&&c.appendChild(O(f,U[f]));b.filter=new odf.OdfNodeFilter;return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n'+b.writeToString(a,odf.Namespaces.namespaceMap)}function ca(){var a,c,f,d=odf.Namespaces.namespaceMap,e=new xmldom.LSSerializer,k=B("document-styles");
c=t(K.rootElement.automaticStyles,"document-styles");f=K.rootElement.masterStyles.cloneNode(!0);a=A(K.rootElement.fontFaceDecls,[f,K.rootElement.styles,c]);b.removePrefixFromStyleNames(c,p,f);e.filter=new g(f,c);k+=e.writeToString(a,d);k+=e.writeToString(K.rootElement.styles,d);k+=e.writeToString(c,d);k+=e.writeToString(f,d);return k+"</office:document-styles>"}function da(){var c,b,f=odf.Namespaces.namespaceMap,d=new xmldom.LSSerializer,e=B("document-content");b=t(K.rootElement.automaticStyles,"document-content");
c=A(K.rootElement.fontFaceDecls,[b]);d.filter=new a(K.rootElement.body,b);e+=d.writeToString(c,f);e+=d.writeToString(b,f);e+=d.writeToString(K.rootElement.body,f);return e+"</office:document-content>"}function W(a,b){runtime.loadXML(a,function(a,f){if(a)b(a);else if(f){D(f);T(f.documentElement);var d=x(f);d&&"document"===d.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===d.namespaceURI?(N(d),E(c.DONE)):E(c.INVALID)}else b("No DOM was loaded.")})}function J(a,c){var b;b=K.rootElement;
var f=b.meta;f||(b.meta=f=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),d(b,f));b=f;a&&l.mapKeyValObjOntoNode(b,a,odf.Namespaces.lookupNamespaceURI);c&&l.removeKeyElementsFromNode(b,c,odf.Namespaces.lookupNamespaceURI)}function Y(a,b){function f(a,c){var b;c||(c=a);b=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",c);h[a]=b;h.appendChild(b)}var d=new core.Zip("",null),e="application/vnd.oasis.opendocument."+a+(!0===b?"-template":""),
k=runtime.byteArrayFromString(e,"utf8"),h=K.rootElement,r=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",a);d.save("mimetype",k,!1,new Date);f("meta");f("settings");f("scripts");f("fontFaceDecls","font-face-decls");f("styles");f("automaticStyles","automatic-styles");f("masterStyles","master-styles");f("body");h.body.appendChild(r);U["/"]=e;U["settings.xml"]="text/xml";U["meta.xml"]="text/xml";U["styles.xml"]="text/xml";U["content.xml"]="text/xml";E(c.DONE);return d}function ga(){var a,
c=new Date,b="";K.rootElement.settings&&K.rootElement.settings.firstElementChild&&(a=new xmldom.LSSerializer,b=B("document-settings"),a.filter=new odf.OdfNodeFilter,b+=a.writeToString(K.rootElement.settings,odf.Namespaces.namespaceMap),b+="</office:document-settings>");(a=b)?(a=runtime.byteArrayFromString(a,"utf8"),aa.save("settings.xml",a,!0,c)):aa.remove("settings.xml");b=runtime.getWindow();a="WebODF/"+webodf.Version;b&&(a=a+" "+b.navigator.userAgent);J({"meta:generator":a},null);a=runtime.byteArrayFromString(P(),
"utf8");aa.save("meta.xml",a,!0,c);a=runtime.byteArrayFromString(ca(),"utf8");aa.save("styles.xml",a,!0,c);a=runtime.byteArrayFromString(da(),"utf8");aa.save("content.xml",a,!0,c);a=runtime.byteArrayFromString(ba(),"utf8");aa.save("META-INF/manifest.xml",a,!0,c)}function Z(a,c){ga();aa.writeAs(a,function(a){c(a)})}var K=this,aa,U={},R,S="";this.onstatereadychange=e;this.state=this.onchange=null;this.rootElement;this.getMetadata=z;this.setRootElement=N;this.getContentElement=function(){var a;R||(a=
K.rootElement.body,R=l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","text")||l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","presentation")||l.getDirectChild(a,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","spreadsheet"));if(!R)throw g_errmsg('<div style="margin:0px 30px">An error has occurred. Please check whether the file format supports. or Reopen a file.</div>'),"Could not find content element in <office:body/>.";return R};this.getDocumentType=
function(){var a=K.getContentElement();return a&&a.localName};this.isTemplate=function(){return"-template"===U["/"].substr(-9)};this.setIsTemplate=function(a){var c=U["/"],b="-template"===c.substr(-9);a!==b&&(c=a?c+"-template":c.substr(0,c.length-9),U["/"]=c,a=runtime.byteArrayFromString(c,"utf8"),aa.save("mimetype",a,!1,new Date))};this.getPart=function(a){return new odf.OdfPart(a,U[a],K,aa)};this.getPartData=function(a,c){aa.load(a,c)};this.getPartData2=function(a,c){aa.loadAsString(a,c)};this.setMetadata=
J;this.incrementEditingCycles=function(){var a=z(odf.Namespaces.metans,"editing-cycles"),a=a?parseInt(a,10):0;isNaN(a)&&(a=0);J({"meta:editing-cycles":a+1},null);return a+1};this.createByteArray=function(a,c){ga();aa.createByteArray(a,c)};this.saveAs=Z;this.save=function(a){Z(S,a)};this.getUrl=function(){return S};this.setBlob=function(a,c,b){b=m.convertBase64ToByteArray(b);aa.save(a,b,!1,new Date);U.hasOwnProperty(a)&&runtime.log(a+" has been overwritten.");U[a]=c};this.removeBlob=function(a){var c=
aa.remove(a);runtime.assert(c,"file is not found: "+a);delete U[a]};this.state=c.LOADING;this.rootElement=function(a){var c=document.createElementNS(a.namespaceURI,a.localName),b;a=new a.Type;for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b]);return c}({Type:odf.ODFDocumentElement,namespaceURI:odf.ODFDocumentElement.namespaceURI,localName:odf.ODFDocumentElement.localName});f===odf.OdfContainer.DocumentType.TEXT?aa=Y("text"):f===odf.OdfContainer.DocumentType.TEXT_TEMPLATE?aa=Y("text",!0):f===odf.OdfContainer.DocumentType.PRESENTATION?
aa=Y("presentation"):f===odf.OdfContainer.DocumentType.PRESENTATION_TEMPLATE?aa=Y("presentation",!0):f===odf.OdfContainer.DocumentType.SPREADSHEET?aa=Y("spreadsheet"):f===odf.OdfContainer.DocumentType.SPREADSHEET_TEMPLATE?aa=Y("spreadsheet",!0):(S=f,aa=new core.Zip(S,function(a,b){aa=b;a?W(S,function(b){a&&(aa.error=a+"\n"+b,E(c.INVALID))}):C([{path:"styles.xml",handler:I},{path:"content.xml",handler:H},{path:"meta.xml",handler:F},{path:"settings.xml",handler:G},{path:"META-INF/manifest.xml",handler:s}])}))};
odf.OdfContainer.EMPTY=0;odf.OdfContainer.LOADING=1;odf.OdfContainer.DONE=2;odf.OdfContainer.INVALID=3;odf.OdfContainer.SAVING=4;odf.OdfContainer.MODIFIED=5;odf.OdfContainer.getContainer=function(a){return new odf.OdfContainer(a,null)}})();odf.OdfContainer.DocumentType={TEXT:1,TEXT_TEMPLATE:2,PRESENTATION:3,PRESENTATION_TEMPLATE:4,SPREADSHEET:5,SPREADSHEET_TEMPLATE:6};gui.AnnotatableCanvas=function(){};gui.AnnotatableCanvas.prototype.refreshSize=function(){};
gui.AnnotatableCanvas.prototype.getZoomLevel=function(){};gui.AnnotatableCanvas.prototype.getSizer=function(){};
gui.AnnotationViewManager=function(e,g,a,d){function b(a){var c=a.annotationEndElement,b=m.createRange(),d=a.getAttributeNS(odf.Namespaces.officens,"name");c&&(b.setStart(a,a.childNodes.length),b.setEnd(c,0),a=q.getTextNodes(b,!1),a.forEach(function(a){var c;a:{for(c=a.parentNode;c.namespaceURI!==odf.Namespaces.officens||"body"!==c.localName;){if("http://www.w3.org/1999/xhtml"===c.namespaceURI&&"webodf-annotationHighlight"===c.className&&c.getAttribute("annotation")===d){c=!0;break a}c=c.parentNode}c=
!1}c||(c=m.createElement("span"),c.className="webodf-annotationHighlight",c.setAttribute("annotation",d),a.parentNode.replaceChild(c,a),c.appendChild(a))}));b.detach()}function l(b){var d=e.getSizer();b?(a.style.display="inline-block",d.style.paddingRight=c.getComputedStyle(a).width):(a.style.display="none",d.style.paddingRight=0);e.refreshSize()}function n(){p.sort(function(a,c){return 0!==(a.compareDocumentPosition(c)&Node.DOCUMENT_POSITION_FOLLOWING)?-1:1})}function h(){var c;for(c=0;c<p.length;c+=
1){var b=p[c],d=b.parentNode,h=d.nextElementSibling,g=h.nextElementSibling,l=d.parentNode,m=0,m=p[p.indexOf(b)-1],n=void 0,b=e.getZoomLevel();d.style.left=(a.getBoundingClientRect().left-l.getBoundingClientRect().left)/b+"px";d.style.width=a.getBoundingClientRect().width/b+"px";h.style.width=parseFloat(d.style.left)-30+"px";m&&(n=m.parentNode.getBoundingClientRect(),20>=(l.getBoundingClientRect().top-n.bottom)/b?d.style.top=Math.abs(l.getBoundingClientRect().top-n.bottom)/b+20+"px":d.style.top="0px");
g.style.left=h.getBoundingClientRect().width/b+"px";var h=g.style,l=g.getBoundingClientRect().left/b,m=g.getBoundingClientRect().top/b,n=d.getBoundingClientRect().left/b,q=d.getBoundingClientRect().top/b,x=0,E=0,x=n-l,x=x*x,E=q-m,E=E*E,l=Math.sqrt(x+E);h.width=l+"px";m=Math.asin((d.getBoundingClientRect().top-g.getBoundingClientRect().top)/(b*parseFloat(g.style.width)));g.style.transform="rotate("+m+"rad)";g.style.MozTransform="rotate("+m+"rad)";g.style.WebkitTransform="rotate("+m+"rad)";g.style.msTransform=
"rotate("+m+"rad)"}}var p=[],m=g.ownerDocument,q=odf.OdfUtils,c=runtime.getWindow();runtime.assert(Boolean(c),"Expected to be run in an environment which has a global window, like a browser.");this.rerenderAnnotations=h;this.rehighlightAnnotations=function(){p.forEach(function(a){b(a)})};this.getMinimumHeightForAnnotationPane=function(){return"none"!==a.style.display&&0<p.length?(p[p.length-1].parentNode.getBoundingClientRect().bottom-a.getBoundingClientRect().top)/e.getZoomLevel()+"px":null};this.addAnnotation=
function(a){l(!0);p.push(a);n();var c=m.createElement("div"),e=m.createElement("div"),g=m.createElement("div"),v=m.createElement("div"),z;c.className="annotationWrapper";c.setAttribute("creator",q.getAnnotationCreator(a));a.parentNode.insertBefore(c,a);e.className="annotationNote";e.appendChild(a);d&&(z=m.createElement("div"),z.className="annotationRemoveButton",e.appendChild(z));g.className="annotationConnector horizontal";v.className="annotationConnector angular";c.appendChild(e);c.appendChild(g);
c.appendChild(v);a.annotationEndElement&&b(a);h()};this.forgetAnnotations=function(){for(;p.length;){var a=p[0],c=p.indexOf(a),b=a.parentNode.parentNode;"div"===b.localName&&(b.parentNode.insertBefore(a,b),b.parentNode.removeChild(b));for(var a=a.getAttributeNS(odf.Namespaces.officens,"name"),a=m.querySelectorAll('span.webodf-annotationHighlight[annotation="'+a+'"]'),d=b=void 0,b=0;b<a.length;b+=1){for(d=a.item(b);d.firstChild;)d.parentNode.insertBefore(d.firstChild,d);d.parentNode.removeChild(d)}-1!==
c&&p.splice(c,1);0===p.length&&l(!1)}}};gui.Viewport=function(){};gui.Viewport.prototype.scrollIntoView=function(e,g){};
gui.SingleScrollViewport=function(e){this.scrollIntoView=function(g,a){var d,b,l,n;n=e.offsetHeight-e.clientHeight;l=e.offsetWidth-e.clientWidth;var h=e.getBoundingClientRect();if(g&&h){d=h.left+5;b=h.top+5;l=h.right-(l+5);n=h.bottom-(n+5);if(a||g.top<b)e.scrollTop-=b-g.top;else if(g.top>n||g.bottom>n)e.scrollTop=g.bottom-g.top<=n-b?e.scrollTop+(g.bottom-n):e.scrollTop+(g.top-b);g.left<d?e.scrollLeft-=d-g.left:g.right>l&&(e.scrollLeft=g.right-g.left<=l-d?e.scrollLeft+(g.right-l):e.scrollLeft-(d-g.left))}}};
(function(){function e(a,g,n,h,p){var m,q=0,c;for(c in a)if(a.hasOwnProperty(c)){if(q===n){m=c;break}q+=1}m?g.getPartData(a[m].href,function(c,r){if(c)runtime.log(c);else if(r){var k="@font-face { font-family: "+(a[m].family||m)+"; src: url(data:application/x-font-ttf;charset=binary;base64,"+d.convertUTF8ArrayToBase64(r)+') format("truetype"); }';try{h.insertRule(k,h.cssRules.length)}catch(q){runtime.log("Problem inserting rule in CSS: "+runtime.toJson(q)+"\nRule: "+k)}}else runtime.log("missing font data for "+
a[m].href);e(a,g,n+1,h,p)}):p&&p()}var g=xmldom.XPath,a=odf.OdfUtils,d=new core.Base64;odf.FontLoader=function(){this.loadFonts=function(b,d){for(var n=b.rootElement.fontFaceDecls;d.cssRules.length;)d.deleteRule(d.cssRules.length-1);if(n){var h={},p,m,q,c;if(n)for(n=g.getODFElementsWithXPath(n,"style:font-face[svg:font-face-src]",odf.Namespaces.lookupNamespaceURI),p=0;p<n.length;p+=1)m=n[p],q=m.getAttributeNS(odf.Namespaces.stylens,"name"),c=a.getNormalizedFontFamilyName(m.getAttributeNS(odf.Namespaces.svgns,
"font-family")),m=g.getODFElementsWithXPath(m,"svg:font-face-src/svg:font-face-uri",odf.Namespaces.lookupNamespaceURI),0<m.length&&(m=m[0].getAttributeNS(odf.Namespaces.xlinkns,"href"),h[q]={href:m,family:c});e(h,b,0,d)}}}})();
odf.Formatting=function(){function e(a){return(a=E[a])?A.mergeObjects({},a):{}}function g(){for(var a=c.rootElement.fontFaceDecls,b={},f,d,a=a&&a.firstElementChild;a;){if(f=a.getAttributeNS(k,"name"))if((d=a.getAttributeNS(r,"font-family"))||0<a.getElementsByTagNameNS(r,"font-face-uri").length)b[f]=d;a=a.nextElementSibling}return b}function a(a){for(var b=c.rootElement.styles.firstElementChild;b;){if(b.namespaceURI===k&&"default-style"===b.localName&&b.getAttributeNS(k,"family")===a)return b;b=b.nextElementSibling}return null}
function d(a,b,f){var d,e,h;f=f||[c.rootElement.automaticStyles,c.rootElement.styles];for(h=0;h<f.length;h+=1)for(d=f[h],d=d.firstElementChild;d;){e=d.getAttributeNS(k,"name");if(d.namespaceURI===k&&"style"===d.localName&&d.getAttributeNS(k,"family")===b&&e===a||"list-style"===b&&d.namespaceURI===u&&"list-style"===d.localName&&e===a||"data"===b&&d.namespaceURI===v&&e===a)return d;d=d.nextElementSibling}return null}function b(a){for(var c,b,f,d,e={},h=a.firstElementChild;h;){if(h.namespaceURI===k)for(f=
e[h.nodeName]={},b=h.attributes,c=0;c<b.length;c+=1)d=b.item(c),f[d.name]=d.value;h=h.nextElementSibling}b=a.attributes;for(c=0;c<b.length;c+=1)d=b.item(c),e[d.name]=d.value;return e}function l(f,h){for(var r=c.rootElement.styles,g,l={},m=f.getAttributeNS(k,"family"),y=f;y;)g=b(y),l=A.mergeObjects(g,l),y=(g=y.getAttributeNS(k,"parent-style-name"))?d(g,m,[r]):null;if(y=a(m))g=b(y),l=A.mergeObjects(g,l);!1!==h&&(g=e(m),l=A.mergeObjects(g,l));return l}function n(a,c){function b(a){Object.keys(a).forEach(function(c){Object.keys(a[c]).forEach(function(a){h+=
"|"+c+":"+a+"|"})})}for(var d=a.nodeType===Node.TEXT_NODE?a.parentNode:a,e,k=[],h="",g=!1;d;)!g&&w.isGroupingElement(d)&&(g=!0),(e=f.determineStylesForNode(d))&&k.push(e),d=d.parentNode;g&&(k.forEach(b),c&&(c[h]=k));return g?k:void 0}function h(a){var b={orderedStyles:[],styleProperties:{}};a.forEach(function(a){Object.keys(a).forEach(function(f){var e=Object.keys(a[f])[0],h={name:e,family:f,displayName:void 0,isCommonStyle:!1},g;(g=d(e,f))?(f=l(g),b.styleProperties=A.mergeObjects(f,b.styleProperties),
h.displayName=g.getAttributeNS(k,"display-name")||void 0,h.isCommonStyle=g.parentNode===c.rootElement.styles):runtime.log("No style element found for '"+e+"' of family '"+f+"'");b.orderedStyles.push(h)})});return b}function p(a,c){var b={},f=[];c||(c={});a.forEach(function(a){n(a,b)});Object.keys(b).forEach(function(a){c[a]||(c[a]=h(b[a]));f.push(c[a])});return f}function m(a){for(var b=c.rootElement.masterStyles.firstElementChild;b&&(b.namespaceURI!==k||"master-page"!==b.localName||b.getAttributeNS(k,
"name")!==a);)b=b.nextElementSibling;return b}function q(a,c){var b;a&&(b=x.convertMeasure(a,"px"));void 0===b&&c&&(b=x.convertMeasure(c,"px"));return b}var c,f=new odf.StyleInfo,r=odf.Namespaces.svgns,k=odf.Namespaces.stylens,u=odf.Namespaces.textns,v=odf.Namespaces.numberns,z=odf.Namespaces.fons,w=odf.OdfUtils,t=core.DomUtils,A=new core.Utils,x=new core.CSSUnits,E={paragraph:{"style:paragraph-properties":{"fo:text-align":"left"}}};this.getSystemDefaultStyleAttributes=e;this.setOdfContainer=function(a){c=
a};this.getFontMap=g;this.getAvailableParagraphStyles=function(){for(var a=c.rootElement.styles,b,f,d=[],a=a&&a.firstElementChild;a;)"style"===a.localName&&a.namespaceURI===k&&(b=a.getAttributeNS(k,"family"),"paragraph"===b&&(b=a.getAttributeNS(k,"name"),f=a.getAttributeNS(k,"display-name")||b,b&&f&&d.push({name:b,displayName:f}))),a=a.nextElementSibling;return d};this.isStyleUsed=function(a){var b,d=c.rootElement;b=f.hasDerivedStyles(d,odf.Namespaces.lookupNamespaceURI,a);a=(new f.UsedStyleList(d.styles)).uses(a)||
(new f.UsedStyleList(d.automaticStyles)).uses(a)||(new f.UsedStyleList(d.body)).uses(a);return b||a};this.getDefaultStyleElement=a;this.getStyleElement=d;this.getStyleAttributes=b;this.getInheritedStyleAttributes=l;this.getFirstCommonParentStyleNameOrSelf=function(a){var b=c.rootElement.styles,f;if(f=d(a,"paragraph",[c.rootElement.automaticStyles]))if(a=f.getAttributeNS(k,"parent-style-name"),!a)return null;return(f=d(a,"paragraph",[b]))?a:null};this.hasParagraphStyle=function(a){return Boolean(d(a,
"paragraph"))};this.getAppliedStyles=p;this.getAppliedStylesForElement=function(a,c){return p([a],c)[0]};this.updateStyle=function(a,b){var f,d;t.mapObjOntoNode(a,b,odf.Namespaces.lookupNamespaceURI);(f=(f=b["style:text-properties"])&&f["style:font-name"])&&!g().hasOwnProperty(f)&&(d=a.ownerDocument.createElementNS(k,"style:font-face"),d.setAttributeNS(k,"style:name",f),d.setAttributeNS(r,"svg:font-family",f),c.rootElement.fontFaceDecls.appendChild(d))};this.createDerivedStyleObject=function(a,f,
e){var k=d(a,f);runtime.assert(Boolean(k),"No style element found for '"+a+"' of family '"+f+"'");a=k.parentNode===c.rootElement.styles?{"style:parent-style-name":a}:b(k);a["style:family"]=f;A.mergeObjects(a,e);return a};this.getDefaultTabStopDistance=function(){for(var c=a("paragraph"),c=c&&c.firstElementChild,b;c;)c.namespaceURI===k&&"paragraph-properties"===c.localName&&(b=c.getAttributeNS(k,"tab-stop-distance")),c=c.nextElementSibling;b||(b="1.25cm");return w.parseNonNegativeLength(b)};this.getMasterPageElement=
m;this.getContentSize=function(a,b){var f,e,h,g,r,l,n,p,u,v;a:{e=d(a,b);runtime.assert("paragraph"===b||"table"===b,"styleFamily must be either paragraph or table");if(e){if(e=e.getAttributeNS(k,"master-page-name"))(f=m(e))||runtime.log("WARN: No master page definition found for "+e);f||(f=m("Standard"));f||(f=c.rootElement.masterStyles.getElementsByTagNameNS(k,"master-page")[0])||runtime.log("WARN: Document has no master pages defined");if(f)for(e=f.getAttributeNS(k,"page-layout-name"),h=c.rootElement.automaticStyles.getElementsByTagNameNS(k,
"page-layout"),g=0;g<h.length;g+=1)if(f=h.item(g),f.getAttributeNS(k,"name")===e)break a}f=null}f||(f=t.getDirectChild(c.rootElement.styles,k,"default-page-layout"));(f=t.getDirectChild(f,k,"page-layout-properties"))?("landscape"===f.getAttributeNS(k,"print-orientation")?(e="29.7cm",h="21.001cm"):(e="21.001cm",h="29.7cm"),e=q(f.getAttributeNS(z,"page-width"),e),h=q(f.getAttributeNS(z,"page-height"),h),g=q(f.getAttributeNS(z,"margin")),void 0===g?(g=q(f.getAttributeNS(z,"margin-left"),"2cm"),r=q(f.getAttributeNS(z,
"margin-right"),"2cm"),l=q(f.getAttributeNS(z,"margin-top"),"2cm"),n=q(f.getAttributeNS(z,"margin-bottom"),"2cm")):g=r=l=n=g,p=q(f.getAttributeNS(z,"padding")),void 0===p?(p=q(f.getAttributeNS(z,"padding-left"),"0cm"),u=q(f.getAttributeNS(z,"padding-right"),"0cm"),v=q(f.getAttributeNS(z,"padding-top"),"0cm"),f=q(f.getAttributeNS(z,"padding-bottom"),"0cm")):p=u=v=f=p):(e=q("21.001cm"),h=q("29.7cm"),g=r=l=n=g=q("2cm"),p=u=v=f=p=q("0cm"));return{width:e-g-r-p-u,height:h-l-n-v-f}}};odf.Formatting.StyleMetadata;
odf.Formatting.StyleData;odf.Formatting.AppliedStyle;
(function(){var e=odf.Namespaces.stylens,g=odf.Namespaces.textns,a={graphic:"draw","drawing-page":"draw",paragraph:"text",presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"};odf.StyleTreeNode=function(a){this.derivedStyles={};this.element=a};odf.StyleTree=function(d,b){function l(a){var c,b,d,k={};if(!a)return k;for(a=a.firstElementChild;a;){if(b=a.namespaceURI!==e||"style"!==a.localName&&
"default-style"!==a.localName?a.namespaceURI===g&&"list-style"===a.localName?"list":a.namespaceURI!==e||"page-layout"!==a.localName&&"default-page-layout"!==a.localName?void 0:"page":a.getAttributeNS(e,"family"))(c=a.getAttributeNS(e,"name"))||(c=""),k.hasOwnProperty(b)?d=k[b]:k[b]=d={},d[c]=a;a=a.nextElementSibling}return k}function n(a,c){if(a.hasOwnProperty(c))return a[c];var b=null,d=Object.keys(a),e;for(e=0;e<d.length&&!(b=n(a[d[e]].derivedStyles,c));e+=1);return b}function h(a,c,b){var d,k,
g;if(!c.hasOwnProperty(a))return null;d=new odf.StyleTreeNode(c[a]);k=d.element.getAttributeNS(e,"parent-style-name");g=null;k&&(g=n(b,k)||h(k,c,b));g?g.derivedStyles[a]=d:b[a]=d;delete c[a];return d}function p(a,c){a&&Object.keys(a).forEach(function(b){h(b,a,c)})}var m={};this.getStyleTree=function(){return m};(function(){var e,c,f;c=l(d);f=l(b);Object.keys(a).forEach(function(a){e=m[a]={};p(c[a],e);p(f[a],e)})})()}})();odf.StyleTree.Tree;
(function(){function e(a,b){try{a.insertRule(b,a.cssRules.length)}catch(d){runtime.log("cannot load rule: "+b+" - "+d)}}function g(a,b){this.listCounterCount=0;this.contentRules=a;this.counterIdStack=[];this.continuedCounterIdStack=b}function a(a){function b(f,d,h,g){var n=d.namespaceURI===l&&"list"===d.localName,q=d.namespaceURI===l&&"list-item"===d.localName;if(n||q){if(n){var n=h+=1,t,A,x;g.listCounterCount+=1;q=f+"-level"+n+"-"+g.listCounterCount;d.setAttributeNS("urn:webodf:names:helper","counter-id",
q);t=g.continuedCounterIdStack.shift();t||(t=q,c+=q+" 1 ",A='text|list[webodfhelper|counter-id="'+q+'"] > text|list-item:first-child > :not(text|list):first-child:before',A+="{",A+="counter-increment: "+t+" 0;",A+="}",e(a,A));for(;g.counterIdStack.length>=n;)g.counterIdStack.pop();g.counterIdStack.push(t);x=g.contentRules[n.toString()]||"";for(A=1;A<=n;A+=1)x=x.replace(A+"webodf-listLevel",g.counterIdStack[A-1]);A='text|list[webodfhelper|counter-id="'+q+'"] > text|list-item > :not(text|list):first-child:before';
A+="{";A+=x;A+="counter-increment: "+t+";";A+="}";e(a,A)}for(d=d.firstElementChild;d;)b(f,d,h,g),d=d.nextElementSibling}else g.continuedCounterIdStack=[]}var d=0,c="",f={};this.createCounterRules=function(a,c,e){var h=c.getAttributeNS(n,"id"),l=[];e&&(e=e.getAttributeNS("urn:webodf:names:helper","counter-id"),l=f[e].slice(0));a=new g(a,l);h?h="Y"+h:(d+=1,h="X"+d);b(h,c,0,a);f[h+"-level1-1"]=a.counterIdStack};this.initialiseCreatedCounters=function(){var b;b="office|document{"+("counter-reset: "+c+
";");b+="}";e(a,b)}}var d=odf.Namespaces.fons,b=odf.Namespaces.stylens,l=odf.Namespaces.textns,n=odf.Namespaces.xmlns,h={1:"decimal",a:"lower-latin",A:"upper-latin",i:"lower-roman",I:"upper-roman"};odf.ListStyleToCss=function(){function g(a){var c=r.parseLength(a);return c?f.convert(c.value,c.unit,"px"):(runtime.log("Could not parse value '"+a+"'."),0)}function m(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function q(a,c){var b;a&&(b=a.getAttributeNS(l,"style-name"));return b===c}function c(c,
f,d){f=f.getElementsByTagNameNS(l,"list");c=new a(c);var e,g,r,p,x,E,N={},I;for(I=0;I<f.length;I+=1){e=f.item(I);if(r=core.DomUtils.getDirectChild(e,l,"list-header"))try{e.parentNode.insertBefore(r.cloneNode(!0),e),r.parentNode.removeChild(r)}catch(H){}if(E=e.getAttributeNS(l,"style-name")){r=e.getAttributeNS(l,"continue-numbering");p=e.getAttributeNS(l,"continue-list");(x=e.getAttributeNS(n,"id"))&&(N[x]=e);x=d[E].element.firstElementChild;for(var F=void 0,G={};x;){var F=(F=x.getAttributeNS(l,"level"))&&
parseInt(F,10),s=x,y="",D=void 0,T=void 0,C=D=void 0;if("list-level-style-number"===s.localName){var y=s.getAttributeNS(b,"num-format"),D=s.getAttributeNS(b,"num-suffix")||"",T=s.getAttributeNS(b,"num-prefix")||"",B="",P=s.getAttributeNS(l,"level"),O=s.getAttributeNS(l,"display-levels");T&&(B+='"'+m(T)+'"\n');if(h.hasOwnProperty(y))for(P=P?parseInt(P,10):1,O=O?parseInt(O,10):1;0<O;)B+=" counter("+(P-O+1)+"webodf-listLevel,"+h[y]+")",1<O&&(B+='"."'),O-=1;else B=y?B+(' "'+y+'"'):B+' ""';y="content:"+
B+' "'+m(D)+'"'}else"list-level-style-image"===s.localName?y="content: none":"list-level-style-bullet"===s.localName&&(y=s.getAttributeNS(l,"bullet-char"),y='content: "'+m(y)+'"');if(D=s.getElementsByTagNameNS(b,"list-level-properties")[0])T=D.getAttributeNS(l,"list-level-position-and-space-mode"),"label-alignment"===T&&((D=D.getElementsByTagNameNS(b,"list-level-label-alignment")[0])&&(C=D.getAttributeNS(l,"label-followed-by")),"space"===C&&(y+=' "\\a0"'));G[F]="\n"+y+";\n";x=x.nextElementSibling}x=
G;r&&!p&&q(g,E)?c.createCounterRules(x,e,g):p&&q(N[p],E)?c.createCounterRules(x,e,N[p]):c.createCounterRules(x,e);g=e}}c.initialiseCreatedCounters()}var f=new core.CSSUnits,r=odf.OdfUtils;this.applyListStyles=function(a,f,h){var r,m;(r=f.list)&&Object.keys(r).forEach(function(c){m=r[c];for(var f=m.element.firstElementChild;f;){if(f.namespaceURI===l){for(var h=a,n=f,q='text|list[text|style-name="'+c+'"]',u=n.getAttributeNS(l,"level"),v=void 0,F=void 0,G=F=void 0,s=void 0,y=void 0,D=v=void 0,T=void 0,
C=void 0,B=void 0,s=void 0,G=(F=n.getElementsByTagNameNS(b,"list-level-properties")[0])&&F.getAttributeNS(l,"list-level-position-and-space-mode"),s=F&&F.getElementsByTagNameNS(b,"list-level-label-alignment")[0],v=u=u&&parseInt(u,10);1<v;)q+=" > text|list-item > text|list",v-=1;v=F&&F.getAttributeNS(d,"text-align")||"left";switch(v){case "end":v="right";break;case "start":v="left"}"label-alignment"===G?(y=s&&s.getAttributeNS(d,"margin-left")||"0px",C=s&&s.getAttributeNS(d,"text-indent")||"0px",B=s&&
s.getAttributeNS(l,"label-followed-by"),s=g(y)):(y=F&&F.getAttributeNS(l,"space-before")||"0px",D=F&&F.getAttributeNS(l,"min-label-width")||"0px",T=F&&F.getAttributeNS(l,"min-label-distance")||"0px",s=g(y)+g(D));F=q+" > text|list-item";F+="{";F+="margin-left: "+s+"px;";F+="}";e(h,F);F=q+" > text|list-item > text|list";F+="{";F+="margin-left: "+-s+"px;";F+="}";e(h,F);F=q+" > text|list-item > :not(text|list):first-child:before";F+="{";F+="text-align: "+v+";";F+="display: inline-block;";"label-alignment"===
G?(F+="margin-left: "+C+";","listtab"===B&&(F+="padding-right: 0.2cm;")):(F+="min-width: "+D+";",F+="margin-left: "+(0===parseFloat(D)?"":"-")+D+";",F+="padding-right: "+T+";");F+="}";e(h,F)}f=f.nextElementSibling}});c(a,h,r)}}})();odf.LazyStyleProperties=function(e,g){var a={};this.value=function(d){var b;a.hasOwnProperty(d)?b=a[d]:(b=g[d](),void 0===b&&e&&(b=e.value(d)),a[d]=b);return b};this.reset=function(d){e=d;a={}}};
odf.StyleParseUtils=function(){function e(a){var d,b;a=(a=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px))/.exec(a))?{value:parseFloat(a[1]),unit:a[3]}:null;b=a&&a.unit;"px"===b?d=a.value:"cm"===b?d=a.value/2.54*96:"mm"===b?d=a.value/25.4*96:"in"===b?d=96*a.value:"pt"===b?d=a.value/.75:"pc"===b&&(d=16*a.value);return d}var g=odf.Namespaces.stylens;this.parseLength=e;this.parsePositiveLengthOrPercent=function(a,d,b){var g;a&&(g=parseFloat(a.substr(0,
a.indexOf("%"))),isNaN(g)&&(g=void 0));var n;void 0!==g?(b&&(n=b.value(d)),g=void 0===n?void 0:n/100*g):g=e(a);return g};this.getPropertiesElement=function(a,d,b){for(d=b?b.nextElementSibling:d.firstElementChild;null!==d&&(d.localName!==a||d.namespaceURI!==g);)d=d.nextElementSibling;return d};this.parseAttributeList=function(a){a&&(a=a.replace(/^\s*(.*?)\s*$/g,"$1"));return a&&0<a.length?a.split(/\s+/):[]}};
odf.Style2CSS=function(){function e(a,c,b){var f=[];b=b.derivedStyles;var d;var h=z[a],k;void 0===h?c=null:(k=c?"["+h+'|style-name="'+c+'"]':"","presentation"===h&&(h="draw",k=c?'[presentation|style-name="'+c+'"]':""),c=h+"|"+w[a].join(k+","+h+"|")+k);null!==c&&f.push(c);for(d in b)b.hasOwnProperty(d)&&(c=e(a,d,b[d]),f=f.concat(c));return f}function g(a){var c="",b="",c=null;if("default-style"===a.localName)return null;c=a.getAttributeNS(q,"parent-style-name");b=a.getAttributeNS(q,"family");return c=
ba.getODFElementsWithXPath(P,c?"//style:*[@style:name='"+c+"'][@style:family='"+b+"']":"//style:default-style[@style:family='"+b+"']",odf.Namespaces.lookupNamespaceURI)[0]}function a(a,c){var b="",f,d,e;for(f=0;f<c.length;f+=1)if(d=c[f],e=a.getAttributeNS(d[0],d[1])){e=e.trim();if(y.hasOwnProperty(d[1])){var h=e,k=h.indexOf(" "),r=void 0;e=void 0;-1!==k?(r=h.substring(0,k),e=h.substring(k)):(r=h,e="");(r=C.parseLength(r))&&"pt"===r.unit&&.75>r.value&&(h="0.75pt"+e);e=h}else if(D.hasOwnProperty(d[1])){var h=
a,k=d[0],r=d[1],l=C.parseLength(e),m=void 0,n=void 0,s=void 0,p=void 0,s=void 0;if(l&&"%"===l.unit){m=l.value/100;n=g(h.parentNode);for(p="0";n;){if(s=u.getDirectChild(n,q,"paragraph-properties"))if(s=C.parseLength(s.getAttributeNS(k,r))){if("%"!==s.unit){p=s.value*m+s.unit;break}m*=s.value/100}n=g(n)}e=p}}d[2]&&(b+=d[2]+":"+e+";")}return b}function d(a,c,b,f){return c+c+b+b+f+f}function b(a,c){var f=[a],d=c.derivedStyles;Object.keys(d).forEach(function(a){a=b(a,d[a]);f=f.concat(a)});return f}function l(a,
c,f,d){function e(c,b){var f=[],d;c.forEach(function(a){h.forEach(function(c){f.push("draw|page[webodfhelper|page-style-name='"+c+"'] draw|frame[presentation|class='"+a+"']")})});0<f.length&&(d=f.join(",")+"{visibility:"+b+";}",a.insertRule(d,a.cssRules.length))}var h=b(c,d),g=[],r=[];["page-number","date-time","header","footer"].forEach(function(a){var c;c=f.getAttributeNS(k,"display-"+a);"true"===c?g.push(a):"false"===c&&r.push(a)});e(g,"visible");e(r,"hidden")}function n(c,b,y,D){var w,z;if("page"===
b){var K=D.element,P="",U,R;R=U="";y=u.getDirectChild(K,q,"page-layout-properties");var S;if(y)if(S=K.getAttributeNS(q,"name"),P+=a(y,G),(U=u.getDirectChild(y,q,"background-image"))&&(R=U.getAttributeNS(r,"href"))&&(P=P+("background-image: url('odfkit:"+R+"');")+a(U,A)),"presentation"===B)for(K=(K=u.getDirectChild(K.parentNode.parentNode,m,"master-styles"))&&K.firstElementChild;K;){if(K.namespaceURI===q&&"master-page"===K.localName&&K.getAttributeNS(q,"page-layout-name")===S){R=K.getAttributeNS(q,
"name");U='draw|page[draw|master-page-name="'+R+'"] {'+P+"}";R='office|body, draw|page[draw|master-page-name="'+R+'"] {'+a(y,s)+" }";try{c.insertRule(U,c.cssRules.length)}catch(Q){console.log(Q)}try{c.insertRule(R,c.cssRules.length)}catch(ba){console.log(ba)}}K=K.nextElementSibling}else"text"===B&&(U="office|text {"+P+"}",R="office|body {width: "+y.getAttributeNS(p,"page-width")+";}",c.insertRule(U,c.cssRules.length),c.insertRule(R,c.cssRules.length))}else if(P=e(b,y,D).join(","),S="","Internet_20_link"!=
D.element.getAttributeNS(q,"name")){if(K=u.getDirectChild(D.element,q,"text-properties")){var X=K,$=z="";U="";R=1;K=""+a(X,t);w=X.getAttributeNS(q,"text-underline-style");"solid"===w&&(z+=" underline");w=X.getAttributeNS(q,"text-line-through-style");"solid"===w&&(z+=" line-through");z.length&&(K=K+("text-decoration:"+z+";\n")+("text-decoration-line:"+z+";\n"),K+="-moz-text-decoration-line:"+z+";\n");w=X.getAttributeNS(q,"text-line-through-type");switch(w){case "double":$+=" double";break;case "single":$+=
" single"}$&&(K+="text-decoration-style:"+$+";\n",K+="-moz-text-decoration-style:"+$+";\n");if(z=X.getAttributeNS(q,"font-name")||X.getAttributeNS(p,"font-family"))w=T[z],K+="font-family: "+(w||z)+";";if(w=X.getAttributeNS(q,"text-position"))z=v.parseAttributeList(w),w=z[0],z=z[1],K+="vertical-align: "+w+"\n; ",z&&(R=parseFloat(z)/100);X.hasAttributeNS(p,"color")&&(w=X.getAttributeNS(p,"color"),w=(w||"").toLowerCase(),"#ffffff"==w||"white"==w||"ffffff"==w||"#fff"==w||"fff"==w)&&(K+="color: #D8D8D8;");
if(X.hasAttributeNS(p,"font-size")||1!==R){for(X=X.parentNode;X;){if(w=(w=u.getDirectChild(X,q,"text-properties"))?C.parseFoFontSize(w.getAttributeNS(p,"font-size")):null){if("%"!==w.unit){U="font-size: "+w.value*R+w.unit+";";break}R*=w.value/100}X=g(X)}U||(U="font-size: "+parseFloat(O)*R+ca.getUnits(O)+";")}K+=U;S+=K}if(K=u.getDirectChild(D.element,q,"paragraph-properties"))U=K,K=""+a(U,x),(R=u.getDirectChild(U,q,"background-image"))&&(X=R.getAttributeNS(r,"href"))&&(K=K+("background-image: url('odfkit:"+
X+"');")+a(R,A)),(U=U.getAttributeNS(p,"line-height"))&&"normal"!==U&&(U=C.parseFoLineHeight(U),K="%"!==U.unit?K+("line-height: "+U.value+U.unit+";"):K+("line-height: "+U.value/100+";")),S+=K;if(K=u.getDirectChild(D.element,q,"graphic-properties"))X=K,K=""+a(X,E),U=X.getAttributeNS(h,"opacity"),R=X.getAttributeNS(h,"fill"),X=X.getAttributeNS(h,"fill-color"),"solid"===R||"hatch"===R?X&&"none"!==X?(U=isNaN(parseFloat(U))?1:parseFloat(U)/100,R=X.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,d),(X=(R=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(R))?
{r:parseInt(R[1],16),g:parseInt(R[2],16),b:parseInt(R[3],16)}:null)&&(K+="background-color: rgba("+X.r+","+X.g+","+X.b+","+U+");")):K+="background: none;":"none"===R&&(K+="background: none;"),S+=K;if(K=u.getDirectChild(D.element,q,"drawing-page-properties"))U=K,R=""+a(U,E),"true"===U.getAttributeNS(k,"background-visible")&&(R+="background: none;"),S+=R,l(c,y,K,D);if(K=u.getDirectChild(D.element,q,"table-cell-properties"))y=S,S=""+a(K,N),S=y+S;if(K=u.getDirectChild(D.element,q,"table-row-properties"))y=
S,S=""+a(K,H),S=y+S;if(K=u.getDirectChild(D.element,q,"table-column-properties"))y=S,S=""+a(K,I),S=y+S;if(K=u.getDirectChild(D.element,q,"table-properties"))y=S,S=""+a(K,F),K=K.getAttributeNS(f,"border-model"),"collapsing"===K?S+="border-collapse:collapse;":"separating"===K&&(S+="border-collapse:separate;"),S=y+S;0!==S.length&&c.insertRule(P+"{"+S+"}",c.cssRules.length)}for(var ea in D.derivedStyles)D.derivedStyles.hasOwnProperty(ea)&&n(c,b,ea,D.derivedStyles[ea])}var h=odf.Namespaces.drawns,p=odf.Namespaces.fons,
m=odf.Namespaces.officens,q=odf.Namespaces.stylens,c=odf.Namespaces.svgns,f=odf.Namespaces.tablens,r=odf.Namespaces.xlinkns,k=odf.Namespaces.presentationns,u=core.DomUtils,v=new odf.StyleParseUtils,z={graphic:"draw","drawing-page":"draw",paragraph:"text",presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"},w={graphic:"circle connected control custom-shape ellipse frame g line measure page page-thumbnail path polygon polyline rect regular-polygon".split(" "),
paragraph:"alphabetical-index-entry-template h illustration-index-entry-template index-source-style object-index-entry-template p table-index-entry-template table-of-content-entry-template user-index-entry-template".split(" "),presentation:"caption circle connector control custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),"drawing-page":"caption circle connector control page custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),
ruby:["ruby","ruby-text"],section:"alphabetical-index bibliography illustration-index index-title object-index section table-of-content table-index user-index".split(" "),table:["background","table"],"table-cell":"body covered-table-cell even-columns even-rows first-column first-row last-column last-row odd-columns odd-rows table-cell".split(" "),"table-column":["table-column"],"table-row":["table-row"],text:"a index-entry-chapter index-entry-link-end index-entry-link-start index-entry-page-number index-entry-span index-entry-tab-stop index-entry-text index-title-template linenumbering-configuration list-level-style-number list-level-style-bullet outline-level-style span".split(" "),
list:["list-item"]},t=[[p,"color","color"],[p,"background-color","background-color"],[p,"font-weight","font-weight"],[p,"font-style","font-style"]],A=[[q,"repeat","background-repeat"]],x=[[p,"background-color","background-color"],[p,"text-align","text-align"],[p,"text-indent","text-indent"],[p,"padding","padding"],[p,"padding-left","padding-left"],[p,"padding-right","padding-right"],[p,"padding-top","padding-top"],[p,"padding-bottom","padding-bottom"],[p,"border-left","border-left"],[p,"border-right",
"border-right"],[p,"border-top","border-top"],[p,"border-bottom","border-bottom"],[p,"margin","margin"],[p,"margin-left","margin-left"],[p,"margin-right","margin-right"],[p,"margin-top","margin-top"],[p,"margin-bottom","margin-bottom"],[p,"border","border"]],E=[[p,"background-color","background-color"],[p,"min-height","min-height"],[h,"stroke","border"],[c,"stroke-color","border-color"],[c,"stroke-width","border-width"],[p,"border","border"],[p,"border-left","border-left"],[p,"border-right","border-right"],
[p,"border-top","border-top"],[p,"border-bottom","border-bottom"]],N=[[p,"background-color","background-color"],[p,"border-left","border-left"],[p,"border-right","border-right"],[p,"border-top","border-top"],[p,"border-bottom","border-bottom"],[p,"border","border"]],I=[[q,"column-width","width"]],H=[[q,"row-height","height"],[p,"keep-together",null]],F=[[q,"width","width"],[p,"margin-left","margin-left"],[p,"margin-right","margin-right"],[p,"margin-top","margin-top"],[p,"margin-bottom","margin-bottom"]],
G=[[p,"background-color","background-color"],[p,"padding","padding"],[p,"padding-left","padding-left"],[p,"padding-right","padding-right"],[p,"padding-top","padding-top"],[p,"padding-bottom","padding-bottom"],[p,"border","border"],[p,"border-left","border-left"],[p,"border-right","border-right"],[p,"border-top","border-top"],[p,"border-bottom","border-bottom"],[p,"margin","margin"],[p,"margin-left","margin-left"],[p,"margin-right","margin-right"],[p,"margin-top","margin-top"],[p,"margin-bottom","margin-bottom"]],
s=[[p,"page-width","width"],[p,"page-height","height"]],y={border:!0,"border-left":!0,"border-right":!0,"border-top":!0,"border-bottom":!0,"stroke-width":!0},D={margin:!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"margin-bottom":!0},T={},C=odf.OdfUtils,B,P,O,ba=xmldom.XPath,ca=new core.CSSUnits;gstyleParseUtils=v;this.style2css=function(a,c,b,f,d){function e(a,c){h="@namespace "+a+" url("+c+");";try{b.insertRule(h,b.cssRules.length)}catch(f){}}var h,k,g;for(P=c;b.cssRules.length;)b.deleteRule(b.cssRules.length-
1);odf.Namespaces.forEachPrefix(e);e("webodfhelper","urn:webodf:names:helper");T=f;B=a;O=runtime.getWindow().getComputedStyle(document.body,null).getPropertyValue("font-size")||"12pt";c=0;for(g in z)if(z.hasOwnProperty(g))for(k in a=d[g],a)if(a.hasOwnProperty(k)){c++;if(1E3<c){c=0;break}n(b,g,k,a[k])}}};
(function(){function e(g,a){var d=this;this.getDistance=function(a){var e=d.x-a.x;a=d.y-a.y;return Math.sqrt(e*e+a*a)};this.getCenter=function(a){return new e((d.x+a.x)/2,(d.y+a.y)/2)};this.x;this.y;d.x=g;d.y=a}gui.ZoomHelper=function(){function g(a,c,b,d){a=d?"translate3d("+a+"px, "+c+"px, 0) scale3d("+b+", "+b+", 1)":"translate("+a+"px, "+c+"px) scale("+b+")";f.style.WebkitTransform=a;f.style.MozTransform=a;f.style.msTransform=a;f.style.OTransform=a;f.style.transform=a}function a(a){a?g(-r.x,-r.y,
v,!0):(g(0,0,v,!0),g(0,0,v,!1))}function d(a){if(w&&N){var c=w.style.overflow,b=w.classList.contains("webodf-customScrollbars");a&&b||!a&&!b||(a?(w.classList.add("webodf-customScrollbars"),w.style.overflow="hidden",runtime.requestAnimationFrame(function(){w.style.overflow=c})):w.classList.remove("webodf-customScrollbars"))}}function b(){g(-r.x,-r.y,v,!0);w.scrollLeft=0;w.scrollTop=0;I=t.style.overflow;t.style.overflow="visible";d(!1)}function l(){g(0,0,v,!0);w.scrollLeft=r.x;w.scrollTop=r.y;t.style.overflow=
I||"";d(!0)}function n(a){return new e(a.pageX-f.offsetLeft,a.pageY-f.offsetTop)}function h(a){if(k){r.x-=a.x-k.x;r.y-=a.y-k.y;var c=r;r=new e(Math.min(Math.max(c.x,f.offsetLeft),(f.offsetLeft+f.offsetWidth)*v-w.clientWidth),Math.min(Math.max(c.y,f.offsetTop),(f.offsetTop+f.offsetHeight)*v-w.clientHeight))}k=a}function p(a){var c=a.touches.length,f=0<c?n(a.touches[0]):null;a=1<c?n(a.touches[1]):null;f&&a?(u=f.getDistance(a),z=v,k=f.getCenter(a),b(),E=x.PINCH):f&&(k=f,E=x.SCROLL)}function m(c){var d=
c.touches.length,e=0<d?n(c.touches[0]):null,d=1<d?n(c.touches[1]):null;if(e&&d)if(c.preventDefault(),E===x.SCROLL)E=x.PINCH,b(),u=e.getDistance(d);else{c=e.getCenter(d);e=e.getDistance(d)/u;h(c);var d=v,k=Math.min(4,f.offsetParent.clientWidth/f.offsetWidth);v=z*e;v=Math.min(Math.max(v,k),4);e=v/d;r.x+=(e-1)*(c.x+r.x);r.y+=(e-1)*(c.y+r.y);a(!0)}else e&&(E===x.PINCH?(E=x.SCROLL,l()):h(e))}function q(){E===x.PINCH&&(A.emit(gui.ZoomHelper.signalZoomChanged,v),l(),a(!1));E=x.NONE}function c(){w&&(w.removeEventListener("touchstart",
p,!1),w.removeEventListener("touchmove",m,!1),w.removeEventListener("touchend",q,!1))}var f,r,k,u,v,z,w,t,A=new core.EventNotifier([gui.ZoomHelper.signalZoomChanged]),x={NONE:0,SCROLL:1,PINCH:2},E=x.NONE,N=runtime.getWindow().hasOwnProperty("ontouchstart"),I="";this.subscribe=function(a,c){A.subscribe(a,c)};this.unsubscribe=function(a,c){A.unsubscribe(a,c)};this.getZoomLevel=function(){return v};this.setZoomLevel=function(c){f&&(v=c,a(!1),A.emit(gui.ZoomHelper.signalZoomChanged,v))};this.destroy=
function(a){c();d(!1);a()};this.setZoomableElement=function(b){c();f=b;w=f.offsetParent;t=f.parentNode;a(!1);w&&(w.addEventListener("touchstart",p,!1),w.addEventListener("touchmove",m,!1),w.addEventListener("touchend",q,!1));d(!0)};z=v=1;r=new e(0,0)};gui.ZoomHelper.signalZoomChanged="zoomChanged"})();ops.Canvas=function(){};ops.Canvas.prototype.getZoomLevel=function(){};ops.Canvas.prototype.getElement=function(){};ops.Canvas.prototype.getSizer=function(){};ops.Canvas.prototype.getZoomHelper=function(){};
(function(){function e(){function a(d){b=!0;runtime.setTimeout(function(){try{d()}catch(e){runtime.log(String(e)+"\n"+e.stack)}b=!1;var h=document.getElementById("documentName");0<c.length?(h&&f&&0==c.length%2&&(h.innerHTML="Loading... "+c.length+" Remained."),a(c.pop())):h&&f&&(h.innerHTML=f||"")},10)}var c=[],b=!1,f;this.clearQueue=function(){c.length=0};this.addToQueue=function(d){if(0===c.length&&!b){if(!f){var e=document.getElementById("documentName");e&&(f=e.innerHTML)}return a(d)}c.push(d)}}
function g(a){function c(){for(;0<b.cssRules.length;)b.deleteRule(0);b.insertRule("#shadowContent draw|page {display:none;}",0);b.insertRule("office|presentation draw|page {display:none;}",1);b.insertRule("#shadowContent draw|page:nth-of-type("+f+") {display:block;}",2);b.insertRule("office|presentation draw|page:nth-of-type("+f+") {display:block;}",3)}var b=a.sheet,f=1;this.showFirstPage=function(){f=1;c()};this.showNextPage=function(){f+=1;c()};this.showPreviousPage=function(){1<f&&(f-=1,c())};
this.showPage=function(a){0<a&&(f=a,c())};this.css=a;this.destroy=function(c){a.parentNode.removeChild(a);c()}}function a(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function d(a){a=a.sheet;for(var c=a.cssRules;c.length;)a.deleteRule(c.length-1)}function b(a,c,b){var f=new odf.Style2CSS,d=new odf.ListStyleToCss;b=b.sheet;var e=(new odf.StyleTree(a.rootElement.styles,a.rootElement.automaticStyles)).getStyleTree();f.style2css(a.getDocumentType(),a.rootElement,b,c.getFontMap(),e);d.applyListStyles(b,
e,a.rootElement.body)}function l(a,c){(new odf.FontLoader).loadFonts(a,c.sheet)}function n(a,c,b){var f=null;a=a.rootElement.body.getElementsByTagNameNS(F,b+"-decl");b=c.getAttributeNS(F,"use-"+b+"-name");var d;if(b&&0<a.length)for(c=0;c<a.length;c+=1)if(d=a[c],d.getAttributeNS(F,"name")===b){f=d.textContent;break}return f}function h(c,b,f,d){var e=c.ownerDocument;b=s.getElementsByTagNameNS(c,b,f);for(c=0;c<b.length;c+=1)a(b[c]),d&&(f=b[c],f.appendChild(e.createTextNode(d)))}function p(a,c,b){c.setAttributeNS("urn:webodf:names:helper",
"styleid",a);var f,d=c.getAttributeNS(I,"anchor-type"),e=c.getAttributeNS(E,"x"),h=c.getAttributeNS(E,"y"),k=c.getAttributeNS(E,"width"),g=c.getAttributeNS(E,"height"),r=c.getAttributeNS(t,"min-height"),l=c.getAttributeNS(t,"min-width");if("as-char"===d||"char"===d||"paragraph"===d)f="display: inline-block;";else if(d||e||h)f="position: absolute;";else if(k||g||r||l)f="display: block;";var m=c.getAttributeNS(w,"transform"),n,s,p;m&&(d=function(a){(n=m.match(new RegExp(a+"(.*?)\\((.*?)\\)","i")))&&
n[2]&&(s=parseFloat(n[2]),isNaN(s)||(arr2=180/Math.PI*s*-1,-360<=arr2&&360>=arr2&&(p+=a+"("+arr2.toFixed(2)+"deg) ")))},p="",(n=m.match(/translate(.*?)\((.*?)\)/i))&&n[2]&&(s=n[2].trim().split(" "),2!=s.length&&(s=n[2].trim().split(",")),2==s.length&&(f="position: absolute;",p+="translate("+s[0]+","+s[1]+") ")),d("rotate"),d("skewX"),p&&(f+="transform: "+p+"; -webkit-transform: "+p+"; transform-origin: left top; -webkit-transform-origin: left top;"));"custom-shape"==c.localName&&(f+="border-width: 0.028cm; ");
e&&(f+="left: "+e+";");h&&(f+="top: "+h+";");k&&(f+="width: "+k+";");g&&(f+="height: "+g+";");r&&(f+="min-height: "+r+";");l&&(f+="min-width: "+l+";");f&&(f="draw|"+c.localName+'[webodfhelper|styleid="'+a+'"] {'+f+"}",b.insertRule(f,b.cssRules.length));!gdocumentType&&godfcontainer&&(gdocumentType=godfcontainer.getDocumentType());h&&g&&"text"==gdocumentType&&(h=gstyleParseUtils.parseLength(h),g=gstyleParseUtils.parseLength(g),h=parseInt(h+g),!isNaN(h)&&document.getElementsByTagName("document")[0]&&
h>document.getElementsByTagName("document")[0].clientHeight&&b.insertRule("office|document{height: "+(h+15)+"px;}",b.cssRules.length))}function m(a){for(a=a.firstChild;a;){if(a.namespaceURI===A&&"binary-data"===a.localName)return"data:image/png;base64,"+a.textContent.replace(/[\r\n\s]/g,"");a=a.nextSibling}return""}function q(a,c,b,f){function d(c){c&&(c='draw|image[webodfhelper|styleid="'+a+'"] {'+("background-image: url("+c+");")+"}",f.insertRule(c,f.cssRules.length))}function e(a){d(a.url)}b.setAttributeNS("urn:webodf:names:helper",
"styleid",a);var h=b.getAttributeNS(H,"href"),k;if(h)try{k=c.getPart(h),k.onchange=e,k.load()}catch(g){runtime.log("slight problem: "+String(g))}else h=m(b),d(h)}function c(a){var c=a.ownerDocument;s.getElementsByTagNameNS(a,I,"line-break").forEach(function(a){a.hasChildNodes()||a.appendChild(c.createElement("br"))})}function f(a){var c=a.ownerDocument;s.getElementsByTagNameNS(a,I,"s").forEach(function(a){for(var b,f;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(c.createTextNode(" "));f=
parseInt(a.getAttributeNS(I,"c"),10);if(1<f)for(a.removeAttributeNS(I,"c"),b=1;b<f;b+=1)a.parentNode.insertBefore(a.cloneNode(!0),a)})}function r(a){s.getElementsByTagNameNS(a,I,"tab").forEach(function(a){a.textContent="\t"})}function k(a,c){function b(a,f,h){f||(f="");var g=k.documentElement.namespaceURI;h||"video/"===f.substr(0,6)?(d=k.createElementNS(g,"video"),d.setAttribute("controls","controls"),e=k.createElementNS(g,"source"),a&&e.setAttribute("src",a),f&&e.setAttribute("type",f),d.appendChild(e),
c.parentNode.appendChild(d)):c.innerHTML="<br>&nbsp;Unrecognised Plugin"}function f(a,d){d&&0<=(d+"").indexOf("not found")?c.innerHTML="<br>&nbsp;Media File Not Found.":b(a.url,a.mimetype)}var d,e,h,k=c.ownerDocument,g;if(h=c.getAttributeNS(H,"href"))if(0==h.indexOf("http"))b(h,"",!0);else try{g=a.getPart(h),g.onchange=f,g.load()}catch(r){runtime.log("slight problem: "+String(r))}else runtime.log("using MP4 data fallback"),h=m(c),b(h,"video/mp4")}function u(a){var c=a.getElementsByTagName("head")[0],
b,f;b=a.styleSheets.length;for(f=c.firstElementChild;f&&("style"!==f.localName||!f.hasAttribute("webodfcss"));)f=f.nextElementSibling;if(f)return b=parseInt(f.getAttribute("webodfcss"),10),f.setAttribute("webodfcss",b+1),f;"string"===String(typeof webodf_css)?b=webodf_css:(f="webodf.css",runtime.currentDirectory&&(f=runtime.currentDirectory(),0<f.length&&"/"!==f.substr(-1)&&(f+="/"),f+="../webodf.css"),b=runtime.readFileSync(f,"utf-8"));f=a.createElementNS(c.namespaceURI,"style");f.setAttribute("media",
"screen, print, handheld, projection");f.setAttribute("type","text/css");f.setAttribute("webodfcss","1");f.appendChild(a.createTextNode(b));c.appendChild(f);return f}function v(a){var c=parseInt(a.getAttribute("webodfcss"),10);1===c?a.parentNode.removeChild(a):a.setAttribute("count",c-1)}function z(a){var c=a.getElementsByTagName("head")[0],b=a.createElementNS(c.namespaceURI,"style"),f="";b.setAttribute("type","text/css");b.setAttribute("media","screen, print, handheld, projection");odf.Namespaces.forEachPrefix(function(a,
c){f+="@namespace "+a+" url("+c+");\n"});f+="@namespace webodfhelper url(urn:webodf:names:helper);\n";b.appendChild(a.createTextNode(f));c.appendChild(b);return b}var w=odf.Namespaces.drawns,t=odf.Namespaces.fons,A=odf.Namespaces.officens,x=odf.Namespaces.stylens,E=odf.Namespaces.svgns,N=odf.Namespaces.tablens,I=odf.Namespaces.textns,H=odf.Namespaces.xlinkns,F=odf.Namespaces.presentationns,G=xmldom.XPath,s=core.DomUtils;odf.OdfCanvas=function(m,D){function t(a,c,b){function f(a,c,b,d){ma.addToQueue(function(){q(a,
c,b,d)})}function d(){var a,c;document.body.getElementsByTagNameNS("http://www.w3.org/1998/Math/MathML","math")[0]&&(document.body.insertAdjacentHTML("afterbegin","<div style='border: 0; clip: rect(0 0 0 0); height: 1px; margin: -1px; overflow: hidden; padding: 0; position: absolute; width: 1px;'><math xmlns='http://www.w3.org/1998/Math/MathML'><mspace height='23px' width='77px'></mspace></math></div>"),c=document.body.firstChild,a=c.firstChild.firstChild.getBoundingClientRect(),document.body.removeChild(c),
1<Math.abs(a.height-23)||1<Math.abs(a.width-77))&&(a=document.createElement("link"),a.href="//iblogbox.github.io/js/odfviewer/mathml.css",a.rel="stylesheet",document.head.appendChild(a))}function e(c){c>k.length-1?p&&d():(r=k.item(c),(m=r.getAttributeNS(H,"href"))?a.getPartData2(m+"/content.xml",function(d,h){h&&0<=h.indexOf("</math>")?(p=!0,h=h.replace(/<\?xml(.*?)\?>/gi,""),s=document.createElement("span"),s.setAttribute("style","white-space:nowrap;"),s.innerHTML=h,r.parentNode.insertBefore(s,r)):
(g=r.parentNode.getElementsByTagNameNS(w,"image"))&&g[0]&&(m=g[0].getAttributeNS(H,"href")||"",0!=m.indexOf("ObjectReplacements/")&&0!=m.indexOf("./ObjectReplacements/")||f("image2"+String(c),a,g[0],b));e(c+1)}):e(c+1))}var h,k,g,r,m;k=c.getElementsByTagNameNS(w,"image");for(h=0;h<k.length;h+=1)r=k.item(h),m=r.getAttributeNS(H,"href")||"",0!=m.indexOf("ObjectReplacements/")&&0!=m.indexOf("./ObjectReplacements/")&&f("image"+String(h),a,r,b);var l,n,s,p=!1;k=c.getElementsByTagNameNS(w,"object");e(0);
!gdocumentType&&godfcontainer&&(gdocumentType=godfcontainer.getDocumentType());if("presentation"==gdocumentType&&document.getElementsByTagName("document")[0]&&2E3>document.getElementsByTagName("document")[0].clientWidth){var y=function(a){s=document.createElement("canvas");s.setAttribute("style","border:0px solid red; left:0px; top:0px; position: absolute; background: transparent;");s.width=z;s.height=z+Math.floor(.4*z);a.parentNode.insertBefore(s,a.nextSibling);u=s.getContext("2d");console.log("Canvas Created.")},
u,v,D,x,C,z=document.getElementsByTagName("document")[0].clientWidth;k=c.getElementsByTagNameNS(w,"g");for(h=0;h<k.length;h+=1)for(u="",r=k.item(h),l=findChildNode(r,w,"line"),n=0;n<l.length;n+=1)0!=n||u||y(r),v=l[n].getAttributeNS(E,"x1"),D=l[n].getAttributeNS(E,"y1"),x=l[n].getAttributeNS(E,"x2"),C=l[n].getAttributeNS(E,"y2"),v=parseInt(gstyleParseUtils.parseLength(v)),D=parseInt(gstyleParseUtils.parseLength(D)),x=parseInt(gstyleParseUtils.parseLength(x)),C=parseInt(gstyleParseUtils.parseLength(C)),
u.beginPath(),u.moveTo(v,D),u.lineTo(x,C),u.stroke()}if("presentation"==gdocumentType){ghyperlinkTooltipView||(ghyperlinkTooltipView=new gui.HyperlinkTooltipView(da));k=c.getElementsByTagNameNS(I,"a");for(h=0;h<k.length;h+=1)r=k.item(h),l=r.getAttributeNS(H,"href")||"",0==l.toLowerCase().indexOf("http")&&(r.addEventListener("click",function(){window.open(this.getAttributeNS(H,"href"))}),r.addEventListener("mousemove",function(a){ghyperlinkTooltipView&&ghyperlinkTooltipView.showTooltip(a)}),r.addEventListener("mouseout",
function(){ghyperlinkTooltipView&&ghyperlinkTooltipView.hideTooltip()}));k=c.getElementsByTagNameNS(F,"date-time-decl");for(h=0;h<k.length;h+=1)r=k.item(h),r.parentNode.removeChild(r)}}function C(a,c){function b(a,c){ma.addToQueue(function(){k(a,c)})}var f,d,e;d=c.getElementsByTagNameNS(w,"plugin");for(f=0;f<d.length;f+=1)e=d.item(f),b(a,e)}function B(){var a;a=Z.firstChild;var c=fa.getZoomLevel();a&&(Z.style.WebkitTransformOrigin="0% 0%",Z.style.MozTransformOrigin="0% 0%",Z.style.msTransformOrigin=
"0% 0%",Z.style.OTransformOrigin="0% 0%",Z.style.transformOrigin="0% 0%",R&&((a=R.getMinimumHeightForAnnotationPane())?Z.style.minHeight=a:Z.style.removeProperty("min-height")),m.style.width=Math.round(c*Z.offsetWidth)+"px",m.style.height=Math.round(c*Z.offsetHeight)+"px",m.style.display="inline-block")}function P(b,d){var e=X.sheet;a(m);Z=W.createElementNS(m.namespaceURI,"div");Z.style.display="inline-block";Z.style.background="white";Z.style.setProperty("float","left","important");Z.appendChild(d);
m.appendChild(Z);K=W.createElementNS(m.namespaceURI,"div");K.id="annotationsPane";$=W.createElementNS(m.namespaceURI,"div");$.id="shadowContent";$.style.position="absolute";$.style.top=0;$.style.left=0;b.getContentElement().appendChild($);var k=d.body,g,l=[],q;for(g=k.firstElementChild;g&&g!==k;)if(g.namespaceURI===w&&(l[l.length]=g),g.firstElementChild)g=g.firstElementChild;else{for(;g&&g!==k&&!g.nextElementSibling;)g=g.parentNode;g&&g.nextElementSibling&&(g=g.nextElementSibling)}for(q=0;q<l.length;q+=
1)g=l[q],p("frame"+String(q),g,e);l=G.getODFElementsWithXPath(k,".//*[*[@text:anchor-type='paragraph']]",odf.Namespaces.lookupNamespaceURI);for(g=0;g<l.length;g+=1)k=l[g],k.setAttributeNS&&k.setAttributeNS("urn:webodf:names:helper","containsparagraphanchor",!0);k=Y;g=$;var u,v,D,z,B=0,E;q=b.rootElement.ownerDocument;if((l=d.body.firstElementChild)&&l.namespaceURI===A&&("presentation"===l.localName||"drawing"===l.localName))for(l=l.firstElementChild;l;){if(u=(u=l.getAttributeNS(w,"master-page-name"))?
k.getMasterPageElement(u):null){v=l.getAttributeNS("urn:webodf:names:helper","styleid");D=q.createElementNS(w,"draw:page");E=u.firstElementChild;for(B=0;E;)"true"!==E.getAttributeNS(F,"placeholder")&&(z=E.cloneNode(!0),D.appendChild(z)),E=E.nextElementSibling,B+=1;E=z=B=void 0;for(var H=s.getElementsByTagNameNS(D,w,"frame"),B=0;B<H.length;B+=1)z=H[B],(E=z.getAttributeNS(F,"class"))&&!/^(date-time|footer|header|page-number)$/.test(E)&&z.parentNode.removeChild(z);z=s.getElementsByTagNameNS(D,w,"*");
for(B=0;B<z.length;B+=1)p(v+"_"+B,z[B],e);g.appendChild(D);B=String(g.getElementsByTagNameNS(w,"page").length);h(D,I,"page-number",B);h(D,F,"header",n(b,l,"header"));h(D,F,"footer",n(b,l,"footer"));p(v,D,e);D.setAttributeNS("urn:webodf:names:helper","page-style-name",l.getAttributeNS(w,"style-name"));D.setAttributeNS(w,"draw:master-page-name",u.getAttributeNS(x,"name"))}l=l.nextElementSibling}k=d.body;q=s.getElementsByTagNameNS(k,N,"table-cell");for(g=0;g<q.length;g+=1)if(u=q[g],u.hasAttributeNS(N,
"number-columns-repeated")&&(v=u.getAttributeNS(N,"number-columns-repeated"),!(100<v)))for(l=1;l<v;l++)u.parentNode.insertBefore(u.cloneNode(!0),u.nextSibling);q=s.getElementsByTagNameNS(k,N,"covered-table-cell");for(g=0;g<q.length;g+=1)if(u=q[g],v=u.hasAttributeNS(N,"number-columns-repeated")?u.getAttributeNS(N,"number-columns-repeated"):1,!(100<v)){for(l=0;l<v;l++)D=document.createElementNS(N,"table:table-cell"),u.parentNode.insertBefore(D,u);u.parentNode.removeChild(u)}q=s.getElementsByTagNameNS(k,
w,"control");for(g=0;g<q.length;g+=1)u=q[g],u.parentNode.removeChild(u);c(d.body);f(d.body);r(d.body);t(b,d.body,e);C(b,d.body);Z.insertBefore($,Z.firstChild);fa.setZoomableElement(Z)}function O(a){aa?(K.parentNode||Z.appendChild(K),R&&R.forgetAnnotations(),R=new gui.AnnotationViewManager(da,a.body,K,U),s.getElementsByTagNameNS(a.body,A,"annotation").forEach(R.addAnnotation),R.rerenderAnnotations(),B()):K.parentNode&&(Z.removeChild(K),R.forgetAnnotations(),B())}function ba(c){function f(){d(Q);d(ia);
d(X);a(m);m.style.display="inline-block";var e=J.rootElement;m.ownerDocument.importNode(e,!0);Y.setOdfContainer(J);l(J,Q);b(J,Y,ia);P(J,e);O(e);c||ma.addToQueue(function(){var a=[J];if(ea.hasOwnProperty("statereadychange")){var c=ea.statereadychange,b;for(b=0;b<c.length;b+=1)c[b].apply(null,a)}})}J.state===odf.OdfContainer.DONE?f():(runtime.log("WARNING: refreshOdf called but ODF was not DONE."),pa=runtime.setTimeout(function V(){J.state===odf.OdfContainer.DONE?f():(g_errmsg(),pa=runtime.setTimeout(V,
1E3))},300))}function ca(a){ma.clearQueue();m.innerHTML=runtime.tr("Loading")+"...";m.removeAttribute("style");godfcontainer=J=new odf.OdfContainer(a,function(a){J=a;ba(!1)})}runtime.assert(null!==m&&void 0!==m,"odf.OdfCanvas constructor needs DOM element");runtime.assert(null!==m.ownerDocument&&void 0!==m.ownerDocument,"odf.OdfCanvas constructor needs DOM");var da=this,W=m.ownerDocument,J,Y=new odf.Formatting,ga,Z=null,K=null,aa=!1,U=!1,R=null,S,Q,ia,X,$,ea={},pa,ka,ha=!1,la=!1,ma=new e,fa=new gui.ZoomHelper,
ja=D||new gui.SingleScrollViewport(m.parentNode);this.refreshCSS=function(){ha=!0;ka.trigger()};this.refreshSize=function(){ka.trigger()};this.odfContainer=function(){return J};this.setOdfContainer=function(a,c){J=a;ba(!0===c)};this.load=this.load=ca;this.save=function(a){J.save(a)};this.addListener=function(a,c){switch(a){case "click":var b=a;m.addEventListener?m.addEventListener(b,c,!1):m.attachEvent?m.attachEvent("on"+b,c):m["on"+b]=c;break;default:b=ea.hasOwnProperty(a)?ea[a]:ea[a]=[],c&&-1===
b.indexOf(c)&&b.push(c)}};this.getFormatting=function(){return Y};this.getAnnotationViewManager=function(){return R};this.refreshAnnotations=function(){O(J.rootElement)};this.rerenderAnnotations=function(){R&&(la=!0,ka.trigger())};this.getSizer=function(){return Z};this.enableAnnotations=function(a,c){a!==aa&&(aa=a,U=c,J&&O(J.rootElement))};this.addAnnotation=function(a){R&&(R.addAnnotation(a),B())};this.forgetAnnotations=function(){R&&(R.forgetAnnotations(),B())};this.getZoomHelper=function(){return fa};
this.setZoomLevel=function(a){fa.setZoomLevel(a)};this.getZoomLevel=function(){return fa.getZoomLevel()};this.fitToContainingElement=function(a,c){var b=fa.getZoomLevel(),f=m.offsetHeight/b,b=a/(m.offsetWidth/b);c/f<b&&(b=c/f);fa.setZoomLevel(b)};this.fitToWidth=function(a){var c=m.offsetWidth/fa.getZoomLevel();fa.setZoomLevel(a/c)};this.fitSmart=function(a,c){var b,f;f=fa.getZoomLevel();b=m.offsetWidth/f;f=m.offsetHeight/f;b=a/b;void 0!==c&&c/f<b&&(b=c/f);fa.setZoomLevel(Math.min(1,b))};this.fitToHeight=
function(a){var c=m.offsetHeight/fa.getZoomLevel();fa.setZoomLevel(a/c)};this.showFirstPage=function(){ga.showFirstPage()};this.showNextPage=function(){ga.showNextPage()};this.showPreviousPage=function(){ga.showPreviousPage()};this.showPage=function(a){ga.showPage(a);godfcontainer&&"spreadsheet"==godfcontainer.getDocumentType()||B()};this.getElement=function(){return m};this.getViewport=function(){return ja};this.addCssForFrameWithImage=function(a){var c=a.getAttributeNS(w,"name"),b=a.firstElementChild;
p(c,a,X.sheet);b&&q(c+"img",J,b,X.sheet)};this.destroy=function(a){var c=W.getElementsByTagName("head")[0],b=[ga.destroy,ka.destroy];runtime.clearTimeout(pa);K&&K.parentNode&&K.parentNode.removeChild(K);fa.destroy(function(){Z&&(m.removeChild(Z),Z=null)});v(S);c.removeChild(Q);c.removeChild(ia);c.removeChild(X);core.Async.destroyAll(b,a)};S=u(W);ga=new g(z(W));Q=z(W);ia=z(W);X=z(W);ka=core.Task.createRedrawTask(function(){ha&&(b(J,Y,ia),ha=!1);la&&(R&&R.rerenderAnnotations(),la=!1);B()});fa.subscribe(gui.ZoomHelper.signalZoomChanged,
B)}})();odf.StepUtils=function(){this.getContentBounds=function(e){var g=e.container(),a,d;runtime.assert(e.isStep(),"Step iterator must be on a step");g.nodeType===Node.TEXT_NODE&&0<e.offset()?a=e.offset():(g=e.leftNode())&&g.nodeType===Node.TEXT_NODE&&(a=g.length);g&&(g.nodeType===Node.TEXT_NODE?(runtime.assert(0<a,"Empty text node found"),d={container:g,startOffset:a-1,endOffset:a}):d={container:g,startOffset:0,endOffset:g.childNodes.length});return d}};
ops.MemberProperties=function(){this.fullName;this.color;this.imageUrl};
ops.Member=function(e,g){var a=new ops.MemberProperties;this.getMemberId=function(){return e};this.getProperties=function(){return a};this.setProperties=function(d){Object.keys(d).forEach(function(b){a[b]=d[b]})};this.removeProperties=function(d){Object.keys(d).forEach(function(b){"fullName"!==b&&"color"!==b&&"imageUrl"!==b&&a.hasOwnProperty(b)&&delete a[b]})};runtime.assert(Boolean(e),"No memberId was supplied!");g.fullName||(g.fullName=runtime.tr("Unknown Author"));g.color||(g.color="black");g.imageUrl||
(g.imageUrl="avatar-joe.png");a=g};ops.Document=function(){};ops.Document.prototype.getMemberIds=function(){};ops.Document.prototype.removeCursor=function(e){};ops.Document.prototype.getDocumentElement=function(){};ops.Document.prototype.getRootNode=function(){};ops.Document.prototype.getDOMDocument=function(){};ops.Document.prototype.cloneDocumentElement=function(){};ops.Document.prototype.setDocumentElement=function(e){};ops.Document.prototype.subscribe=function(e,g){};
ops.Document.prototype.unsubscribe=function(e,g){};ops.Document.prototype.getCanvas=function(){};ops.Document.prototype.createRootFilter=function(e){};ops.Document.prototype.createPositionIterator=function(e){};ops.Document.signalCursorAdded="cursor/added";ops.Document.signalCursorRemoved="cursor/removed";ops.Document.signalCursorMoved="cursor/moved";ops.Document.signalMemberAdded="member/added";ops.Document.signalMemberUpdated="member/updated";ops.Document.signalMemberRemoved="member/removed";
ops.OdtCursor=function(e,g){var a=this,d={},b,l,n=new core.EventNotifier([ops.OdtCursor.signalCursorUpdated]);this.removeFromDocument=function(){l.remove()};this.subscribe=function(a,b){n.subscribe(a,b)};this.unsubscribe=function(a,b){n.unsubscribe(a,b)};this.getMemberId=function(){return e};this.getNode=function(){return l.getNode()};this.getAnchorNode=function(){return l.getAnchorNode()};this.getSelectedRange=function(){return l.getSelectedRange()};this.setSelectedRange=function(b,d){l.setSelectedRange(b,
d);n.emit(ops.OdtCursor.signalCursorUpdated,a)};this.hasForwardSelection=function(){return l.hasForwardSelection()};this.getDocument=function(){return g};this.getSelectionType=function(){return b};this.setSelectionType=function(a){d.hasOwnProperty(a)?b=a:runtime.log("Invalid selection type: "+a)};this.resetSelectionType=function(){a.setSelectionType(ops.OdtCursor.RangeSelection)};l=new core.Cursor(g.getDOMDocument(),e);d[ops.OdtCursor.RangeSelection]=!0;d[ops.OdtCursor.RegionSelection]=!0;a.resetSelectionType()};
ops.OdtCursor.RangeSelection="Range";ops.OdtCursor.RegionSelection="Region";ops.OdtCursor.signalCursorUpdated="cursorUpdated";
(function(){var e=0;ops.StepsCache=function(g,a,d){function b(a,c){var b=this;this.nodeId=a;this.steps=-1;this.node=c;this.previousBookmark=this.nextBookmark=null;this.setIteratorPosition=function(a){a.setPositionBeforeElement(c);d(b.steps,a)}}function l(a,c,b){var f=this;this.nodeId=a;this.steps=c;this.node=b;this.previousBookmark=this.nextBookmark=null;this.setIteratorPosition=function(a){a.setUnfilteredPosition(b,0);d(f.steps,a)}}function n(a,c){var b="["+a.nodeId;c&&(b+=" => "+c.nodeId);return b+
"]"}function h(){for(var a=v,c,b,f,d=new core.LoopWatchDog(0,1E5),e={};a;){d.check();(c=a.previousBookmark)?runtime.assert(c.nextBookmark===a,"Broken bookmark link to previous @"+n(c,a)):(runtime.assert(a===v,"Broken bookmark link @"+n(a)),runtime.assert(void 0===z||v===v||v.steps<=z,"Base point is damaged @"+n(a)));(b=a.nextBookmark)&&runtime.assert(b.previousBookmark===a,"Broken bookmark link to next @"+n(a,b));if(void 0===z||a===v||a.steps<=z)runtime.assert(u.containsNode(g,a.node),"Disconnected node is being reported as undamaged @"+
n(a)),c&&(f=a.node.compareDocumentPosition(c.node),runtime.assert(0===f||0!==(f&t),"Bookmark order with previous does not reflect DOM order @"+n(c,a))),b&&u.containsNode(g,b.node)&&(f=a.node.compareDocumentPosition(b.node),runtime.assert(0===f||0!==(f&w),"Bookmark order with next does not reflect DOM order @"+n(a,b)));a=a.nextBookmark}Object.keys(r).forEach(function(a){var c=r[a];(void 0===z||a<=z)&&runtime.assert(c.steps<=a,"Bookmark step of "+c.steps+" exceeds cached step lookup for "+a+" @"+n(c));
runtime.assert(!1===e.hasOwnProperty(c.nodeId),"Bookmark "+n(c)+" appears twice in cached step lookup at steps "+e[c.nodeId]+" and "+a);e[c.nodeId]=a})}function p(a){var c="";a.nodeType===Node.ELEMENT_NODE&&(c=a.getAttributeNS("urn:webodf:names:steps","nodeId")||"");return c}function m(a){var c=e.toString();a.setAttributeNS("urn:webodf:names:steps","nodeId",c);e+=1;return c}function q(c){var b,f,d=new core.LoopWatchDog(0,1E4);void 0!==z&&c>z&&(c=z);for(b=Math.floor(c/a)*a;!f&&0<=b;)f=r[b],b-=a;for(f=
f||v;f.nextBookmark&&f.nextBookmark.steps<=c;)d.check(),f=f.nextBookmark;runtime.assert(-1===c||f.steps<=c,"Bookmark @"+n(f)+" at step "+f.steps+" exceeds requested step of "+c);return f}function c(a){a.previousBookmark&&(a.previousBookmark.nextBookmark=a.nextBookmark);a.nextBookmark&&(a.nextBookmark.previousBookmark=a.previousBookmark)}function f(a){for(var c,b=null;!b&&a&&a!==g;)(c=p(a))&&(b=k[c])&&b.node!==a&&(runtime.log("Cloned node detected. Creating new bookmark"),b=null,a.removeAttributeNS("urn:webodf:names:steps",
"nodeId")),a=a.parentNode;return b}var r={},k={},u=core.DomUtils,v,z,w=Node.DOCUMENT_POSITION_FOLLOWING,t=Node.DOCUMENT_POSITION_PRECEDING,A;this.updateBookmark=function(f,d){var e,h=Math.ceil(f/a)*a,l,n,t;if(void 0!==z&&z<f){l=q(z);for(n=l.nextBookmark;n&&n.steps<=f;)e=n.nextBookmark,t=Math.ceil(n.steps/a)*a,r[t]===n&&delete r[t],u.containsNode(g,n.node)?n.steps=f+1:(c(n),delete k[n.nodeId]),n=e;z=f}else l=q(f);n=p(d)||m(d);e=k[n];e?e.node!==d&&(runtime.log("Cloned node detected. Creating new bookmark"),
n=m(d),e=k[n]=new b(n,d)):e=k[n]=new b(n,d);n=e;n.steps!==f&&(e=Math.ceil(n.steps/a)*a,e!==h&&r[e]===n&&delete r[e],n.steps=f);if(l!==n&&l.nextBookmark!==n){if(l.steps===n.steps)for(;0!==(n.node.compareDocumentPosition(l.node)&w)&&l!==v;)l=l.previousBookmark;l!==n&&l.nextBookmark!==n&&(c(n),e=l.nextBookmark,n.nextBookmark=l.nextBookmark,n.previousBookmark=l,l.nextBookmark=n,e&&(e.previousBookmark=n))}l=r[h];if(!l||n.steps>l.steps)r[h]=n;A()};this.setToClosestStep=function(a,c){var b;A();b=q(a);b.setIteratorPosition(c);
return b.steps};this.setToClosestDomPoint=function(a,c,b){var d,e;A();if(a===g&&0===c)d=v;else if(a===g&&c===g.childNodes.length)for(e in d=v,r)r.hasOwnProperty(e)&&(a=r[e],a.steps>d.steps&&(d=a));else if(d=f(a.childNodes.item(c)||a),!d)for(b.setUnfilteredPosition(a,c);!d&&b.previousNode();)d=f(b.getCurrentNode());d=d||v;void 0!==z&&d.steps>z&&(d=q(z));d.setIteratorPosition(b);return d.steps};this.damageCacheAfterStep=function(a){0>a&&(a=-1);void 0===z?z=a:a<z&&(z=a);A()};(function(){var a=p(g)||
m(g);v=new l(a,0,g);A=ops.StepsCache.ENABLE_CACHE_VERIFICATION?h:function(){}})()};ops.StepsCache.ENABLE_CACHE_VERIFICATION=!1;ops.StepsCache.Bookmark=function(){};ops.StepsCache.Bookmark.prototype.nodeId;ops.StepsCache.Bookmark.prototype.node;ops.StepsCache.Bookmark.prototype.steps;ops.StepsCache.Bookmark.prototype.previousBookmark;ops.StepsCache.Bookmark.prototype.nextBookmark;ops.StepsCache.Bookmark.prototype.setIteratorPosition=function(e){}})();
(function(){ops.OdtStepsTranslator=function(e,g,a,d){function b(a,c,b){var f=c.getCurrentNode();c.isBeforeNode()&&q.isParagraph(f)&&(b||(a+=1),m.updateBookmark(a,f))}function l(c,f){do{if(a.acceptPosition(f)===r){b(c,f,!0);break}b(c-1,f,!1)}while(f.nextPosition())}function n(){var a=e();a!==p&&(p&&runtime.log("Undo detected. Resetting steps cache"),p=a,m=new ops.StepsCache(p,d,l),f=g(p))}function h(c,b){if(!b||a.acceptPosition(c)===r)return!0;for(;c.previousPosition();)if(a.acceptPosition(c)===r){if(b(k,
c.container(),c.unfilteredDomOffset()))return!0;break}for(;c.nextPosition();)if(a.acceptPosition(c)===r){if(b(u,c.container(),c.unfilteredDomOffset()))return!0;break}return!1}var p,m,q=odf.OdfUtils,c=core.DomUtils,f,r=core.PositionFilter.FilterResult.FILTER_ACCEPT,k=core.StepDirection.PREVIOUS,u=core.StepDirection.NEXT;this.convertStepsToDomPoint=function(c){var d,e;if(isNaN(c))throw new TypeError("Requested steps is not numeric ("+c+")");if(0>c)throw new RangeError("Requested steps is negative ("+
c+")");n();for(d=m.setToClosestStep(c,f);d<c&&f.nextPosition();)(e=a.acceptPosition(f)===r)&&(d+=1),b(d,f,e);if(d!==c)throw new RangeError("Requested steps ("+c+") exceeds available steps ("+d+")");return{node:f.container(),offset:f.unfilteredDomOffset()}};this.convertDomPointToSteps=function(d,e,k){var g;n();c.containsNode(p,d)||(e=0>c.comparePoints(p,0,d,e),d=p,e=e?0:p.childNodes.length);f.setUnfilteredPosition(d,e);h(f,k)||f.setUnfilteredPosition(d,e);k=f.container();e=f.unfilteredDomOffset();
d=m.setToClosestDomPoint(k,e,f);if(0>c.comparePoints(f.container(),f.unfilteredDomOffset(),k,e))return 0<d?d-1:d;for(;(f.container()!==k||f.unfilteredDomOffset()!==e)&&f.nextPosition();)(g=a.acceptPosition(f)===r)&&(d+=1),b(d,f,g);return d+0};this.prime=function(){var c,d;n();for(c=m.setToClosestStep(0,f);f.nextPosition();)(d=a.acceptPosition(f)===r)&&(c+=1),b(c,f,d)};this.handleStepsInserted=function(a){n();m.damageCacheAfterStep(a.position)};this.handleStepsRemoved=function(a){n();m.damageCacheAfterStep(a.position-
1)};n()}})();ops.Operation=function(){};ops.Operation.prototype.init=function(e){};ops.Operation.prototype.isEdit;ops.Operation.prototype.group;ops.Operation.prototype.execute=function(e){};ops.Operation.prototype.spec=function(){};
ops.TextPositionFilter=function(){function e(a,d,e){var m,q;if(d){if(g.isInlineRoot(d)&&g.isGroupingElement(e))return l;m=g.lookLeftForCharacter(d);if(1===m||2===m&&(g.scanRightForAnyCharacter(e)||g.scanRightForAnyCharacter(g.nextNode(a))))return b}else if(g.isInlineRoot(a.previousSibling)&&g.isGroupingElement(a))return b;m=null===d&&g.isParagraph(a);q=g.lookRightForCharacter(e);if(m)return q?b:g.scanRightForAnyCharacter(e)?l:b;if(!q)return l;d=d||g.previousNode(a);return g.scanLeftForAnyCharacter(d)?
l:b}var g=odf.OdfUtils,a=Node.ELEMENT_NODE,d=Node.TEXT_NODE,b=core.PositionFilter.FilterResult.FILTER_ACCEPT,l=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(n){var h=n.container(),p=h.nodeType,m,q,c;if(p!==a&&p!==d)return l;if(p===d){p=n.unfilteredDomOffset();m=h.data;runtime.assert(p!==m.length,"Unexpected offset.");if(0<p){n=m[p-1];if(!g.isODFWhitespace(n))return b;if(1<p)if(n=m[p-2],!g.isODFWhitespace(n))q=b;else{if(!g.isODFWhitespace(m.substr(0,p)))return l}else c=
g.previousNode(h),g.scanLeftForNonSpace(c)&&(q=b);if(q===b)return g.isTrailingWhitespace(h,p)?l:b;q=m[p];return g.isODFWhitespace(q)?l:g.scanLeftForAnyCharacter(g.previousNode(h))?l:b}c=n.leftNode();q=h;h=h.parentNode;q=e(h,c,q)}else g.isGroupingElement(h)?(c=n.leftNode(),q=n.rightNode(),q=e(h,c,q)):q=l;return q}};
ops.OdtDocument=function(e){function g(a){return new core.PositionIterator(a,I,G,!1)}function a(){var a=e.odfContainer().getContentElement(),c=a&&a.localName;runtime.assert("text"===c,"Unsupported content element type '"+c+"' for OdtDocument");return a}function d(){return c.getDocumentElement().ownerDocument}function b(a){for(;a&&!(a.namespaceURI===odf.Namespaces.officens&&"text"===a.localName||a.namespaceURI===odf.Namespaces.officens&&"annotation"===a.localName);)a=a.parentNode;return a}function l(a){this.acceptPosition=
function(c){c=c.container();var f;f="string"===typeof a?u[a].getNode():a;return b(c)===b(f)?w:t}}function n(a,c,b,f){f=g(f);var d;1===b.length?d=b[0]:(d=new core.PositionFilterChain,b.forEach(d.addFilter));b=new core.StepIterator(d,f);b.setPosition(a,c);return b}function h(c){var b=g(a());c=E.convertStepsToDomPoint(c);b.setUnfilteredPosition(c.node,c.offset);return b}function p(a){return a===A}function m(a){var c,b=[],d,e=2;runtime.assert(a.isStep(),"positionIterator is not at a step");do{if(c=f.getContentBounds(a))if(c=
c.container,r.isDowngradableSpaceElement(c)){for(d=c.lastChild;c.firstChild;)b.push(c.firstChild),c.parentNode.insertBefore(c.firstChild,c);c.parentNode.removeChild(c);a.setPosition(d,d.nodeType===Node.TEXT_NODE?d.length:d.childNodes.length);a.roundToPreviousStep()}e-=1}while(0<e&&a.nextStep());b.forEach(k.normalizeTextNodes)}function q(a,c,b){a=a.childNodes.item(c)||a;return(a=r.getParagraphElement(a))&&k.containsNode(b,a)?a:b}var c=this,f,r=odf.OdfUtils,k=core.DomUtils,u={},v={},z=new core.EventNotifier([ops.Document.signalMemberAdded,
ops.Document.signalMemberUpdated,ops.Document.signalMemberRemoved,ops.Document.signalCursorAdded,ops.Document.signalCursorRemoved,ops.Document.signalCursorMoved,ops.OdtDocument.signalParagraphChanged,ops.OdtDocument.signalParagraphStyleModified,ops.OdtDocument.signalCommonStyleCreated,ops.OdtDocument.signalCommonStyleDeleted,ops.OdtDocument.signalTableAdded,ops.OdtDocument.signalOperationStart,ops.OdtDocument.signalOperationEnd,ops.OdtDocument.signalProcessingBatchStart,ops.OdtDocument.signalProcessingBatchEnd,
ops.OdtDocument.signalUndoStackChanged,ops.OdtDocument.signalStepsInserted,ops.OdtDocument.signalStepsRemoved,ops.OdtDocument.signalMetadataUpdated,ops.OdtDocument.signalAnnotationAdded]),w=core.PositionFilter.FilterResult.FILTER_ACCEPT,t=core.PositionFilter.FilterResult.FILTER_REJECT,A=core.StepDirection.NEXT,x,E,N,I=NodeFilter.SHOW_ALL,H=new gui.BlacklistNamespaceNodeFilter(["urn:webodf:names:cursor","urn:webodf:names:editinfo"]),F=new gui.OdfTextBodyNodeFilter,G=new core.NodeFilterChain([H,F]);
this.createPositionIterator=g;this.getDocumentElement=function(){return e.odfContainer().rootElement};this.getDOMDocument=function(){return this.getDocumentElement().ownerDocument};this.cloneDocumentElement=function(){var a=c.getDocumentElement(),b=e.getAnnotationViewManager();b&&b.forgetAnnotations();a=a.cloneNode(!0);e.refreshAnnotations();return a};this.setDocumentElement=function(a){var c=e.odfContainer();c.setRootElement(a);e.setOdfContainer(c,!0);e.refreshCSS()};this.getDOMDocument=d;this.getRootElement=
b;this.createStepIterator=n;this.getIteratorAtPosition=h;this.convertCursorStepToDomPoint=function(a){return E.convertStepsToDomPoint(a)};this.convertDomPointToCursorStep=function(a,c,b){var f;b===A&&(f=p);return E.convertDomPointToSteps(a,c,f)};this.convertDomToCursorRange=function(a){var c;c=E.convertDomPointToSteps(a.anchorNode,a.anchorOffset);a=a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset?c:E.convertDomPointToSteps(a.focusNode,a.focusOffset);return{position:c,length:a-c}};this.convertCursorToDomRange=
function(a,c){var b=d().createRange(),f,e;f=E.convertStepsToDomPoint(a);c?(e=E.convertStepsToDomPoint(a+c),0<c?(b.setStart(f.node,f.offset),b.setEnd(e.node,e.offset)):(b.setStart(e.node,e.offset),b.setEnd(f.node,f.offset))):b.setStart(f.node,f.offset);return b};this.upgradeWhitespacesAtPosition=function(a){var c=h(a),c=new core.StepIterator(x,c),b,d=2;runtime.assert(c.isStep(),"positionIterator is not at a step (requested step: "+a+")");do{if(b=f.getContentBounds(c))if(a=b.container,b=b.startOffset,
a.nodeType===Node.TEXT_NODE&&r.isSignificantWhitespace(a,b)){runtime.assert(" "===a.data[b],"upgradeWhitespaceToElement: textNode.data[offset] should be a literal space");var e=a.ownerDocument.createElementNS(odf.Namespaces.textns,"text:s"),k=a.parentNode,g=a;e.appendChild(a.ownerDocument.createTextNode(" "));1===a.length?k.replaceChild(e,a):(a.deleteData(b,1),0<b&&(b<a.length&&a.splitText(b),g=a.nextSibling),k.insertBefore(e,g));a=e;c.setPosition(a,a.childNodes.length);c.roundToPreviousStep()}d-=
1}while(0<d&&c.nextStep())};this.downgradeWhitespaces=m;this.downgradeWhitespacesAtPosition=function(a){a=h(a);a=new core.StepIterator(x,a);m(a)};this.getTextNodeAtStep=function(a,b){var f=h(a),e=f.container(),k,g=0,l=null;e.nodeType===Node.TEXT_NODE?(k=e,g=f.unfilteredDomOffset(),0<k.length&&(0<g&&(k=k.splitText(g)),k.parentNode.insertBefore(d().createTextNode(""),k),k=k.previousSibling,g=0)):(k=d().createTextNode(""),g=0,e.insertBefore(k,f.rightNode()));if(b){if(u[b]&&c.getCursorPosition(b)===a){for(l=
u[b].getNode();l.nextSibling&&"cursor"===l.nextSibling.localName;)l.parentNode.insertBefore(l.nextSibling,l);0<k.length&&k.nextSibling!==l&&(k=d().createTextNode(""),g=0);l.parentNode.insertBefore(k,l)}}else for(;k.nextSibling&&"cursor"===k.nextSibling.localName;)k.parentNode.insertBefore(k.nextSibling,k);for(;k.previousSibling&&k.previousSibling.nodeType===Node.TEXT_NODE;)f=k.previousSibling,f.appendData(k.data),g=f.length,k=f,k.parentNode.removeChild(k.nextSibling);for(;k.nextSibling&&k.nextSibling.nodeType===
Node.TEXT_NODE;)f=k.nextSibling,k.appendData(f.data),k.parentNode.removeChild(f);return{textNode:k,offset:g}};this.fixCursorPositions=function(){Object.keys(u).forEach(function(a){var f=u[a],d=b(f.getNode()),e=c.createRootFilter(d),k,h,g,l=!1;g=f.getSelectedRange();k=q(g.startContainer,g.startOffset,d);h=n(g.startContainer,g.startOffset,[x,e],k);g.collapsed?d=h:(k=q(g.endContainer,g.endOffset,d),d=n(g.endContainer,g.endOffset,[x,e],k));h.isStep()&&d.isStep()?h.container()!==d.container()||h.offset()!==
d.offset()||g.collapsed&&f.getAnchorNode()===f.getNode()||(l=!0,g.setStart(h.container(),h.offset()),g.collapse(!0)):(l=!0,runtime.assert(h.roundToClosestStep(),"No walkable step found for cursor owned by "+a),g.setStart(h.container(),h.offset()),runtime.assert(d.roundToClosestStep(),"No walkable step found for cursor owned by "+a),g.setEnd(d.container(),d.offset()));l&&(f.setSelectedRange(g,f.hasForwardSelection()),c.emit(ops.Document.signalCursorMoved,f))})};this.getCursorPosition=function(a){return(a=
u[a])?E.convertDomPointToSteps(a.getNode(),0):0};this.getCursorSelection=function(a){a=u[a];var c=0,b=0;a&&(c=E.convertDomPointToSteps(a.getNode(),0),b=E.convertDomPointToSteps(a.getAnchorNode(),0));return{position:b,length:c-b}};this.getPositionFilter=function(){return x};this.getOdfCanvas=function(){return e};this.getCanvas=function(){return e};this.getRootNode=a;this.addMember=function(a){runtime.assert(void 0===v[a.getMemberId()],"This member already exists");v[a.getMemberId()]=a};this.getMember=
function(a){return v.hasOwnProperty(a)?v[a]:null};this.removeMember=function(a){delete v[a]};this.getCursor=function(a){return u[a]};this.getMemberIds=function(){var a=[],c;for(c in u)u.hasOwnProperty(c)&&a.push(u[c].getMemberId());return a};this.addCursor=function(a){runtime.assert(Boolean(a),"OdtDocument::addCursor without cursor");var b=a.getMemberId(),f=c.convertCursorToDomRange(0,0);runtime.assert("string"===typeof b,"OdtDocument::addCursor has cursor without memberid");runtime.assert(!u[b],
"OdtDocument::addCursor is adding a duplicate cursor with memberid "+b);a.setSelectedRange(f,!0);u[b]=a};this.removeCursor=function(a){var b=u[a];return b?(b.removeFromDocument(),delete u[a],c.emit(ops.Document.signalCursorRemoved,a),!0):!1};this.moveCursor=function(a,b,f,d){a=u[a];b=c.convertCursorToDomRange(b,f);a&&(a.setSelectedRange(b,0<=f),a.setSelectionType(d||ops.OdtCursor.RangeSelection))};this.getFormatting=function(){return e.getFormatting()};this.emit=function(a,c){z.emit(a,c)};this.subscribe=
function(a,c){z.subscribe(a,c)};this.unsubscribe=function(a,c){z.unsubscribe(a,c)};this.createRootFilter=function(a){return new l(a)};this.close=function(a){a()};this.destroy=function(a){a()};x=new ops.TextPositionFilter;f=new odf.StepUtils;E=new ops.OdtStepsTranslator(a,g,x,500);z.subscribe(ops.OdtDocument.signalStepsInserted,E.handleStepsInserted);z.subscribe(ops.OdtDocument.signalStepsRemoved,E.handleStepsRemoved);z.subscribe(ops.OdtDocument.signalOperationEnd,function(a){var b=a.spec(),f=b.memberid,
d=(new Date(b.timestamp)).toISOString(),k=e.odfContainer(),h={setProperties:{},removedProperties:[]};a.isEdit&&("UpdateMetadata"===b.optype&&(h.setProperties=JSON.parse(JSON.stringify(b.setProperties)),b.removedProperties&&(h.removedProperties=b.removedProperties.attributes.split(","))),b=c.getMember(f).getProperties().fullName,k.setMetadata({"dc:creator":b,"dc:date":d},null),h.setProperties["dc:creator"]=b,h.setProperties["dc:date"]=d,N||(h.setProperties["meta:editing-cycles"]=k.incrementEditingCycles(),
k.setMetadata(null,["meta:editing-duration","meta:document-statistic"])),N=a,c.emit(ops.OdtDocument.signalMetadataUpdated,h))});z.subscribe(ops.OdtDocument.signalProcessingBatchEnd,core.Task.processTasks)};ops.OdtDocument.signalParagraphChanged="paragraph/changed";ops.OdtDocument.signalTableAdded="table/added";ops.OdtDocument.signalCommonStyleCreated="style/created";ops.OdtDocument.signalCommonStyleDeleted="style/deleted";ops.OdtDocument.signalParagraphStyleModified="paragraphstyle/modified";
ops.OdtDocument.signalOperationStart="operation/start";ops.OdtDocument.signalOperationEnd="operation/end";ops.OdtDocument.signalProcessingBatchStart="router/batchstart";ops.OdtDocument.signalProcessingBatchEnd="router/batchend";ops.OdtDocument.signalUndoStackChanged="undo/changed";ops.OdtDocument.signalStepsInserted="steps/inserted";ops.OdtDocument.signalStepsRemoved="steps/removed";ops.OdtDocument.signalMetadataUpdated="metadata/updated";ops.OdtDocument.signalAnnotationAdded="annotation/added";
ops.OpAddAnnotation=function(){function e(a,b,d){var e=a.getTextNodeAtStep(d,g);e&&(a=e.textNode,d=a.parentNode,e.offset!==a.length&&a.splitText(e.offset),d.insertBefore(b,a.nextSibling),0===a.length&&d.removeChild(a))}var g,a,d,b,l,n;this.init=function(e){g=e.memberid;a=parseInt(e.timestamp,10);d=parseInt(e.position,10);b=parseInt(e.length,10)||0;l=e.name};this.isEdit=!0;this.group=void 0;this.execute=function(h){var p=h.getCursor(g),m,q;n=h.getDOMDocument();var c=new Date(a),f,r,k;f=n.createElementNS(odf.Namespaces.officens,
"office:annotation");f.setAttributeNS(odf.Namespaces.officens,"office:name",l);m=n.createElementNS(odf.Namespaces.dcns,"dc:creator");m.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",g);m.textContent=h.getMember(g).getProperties().fullName;q=n.createElementNS(odf.Namespaces.dcns,"dc:date");q.appendChild(n.createTextNode(c.toISOString()));c=n.createElementNS(odf.Namespaces.textns,"text:list");r=n.createElementNS(odf.Namespaces.textns,"text:list-item");k=n.createElementNS(odf.Namespaces.textns,
"text:p");r.appendChild(k);c.appendChild(r);f.appendChild(m);f.appendChild(q);f.appendChild(c);b&&(m=n.createElementNS(odf.Namespaces.officens,"office:annotation-end"),m.setAttributeNS(odf.Namespaces.officens,"office:name",l),f.annotationEndElement=m,e(h,m,d+b));e(h,f,d);h.emit(ops.OdtDocument.signalStepsInserted,{position:d});p&&(m=n.createRange(),q=f.getElementsByTagNameNS(odf.Namespaces.textns,"p")[0],m.selectNodeContents(q),p.setSelectedRange(m,!1),p.setSelectionType(ops.OdtCursor.RangeSelection),
h.emit(ops.Document.signalCursorMoved,p));h.getOdfCanvas().addAnnotation(f);h.fixCursorPositions();h.emit(ops.OdtDocument.signalAnnotationAdded,{memberId:g,annotation:f});return!0};this.spec=function(){return{optype:"AddAnnotation",memberid:g,timestamp:a,position:d,length:b,name:l}}};ops.OpAddAnnotation.Spec;ops.OpAddAnnotation.InitSpec;
ops.OpAddCursor=function(){var e,g;this.init=function(a){e=a.memberid;g=a.timestamp};this.isEdit=!1;this.group=void 0;this.execute=function(a){var d=a.getCursor(e);if(d)return!1;d=new ops.OdtCursor(e,a);a.addCursor(d);a.emit(ops.Document.signalCursorAdded,d);return!0};this.spec=function(){return{optype:"AddCursor",memberid:e,timestamp:g}}};ops.OpAddCursor.Spec;ops.OpAddCursor.InitSpec;
ops.OpAddMember=function(){var e,g,a;this.init=function(d){e=d.memberid;g=parseInt(d.timestamp,10);a=d.setProperties};this.isEdit=!1;this.group=void 0;this.execute=function(d){var b;if(d.getMember(e))return!1;b=new ops.Member(e,a);d.addMember(b);d.emit(ops.Document.signalMemberAdded,b);return!0};this.spec=function(){return{optype:"AddMember",memberid:e,timestamp:g,setProperties:a}}};ops.OpAddMember.Spec;ops.OpAddMember.InitSpec;
ops.OpAddStyle=function(){var e,g,a,d,b,l,n=odf.Namespaces.stylens;this.init=function(h){e=h.memberid;g=h.timestamp;a=h.styleName;d=h.styleFamily;b="true"===h.isAutomaticStyle||!0===h.isAutomaticStyle;l=h.setProperties};this.isEdit=!0;this.group=void 0;this.execute=function(e){var g=e.getOdfCanvas().odfContainer(),m=e.getFormatting(),q=e.getDOMDocument().createElementNS(n,"style:style");if(!q)return!1;l&&m.updateStyle(q,l);q.setAttributeNS(n,"style:family",d);q.setAttributeNS(n,"style:name",a);b?
g.rootElement.automaticStyles.appendChild(q):g.rootElement.styles.appendChild(q);e.getOdfCanvas().refreshCSS();b||e.emit(ops.OdtDocument.signalCommonStyleCreated,{name:a,family:d});return!0};this.spec=function(){return{optype:"AddStyle",memberid:e,timestamp:g,styleName:a,styleFamily:d,isAutomaticStyle:b,setProperties:l}}};ops.OpAddStyle.Spec;ops.OpAddStyle.InitSpec;
odf.ObjectNameGenerator=function(e,g){function a(a,c){var b={};this.generateName=function(){var f=c(),d=0,e;do e=a+d,d+=1;while(b[e]||f[e]);b[e]=!0;return e}}function d(){var a={};[e.rootElement.automaticStyles,e.rootElement.styles].forEach(function(c){for(c=c.firstElementChild;c;)c.namespaceURI===b&&"style"===c.localName&&(a[c.getAttributeNS(b,"name")]=!0),c=c.nextElementSibling});return a}var b=odf.Namespaces.stylens,l=odf.Namespaces.drawns,n=odf.Namespaces.xlinkns,h=(new core.Utils).hashString(g),
p=null,m=null,q=null,c={},f={};this.generateStyleName=function(){null===p&&(p=new a("auto"+h+"_",function(){return d()}));return p.generateName()};this.generateFrameName=function(){var b,f,d;if(null===m){f=e.rootElement.body.getElementsByTagNameNS(l,"frame");for(b=0;b<f.length;b+=1)d=f.item(b),c[d.getAttributeNS(l,"name")]=!0;m=new a("fr"+h+"_",function(){return c})}return m.generateName()};this.generateImageName=function(){var c,b,d;if(null===q){d=e.rootElement.body.getElementsByTagNameNS(l,"image");
for(c=0;c<d.length;c+=1)b=d.item(c),b=b.getAttributeNS(n,"href"),b=b.substring(9,b.lastIndexOf(".")),f[b]=!0;q=new a("img"+h+"_",function(){return f})}return q.generateName()}};
odf.TextStyleApplicator=function(e,g,a){function d(a){function b(a,c){return"object"===typeof a&&"object"===typeof c?Object.keys(a).every(function(d){return b(a[d],c[d])}):a===c}var c={};this.isStyleApplied=function(f){f=g.getAppliedStylesForElement(f,c).styleProperties;return b(a,f)}}function b(b){var d={};this.applyStyleToContainer=function(c){var f;f=c.getAttributeNS(h,"style-name");var l=c.ownerDocument;f=f||"";if(!d.hasOwnProperty(f)){var k=f,n;n=f?g.createDerivedStyleObject(f,"text",b):b;l=
l.createElementNS(p,"style:style");g.updateStyle(l,n);l.setAttributeNS(p,"style:name",e.generateStyleName());l.setAttributeNS(p,"style:family","text");l.setAttributeNS("urn:webodf:names:scope","scope","document-content");a.appendChild(l);d[k]=l}f=d[f].getAttributeNS(p,"name");c.setAttributeNS(h,"text:style-name",f)}}function l(a,b){var c=a.ownerDocument,f=a.parentNode,d,e,g,l=new core.LoopWatchDog(1E4);e=[];e.push(a);for(g=a.nextSibling;g&&n.rangeContainsNode(b,g);)l.check(),e.push(g),g=g.nextSibling;
"span"!==f.localName||f.namespaceURI!==h?(d=c.createElementNS(h,"text:span"),f.insertBefore(d,a),c=!1):(a.previousSibling&&!n.rangeContainsNode(b,f.firstChild)?(d=f.cloneNode(!1),f.parentNode.insertBefore(d,f.nextSibling)):d=f,c=!0);e.forEach(function(a){a.parentNode!==d&&d.appendChild(a)});if(g&&c)for(e=d.cloneNode(!1),d.parentNode.insertBefore(e,d.nextSibling);g;)l.check(),c=g.nextSibling,e.appendChild(g),g=c;return d}var n=core.DomUtils,h=odf.Namespaces.textns,p=odf.Namespaces.stylens;this.applyStyle=
function(a,e,c){var f={},h,k,g,n;runtime.assert(c&&c.hasOwnProperty("style:text-properties"),"applyStyle without any text properties");f["style:text-properties"]=c["style:text-properties"];g=new b(f);n=new d(f);a.forEach(function(a){h=n.isStyleApplied(a);!1===h&&(k=l(a,e),g.applyStyleToContainer(k))})}};
ops.OpApplyDirectStyling=function(){function e(a,b,d){var c=a.getOdfCanvas().odfContainer(),f=h.splitBoundaries(b),e=n.getTextNodes(b,!1);(new odf.TextStyleApplicator(new odf.ObjectNameGenerator(c,g),a.getFormatting(),c.rootElement.automaticStyles)).applyStyle(e,b,d);f.forEach(h.normalizeTextNodes)}var g,a,d,b,l,n=odf.OdfUtils,h=core.DomUtils;this.init=function(e){g=e.memberid;a=e.timestamp;d=parseInt(e.position,10);b=parseInt(e.length,10);l=e.setProperties};this.isEdit=!0;this.group=void 0;this.execute=
function(h){var m=h.convertCursorToDomRange(d,b),q=n.getParagraphElements(m);e(h,m,l);m.detach();h.getOdfCanvas().refreshCSS();h.fixCursorPositions();q.forEach(function(c){h.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:c,memberId:g,timeStamp:a})});h.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"ApplyDirectStyling",memberid:g,timestamp:a,position:d,length:b,setProperties:l}}};ops.OpApplyDirectStyling.Spec;ops.OpApplyDirectStyling.InitSpec;
ops.OpApplyHyperlink=function(){function e(a){for(;a;){if(h.isHyperlink(a))return!0;a=a.parentNode}return!1}var g,a,d,b,l,n=core.DomUtils,h=odf.OdfUtils;this.init=function(e){g=e.memberid;a=e.timestamp;d=e.position;b=e.length;l=e.hyperlink};this.isEdit=!0;this.group=void 0;this.execute=function(p){var m=p.getDOMDocument(),q=p.convertCursorToDomRange(d,b),c=n.splitBoundaries(q),f=[],r=h.getTextNodes(q,!1);if(0===r.length)return!1;r.forEach(function(a){var c=h.getParagraphElement(a);runtime.assert(!1===
e(a),"The given range should not contain any link.");var b=l,d=m.createElementNS(odf.Namespaces.textns,"text:a");d.setAttributeNS(odf.Namespaces.xlinkns,"xlink:type","simple");d.setAttributeNS(odf.Namespaces.xlinkns,"xlink:href",b);a.parentNode.insertBefore(d,a);d.appendChild(a);-1===f.indexOf(c)&&f.push(c)});c.forEach(n.normalizeTextNodes);q.detach();p.fixCursorPositions();p.getOdfCanvas().refreshSize();p.getOdfCanvas().rerenderAnnotations();f.forEach(function(c){p.emit(ops.OdtDocument.signalParagraphChanged,
{paragraphElement:c,memberId:g,timeStamp:a})});return!0};this.spec=function(){return{optype:"ApplyHyperlink",memberid:g,timestamp:a,position:d,length:b,hyperlink:l}}};ops.OpApplyHyperlink.Spec;ops.OpApplyHyperlink.InitSpec;
ops.OpInsertImage=function(){var e,g,a,d,b,l,n,h,p=odf.Namespaces.drawns,m=odf.Namespaces.svgns,q=odf.Namespaces.textns,c=odf.Namespaces.xlinkns,f=odf.OdfUtils;this.init=function(c){e=c.memberid;g=c.timestamp;a=c.position;d=c.filename;b=c.frameWidth;l=c.frameHeight;n=c.frameStyleName;h=c.frameName};this.isEdit=!0;this.group=void 0;this.execute=function(r){var k=r.getOdfCanvas(),u=r.getTextNodeAtStep(a,e),v,z;if(!u)return!1;v=u.textNode;z=f.getParagraphElement(v);var u=u.offset!==v.length?v.splitText(u.offset):
v.nextSibling,w=r.getDOMDocument(),t=w.createElementNS(p,"draw:image"),w=w.createElementNS(p,"draw:frame");t.setAttributeNS(c,"xlink:href",d);t.setAttributeNS(c,"xlink:type","simple");t.setAttributeNS(c,"xlink:show","embed");t.setAttributeNS(c,"xlink:actuate","onLoad");w.setAttributeNS(p,"draw:style-name",n);w.setAttributeNS(p,"draw:name",h);w.setAttributeNS(q,"text:anchor-type","as-char");w.setAttributeNS(m,"svg:width",b);w.setAttributeNS(m,"svg:height",l);w.appendChild(t);v.parentNode.insertBefore(w,
u);r.emit(ops.OdtDocument.signalStepsInserted,{position:a});0===v.length&&v.parentNode.removeChild(v);k.addCssForFrameWithImage(w);k.refreshCSS();r.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:z,memberId:e,timeStamp:g});k.rerenderAnnotations();return!0};this.spec=function(){return{optype:"InsertImage",memberid:e,timestamp:g,filename:d,position:a,frameWidth:b,frameHeight:l,frameStyleName:n,frameName:h}}};ops.OpInsertImage.Spec;ops.OpInsertImage.InitSpec;
ops.OpInsertTable=function(){function e(a,f){var e;if(1===m.length)e=m[0];else if(3===m.length)switch(a){case 0:e=m[0];break;case d-1:e=m[2];break;default:e=m[1]}else e=m[a];if(1===e.length)return e[0];if(3===e.length)switch(f){case 0:return e[0];case b-1:return e[2];default:return e[1]}return e[f]}var g,a,d,b,l,n,h,p,m,q=odf.OdfUtils;this.init=function(c){g=c.memberid;a=c.timestamp;l=c.position;d=c.initialRows;b=c.initialColumns;n=c.tableName;h=c.tableStyleName;p=c.tableColumnStyleName;m=c.tableCellStyleMatrix};
this.isEdit=!0;this.group=void 0;this.execute=function(c){var f=c.getTextNodeAtStep(l),m=c.getRootNode();if(f){var k=c.getDOMDocument(),u=k.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table"),v=k.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-column"),z,w,t,A;h&&u.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",h);n&&u.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:name",n);v.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0",
"table:number-columns-repeated",b);p&&v.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",p);u.appendChild(v);for(t=0;t<d;t+=1){v=k.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-row");for(A=0;A<b;A+=1)z=k.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-cell"),(w=e(t,A))&&z.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",w),w=k.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0",
"text:p"),z.appendChild(w),v.appendChild(z);u.appendChild(v)}f=q.getParagraphElement(f.textNode);m.insertBefore(u,f.nextSibling);c.emit(ops.OdtDocument.signalStepsInserted,{position:l});c.getOdfCanvas().refreshSize();c.emit(ops.OdtDocument.signalTableAdded,{tableElement:u,memberId:g,timeStamp:a});c.getOdfCanvas().rerenderAnnotations();return!0}return!1};this.spec=function(){return{optype:"InsertTable",memberid:g,timestamp:a,position:l,initialRows:d,initialColumns:b,tableName:n,tableStyleName:h,tableColumnStyleName:p,
tableCellStyleMatrix:m}}};ops.OpInsertTable.Spec;ops.OpInsertTable.InitSpec;
ops.OpInsertText=function(){function e(a){return"\t"!==a&&n.isODFWhitespace(a)}var g,a,d,b,l,n=odf.OdfUtils;this.init=function(e){g=e.memberid;a=e.timestamp;d=e.position;l=e.text;b="true"===e.moveCursor||!0===e.moveCursor};this.isEdit=!0;this.group=void 0;this.execute=function(h){var p,m,q,c=null,f=h.getDOMDocument(),r,k=0,u,v=h.getCursor(g),z;h.upgradeWhitespacesAtPosition(d);if(p=h.getTextNodeAtStep(d)){m=p.textNode;c=m.nextSibling;q=m.parentNode;r=n.getParagraphElement(m);for(z=0;z<l.length;z+=
1){if(!(u="\t"===l[z])){u=l;var w=z;u=e(u[w])&&(0===w||w===u.length-1||e(u[w-1]))}u&&(0===k?(p.offset!==m.length&&(c=m.splitText(p.offset)),0<z&&m.appendData(l.substring(0,z))):k<z&&(k=l.substring(k,z),q.insertBefore(f.createTextNode(k),c)),k=z+1,"\t"===l[z]?(u=f.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:tab"),u.appendChild(f.createTextNode("\t"))):(" "!==l[z]&&runtime.log("WARN: InsertText operation contains non-tab, non-space whitespace character (character code "+l.charCodeAt(z)+
")"),u=f.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:s"),u.appendChild(f.createTextNode(" "))),q.insertBefore(u,c))}0===k?m.insertData(p.offset,l):k<l.length&&(p=l.substring(k),q.insertBefore(f.createTextNode(p),c));q=m.parentNode;c=m.nextSibling;q.removeChild(m);q.insertBefore(m,c);0===m.length&&m.parentNode.removeChild(m);h.emit(ops.OdtDocument.signalStepsInserted,{position:d});v&&b&&(h.moveCursor(g,d+l.length,0),h.emit(ops.Document.signalCursorMoved,v));h.downgradeWhitespacesAtPosition(d);
h.downgradeWhitespacesAtPosition(d+l.length);h.getOdfCanvas().refreshSize();h.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:r,memberId:g,timeStamp:a});h.getOdfCanvas().rerenderAnnotations();return!0}return!1};this.spec=function(){return{optype:"InsertText",memberid:g,timestamp:a,position:d,text:l,moveCursor:b}}};ops.OpInsertText.Spec;ops.OpInsertText.InitSpec;
odf.CollapsingRules=function(e){function g(a){return d.isODFNode(a)||"br"===a.localName&&d.isLineBreak(a.parentNode)||a.nodeType===Node.TEXT_NODE&&d.isODFNode(a.parentNode)}function a(l){var n;l.nodeType===Node.TEXT_NODE?(n=l.parentNode,n.removeChild(l)):n=b.removeUnwantedNodes(l,g);if(l=n)l=n,l=!d.isParagraph(l)&&l!==e&&d.hasNoODFContent(l);return l?a(n):n}var d=odf.OdfUtils,b=core.DomUtils;this.mergeChildrenIntoParent=a};
ops.OpMergeParagraph=function(){function e(a){return q.isGroupingElement(a)&&q.hasNoODFContent(a)}function g(a){if(a.nodeType===Node.TEXT_NODE){if(0===a.length)return runtime.log("WARN: Empty text node found during merge operation"),!0;if(q.isODFWhitespace(a.data)&&!1===q.isSignificantWhitespace(a,0))return!0;a="#text"}else a=(a.prefix?a.prefix+":":"")+a.localName;runtime.log("WARN: Unexpected text element found near paragraph boundary ["+a+"]");return!1}function a(a){a.collapsed||(c.splitBoundaries(a),
a=q.getTextElements(a,!1,!0).filter(g),a.forEach(function(a){a.parentNode.removeChild(a)}))}function d(a,c,b){a=a.convertCursorStepToDomPoint(c);var f=q.getParagraphElement(a.node,a.offset);runtime.assert(Boolean(f),"Paragraph not found at step "+c);b&&b.setPosition(a.node,a.offset);return f}var b,l,n,h,p,m,q=odf.OdfUtils,c=core.DomUtils,f=odf.Namespaces.textns;this.init=function(a){b=a.memberid;l=a.timestamp;n=a.moveCursor;h=a.paragraphStyleName;p=parseInt(a.sourceStartPosition,10);m=parseInt(a.destinationStartPosition,
10)};this.isEdit=!0;this.group=void 0;this.execute=function(g){var k,q,v=g.getCursor(b);k=g.getRootNode();var z=new odf.CollapsingRules(k),w=g.createStepIterator(k,0,[g.getPositionFilter()],k),t;runtime.assert(m<p,"Destination paragraph ("+m+") must be before source paragraph ("+p+")");q=d(g,m);k=d(g,p,w);w.previousStep();runtime.assert(c.containsNode(q,w.container()),"Destination paragraph must be adjacent to the source paragraph");t=q.ownerDocument.createRange();w.setPosition(q,q.childNodes.length);
w.roundToPreviousStep();t.setStart(w.container(),w.offset());t.setEnd(q,q.childNodes.length);a(t);t=q.childNodes.length;var A=k.ownerDocument.createRange();w.setPosition(k,0);w.roundToNextStep();A.setStart(k,0);A.setEnd(w.container(),w.offset());a(A);for(A=k.firstChild;A;)"editinfo"===A.localName?k.removeChild(A):(q.appendChild(A),c.removeUnwantedNodes(A,e)),A=k.firstChild;runtime.assert(0===k.childNodes.length,"Source paragraph should be empty before it is removed");z.mergeChildrenIntoParent(k);
g.emit(ops.OdtDocument.signalStepsRemoved,{position:p-1});w.setPosition(q,t);w.roundToClosestStep();w.previousStep()||w.roundToNextStep();g.downgradeWhitespaces(w);h?q.setAttributeNS(f,"text:style-name",h):q.removeAttributeNS(f,"style-name");v&&n&&(g.moveCursor(b,p-1,0),g.emit(ops.Document.signalCursorMoved,v));g.fixCursorPositions();g.getOdfCanvas().refreshSize();g.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:q,memberId:b,timeStamp:l});g.getOdfCanvas().rerenderAnnotations();return!0};
this.spec=function(){return{optype:"MergeParagraph",memberid:b,timestamp:l,moveCursor:n,paragraphStyleName:h,sourceStartPosition:p,destinationStartPosition:m}}};ops.OpMergeParagraph.Spec;ops.OpMergeParagraph.InitSpec;
ops.OpMoveCursor=function(){var e,g,a,d,b;this.init=function(l){e=l.memberid;g=l.timestamp;a=l.position;d=l.length||0;b=l.selectionType||ops.OdtCursor.RangeSelection};this.isEdit=!1;this.group=void 0;this.execute=function(g){var n=g.getCursor(e),h;if(!n)return!1;h=g.convertCursorToDomRange(a,d);n.setSelectedRange(h,0<=d);n.setSelectionType(b);g.emit(ops.Document.signalCursorMoved,n);return!0};this.spec=function(){return{optype:"MoveCursor",memberid:e,timestamp:g,position:a,length:d,selectionType:b}}};
ops.OpMoveCursor.Spec;ops.OpMoveCursor.InitSpec;
ops.OpRemoveAnnotation=function(){var e,g,a,d,b=core.DomUtils;this.init=function(b){e=b.memberid;g=b.timestamp;a=parseInt(b.position,10);d=parseInt(b.length,10)};this.isEdit=!0;this.group=void 0;this.execute=function(d){function e(a){g.parentNode.insertBefore(a,g)}for(var h=d.getIteratorAtPosition(a).container(),g;h.namespaceURI!==odf.Namespaces.officens||"annotation"!==h.localName;)h=h.parentNode;if(null===h)return!1;g=h;h=g.annotationEndElement;d.getOdfCanvas().forgetAnnotations();b.getElementsByTagNameNS(g,
"urn:webodf:names:cursor","cursor").forEach(e);b.getElementsByTagNameNS(g,"urn:webodf:names:cursor","anchor").forEach(e);g.parentNode.removeChild(g);h&&h.parentNode.removeChild(h);d.emit(ops.OdtDocument.signalStepsRemoved,{position:0<a?a-1:a});d.fixCursorPositions();d.getOdfCanvas().refreshAnnotations();return!0};this.spec=function(){return{optype:"RemoveAnnotation",memberid:e,timestamp:g,position:a,length:d}}};ops.OpRemoveAnnotation.Spec;ops.OpRemoveAnnotation.InitSpec;
ops.OpRemoveBlob=function(){var e,g,a;this.init=function(d){e=d.memberid;g=d.timestamp;a=d.filename};this.isEdit=!0;this.group=void 0;this.execute=function(d){d.getOdfCanvas().odfContainer().removeBlob(a);return!0};this.spec=function(){return{optype:"RemoveBlob",memberid:e,timestamp:g,filename:a}}};ops.OpRemoveBlob.Spec;ops.OpRemoveBlob.InitSpec;
ops.OpRemoveCursor=function(){var e,g;this.init=function(a){e=a.memberid;g=a.timestamp};this.isEdit=!1;this.group=void 0;this.execute=function(a){return a.removeCursor(e)?!0:!1};this.spec=function(){return{optype:"RemoveCursor",memberid:e,timestamp:g}}};ops.OpRemoveCursor.Spec;ops.OpRemoveCursor.InitSpec;
ops.OpRemoveHyperlink=function(){var e,g,a,d,b=core.DomUtils,l=odf.OdfUtils;this.init=function(b){e=b.memberid;g=b.timestamp;a=b.position;d=b.length};this.isEdit=!0;this.group=void 0;this.execute=function(n){var h=n.convertCursorToDomRange(a,d),p=l.getHyperlinkElements(h);runtime.assert(1===p.length,"The given range should only contain a single link.");p=b.mergeIntoParent(p[0]);h.detach();n.fixCursorPositions();n.getOdfCanvas().refreshSize();n.getOdfCanvas().rerenderAnnotations();n.emit(ops.OdtDocument.signalParagraphChanged,
{paragraphElement:l.getParagraphElement(p),memberId:e,timeStamp:g});return!0};this.spec=function(){return{optype:"RemoveHyperlink",memberid:e,timestamp:g,position:a,length:d}}};ops.OpRemoveHyperlink.Spec;ops.OpRemoveHyperlink.InitSpec;
ops.OpRemoveMember=function(){var e,g;this.init=function(a){e=a.memberid;g=parseInt(a.timestamp,10)};this.isEdit=!1;this.group=void 0;this.execute=function(a){if(!a.getMember(e))return!1;a.removeMember(e);a.emit(ops.Document.signalMemberRemoved,e);return!0};this.spec=function(){return{optype:"RemoveMember",memberid:e,timestamp:g}}};ops.OpRemoveMember.Spec;ops.OpRemoveMember.InitSpec;
ops.OpRemoveStyle=function(){var e,g,a,d;this.init=function(b){e=b.memberid;g=b.timestamp;a=b.styleName;d=b.styleFamily};this.isEdit=!0;this.group=void 0;this.execute=function(b){var e=b.getFormatting().getStyleElement(a,d);if(!e)return!1;e.parentNode.removeChild(e);b.getOdfCanvas().refreshCSS();b.emit(ops.OdtDocument.signalCommonStyleDeleted,{name:a,family:d});return!0};this.spec=function(){return{optype:"RemoveStyle",memberid:e,timestamp:g,styleName:a,styleFamily:d}}};ops.OpRemoveStyle.Spec;ops.OpRemoveStyle.InitSpec;
ops.OpRemoveText=function(){var e,g,a,d,b=odf.OdfUtils,l=core.DomUtils;this.init=function(b){runtime.assert(0<=b.length,"OpRemoveText only supports positive lengths");e=b.memberid;g=b.timestamp;a=parseInt(b.position,10);d=parseInt(b.length,10)};this.isEdit=!0;this.group=void 0;this.execute=function(n){var h,p,m,q=n.getCursor(e),c=new odf.CollapsingRules(n.getRootNode());n.upgradeWhitespacesAtPosition(a);n.upgradeWhitespacesAtPosition(a+d);h=n.convertCursorToDomRange(a,d);l.splitBoundaries(h);p=b.getTextElements(h,
!1,!0);m=b.getParagraphElement(h.startContainer,h.startOffset);runtime.assert(void 0!==m,"Attempting to remove text outside a paragraph element");h.detach();p.forEach(function(a){a.parentNode?(runtime.assert(l.containsNode(m,a),"RemoveText only supports removing elements within the same paragraph"),c.mergeChildrenIntoParent(a)):runtime.log("WARN: text element has already been removed from it's container")});n.emit(ops.OdtDocument.signalStepsRemoved,{position:a});n.downgradeWhitespacesAtPosition(a);
n.fixCursorPositions();n.getOdfCanvas().refreshSize();n.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:m,memberId:e,timeStamp:g});q&&(q.resetSelectionType(),n.emit(ops.Document.signalCursorMoved,q));n.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"RemoveText",memberid:e,timestamp:g,position:a,length:d}}};ops.OpRemoveText.Spec;ops.OpRemoveText.InitSpec;
ops.OpSetBlob=function(){var e,g,a,d,b;this.init=function(l){e=l.memberid;g=l.timestamp;a=l.filename;d=l.mimetype;b=l.content};this.isEdit=!0;this.group=void 0;this.execute=function(e){e.getOdfCanvas().odfContainer().setBlob(a,d,b);return!0};this.spec=function(){return{optype:"SetBlob",memberid:e,timestamp:g,filename:a,mimetype:d,content:b}}};ops.OpSetBlob.Spec;ops.OpSetBlob.InitSpec;
ops.OpSetParagraphStyle=function(){function e(a,b,d){var e=[a.getPositionFilter()],g=d.container();d=d.unfilteredDomOffset();return!1===a.createStepIterator(g,d,e,b).previousStep()}var g,a,d,b,l=odf.OdfUtils;this.init=function(e){g=e.memberid;a=e.timestamp;d=e.position;b=e.styleName};this.isEdit=!0;this.group=void 0;this.execute=function(n){var h,p;h=n.getIteratorAtPosition(d);return(p=l.getParagraphElement(h.container()))?(runtime.assert(e(n,p,h),"SetParagraphStyle position should be the first position in the paragraph"),
b?p.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:style-name",b):p.removeAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","style-name"),n.getOdfCanvas().refreshSize(),n.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:p,timeStamp:a,memberId:g}),n.getOdfCanvas().rerenderAnnotations(),!0):!1};this.spec=function(){return{optype:"SetParagraphStyle",memberid:g,timestamp:a,position:d,styleName:b}}};ops.OpSetParagraphStyle.Spec;ops.OpSetParagraphStyle.InitSpec;
ops.OpSplitParagraph=function(){var e,g,a,d,b,l,n=odf.OdfUtils,h=odf.Namespaces.textns;this.init=function(h){e=h.memberid;g=h.timestamp;d=h.position;a=h.sourceParagraphPosition;l=h.paragraphStyleName;b="true"===h.moveCursor||!0===h.moveCursor};this.isEdit=!0;this.group=void 0;this.execute=function(a){var m,q,c,f,r,k,u,v=a.getCursor(e);a.upgradeWhitespacesAtPosition(d);m=a.getTextNodeAtStep(d);if(!m)return!1;q=n.getParagraphElement(m.textNode);if(!q)return!1;c=n.isListItem(q.parentNode)?q.parentNode:
q;0===m.offset?(u=m.textNode.previousSibling,k=null):(u=m.textNode,k=m.offset>=m.textNode.length?null:m.textNode.splitText(m.offset));for(f=m.textNode;f!==c;){f=f.parentNode;r=f.cloneNode(!1);k&&r.appendChild(k);if(u)for(;u&&u.nextSibling;)r.appendChild(u.nextSibling);else for(;f.firstChild;)r.appendChild(f.firstChild);f.parentNode.insertBefore(r,f.nextSibling);u=f;k=r}n.isListItem(k)&&(k=k.childNodes.item(0));l?k.setAttributeNS(h,"text:style-name",l):k.removeAttributeNS(h,"style-name");0===m.textNode.length&&
m.textNode.parentNode.removeChild(m.textNode);a.emit(ops.OdtDocument.signalStepsInserted,{position:d});v&&b&&(a.moveCursor(e,d+1,0),a.emit(ops.Document.signalCursorMoved,v));a.fixCursorPositions();a.getOdfCanvas().refreshSize();a.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:q,memberId:e,timeStamp:g});a.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:k,memberId:e,timeStamp:g});a.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"SplitParagraph",
memberid:e,timestamp:g,position:d,sourceParagraphPosition:a,paragraphStyleName:l,moveCursor:b}}};ops.OpSplitParagraph.Spec;ops.OpSplitParagraph.InitSpec;
ops.OpUpdateMember=function(){function e(a){var b="//dc:creator[@editinfo:memberid='"+g+"']";a=xmldom.XPath.getODFElementsWithXPath(a.getRootNode(),b,function(a){return"editinfo"===a?"urn:webodf:names:editinfo":odf.Namespaces.lookupNamespaceURI(a)});for(b=0;b<a.length;b+=1)a[b].textContent=d.fullName}var g,a,d,b;this.init=function(e){g=e.memberid;a=parseInt(e.timestamp,10);d=e.setProperties;b=e.removedProperties};this.isEdit=!1;this.group=void 0;this.execute=function(a){var n=a.getMember(g);if(!n)return!1;
b&&n.removeProperties(b);d&&(n.setProperties(d),d.fullName&&e(a));a.emit(ops.Document.signalMemberUpdated,n);return!0};this.spec=function(){return{optype:"UpdateMember",memberid:g,timestamp:a,setProperties:d,removedProperties:b}}};ops.OpUpdateMember.Spec;ops.OpUpdateMember.InitSpec;
ops.OpUpdateMetadata=function(){var e,g,a,d;this.init=function(b){e=b.memberid;g=parseInt(b.timestamp,10);a=b.setProperties;d=b.removedProperties};this.isEdit=!0;this.group=void 0;this.execute=function(b){b=b.getOdfCanvas().odfContainer();var e=null;d&&(e=d.attributes.split(","));b.setMetadata(a,e);return!0};this.spec=function(){return{optype:"UpdateMetadata",memberid:e,timestamp:g,setProperties:a,removedProperties:d}}};ops.OpUpdateMetadata.Spec;ops.OpUpdateMetadata.InitSpec;
ops.OpUpdateParagraphStyle=function(){function e(a,b){var d,e,c=b?b.split(","):[];for(d=0;d<c.length;d+=1)e=c[d].split(":"),a.removeAttributeNS(odf.Namespaces.lookupNamespaceURI(e[0]),e[1])}var g,a,d,b,l,n=odf.Namespaces.stylens;this.init=function(e){g=e.memberid;a=e.timestamp;d=e.styleName;b=e.setProperties;l=e.removedProperties};this.isEdit=!0;this.group=void 0;this.execute=function(a){var g=a.getFormatting(),m,q,c;return(m=""!==d?g.getStyleElement(d,"paragraph"):g.getDefaultStyleElement("paragraph"))?
(q=m.getElementsByTagNameNS(n,"paragraph-properties").item(0),c=m.getElementsByTagNameNS(n,"text-properties").item(0),b&&g.updateStyle(m,b),l&&(g=l["style:paragraph-properties"],q&&g&&(e(q,g.attributes),0===q.attributes.length&&m.removeChild(q)),g=l["style:text-properties"],c&&g&&(e(c,g.attributes),0===c.attributes.length&&m.removeChild(c)),e(m,l.attributes)),a.getOdfCanvas().refreshCSS(),a.emit(ops.OdtDocument.signalParagraphStyleModified,d),a.getOdfCanvas().rerenderAnnotations(),!0):!1};this.spec=
function(){return{optype:"UpdateParagraphStyle",memberid:g,timestamp:a,styleName:d,setProperties:b,removedProperties:l}}};ops.OpUpdateParagraphStyle.Spec;ops.OpUpdateParagraphStyle.InitSpec;
ops.OperationFactory=function(){function e(a){return function(d){return new a}}var g;this.register=function(a,d){g[a]=d};this.create=function(a){var d=null,b=g[a.optype];b&&(d=b(a),d.init(a));return d};g={AddMember:e(ops.OpAddMember),UpdateMember:e(ops.OpUpdateMember),RemoveMember:e(ops.OpRemoveMember),AddCursor:e(ops.OpAddCursor),ApplyDirectStyling:e(ops.OpApplyDirectStyling),SetBlob:e(ops.OpSetBlob),RemoveBlob:e(ops.OpRemoveBlob),InsertImage:e(ops.OpInsertImage),InsertTable:e(ops.OpInsertTable),
InsertText:e(ops.OpInsertText),RemoveText:e(ops.OpRemoveText),MergeParagraph:e(ops.OpMergeParagraph),SplitParagraph:e(ops.OpSplitParagraph),SetParagraphStyle:e(ops.OpSetParagraphStyle),UpdateParagraphStyle:e(ops.OpUpdateParagraphStyle),AddStyle:e(ops.OpAddStyle),RemoveStyle:e(ops.OpRemoveStyle),MoveCursor:e(ops.OpMoveCursor),RemoveCursor:e(ops.OpRemoveCursor),AddAnnotation:e(ops.OpAddAnnotation),RemoveAnnotation:e(ops.OpRemoveAnnotation),UpdateMetadata:e(ops.OpUpdateMetadata),ApplyHyperlink:e(ops.OpApplyHyperlink),
RemoveHyperlink:e(ops.OpRemoveHyperlink)}};ops.OperationFactory.SpecConstructor;ops.OperationRouter=function(){};ops.OperationRouter.prototype.setOperationFactory=function(e){};ops.OperationRouter.prototype.setPlaybackFunction=function(e){};ops.OperationRouter.prototype.push=function(e){};ops.OperationRouter.prototype.close=function(e){};ops.OperationRouter.prototype.subscribe=function(e,g){};ops.OperationRouter.prototype.unsubscribe=function(e,g){};
ops.OperationRouter.prototype.hasLocalUnsyncedOps=function(){};ops.OperationRouter.prototype.hasSessionHostConnection=function(){};ops.OperationRouter.signalProcessingBatchStart="router/batchstart";ops.OperationRouter.signalProcessingBatchEnd="router/batchend";
ops.TrivialOperationRouter=function(){var e=new core.EventNotifier([ops.OperationRouter.signalProcessingBatchStart,ops.OperationRouter.signalProcessingBatchEnd]),g,a,d=0;this.setOperationFactory=function(a){g=a};this.setPlaybackFunction=function(b){a=b};this.push=function(b){d+=1;e.emit(ops.OperationRouter.signalProcessingBatchStart,{});b.forEach(function(b){b=b.spec();b.timestamp=Date.now();b=g.create(b);b.group="g"+d;a(b)});e.emit(ops.OperationRouter.signalProcessingBatchEnd,{})};this.close=function(a){a()};
this.subscribe=function(a,d){e.subscribe(a,d)};this.unsubscribe=function(a,d){e.unsubscribe(a,d)};this.hasLocalUnsyncedOps=function(){return!1};this.hasSessionHostConnection=function(){return!0}};
ops.Session=function(e){function g(a){b.emit(ops.OdtDocument.signalProcessingBatchStart,a)}function a(a){b.emit(ops.OdtDocument.signalProcessingBatchEnd,a)}var d=new ops.OperationFactory,b=new ops.OdtDocument(e),l=null;this.setOperationFactory=function(a){d=a;l&&l.setOperationFactory(d)};this.setOperationRouter=function(e){l&&(l.unsubscribe(ops.OperationRouter.signalProcessingBatchStart,g),l.unsubscribe(ops.OperationRouter.signalProcessingBatchEnd,a));l=e;l.subscribe(ops.OperationRouter.signalProcessingBatchStart,
g);l.subscribe(ops.OperationRouter.signalProcessingBatchEnd,a);e.setPlaybackFunction(function(a){b.emit(ops.OdtDocument.signalOperationStart,a);return a.execute(b)?(b.emit(ops.OdtDocument.signalOperationEnd,a),!0):!1});e.setOperationFactory(d)};this.getOperationFactory=function(){return d};this.getOdtDocument=function(){return b};this.enqueue=function(a){l.push(a)};this.close=function(a){l.close(function(d){d?a(d):b.close(a)})};this.destroy=function(a){b.destroy(a)};this.setOperationRouter(new ops.TrivialOperationRouter)};
gui.AnnotationController=function(e,g,a){function d(){var c=h.getCursor(a),c=c&&c.getNode(),b=!1;c&&(b=!q.isWithinAnnotation(c,h.getRootNode()));b!==p&&(p=b,m.emit(gui.AnnotationController.annotatableChanged,p))}function b(c){c.getMemberId()===a&&d()}function l(c){c===a&&d()}function n(c){c.getMemberId()===a&&d()}var h=e.getOdtDocument(),p=!1,m=new core.EventNotifier([gui.AnnotationController.annotatableChanged]),q=odf.OdfUtils,c=core.StepDirection.NEXT;this.isAnnotatable=function(){return p};this.addAnnotation=
function(){var c=new ops.OpAddAnnotation,b=h.getCursorSelection(a),d=b.length,b=b.position;p&&(b=0<=d?b:b+d,d=Math.abs(d),c.init({memberid:a,position:b,length:d,name:a+Date.now()}),e.enqueue([c]))};this.removeAnnotation=function(b){var d,k;d=h.getMember(a).getProperties().fullName;if(!0!==g.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)||d===q.getAnnotationCreator(b))d=h.convertDomPointToCursorStep(b,0,c),k=h.convertDomPointToCursorStep(b,b.childNodes.length),b=new ops.OpRemoveAnnotation,
b.init({memberid:a,position:d,length:k-d}),k=new ops.OpMoveCursor,k.init({memberid:a,position:0<d?d-1:d,length:0}),e.enqueue([b,k])};this.subscribe=function(a,c){m.subscribe(a,c)};this.unsubscribe=function(a,c){m.unsubscribe(a,c)};this.destroy=function(a){h.unsubscribe(ops.Document.signalCursorAdded,b);h.unsubscribe(ops.Document.signalCursorRemoved,l);h.unsubscribe(ops.Document.signalCursorMoved,n);a()};g.registerConstraint(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN);h.subscribe(ops.Document.signalCursorAdded,
b);h.subscribe(ops.Document.signalCursorRemoved,l);h.subscribe(ops.Document.signalCursorMoved,n);d()};gui.AnnotationController.annotatableChanged="annotatable/changed";
gui.Avatar=function(e,g){var a=this,d,b,l;this.setColor=function(a){b.style.borderColor=a};this.setImageUrl=function(d){a.isVisible()?b.src=d:l=d};this.isVisible=function(){return"block"===d.style.display};this.show=function(){l&&(b.src=l,l=void 0);d.style.display="block"};this.hide=function(){d.style.display="none"};this.markAsFocussed=function(a){a?d.classList.add("active"):d.classList.remove("active")};this.destroy=function(a){e.removeChild(d);a()};(function(){var a=e.ownerDocument;d=a.createElement("div");
b=a.createElement("img");d.appendChild(b);d.style.display=g?"block":"none";d.className="handle";e.appendChild(d)})()};gui.StepInfo=function(){};gui.StepInfo.VisualDirection={LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1};gui.StepInfo.prototype.token;gui.StepInfo.prototype.container=function(){};gui.StepInfo.prototype.offset=function(){};gui.StepInfo.prototype.direction;gui.StepInfo.prototype.visualDirection;gui.VisualStepScanner=function(){};gui.VisualStepScanner.prototype.token;
gui.VisualStepScanner.prototype.process=function(e,g,a){};
gui.GuiStepUtils=function(){function e(b){b=a.getContentBounds(b);var e,l=null;if(b)if(b.container.nodeType===Node.TEXT_NODE)e=b.container.ownerDocument.createRange(),e.setStart(b.container,b.startOffset),e.setEnd(b.container,b.endOffset),(l=0<e.getClientRects().length?e.getBoundingClientRect():null)&&" "===b.container.data.substring(b.startOffset,b.endOffset)&&1>=l.width&&(l=null),e.detach();else if(g.isCharacterElement(b.container)||g.isCharacterFrame(b.container))l=d.getBoundingClientRect(b.container);
return l}var g=odf.OdfUtils,a=new odf.StepUtils,d=core.DomUtils,b=core.StepDirection.NEXT,l=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT,n=gui.StepInfo.VisualDirection.RIGHT_TO_LEFT;this.getContentRect=e;this.moveToFilteredStep=function(a,d,g){function q(a,c){c.process(w,k,u)&&(a=!0,!v&&c.token&&(v=c.token));return a}var c=d===b,f,r,k,u,v,z=a.snapshot();f=!1;var w;do f=e(a),w={token:a.snapshot(),container:a.container,offset:a.offset,direction:d,visualDirection:d===b?l:n},r=a.nextStep()?e(a):null,a.restore(w.token),
c?(k=f,u=r):(k=r,u=f),f=g.reduce(q,!1);while(!f&&a.advanceStep(d));f||g.forEach(function(a){!v&&a.token&&(v=a.token)});a.restore(v||z);return Boolean(v)}};
gui.Caret=function(e,g,a,d){function b(){c.style.opacity="0"===c.style.opacity?"1":"0";x.trigger()}function l(){u.selectNodeContents(k);return u.getBoundingClientRect()}function n(a){return F[a]!==H[a]}function h(){Object.keys(H).forEach(function(a){F[a]=H[a]})}function p(){if(!1===H.isShown||e.getSelectionType()!==ops.OdtCursor.RangeSelection||!d&&!e.getSelectedRange().collapsed)H.visibility="hidden",c.style.visibility="hidden",x.cancel();else if(H.visibility="visible",c.style.visibility="visible",
!1===H.isFocused)c.style.opacity="1",x.cancel();else{if(E||n("visibility"))c.style.opacity="1",x.cancel();x.trigger()}if(I||N){var a;a=e.getNode();var b,k,m=z.getBoundingClientRect(v.getSizer()),p=!1,u=0;a.removeAttributeNS("urn:webodf:names:cursor","caret-sizer-active");if(0<a.getClientRects().length)k=l(),u=k.left-z.getBoundingClientRect(a).left,p=!0;else if(t.setPosition(a,0),k=w.getContentRect(t),!k&&t.nextStep()&&(b=w.getContentRect(t))&&(k=b,p=!0),k||(a.setAttributeNS("urn:webodf:names:cursor",
"caret-sizer-active","true"),k=l(),p=!0),!k)for(runtime.log("WARN: No suitable client rectangle found for visual caret for "+e.getMemberId());a;){if(0<a.getClientRects().length){k=z.getBoundingClientRect(a);p=!0;break}a=a.parentNode}k=z.translateRect(k,m,v.getZoomLevel());a={top:k.top,height:k.height,right:p?k.left:k.right,width:z.adaptRangeDifferenceToZoomLevel(u,v.getZoomLevel())};8>a.height&&(a={top:a.top-(8-a.height)/2,height:8,right:a.right});q.style.height=a.height+"px";q.style.top=a.top+"px";
q.style.left=a.right-a.width+"px";q.style.width=a.width?a.width+"px":"";r&&(a=runtime.getWindow().getComputedStyle(e.getNode(),null),a.font?r.style.font=a.font:(r.style.fontStyle=a.fontStyle,r.style.fontVariant=a.fontVariant,r.style.fontWeight=a.fontWeight,r.style.fontSize=a.fontSize,r.style.lineHeight=a.lineHeight,r.style.fontFamily=a.fontFamily))}H.isShown&&N&&g.scrollIntoView(c.getBoundingClientRect());n("isFocused")&&f.markAsFocussed(H.isFocused);h();I=N=E=!1}function m(a){q.parentNode.removeChild(q);
k.parentNode.removeChild(k);a()}var q,c,f,r,k,u,v=e.getDocument().getCanvas(),z=core.DomUtils,w=new gui.GuiStepUtils,t,A,x,E=!1,N=!1,I=!1,H={isFocused:!1,isShown:!0,visibility:"hidden"},F={isFocused:!H.isFocused,isShown:!H.isShown,visibility:"hidden"};this.handleUpdate=function(){I=!0;A.trigger()};this.refreshCursorBlinking=function(){E=!0;A.trigger()};this.setFocus=function(){H.isFocused=!0;A.trigger()};this.removeFocus=function(){H.isFocused=!1;A.trigger()};this.show=function(){H.isShown=!0;A.trigger()};
this.hide=function(){H.isShown=!1;A.trigger()};this.setAvatarImageUrl=function(a){f.setImageUrl(a)};this.setColor=function(a){c.style.borderColor=a;f.setColor(a)};this.getCursor=function(){return e};this.getFocusElement=function(){return c};this.toggleHandleVisibility=function(){f.isVisible()?f.hide():f.show()};this.showHandle=function(){f.show()};this.hideHandle=function(){f.hide()};this.setOverlayElement=function(a){r=a;q.appendChild(a);I=!0;A.trigger()};this.ensureVisible=function(){N=!0;A.trigger()};
this.getBoundingClientRect=function(){return z.getBoundingClientRect(q)};this.destroy=function(a){core.Async.destroyAll([A.destroy,x.destroy,f.destroy,m],a)};(function(){var d=e.getDocument(),g=[d.createRootFilter(e.getMemberId()),d.getPositionFilter()],h=d.getDOMDocument();u=h.createRange();k=h.createElement("span");k.className="webodf-caretSizer";k.textContent="|";e.getNode().appendChild(k);q=h.createElement("div");q.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",e.getMemberId());
q.className="webodf-caretOverlay";c=h.createElement("div");c.className="caret";q.appendChild(c);f=new gui.Avatar(q,a);v.getSizer().appendChild(q);t=d.createStepIterator(e.getNode(),0,g,d.getRootNode());A=core.Task.createRedrawTask(p);x=core.Task.createTimeoutTask(b,500);A.triggerImmediate()})()};
odf.TextSerializer=function(){function e(d){var b="",l=g.filter?g.filter.acceptNode(d):NodeFilter.FILTER_ACCEPT,n=d.nodeType,h;if((l===NodeFilter.FILTER_ACCEPT||l===NodeFilter.FILTER_SKIP)&&a.isTextContentContainingNode(d))for(h=d.firstChild;h;)b+=e(h),h=h.nextSibling;l===NodeFilter.FILTER_ACCEPT&&(n===Node.ELEMENT_NODE&&a.isParagraph(d)?b+="\n":n===Node.TEXT_NODE&&d.textContent&&(b+=d.textContent));return b}var g=this,a=odf.OdfUtils;this.filter=null;this.writeToString=function(a){if(!a)return"";
a=e(a);"\n"===a[a.length-1]&&(a=a.substr(0,a.length-1));return a}};gui.MimeDataExporter=function(){var e;this.exportRangeToDataTransfer=function(g,a){var d;d=a.startContainer.ownerDocument.createElement("span");d.appendChild(a.cloneContents());d=e.writeToString(d);try{g.setData("text/plain",d)}catch(b){g.setData("Text",d)}};e=new odf.TextSerializer;e.filter=new odf.OdfNodeFilter};
gui.Clipboard=function(e){this.setDataFromRange=function(g,a){var d,b=g.clipboardData;d=runtime.getWindow();!b&&d&&(b=d.clipboardData);b?(d=!0,e.exportRangeToDataTransfer(b,a),g.preventDefault()):d=!1;return d}};
gui.SessionContext=function(e,g){var a=e.getOdtDocument(),d=odf.OdfUtils;this.isLocalCursorWithinOwnAnnotation=function(){var b=a.getCursor(g),e;if(!b)return!1;e=b&&b.getNode();b=a.getMember(g).getProperties().fullName;return(e=d.getParentAnnotation(e,a.getRootNode()))&&d.getAnnotationCreator(e)===b?!0:!1}};
gui.StyleSummary=function(e){function g(a,d){var g=a+"|"+d,p;b.hasOwnProperty(g)||(p=[],e.forEach(function(b){b=(b=b.styleProperties[a])&&b[d];-1===p.indexOf(b)&&p.push(b)}),b[g]=p);return b[g]}function a(a,b,d){return function(){var e=g(a,b);return d.length>=e.length&&e.every(function(a){return-1!==d.indexOf(a)})}}function d(a,b){var d=g(a,b);return 1===d.length?d[0]:void 0}var b={};this.getPropertyValues=g;this.getCommonValue=d;this.isBold=a("style:text-properties","fo:font-weight",["bold"]);this.isItalic=
a("style:text-properties","fo:font-style",["italic"]);this.hasUnderline=a("style:text-properties","style:text-underline-style",["solid"]);this.hasStrikeThrough=a("style:text-properties","style:text-line-through-style",["solid"]);this.fontSize=function(){var a=d("style:text-properties","fo:font-size");return a&&parseFloat(a)};this.fontName=function(){return d("style:text-properties","style:font-name")};this.isAlignedLeft=a("style:paragraph-properties","fo:text-align",["left","start"]);this.isAlignedCenter=
a("style:paragraph-properties","fo:text-align",["center"]);this.isAlignedRight=a("style:paragraph-properties","fo:text-align",["right","end"]);this.isAlignedJustified=a("style:paragraph-properties","fo:text-align",["justify"]);this.text={isBold:this.isBold,isItalic:this.isItalic,hasUnderline:this.hasUnderline,hasStrikeThrough:this.hasStrikeThrough,fontSize:this.fontSize,fontName:this.fontName};this.paragraph={isAlignedLeft:this.isAlignedLeft,isAlignedCenter:this.isAlignedCenter,isAlignedRight:this.isAlignedRight,
isAlignedJustified:this.isAlignedJustified}};
gui.DirectFormattingController=function(e,g,a,d,b,l,n){function h(){return Y.value().styleSummary}function p(){return Y.value().enabledFeatures}function m(a){var c;a.collapsed?(c=a.startContainer,c.hasChildNodes()&&a.startOffset<c.childNodes.length&&(c=c.childNodes.item(a.startOffset)),a=[c]):a=O.getTextElements(a,!0,!1);return a}function q(){var c=B.getCursor(d),b=c&&c.getSelectedRange(),f=[],f=[],e=!0,k={directTextStyling:!0,directParagraphStyling:!0};b&&(f=m(b),0===f.length&&(f=[b.startContainer,
b.endContainer],e=!1),f=B.getFormatting().getAppliedStyles(f));void 0!==f[0]&&W&&(f[0].styleProperties=P.mergeObjects(f[0].styleProperties,W));!0===g.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(k.directTextStyling=k.directParagraphStyling=a.isLocalCursorWithinOwnAnnotation());k.directTextStyling&&(k.directTextStyling=e&&void 0!==c&&c.getSelectionType()===ops.OdtCursor.RangeSelection);return{enabledFeatures:k,appliedStyles:f,styleSummary:new gui.StyleSummary(f)}}function c(a,c){var b={};Object.keys(a).forEach(function(f){var d=
a[f](),e=c[f]();d!==e&&(b[f]=e)});return b}function f(){var a,b;b=J.styleSummary;var f=Y.value(),d=f.styleSummary,e=J.enabledFeatures,k=f.enabledFeatures;a=c(b.text,d.text);b=c(b.paragraph,d.paragraph);e=!(k.directTextStyling===e.directTextStyling&&k.directParagraphStyling===e.directParagraphStyling);J=f;e&&ba.emit(gui.DirectFormattingController.enabledChanged,k);0<Object.keys(a).length&&ba.emit(gui.DirectFormattingController.textStylingChanged,a);0<Object.keys(b).length&&ba.emit(gui.DirectFormattingController.paragraphStylingChanged,
b)}function r(){Y.reset();f()}function k(a){("string"===typeof a?a:a.getMemberId())===d&&Y.reset()}function u(){Y.reset()}function v(a){var c=B.getCursor(d);a=a.paragraphElement;c&&O.getParagraphElement(c.getNode())===a&&Y.reset()}function z(a,c){c(!a());return!0}function w(a){if(p().directTextStyling){var c=B.getCursorSelection(d),b={"style:text-properties":a};0!==c.length?(a=new ops.OpApplyDirectStyling,a.init({memberid:d,position:c.position,length:c.length,setProperties:b}),e.enqueue([a])):(W=
P.mergeObjects(W||{},b),Y.reset())}}function t(a,c){var b={};b[a]=c;w(b)}function A(a){a=a.spec();W&&a.memberid===d&&"SplitParagraph"!==a.optype&&(W=null,Y.reset())}function x(a){t("fo:font-weight",a?"bold":"normal")}function E(a){t("fo:font-style",a?"italic":"normal")}function N(a){t("style:text-underline-style",a?"solid":"none")}function I(a){t("style:text-line-through-style",a?"solid":"none")}function H(a){if(p().directParagraphStyling){var c=B.getCursor(d).getSelectedRange(),c=O.getParagraphElements(c),
f=B.getFormatting(),k=[],g={},h;c.forEach(function(c){var e=B.convertDomPointToCursorStep(c,0,da),l=c.getAttributeNS(odf.Namespaces.textns,"style-name"),m;c=l?g.hasOwnProperty(l)?g[l]:void 0:h;c||(c=b.generateStyleName(),l?(g[l]=c,m=f.createDerivedStyleObject(l,"paragraph",{})):(h=c,m={}),m=a(m),l=new ops.OpAddStyle,l.init({memberid:d,styleName:c.toString(),styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:m}),k.push(l));l=new ops.OpSetParagraphStyle;l.init({memberid:d,styleName:c.toString(),
position:e});k.push(l)});e.enqueue(k)}}function F(a){H(function(c){return P.mergeObjects(c,a)})}function G(a){F({"style:paragraph-properties":{"fo:text-align":a}})}function s(a,c){var b=B.getFormatting().getDefaultTabStopDistance(),f=c["style:paragraph-properties"],d;f&&(f=f["fo:margin-left"],d=O.parseLength(f));return P.mergeObjects(c,{"style:paragraph-properties":{"fo:margin-left":d&&d.unit===b.unit?d.value+a*b.value+d.unit:a*b.value+b.unit}})}function y(a,c){var b=m(a),b=0===b.length?[a.startContainer]:
b,b=B.getFormatting().getAppliedStyles(b),f=0<b.length?b[0].styleProperties:void 0,d=B.getFormatting().getAppliedStylesForElement(c).styleProperties;if(!f||"text"!==f["style:family"]||!f["style:text-properties"])return!1;if(!d||!d["style:text-properties"])return!0;f=f["style:text-properties"];d=d["style:text-properties"];return!Object.keys(f).every(function(a){return f[a]===d[a]})}function D(){}function T(){return!1}var C=this,B=e.getOdtDocument(),P=new core.Utils,O=odf.OdfUtils,ba=new core.EventNotifier([gui.DirectFormattingController.enabledChanged,
gui.DirectFormattingController.textStylingChanged,gui.DirectFormattingController.paragraphStylingChanged]),ca=odf.Namespaces.textns,da=core.StepDirection.NEXT,W=null,J,Y;this.enabledFeatures=p;this.formatTextSelection=w;this.createCursorStyleOp=function(a,c,b){var f=null,e=W;b&&(e=(b=Y.value().appliedStyles[0])&&b.styleProperties);e&&e["style:text-properties"]&&(f=new ops.OpApplyDirectStyling,f.init({memberid:d,position:a,length:c,setProperties:{"style:text-properties":e["style:text-properties"]}}),
W=null,Y.reset());return f};this.setBold=x;this.setItalic=E;this.setHasUnderline=N;this.setHasStrikethrough=I;this.setFontSize=function(a){t("fo:font-size",a+"pt")};this.setFontName=function(a){t("style:font-name",a)};this.getAppliedStyles=function(){return Y.value().appliedStyles};this.toggleBold=z.bind(C,function(){return h().isBold()},x);this.toggleItalic=z.bind(C,function(){return h().isItalic()},E);this.toggleUnderline=z.bind(C,function(){return h().hasUnderline()},N);this.toggleStrikethrough=
z.bind(C,function(){return h().hasStrikeThrough()},I);this.isBold=function(){return h().isBold()};this.isItalic=function(){return h().isItalic()};this.hasUnderline=function(){return h().hasUnderline()};this.hasStrikeThrough=function(){return h().hasStrikeThrough()};this.fontSize=function(){return h().fontSize()};this.fontName=function(){return h().fontName()};this.isAlignedLeft=function(){return h().isAlignedLeft()};this.isAlignedCenter=function(){return h().isAlignedCenter()};this.isAlignedRight=
function(){return h().isAlignedRight()};this.isAlignedJustified=function(){return h().isAlignedJustified()};this.alignParagraphLeft=function(){G("left");return!0};this.alignParagraphCenter=function(){G("center");return!0};this.alignParagraphRight=function(){G("right");return!0};this.alignParagraphJustified=function(){G("justify");return!0};this.indent=function(){H(s.bind(null,1));return!0};this.outdent=function(){H(s.bind(null,-1));return!0};this.createParagraphStyleOps=function(a){if(!p().directParagraphStyling)return[];
var c=B.getCursor(d),f=c.getSelectedRange(),e=[],k,g;c.hasForwardSelection()?(k=c.getAnchorNode(),g=c.getNode()):(k=c.getNode(),g=c.getAnchorNode());c=O.getParagraphElement(g);runtime.assert(Boolean(c),"DirectFormattingController: Cursor outside paragraph");var h=c,l=[B.getPositionFilter(),B.createRootFilter(d)];if(!1!==B.createStepIterator(f.endContainer,f.endOffset,l,h).nextStep())return e;g!==k&&(c=O.getParagraphElement(k));if(!W&&!y(f,c))return e;f=(f=Y.value().appliedStyles[0])&&f.styleProperties;
if(!f)return e;if(c=c.getAttributeNS(ca,"style-name"))f={"style:text-properties":f["style:text-properties"]},f=B.getFormatting().createDerivedStyleObject(c,"paragraph",f);k=b.generateStyleName();c=new ops.OpAddStyle;c.init({memberid:d,styleName:k,styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:f});e.push(c);c=new ops.OpSetParagraphStyle;c.init({memberid:d,styleName:k,position:a});e.push(c);return e};this.subscribe=function(a,c){ba.subscribe(a,c)};this.unsubscribe=function(a,c){ba.unsubscribe(a,
c)};this.destroy=function(a){B.unsubscribe(ops.Document.signalCursorAdded,k);B.unsubscribe(ops.Document.signalCursorRemoved,k);B.unsubscribe(ops.Document.signalCursorMoved,k);B.unsubscribe(ops.OdtDocument.signalParagraphStyleModified,u);B.unsubscribe(ops.OdtDocument.signalParagraphChanged,v);B.unsubscribe(ops.OdtDocument.signalOperationEnd,A);B.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,f);g.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,r);a()};(function(){B.subscribe(ops.Document.signalCursorAdded,
k);B.subscribe(ops.Document.signalCursorRemoved,k);B.subscribe(ops.Document.signalCursorMoved,k);B.subscribe(ops.OdtDocument.signalParagraphStyleModified,u);B.subscribe(ops.OdtDocument.signalParagraphChanged,v);B.subscribe(ops.OdtDocument.signalOperationEnd,A);B.subscribe(ops.OdtDocument.signalProcessingBatchEnd,f);g.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,r);Y=new core.LazyProperty(q);J=Y.value();l||(C.formatTextSelection=D,C.setBold=D,C.setItalic=D,C.setHasUnderline=D,C.setHasStrikethrough=
D,C.setFontSize=D,C.setFontName=D,C.toggleBold=T,C.toggleItalic=T,C.toggleUnderline=T,C.toggleStrikethrough=T);n||(C.alignParagraphCenter=D,C.alignParagraphJustified=D,C.alignParagraphLeft=D,C.alignParagraphRight=D,C.createParagraphStyleOps=function(){return[]},C.indent=D,C.outdent=D)})()};gui.DirectFormattingController.enabledChanged="enabled/changed";gui.DirectFormattingController.textStylingChanged="textStyling/changed";gui.DirectFormattingController.paragraphStylingChanged="paragraphStyling/changed";
gui.DirectFormattingController.SelectionInfo=function(){this.enabledFeatures;this.appliedStyles;this.styleSummary};
gui.KeyboardHandler=function(){function e(a,d){d||(d=g.None);switch(a){case gui.KeyboardHandler.KeyCode.LeftMeta:case gui.KeyboardHandler.KeyCode.RightMeta:case gui.KeyboardHandler.KeyCode.MetaInMozilla:d|=g.Meta;break;case gui.KeyboardHandler.KeyCode.Ctrl:d|=g.Ctrl;break;case gui.KeyboardHandler.KeyCode.Alt:d|=g.Alt;break;case gui.KeyboardHandler.KeyCode.Shift:d|=g.Shift}return a+":"+d}var g=gui.KeyboardHandler.Modifier,a=null,d={};this.setDefault=function(b){a=b};this.bind=function(a,g,n,h){a=e(a,
g);runtime.assert(h||!1===d.hasOwnProperty(a),"tried to overwrite the callback handler of key combo: "+a);d[a]=n};this.unbind=function(a,g){var n=e(a,g);delete d[n]};this.reset=function(){a=null;d={}};this.handleEvent=function(b){var l=b.keyCode,n=g.None;b.metaKey&&(n|=g.Meta);b.ctrlKey&&(n|=g.Ctrl);b.altKey&&(n|=g.Alt);b.shiftKey&&(n|=g.Shift);l=e(l,n);l=d[l];n=!1;l?n=l():null!==a&&(n=a(b));n&&(b.preventDefault?b.preventDefault():b.returnValue=!1)}};
gui.KeyboardHandler.Modifier={None:0,Meta:1,Ctrl:2,Alt:4,CtrlAlt:6,Shift:8,MetaShift:9,CtrlShift:10,AltShift:12};gui.KeyboardHandler.KeyCode={Backspace:8,Tab:9,Clear:12,Enter:13,Shift:16,Ctrl:17,Alt:18,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Delete:46,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LeftMeta:91,RightMeta:93,MetaInMozilla:224};
gui.HyperlinkClickHandler=function(e,g,a){function d(a){for(;null!==a;){if(c.isHyperlink(a))return a;if(c.isParagraph(a))break;a=a.parentNode}return null}function b(){var a=e();runtime.assert(Boolean(a.classList),"Document container has no classList element");a.classList.remove("webodf-inactiveLinks")}function l(){var a=e();runtime.assert(Boolean(a.classList),"Document container has no classList element");a.classList.add("webodf-inactiveLinks")}function n(){f.removeEventListener("focus",l,!1);k.forEach(function(c){g.unbind(c.keyCode,
c.modifier);a.unbind(c.keyCode,c.modifier)});k.length=0}function h(c){n();if(c!==p.None){f.addEventListener("focus",l,!1);switch(c){case p.Ctrl:k.push({keyCode:m.Ctrl,modifier:p.None});break;case p.Meta:k.push({keyCode:m.LeftMeta,modifier:p.None}),k.push({keyCode:m.RightMeta,modifier:p.None}),k.push({keyCode:m.MetaInMozilla,modifier:p.None})}k.forEach(function(c){g.bind(c.keyCode,c.modifier,b);a.bind(c.keyCode,c.modifier,l)})}}var p=gui.KeyboardHandler.Modifier,m=gui.KeyboardHandler.KeyCode,q=xmldom.XPath,
c=odf.OdfUtils,f=runtime.getWindow(),r=p.None,k=[];runtime.assert(null!==f,"Expected to be run in an environment which has a global window, like a browser.");this.handleClick=function(a){var b=a.target||a.srcElement,k,g,h;a.ctrlKey?k=p.Ctrl:a.metaKey&&(k=p.Meta);if(r===p.None||r===k)if(k=d(b))g=c.getHyperlinkTarget(k),""!==g&&("#"===g[0]?(g=g.substring(1),k=e(),h=q.getODFElementsWithXPath(k,"//text:bookmark-start[@text:name='"+g+"']",odf.Namespaces.lookupNamespaceURI),0===h.length&&(h=q.getODFElementsWithXPath(k,
"//text:bookmark[@text:name='"+g+"']",odf.Namespaces.lookupNamespaceURI)),0<h.length&&(clearTimeout(clicktimer),clicktimer=setTimeout(function(){function a(c){for(var b=0;b<=historylist.length-1;b++)if(historylist[b].url==c.url)return;historylist.push(c)}a({url:"#S"+g,node:b});a({url:"#"+g,node:h[0]});history.pushState(null,null,"#S"+g);history.pushState(null,null,"#"+g);h[0].scrollIntoView(!0)},100))):f.open(g),a.preventDefault?a.preventDefault():a.returnValue=!1)};this.setModifier=function(a){r!==
a&&(runtime.assert(a===p.None||a===p.Ctrl||a===p.Meta,"Unsupported KeyboardHandler.Modifier value: "+a),r=a,r!==p.None?l():b(),h(r))};this.getModifier=function(){return r};this.destroy=function(a){l();n();a()}};
gui.EventManager=function(e){function g(a){function c(a,b,f){var d,e=!1;d="on"+b;a.attachEvent&&(a.attachEvent(d,f),e=!0);!e&&a.addEventListener&&(a.addEventListener(b,f,!1),e=!0);e&&!A[b]||!a.hasOwnProperty(d)||(a[d]=f)}function b(a,c,f){var d="on"+c;a.detachEvent&&a.detachEvent(d,f);a.removeEventListener&&a.removeEventListener(c,f,!1);a[d]===f&&(a[d]=null)}function f(c){if(-1===e.indexOf(c)){e.push(c);if(d.filters.every(function(a){return a(c)}))try{k.emit(a,c)}catch(b){runtime.log("Error occurred while processing "+
a+":\n"+b.message+"\n"+b.stack)}runtime.setTimeout(function(){e.splice(e.indexOf(c),1)},0)}}var d=this,e=[],k=new core.EventNotifier([a]);this.filters=[];this.subscribe=function(c){k.subscribe(a,c)};this.unsubscribe=function(c){k.unsubscribe(a,c)};this.destroy=function(){b(t,a,f);b(I,a,f);b(H,a,f)};x[a]&&c(t,a,f);c(I,a,f);c(H,a,f)}function a(a,c,b){function f(c){b(c,d,function(c){c.type=a;e.emit(a,c)})}var d={},e=new core.EventNotifier([a]);this.subscribe=function(c){e.subscribe(a,c)};this.unsubscribe=
function(c){e.unsubscribe(a,c)};this.destroy=function(){c.forEach(function(a){F.unsubscribe(a,f)})};(function(){c.forEach(function(a){F.subscribe(a,f)})})()}function d(a){runtime.clearTimeout(a);delete G[a]}function b(a,c){var b=runtime.setTimeout(function(){a();d(b)},c);G[b]=!0;return b}function l(a,c,f){var e=a.touches.length,k=a.touches[0],g=c.timer;"touchmove"===a.type||"touchend"===a.type?g&&d(g):"touchstart"===a.type&&(1!==e?runtime.clearTimeout(g):g=b(function(){f({clientX:k.clientX,clientY:k.clientY,
pageX:k.pageX,pageY:k.pageY,target:a.target||a.srcElement||null,detail:1})},400));c.timer=g}function n(a,c,b){var f=a.touches[0],d=a.target||a.srcElement||null,e=c.target;1!==a.touches.length||"touchend"===a.type?e=null:"touchstart"===a.type&&"webodf-draggable"===d.getAttribute("class")?e=d:"touchmove"===a.type&&e&&(a.preventDefault(),a.stopPropagation(),b({clientX:f.clientX,clientY:f.clientY,pageX:f.pageX,pageY:f.pageY,target:e,detail:1}));c.target=e}function h(a,c,b){var f=a.target||a.srcElement||
null,d=c.dragging;"drag"===a.type?d=!0:"touchend"===a.type&&d&&(d=!1,a=a.changedTouches[0],b({clientX:a.clientX,clientY:a.clientY,pageX:a.pageX,pageY:a.pageY,target:f,detail:1}));c.dragging=d}function p(){H.classList.add("webodf-touchEnabled");F.unsubscribe("touchstart",p)}function m(a){var c=a.scrollX,b=a.scrollY;this.restore=function(){a.scrollX===c&&a.scrollY===b||a.scrollTo(c,b)}}function q(a){var c=a.scrollTop,b=a.scrollLeft;this.restore=function(){if(a.scrollTop!==c||a.scrollLeft!==b)a.scrollTop=
c,a.scrollLeft=b}}function c(a,c){var b=N[a]||E[a]||null;!b&&c&&(b=N[a]=new g(a));return b}function f(a,b){c(a,!0).subscribe(b)}function r(a,b){var f=c(a,!1);f&&f.unsubscribe(b)}function k(){return e.getDOMDocument().activeElement===I}function u(){k()&&I.blur();I.setAttribute("disabled","true")}function v(){I.removeAttribute("disabled")}function z(a){for(var c=[];a;)(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight)&&c.push(new q(a)),a=a.parentNode;c.push(new m(t));return c}function w(){var a;
k()||(a=z(I),v(),I.focus(),a.forEach(function(a){a.restore()}))}var t=runtime.getWindow(),A={beforecut:!0,beforepaste:!0,longpress:!0,drag:!0,dragstop:!0},x={mousedown:!0,mouseup:!0,focus:!0},E={},N={},I,H=e.getCanvas().getElement(),F=this,G={};this.addFilter=function(a,b){c(a,!0).filters.push(b)};this.removeFilter=function(a,b){var f=c(a,!0),d=f.filters.indexOf(b);-1!==d&&f.filters.splice(d,1)};this.subscribe=f;this.unsubscribe=r;this.hasFocus=k;this.focus=w;this.getEventTrap=function(){return I};
this.setEditing=function(a){var c=k();c&&I.blur();a?I.removeAttribute("readOnly"):I.setAttribute("readOnly","true");c&&w()};this.destroy=function(a){r("touchstart",p);Object.keys(G).forEach(function(a){d(parseInt(a,10))});G.length=0;Object.keys(E).forEach(function(a){E[a].destroy()});E={};r("mousedown",u);r("mouseup",v);r("contextmenu",v);Object.keys(N).forEach(function(a){N[a].destroy()});N={};I.parentNode.removeChild(I);a()};(function(){var c=e.getOdfCanvas().getSizer(),b=c.ownerDocument;runtime.assert(Boolean(t),
"EventManager requires a window object to operate correctly");I=b.createElement("textarea");I.id="eventTrap";I.setAttribute("tabindex","-1");I.setAttribute("readOnly","true");I.setAttribute("rows","1");c.appendChild(I);f("mousedown",u);f("mouseup",v);f("contextmenu",v);E.longpress=new a("longpress",["touchstart","touchmove","touchend"],l);E.drag=new a("drag",["touchstart","touchmove","touchend"],n);E.dragstop=new a("dragstop",["drag","touchend"],h);f("touchstart",p)})()};
gui.IOSSafariSupport=function(e){function g(){a.innerHeight!==a.outerHeight&&(d.style.display="none",runtime.requestAnimationFrame(function(){d.style.display="block"}))}var a=runtime.getWindow(),d=e.getEventTrap();this.destroy=function(a){e.unsubscribe("focus",g);d.removeAttribute("autocapitalize");d.style.WebkitTransform="";a()};e.subscribe("focus",g);d.setAttribute("autocapitalize","off");d.style.WebkitTransform="translateX(-10000px)"};
gui.HyperlinkController=function(e,g,a,d){function b(){var b=!0;!0===g.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(b=a.isLocalCursorWithinOwnAnnotation());b!==m&&(m=b,p.emit(gui.HyperlinkController.enabledChanged,m))}function l(a){a.getMemberId()===d&&b()}var n=odf.OdfUtils,h=e.getOdtDocument(),p=new core.EventNotifier([gui.HyperlinkController.enabledChanged]),m=!1;this.isEnabled=function(){return m};this.subscribe=function(a,c){p.subscribe(a,c)};this.unsubscribe=function(a,c){p.unsubscribe(a,
c)};this.addHyperlink=function(a,c){if(m){var b=h.getCursorSelection(d),g=new ops.OpApplyHyperlink,k=[];if(0===b.length||c)c=c||a,g=new ops.OpInsertText,g.init({memberid:d,position:b.position,text:c}),b.length=c.length,k.push(g);g=new ops.OpApplyHyperlink;g.init({memberid:d,position:b.position,length:b.length,hyperlink:a});k.push(g);e.enqueue(k)}};this.removeHyperlinks=function(){if(m){var a=h.createPositionIterator(h.getRootNode()),c=h.getCursor(d).getSelectedRange(),b=n.getHyperlinkElements(c),
g=c.collapsed&&1===b.length,k=h.getDOMDocument().createRange(),l=[],p,z;0!==b.length&&(b.forEach(function(a){k.selectNodeContents(a);p=h.convertDomToCursorRange({anchorNode:k.startContainer,anchorOffset:k.startOffset,focusNode:k.endContainer,focusOffset:k.endOffset});z=new ops.OpRemoveHyperlink;z.init({memberid:d,position:p.position,length:p.length});l.push(z)}),g||(g=b[0],-1===c.comparePoint(g,0)&&(k.setStart(g,0),k.setEnd(c.startContainer,c.startOffset),p=h.convertDomToCursorRange({anchorNode:k.startContainer,
anchorOffset:k.startOffset,focusNode:k.endContainer,focusOffset:k.endOffset}),0<p.length&&(z=new ops.OpApplyHyperlink,z.init({memberid:d,position:p.position,length:p.length,hyperlink:n.getHyperlinkTarget(g)}),l.push(z))),b=b[b.length-1],a.moveToEndOfNode(b),a=a.unfilteredDomOffset(),1===c.comparePoint(b,a)&&(k.setStart(c.endContainer,c.endOffset),k.setEnd(b,a),p=h.convertDomToCursorRange({anchorNode:k.startContainer,anchorOffset:k.startOffset,focusNode:k.endContainer,focusOffset:k.endOffset}),0<p.length&&
(z=new ops.OpApplyHyperlink,z.init({memberid:d,position:p.position,length:p.length,hyperlink:n.getHyperlinkTarget(b)}),l.push(z)))),e.enqueue(l),k.detach())}};this.destroy=function(a){h.unsubscribe(ops.Document.signalCursorMoved,l);g.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,b);a()};h.subscribe(ops.Document.signalCursorMoved,l);g.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,b);b()};gui.HyperlinkController.enabledChanged="enabled/changed";
gui.ImageController=function(e,g,a,d,b){function l(){var c=!0;!0===g.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(c=a.isLocalCursorWithinOwnAnnotation());c!==r&&(r=c,f.emit(gui.ImageController.enabledChanged,r))}function n(a){a.getMemberId()===d&&l()}var h={"image/gif":".gif","image/jpeg":".jpg","image/png":".png"},p=odf.Namespaces.textns,m=e.getOdtDocument(),q=odf.OdfUtils,c=m.getFormatting(),f=new core.EventNotifier([gui.HyperlinkController.enabledChanged]),r=!1;this.isEnabled=function(){return r};
this.subscribe=function(a,c){f.subscribe(a,c)};this.unsubscribe=function(a,c){f.unsubscribe(a,c)};this.insertImage=function(a,f,g,l){if(r){runtime.assert(0<g&&0<l,"Both width and height of the image should be greater than 0px.");l={width:g,height:l};if(g=q.getParagraphElement(m.getCursor(d).getNode()).getAttributeNS(p,"style-name")){g=c.getContentSize(g,"paragraph");var n=1,t=1;l.width>g.width&&(n=g.width/l.width);l.height>g.height&&(t=g.height/l.height);g=Math.min(n,t);l={width:l.width*g,height:l.height*
g}}g=l.width+"px";l=l.height+"px";var A=m.getOdfCanvas().odfContainer().rootElement.styles,n=a.toLowerCase(),t=h.hasOwnProperty(n)?h[n]:null,x,n=[];runtime.assert(null!==t,"Image type is not supported: "+a);t="Pictures/"+b.generateImageName()+t;x=new ops.OpSetBlob;x.init({memberid:d,filename:t,mimetype:a,content:f});n.push(x);c.getStyleElement("Graphics","graphic",[A])||(a=new ops.OpAddStyle,a.init({memberid:d,styleName:"Graphics",styleFamily:"graphic",isAutomaticStyle:!1,setProperties:{"style:graphic-properties":{"text:anchor-type":"paragraph",
"svg:x":"0cm","svg:y":"0cm","style:wrap":"dynamic","style:number-wrapped-paragraphs":"no-limit","style:wrap-contour":"false","style:vertical-pos":"top","style:vertical-rel":"paragraph","style:horizontal-pos":"center","style:horizontal-rel":"paragraph"}}}),n.push(a));a=b.generateStyleName();f=new ops.OpAddStyle;f.init({memberid:d,styleName:a,styleFamily:"graphic",isAutomaticStyle:!0,setProperties:{"style:parent-style-name":"Graphics","style:graphic-properties":{"style:vertical-pos":"top","style:vertical-rel":"baseline",
"style:horizontal-pos":"center","style:horizontal-rel":"paragraph","fo:background-color":"transparent","style:background-transparency":"100%","style:shadow":"none","style:mirror":"none","fo:clip":"rect(0cm, 0cm, 0cm, 0cm)","draw:luminance":"0%","draw:contrast":"0%","draw:red":"0%","draw:green":"0%","draw:blue":"0%","draw:gamma":"100%","draw:color-inversion":"false","draw:image-opacity":"100%","draw:color-mode":"standard"}}});n.push(f);x=new ops.OpInsertImage;x.init({memberid:d,position:m.getCursorPosition(d),
filename:t,frameWidth:g,frameHeight:l,frameStyleName:a,frameName:b.generateFrameName()});n.push(x);e.enqueue(n)}};this.destroy=function(a){m.unsubscribe(ops.Document.signalCursorMoved,n);g.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,l);a()};m.subscribe(ops.Document.signalCursorMoved,n);g.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,l);l()};gui.ImageController.enabledChanged="enabled/changed";
gui.ImageSelector=function(e){function g(){var a=e.getSizer(),g=b.createElement("div");g.id="imageSelector";g.style.borderWidth="1px";a.appendChild(g);d.forEach(function(a){var d=b.createElement("div");d.className=a;g.appendChild(d)});return g}var a=odf.Namespaces.svgns,d="topLeft topRight bottomRight bottomLeft topMiddle rightMiddle bottomMiddle leftMiddle".split(" "),b=e.getElement().ownerDocument,l=!1;this.select=function(d){var h,p,m=b.getElementById("imageSelector");m||(m=g());l=!0;h=m.parentNode;
p=d.getBoundingClientRect();var q=h.getBoundingClientRect(),c=e.getZoomLevel();h=(p.left-q.left)/c-1;p=(p.top-q.top)/c-1;m.style.display="block";m.style.left=h+"px";m.style.top=p+"px";m.style.width=d.getAttributeNS(a,"width");m.style.height=d.getAttributeNS(a,"height")};this.clearSelection=function(){var a;l&&(a=b.getElementById("imageSelector"))&&(a.style.display="none");l=!1};this.isSelectorElement=function(a){var d=b.getElementById("imageSelector");return d?a===d||a.parentNode===d:!1}};
(function(){function e(e){function a(a){n=a.which&&String.fromCharCode(a.which)===l;l=void 0;return!1===n}function d(){n=!1}function b(a){l=a.data;n=!1}var l,n=!1;this.destroy=function(h){e.unsubscribe("textInput",d);e.unsubscribe("compositionend",b);e.removeFilter("keypress",a);h()};e.subscribe("textInput",d);e.subscribe("compositionend",b);e.addFilter("keypress",a)}gui.InputMethodEditor=function(g,a){function d(a){c&&(a?c.getNode().setAttributeNS("urn:webodf:names:cursor","composing","true"):(c.getNode().removeAttributeNS("urn:webodf:names:cursor",
"composing"),k.textContent=""))}function b(){v&&(v=!1,d(!1),w.emit(gui.InputMethodEditor.signalCompositionEnd,{data:z}),z="")}function l(){N||(N=!0,b(),c&&c.getSelectedRange().collapsed?f.value="":f.value=A.writeToString(c.getSelectedRange().cloneContents()),f.setSelectionRange(0,f.value.length),N=!1)}function n(){a.hasFocus()&&u.trigger()}function h(){t=void 0;u.cancel();d(!0);v||w.emit(gui.InputMethodEditor.signalCompositionStart,{data:""})}function p(a){a=t=a.data;v=!0;z+=a;u.trigger()}function m(a){a.data!==
t&&(a=a.data,v=!0,z+=a,u.trigger());t=void 0}function q(){k.textContent=f.value}var c=null,f=a.getEventTrap(),r=f.ownerDocument,k,u,v=!1,z="",w=new core.EventNotifier([gui.InputMethodEditor.signalCompositionStart,gui.InputMethodEditor.signalCompositionEnd]),t,A,x=[],E,N=!1;this.subscribe=w.subscribe;this.unsubscribe=w.unsubscribe;this.registerCursor=function(b){b.getMemberId()===g&&(c=b,c.getNode().appendChild(k),b.subscribe(ops.OdtCursor.signalCursorUpdated,n),a.subscribe("input",q),a.subscribe("compositionupdate",
q))};this.removeCursor=function(b){c&&b===g&&(c.getNode().removeChild(k),c.unsubscribe(ops.OdtCursor.signalCursorUpdated,n),a.unsubscribe("input",q),a.unsubscribe("compositionupdate",q),c=null)};this.destroy=function(c){a.unsubscribe("compositionstart",h);a.unsubscribe("compositionend",p);a.unsubscribe("textInput",m);a.unsubscribe("keypress",b);a.unsubscribe("focus",l);core.Async.destroyAll(E,c)};(function(){A=new odf.TextSerializer;A.filter=new odf.OdfNodeFilter;a.subscribe("compositionstart",h);
a.subscribe("compositionend",p);a.subscribe("textInput",m);a.subscribe("keypress",b);a.subscribe("focus",l);x.push(new e(a));E=x.map(function(a){return a.destroy});k=r.createElement("span");k.setAttribute("id","composer");u=core.Task.createTimeoutTask(l,1);E.push(u.destroy)})()};gui.InputMethodEditor.signalCompositionStart="input/compositionstart";gui.InputMethodEditor.signalCompositionEnd="input/compositionend"})();
gui.MetadataController=function(e,g){function a(a){l.emit(gui.MetadataController.signalMetadataChanged,a)}function d(a){var b=-1===n.indexOf(a);b||runtime.log("Setting "+a+" is restricted.");return b}var b=e.getOdtDocument(),l=new core.EventNotifier([gui.MetadataController.signalMetadataChanged]),n=["dc:creator","dc:date","meta:editing-cycles","meta:editing-duration","meta:document-statistic"];this.setMetadata=function(a,b){var l={},n="",c;a&&Object.keys(a).filter(d).forEach(function(c){l[c]=a[c]});
b&&(n=b.filter(d).join(","));if(0<n.length||0<Object.keys(l).length)c=new ops.OpUpdateMetadata,c.init({memberid:g,setProperties:l,removedProperties:0<n.length?{attributes:n}:null}),e.enqueue([c])};this.getMetadata=function(a){var d;runtime.assert("string"===typeof a,"Property must be a string");d=a.split(":");runtime.assert(2===d.length,"Property must be a namespace-prefixed string");a=odf.Namespaces.lookupNamespaceURI(d[0]);runtime.assert(Boolean(a),"Prefix must be for an ODF namespace.");return b.getOdfCanvas().odfContainer().getMetadata(a,
d[1])};this.subscribe=function(a,b){l.subscribe(a,b)};this.unsubscribe=function(a,b){l.unsubscribe(a,b)};this.destroy=function(d){b.unsubscribe(ops.OdtDocument.signalMetadataUpdated,a);d()};b.subscribe(ops.OdtDocument.signalMetadataUpdated,a)};gui.MetadataController.signalMetadataChanged="metadata/changed";
gui.PasteController=function(e,g,a,d){function b(){h=!0===g.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)?a.isLocalCursorWithinOwnAnnotation():!0}function l(a){a.getMemberId()===d&&b()}var n=e.getOdtDocument(),h=!1,p=odf.Namespaces.textns,m=core.StepDirection.NEXT,q=odf.OdfUtils;this.isEnabled=function(){return h};this.paste=function(a){if(h){var b=n.getCursorPosition(d),g=n.getCursor(d).getNode(),g=q.getParagraphElement(g),k=g.getAttributeNS(p,"style-name")||"",l=b,v=[],z=n.convertDomPointToCursorStep(g,
0,m);a.replace(/\r/g,"").split("\n").forEach(function(a){var c=new ops.OpInsertText,b=new ops.OpSplitParagraph;c.init({memberid:d,position:l,text:a,moveCursor:!0});v.push(c);l+=a.length;b.init({memberid:d,position:l,paragraphStyleName:k,sourceParagraphPosition:z,moveCursor:!0});v.push(b);z=l+=1});v.pop();e.enqueue(v)}};this.destroy=function(a){n.unsubscribe(ops.Document.signalCursorMoved,l);g.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,b);a()};n.subscribe(ops.Document.signalCursorMoved,l);
g.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,b);b()};gui.ClosestXOffsetScanner=function(e){function g(a){return null!==a&&void 0!==b?Math.abs(a-e)>b:!1}function a(a){null!==a&&!1===g(a)&&(b=Math.abs(a-e))}var d=this,b,l=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT;this.token=void 0;this.process=function(b,e,p){var m,q;b.visualDirection===l?(m=e&&e.right,q=p&&p.left):(m=e&&e.left,q=p&&p.right);if(g(m)||g(q))return!0;if(e||p)a(m),a(q),d.token=b.token;return!1}};
gui.LineBoundaryScanner=function(){var e=this,g=null;this.token=void 0;this.process=function(a,d,b){var l;if(l=b)if(g){var n=g;l=Math.min(n.bottom-n.top,b.bottom-b.top);var h=Math.max(n.top,b.top),n=Math.min(n.bottom,b.bottom)-h;l=.4>=(0<l?n/l:0)}else l=!1;!d||b&&!l||(e.token=a.token);if(l)return!0;g=(a=g)&&d?{left:Math.min(a.left,d.left),right:Math.max(a.right,d.right),top:Math.min(a.top,d.top),bottom:Math.min(a.bottom,d.bottom)}:a||d;return!1}};
gui.ParagraphBoundaryScanner=function(){var e=this,g=!1,a,d=odf.OdfUtils;this.token=void 0;this.process=function(b){var l=d.getParagraphElement(b.container());g||(a=l,g=!0);if(a!==l)return!0;e.token=b.token;return!1}};
odf.WordBoundaryFilter=function(e,g){function a(a,c,b){for(var f=null,d=e.getRootNode(),g;a!==d&&null!==a&&null===f;)g=0>c?a.previousSibling:a.nextSibling,b(g)===NodeFilter.FILTER_ACCEPT&&(f=g),a=a.parentNode;return f}function d(a,c){var f;return null===a?r.NO_NEIGHBOUR:n.isCharacterElement(a)?r.SPACE_CHAR:a.nodeType===b||n.isTextSpan(a)||n.isHyperlink(a)?(f=a.textContent.charAt(c()),p.test(f)?r.SPACE_CHAR:h.test(f)?r.PUNCTUATION_CHAR:r.WORD_CHAR):r.OTHER}var b=Node.TEXT_NODE,l=Node.ELEMENT_NODE,
n=odf.OdfUtils,h=/[!-#%-*,-\/:-;?-@\[-\]_{}\u00a1\u00ab\u00b7\u00bb\u00bf;\u00b7\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0700-\u070d\u07f7-\u07f9\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u169b-\u169c\u16eb-\u16ed\u1735-\u1736\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u1944-\u1945\u19de-\u19df\u1a1e-\u1a1f\u1b5a-\u1b60\u1c3b-\u1c3f\u1c7e-\u1c7f\u2000-\u206e\u207d-\u207e\u208d-\u208e\u3008-\u3009\u2768-\u2775\u27c5-\u27c6\u27e6-\u27ef\u2983-\u2998\u29d8-\u29db\u29fc-\u29fd\u2cf9-\u2cfc\u2cfe-\u2cff\u2e00-\u2e7e\u3000-\u303f\u30a0\u30fb\ua60d-\ua60f\ua673\ua67e\ua874-\ua877\ua8ce-\ua8cf\ua92e-\ua92f\ua95f\uaa5c-\uaa5f\ufd3e-\ufd3f\ufe10-\ufe19\ufe30-\ufe52\ufe54-\ufe61\ufe63\ufe68\ufe6a-\ufe6b\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|\ud800[\udd00-\udd01\udf9f\udfd0]|\ud802[\udd1f\udd3f\ude50-\ude58]|\ud809[\udc00-\udc7e]/,
p=/\s/,m=core.PositionFilter.FilterResult.FILTER_ACCEPT,q=core.PositionFilter.FilterResult.FILTER_REJECT,c=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,f=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,r={NO_NEIGHBOUR:0,SPACE_CHAR:1,PUNCTUATION_CHAR:2,WORD_CHAR:3,OTHER:4};this.acceptPosition=function(b){var e=b.container(),h=b.leftNode(),n=b.rightNode(),p=b.unfilteredDomOffset,t=function(){return b.unfilteredDomOffset()-1};e.nodeType===l&&(null===n&&(n=a(e,1,b.getNodeFilter())),null===h&&(h=
a(e,-1,b.getNodeFilter())));e!==n&&(p=function(){return 0});e!==h&&null!==h&&(t=function(){return h.textContent.length-1});e=d(h,t);n=d(n,p);return e===r.WORD_CHAR&&n===r.WORD_CHAR||e===r.PUNCTUATION_CHAR&&n===r.PUNCTUATION_CHAR||g===c&&e!==r.NO_NEIGHBOUR&&n===r.SPACE_CHAR||g===f&&e===r.SPACE_CHAR&&n!==r.NO_NEIGHBOUR?q:m}};odf.WordBoundaryFilter.IncludeWhitespace={None:0,TRAILING:1,LEADING:2};
gui.SelectionController=function(e,g){function a(a){var c=a.spec();if(a.isEdit||c.memberid===g)N=void 0,I.cancel()}function d(){var a=v.getCursor(g).getNode();return v.createStepIterator(a,0,[t,x],v.getRootElement(a))}function b(a,c,b){b=new odf.WordBoundaryFilter(v,b);var f=v.getRootElement(a)||v.getRootNode(),d=v.createRootFilter(f);return v.createStepIterator(a,c,[t,d,b],f)}function l(a,c){return c?{anchorNode:a.startContainer,anchorOffset:a.startOffset,focusNode:a.endContainer,focusOffset:a.endOffset}:
{anchorNode:a.endContainer,anchorOffset:a.endOffset,focusNode:a.startContainer,focusOffset:a.startOffset}}function n(a,c,b){var f=new ops.OpMoveCursor;f.init({memberid:g,position:a,length:c||0,selectionType:b});return f}function h(a,c,b){var f;f=v.getCursor(g);f=l(f.getSelectedRange(),f.hasForwardSelection());f.focusNode=a;f.focusOffset=c;b||(f.anchorNode=f.focusNode,f.anchorOffset=f.focusOffset);a=v.convertDomToCursorRange(f);e.enqueue([n(a.position,a.length)])}function p(a){var c;c=b(a.startContainer,
a.startOffset,H);c.roundToPreviousStep()&&a.setStart(c.container(),c.offset());c=b(a.endContainer,a.endOffset,F);c.roundToNextStep()&&a.setEnd(c.container(),c.offset())}function m(a){var c=w.getParagraphElements(a),b=c[0],c=c[c.length-1];b&&a.setStart(b,0);c&&(w.isParagraph(a.endContainer)&&0===a.endOffset?a.setEndBefore(c):a.setEnd(c,c.childNodes.length))}function q(a,c,b,f){var d,e;f?(d=b.startContainer,e=b.startOffset):(d=b.endContainer,e=b.endOffset);z.containsNode(a,d)||(e=0>z.comparePoints(a,
0,d,e)?0:a.childNodes.length,d=a);a=v.createStepIterator(d,e,c,w.getParagraphElement(d)||a);a.roundToClosestStep()||runtime.assert(!1,"No step found in requested range");f?b.setStart(a.container(),a.offset()):b.setEnd(a.container(),a.offset())}function c(a,c){var b=d();b.advanceStep(a)&&h(b.container(),b.offset(),c)}function f(a,c){var b,f=N,e=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];void 0===f&&E&&(f=E());isNaN(f)||(b=d(),A.moveToFilteredStep(b,a,e)&&b.advanceStep(a)&&(e=[new gui.ClosestXOffsetScanner(f),
new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner],A.moveToFilteredStep(b,a,e)&&(h(b.container(),b.offset(),c),N=f,I.restart())))}function r(a,c){var b=d(),f=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];A.moveToFilteredStep(b,a,f)&&h(b.container(),b.offset(),c)}function k(a,c){var f=v.getCursor(g),f=l(f.getSelectedRange(),f.hasForwardSelection()),f=b(f.focusNode,f.focusOffset,H);f.advanceStep(a)&&h(f.container(),f.offset(),c)}function u(a,c,b){var f=!1,d=v.getCursor(g),
d=l(d.getSelectedRange(),d.hasForwardSelection()),f=v.getRootElement(d.focusNode);runtime.assert(Boolean(f),"SelectionController: Cursor outside root");d=v.createStepIterator(d.focusNode,d.focusOffset,[t,x],f);d.roundToClosestStep();d.advanceStep(a)&&(b=b(d.container()))&&(a===G?(d.setPosition(b,0),f=d.roundToNextStep()):(d.setPosition(b,b.childNodes.length),f=d.roundToPreviousStep()),f&&h(d.container(),d.offset(),c))}var v=e.getOdtDocument(),z=core.DomUtils,w=odf.OdfUtils,t=v.getPositionFilter(),
A=new gui.GuiStepUtils,x=v.createRootFilter(g),E=null,N,I,H=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,F=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,G=core.StepDirection.PREVIOUS,s=core.StepDirection.NEXT;this.selectionToRange=function(a){var c=0<=z.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset),b=a.focusNode.ownerDocument.createRange();c?(b.setStart(a.anchorNode,a.anchorOffset),b.setEnd(a.focusNode,a.focusOffset)):(b.setStart(a.focusNode,a.focusOffset),b.setEnd(a.anchorNode,
a.anchorOffset));return{range:b,hasForwardSelection:c}};this.rangeToSelection=l;this.selectImage=function(a){var c=v.getRootElement(a),b=v.createRootFilter(c),c=v.createStepIterator(a,0,[b,v.getPositionFilter()],c),f;c.roundToPreviousStep()||runtime.assert(!1,"No walkable position before frame");b=c.container();f=c.offset();c.setPosition(a,a.childNodes.length);c.roundToNextStep()||runtime.assert(!1,"No walkable position after frame");a=v.convertDomToCursorRange({anchorNode:b,anchorOffset:f,focusNode:c.container(),
focusOffset:c.offset()});a=n(a.position,a.length,ops.OdtCursor.RegionSelection);e.enqueue([a])};this.expandToWordBoundaries=p;this.expandToParagraphBoundaries=m;this.selectRange=function(a,c,b){var f=v.getOdfCanvas().getElement(),d,k=[t];d=z.containsNode(f,a.startContainer);f=z.containsNode(f,a.endContainer);if(d||f)if(d&&f&&(2===b?p(a):3<=b&&m(a)),(b=c?v.getRootElement(a.startContainer):v.getRootElement(a.endContainer))||(b=v.getRootNode()),k.push(v.createRootFilter(b)),q(b,k,a,!0),q(b,k,a,!1),a=
l(a,c),c=v.convertDomToCursorRange(a),a=v.getCursorSelection(g),c.position!==a.position||c.length!==a.length)a=n(c.position,c.length,ops.OdtCursor.RangeSelection),e.enqueue([a])};this.moveCursorToLeft=function(){c(G,!1);return!0};this.moveCursorToRight=function(){c(s,!1);return!0};this.extendSelectionToLeft=function(){c(G,!0);return!0};this.extendSelectionToRight=function(){c(s,!0);return!0};this.setCaretXPositionLocator=function(a){E=a};this.moveCursorUp=function(){f(G,!1);return!0};this.moveCursorDown=
function(){f(s,!1);return!0};this.extendSelectionUp=function(){f(G,!0);return!0};this.extendSelectionDown=function(){f(s,!0);return!0};this.moveCursorBeforeWord=function(){k(G,!1);return!0};this.moveCursorPastWord=function(){k(s,!1);return!0};this.extendSelectionBeforeWord=function(){k(G,!0);return!0};this.extendSelectionPastWord=function(){k(s,!0);return!0};this.moveCursorToLineStart=function(){r(G,!1);return!0};this.moveCursorToLineEnd=function(){r(s,!1);return!0};this.extendSelectionToLineStart=
function(){r(G,!0);return!0};this.extendSelectionToLineEnd=function(){r(s,!0);return!0};this.extendSelectionToParagraphStart=function(){u(G,!0,w.getParagraphElement);return!0};this.extendSelectionToParagraphEnd=function(){u(s,!0,w.getParagraphElement);return!0};this.moveCursorToParagraphStart=function(){u(G,!1,w.getParagraphElement);return!0};this.moveCursorToParagraphEnd=function(){u(s,!1,w.getParagraphElement);return!0};this.moveCursorToDocumentStart=function(){u(G,!1,v.getRootElement);return!0};
this.moveCursorToDocumentEnd=function(){u(s,!1,v.getRootElement);return!0};this.extendSelectionToDocumentStart=function(){u(G,!0,v.getRootElement);return!0};this.extendSelectionToDocumentEnd=function(){u(s,!0,v.getRootElement);return!0};this.extendSelectionToEntireDocument=function(){var a=v.getCursor(g),a=v.getRootElement(a.getNode()),c,b,f;runtime.assert(Boolean(a),"SelectionController: Cursor outside root");f=v.createStepIterator(a,0,[t,x],a);f.roundToClosestStep();c=f.container();b=f.offset();
f.setPosition(a,a.childNodes.length);f.roundToClosestStep();a=v.convertDomToCursorRange({anchorNode:c,anchorOffset:b,focusNode:f.container(),focusOffset:f.offset()});e.enqueue([n(a.position,a.length)]);return!0};this.destroy=function(c){v.unsubscribe(ops.OdtDocument.signalOperationStart,a);core.Async.destroyAll([I.destroy],c)};(function(){I=core.Task.createTimeoutTask(function(){N=void 0},2E3);v.subscribe(ops.OdtDocument.signalOperationStart,a)})()};
gui.TextController=function(e,g,a,d,b,l){function n(){u=!0===g.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)?a.isLocalCursorWithinOwnAnnotation():!0}function h(a){a.getMemberId()===d&&n()}function p(a,c,b){var d=[f.getPositionFilter()];b&&d.push(f.createRootFilter(a.startContainer));b=f.createStepIterator(a.startContainer,a.startOffset,d,c);b.roundToClosestStep()||runtime.assert(!1,"No walkable step found in paragraph element at range start");c=f.convertDomPointToCursorStep(b.container(),b.offset());
a.collapsed?a=c:(b.setPosition(a.endContainer,a.endOffset),b.roundToClosestStep()||runtime.assert(!1,"No walkable step found in paragraph element at range end"),a=f.convertDomPointToCursorStep(b.container(),b.offset()));return{position:c,length:a-c}}function m(a){var c,b,f,e=r.getParagraphElements(a),g=a.cloneRange(),h=[];c=e[0];1<e.length&&(r.hasNoODFContent(c)&&(c=e[e.length-1]),b=c.getAttributeNS(odf.Namespaces.textns,"style-name")||"");e.forEach(function(c,e){var l,m;g.setStart(c,0);g.collapse(!0);
l=p(g,c,!1).position;0<e&&(m=new ops.OpMergeParagraph,m.init({memberid:d,paragraphStyleName:b,destinationStartPosition:f,sourceStartPosition:l,moveCursor:1===e}),h.unshift(m));f=l;g.selectNodeContents(c);if(l=k.rangeIntersection(g,a))l=p(l,c,!0),0<l.length&&(m=new ops.OpRemoveText,m.init({memberid:d,position:l.position,length:l.length}),h.unshift(m))});return h}function q(a){0>a.length&&(a.position+=a.length,a.length=-a.length);return a}function c(a){if(!u)return!1;var c,b=f.getCursor(d).getSelectedRange().cloneRange(),
g=q(f.getCursorSelection(d)),k;if(0===g.length){g=void 0;c=f.getCursor(d).getNode();k=f.getRootElement(c);var h=[f.getPositionFilter(),f.createRootFilter(k)];k=f.createStepIterator(c,0,h,k);k.roundToClosestStep()&&(a?k.nextStep():k.previousStep())&&(g=q(f.convertDomToCursorRange({anchorNode:c,anchorOffset:0,focusNode:k.container(),focusOffset:k.offset()})),a?(b.setStart(c,0),b.setEnd(k.container(),k.offset())):(b.setStart(k.container(),k.offset()),b.setEnd(c,0)))}g&&e.enqueue(m(b));return void 0!==
g}var f=e.getOdtDocument(),r=odf.OdfUtils,k=core.DomUtils,u=!1,v=odf.Namespaces.textns,z=core.StepDirection.NEXT;this.isEnabled=function(){return u};this.enqueueParagraphSplittingOps=function(){if(!u)return!1;var a=f.getCursor(d),c=a.getSelectedRange(),b=q(f.getCursorSelection(d)),g=[],a=r.getParagraphElement(a.getNode()),k=a.getAttributeNS(v,"style-name")||"";0<b.length&&(g=g.concat(m(c)));c=new ops.OpSplitParagraph;c.init({memberid:d,position:b.position,paragraphStyleName:k,sourceParagraphPosition:f.convertDomPointToCursorStep(a,
0,z),moveCursor:!0});g.push(c);l&&(b=l(b.position+1),g=g.concat(b));e.enqueue(g);return!0};this.removeTextByBackspaceKey=function(){return c(!1)};this.removeTextByDeleteKey=function(){return c(!0)};this.removeCurrentSelection=function(){if(!u)return!1;var a=f.getCursor(d).getSelectedRange();e.enqueue(m(a));return!0};this.insertText=function(a){if(u){var c=f.getCursor(d).getSelectedRange(),g=q(f.getCursorSelection(d)),k=[],h=!1;0<g.length&&(k=k.concat(m(c)),h=!0);c=new ops.OpInsertText;c.init({memberid:d,
position:g.position,text:a,moveCursor:!0});k.push(c);b&&(a=b(g.position,a.length,h))&&k.push(a);e.enqueue(k)}};this.destroy=function(a){f.unsubscribe(ops.Document.signalCursorMoved,h);g.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,n);a()};f.subscribe(ops.Document.signalCursorMoved,h);g.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,n);n()};gui.UndoManager=function(){};gui.UndoManager.prototype.subscribe=function(e,g){};gui.UndoManager.prototype.unsubscribe=function(e,g){};
gui.UndoManager.prototype.setDocument=function(e){};gui.UndoManager.prototype.setInitialState=function(){};gui.UndoManager.prototype.initialize=function(){};gui.UndoManager.prototype.purgeInitialState=function(){};gui.UndoManager.prototype.setPlaybackFunction=function(e){};gui.UndoManager.prototype.hasUndoStates=function(){};gui.UndoManager.prototype.hasRedoStates=function(){};gui.UndoManager.prototype.moveForward=function(e){};gui.UndoManager.prototype.moveBackward=function(e){};
gui.UndoManager.prototype.onOperationExecuted=function(e){};gui.UndoManager.signalUndoStackChanged="undoStackChanged";gui.UndoManager.signalUndoStateCreated="undoStateCreated";gui.UndoManager.signalUndoStateModified="undoStateModified";gui.SessionControllerOptions=function(){this.annotationsEnabled=this.directParagraphStylingEnabled=this.directTextStylingEnabled=!1};
(function(){var e=core.PositionFilter.FilterResult.FILTER_ACCEPT;gui.SessionController=function(g,a,d,b){function l(a){return a.target||a.srcElement||null}function n(a,c){var b=B.getDOMDocument(),f=null;b.caretRangeFromPoint?(b=b.caretRangeFromPoint(a,c),f={container:b.startContainer,offset:b.startOffset}):b.caretPositionFromPoint&&(b=b.caretPositionFromPoint(a,c))&&b.offsetNode&&(f={container:b.offsetNode,offset:b.offset});return f}function h(c){var b=B.getCursor(a).getSelectedRange();b.collapsed?
c.preventDefault():W.setDataFromRange(c,b)?ea.removeCurrentSelection():runtime.log("Cut operation failed")}function p(){return!1!==B.getCursor(a).getSelectedRange().collapsed}function m(c){var b=B.getCursor(a).getSelectedRange();b.collapsed?c.preventDefault():W.setDataFromRange(c,b)||runtime.log("Copy operation failed")}function q(a){var c;C.clipboardData&&C.clipboardData.getData?c=C.clipboardData.getData("Text"):a.clipboardData&&a.clipboardData.getData&&(c=a.clipboardData.getData("text/plain"));
c&&(ea.removeCurrentSelection(),fa.paste(c));a.preventDefault?a.preventDefault():a.returnValue=!1}function c(){return!1}function f(a){if(S)S.onOperationExecuted(a)}function r(a){B.emit(ops.OdtDocument.signalUndoStackChanged,a)}function k(){var a;return S?(a=Q.hasFocus(),S.moveBackward(1),a&&Q.focus(),!0):!1}function u(){var a;return S?(a=Q.hasFocus(),S.moveForward(1),a&&Q.focus(),!0):!1}function v(c){var b=B.getCursor(a).getSelectedRange(),f=l(c).getAttribute("end");b&&f&&(c=n(c.clientX,c.clientY))&&
(ha.setUnfilteredPosition(c.container,c.offset),U.acceptPosition(ha)===e&&(b=b.cloneRange(),"left"===f?b.setStart(ha.container(),ha.unfilteredDomOffset()):b.setEnd(ha.container(),ha.unfilteredDomOffset()),d.setSelectedRange(b,"right"===f),B.emit(ops.Document.signalCursorMoved,d)))}function z(){V.selectRange(d.getSelectedRange(),d.hasForwardSelection(),1)}function w(){var a=C.getSelection(),c=0<a.rangeCount&&V.selectionToRange(a);Z&&c&&(aa=!0,ka.clearSelection(),ha.setUnfilteredPosition(a.focusNode,
a.focusOffset),U.acceptPosition(ha)===e&&(2===na?V.expandToWordBoundaries(c.range):3<=na&&V.expandToParagraphBoundaries(c.range),d.setSelectedRange(c.range,c.hasForwardSelection),B.emit(ops.Document.signalCursorMoved,d)))}function t(c){var b=l(c),f=B.getCursor(a);if(Z=null!==b&&ba.containsNode(B.getOdfCanvas().getElement(),b))aa=!1,b=B.getRootElement(b)||B.getRootNode(),U=B.createRootFilter(b),na=0===c.button?c.detail:0,f&&c.shiftKey?C.getSelection().collapse(f.getAnchorNode(),0):(c=C.getSelection(),
b=f.getSelectedRange(),c.extend?f.hasForwardSelection()?(c.collapse(b.startContainer,b.startOffset),c.extend(b.endContainer,b.endOffset)):(c.collapse(b.endContainer,b.endOffset),c.extend(b.startContainer,b.startOffset)):(c.removeAllRanges(),c.addRange(b.cloneRange()))),1<na&&w()}function A(a){var c=B.getRootElement(a),b=B.createRootFilter(c),c=B.createStepIterator(a,0,[b,B.getPositionFilter()],c);c.setPosition(a,a.childNodes.length);return c.roundToNextStep()?{container:c.container(),offset:c.offset()}:
null}function x(a){var c;c=(c=C.getSelection())?{anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}:null;var b=C.getSelection().isCollapsed,f,d;c.anchorNode||c.focusNode||!(f=n(a.clientX,a.clientY))||(c.anchorNode=f.container,c.anchorOffset=f.offset,c.focusNode=c.anchorNode,c.focusOffset=c.anchorOffset);if(ca.isImage(c.focusNode)&&0===c.focusOffset&&ca.isCharacterFrame(c.focusNode.parentNode)){if(d=c.focusNode.parentNode,f=d.getBoundingClientRect(),
a.clientX>f.left&&(f=A(d)))c.focusNode=f.container,c.focusOffset=f.offset,b&&(c.anchorNode=c.focusNode,c.anchorOffset=c.focusOffset)}else ca.isImage(c.focusNode.firstChild)&&1===c.focusOffset&&ca.isCharacterFrame(c.focusNode)&&(f=A(c.focusNode))&&(c.anchorNode=c.focusNode=f.container,c.anchorOffset=c.focusOffset=f.offset);c.anchorNode&&c.focusNode&&(c=V.selectionToRange(c),V.selectRange(c.range,c.hasForwardSelection,0===a.button?a.detail:0));Q.focus()}function E(a){var c;if(c=n(a.clientX,a.clientY))a=
c.container,c=c.offset,a={anchorNode:a,anchorOffset:c,focusNode:a,focusOffset:c},a=V.selectionToRange(a),V.selectRange(a.range,a.hasForwardSelection,2),Q.focus()}function N(a){var c=l(a),b,f,e;la.processRequests();Z&&(ca.isImage(c)&&ca.isCharacterFrame(c.parentNode)&&C.getSelection().isCollapsed?(V.selectImage(c.parentNode),Q.focus()):ka.isSelectorElement(c)?Q.focus():aa?(c=d.getSelectedRange(),f=c.collapsed,ca.isImage(c.endContainer)&&0===c.endOffset&&ca.isCharacterFrame(c.endContainer.parentNode)&&
(e=c.endContainer.parentNode,e=A(e))&&(c.setEnd(e.container,e.offset),f&&c.collapse(!1)),V.selectRange(c,d.hasForwardSelection(),0===a.button?a.detail:0),Q.focus()):ua?x(a):(b=ba.cloneEvent(a),R=runtime.setTimeout(function(){x(b)},0)),na=0,aa=Z=!1)}function I(c){var b=B.getCursor(a).getSelectedRange();b.collapsed||da.exportRangeToDataTransfer(c.dataTransfer,b)}function H(){Z&&Q.focus();na=0;aa=Z=!1}function F(a){N(a)}function G(a){var c=l(a),b=null;"annotationRemoveButton"===c.className?(runtime.assert(ia,
"Remove buttons are displayed on annotations while annotation editing is disabled in the controller."),b=c.parentNode.getElementsByTagNameNS(odf.Namespaces.officens,"annotation").item(0),X.removeAnnotation(b),Q.focus()):"webodf-draggable"!==c.getAttribute("class")&&N(a)}function s(a){(a=a.data)&&(-1===a.indexOf("\n")?ea.insertText(a):fa.paste(a))}function y(a){return function(){a();return!0}}function D(c){return function(b){return B.getCursor(a).getSelectionType()===ops.OdtCursor.RangeSelection?c(b):
!0}}function T(a){Q.unsubscribe("keydown",J.handleEvent);Q.unsubscribe("keypress",Y.handleEvent);Q.unsubscribe("keyup",ga.handleEvent);Q.unsubscribe("copy",m);Q.unsubscribe("mousedown",t);Q.unsubscribe("mousemove",la.trigger);Q.unsubscribe("mouseup",G);Q.unsubscribe("contextmenu",F);Q.unsubscribe("dragstart",I);Q.unsubscribe("dragend",H);Q.unsubscribe("click",oa.handleClick);Q.unsubscribe("longpress",E);Q.unsubscribe("drag",v);Q.unsubscribe("dragstop",z);B.unsubscribe(ops.OdtDocument.signalOperationEnd,
ma.trigger);B.unsubscribe(ops.Document.signalCursorAdded,ja.registerCursor);B.unsubscribe(ops.Document.signalCursorRemoved,ja.removeCursor);B.unsubscribe(ops.OdtDocument.signalOperationEnd,f);a()}var C=runtime.getWindow(),B=g.getOdtDocument(),P=new gui.SessionConstraints,O=new gui.SessionContext(g,a),ba=core.DomUtils,ca=odf.OdfUtils,da=new gui.MimeDataExporter,W=new gui.Clipboard(da),J=new gui.KeyboardHandler,Y=new gui.KeyboardHandler,ga=new gui.KeyboardHandler,Z=!1,K=new odf.ObjectNameGenerator(B.getOdfCanvas().odfContainer(),
a),aa=!1,U=null,R,S=null,Q=new gui.EventManager(B),ia=b.annotationsEnabled,X=new gui.AnnotationController(g,P,a),$=new gui.DirectFormattingController(g,P,O,a,K,b.directTextStylingEnabled,b.directParagraphStylingEnabled),ea=new gui.TextController(g,P,O,a,$.createCursorStyleOp,$.createParagraphStyleOps),pa=new gui.ImageController(g,P,O,a,K),ka=new gui.ImageSelector(B.getOdfCanvas()),ha=B.createPositionIterator(B.getRootNode()),la,ma,fa=new gui.PasteController(g,P,O,a),ja=new gui.InputMethodEditor(a,
Q),na=0,oa=new gui.HyperlinkClickHandler(B.getOdfCanvas().getElement,J,ga),sa=new gui.HyperlinkController(g,P,O,a),V=new gui.SelectionController(g,a),ta=new gui.MetadataController(g,a),L=gui.KeyboardHandler.Modifier,M=gui.KeyboardHandler.KeyCode,qa=-1!==C.navigator.appVersion.toLowerCase().indexOf("mac"),ua=-1!==["iPad","iPod","iPhone"].indexOf(C.navigator.platform),ra;runtime.assert(null!==C,"Expected to be run in an environment which has a global window, like a browser.");this.undo=k;this.redo=
u;this.insertLocalCursor=function(){runtime.assert(void 0===g.getOdtDocument().getCursor(a),"Inserting local cursor a second time.");var c=new ops.OpAddCursor;c.init({memberid:a});g.enqueue([c]);Q.focus()};this.removeLocalCursor=function(){runtime.assert(void 0!==g.getOdtDocument().getCursor(a),"Removing local cursor without inserting before.");var c=new ops.OpRemoveCursor;c.init({memberid:a});g.enqueue([c])};this.startEditing=function(){ja.subscribe(gui.InputMethodEditor.signalCompositionStart,ea.removeCurrentSelection);
ja.subscribe(gui.InputMethodEditor.signalCompositionEnd,s);Q.subscribe("beforecut",p);Q.subscribe("cut",h);Q.subscribe("beforepaste",c);Q.subscribe("paste",q);S&&S.initialize();Q.setEditing(!0);oa.setModifier(qa?L.Meta:L.Ctrl);J.bind(M.Backspace,L.None,y(ea.removeTextByBackspaceKey),!0);J.bind(M.Delete,L.None,ea.removeTextByDeleteKey);J.bind(M.Tab,L.None,D(function(){ea.insertText("\t");return!0}));qa?(J.bind(M.Clear,L.None,ea.removeCurrentSelection),J.bind(M.B,L.Meta,D($.toggleBold)),J.bind(M.I,
L.Meta,D($.toggleItalic)),J.bind(M.U,L.Meta,D($.toggleUnderline)),J.bind(M.L,L.MetaShift,D($.alignParagraphLeft)),J.bind(M.E,L.MetaShift,D($.alignParagraphCenter)),J.bind(M.R,L.MetaShift,D($.alignParagraphRight)),J.bind(M.J,L.MetaShift,D($.alignParagraphJustified)),ia&&J.bind(M.C,L.MetaShift,X.addAnnotation),J.bind(M.Z,L.Meta,k),J.bind(M.Z,L.MetaShift,u)):(J.bind(M.B,L.Ctrl,D($.toggleBold)),J.bind(M.I,L.Ctrl,D($.toggleItalic)),J.bind(M.U,L.Ctrl,D($.toggleUnderline)),J.bind(M.L,L.CtrlShift,D($.alignParagraphLeft)),
J.bind(M.E,L.CtrlShift,D($.alignParagraphCenter)),J.bind(M.R,L.CtrlShift,D($.alignParagraphRight)),J.bind(M.J,L.CtrlShift,D($.alignParagraphJustified)),ia&&J.bind(M.C,L.CtrlAlt,X.addAnnotation),J.bind(M.Z,L.Ctrl,k),J.bind(M.Z,L.CtrlShift,u));Y.setDefault(D(function(a){var c;c=null===a.which||void 0===a.which?String.fromCharCode(a.keyCode):0!==a.which&&0!==a.charCode?String.fromCharCode(a.which):null;return!c||a.altKey||a.ctrlKey||a.metaKey?!1:(ea.insertText(c),!0)}));Y.bind(M.Enter,L.None,D(ea.enqueueParagraphSplittingOps))};
this.endEditing=function(){ja.unsubscribe(gui.InputMethodEditor.signalCompositionStart,ea.removeCurrentSelection);ja.unsubscribe(gui.InputMethodEditor.signalCompositionEnd,s);Q.unsubscribe("cut",h);Q.unsubscribe("beforecut",p);Q.unsubscribe("paste",q);Q.unsubscribe("beforepaste",c);Q.setEditing(!1);oa.setModifier(L.None);J.bind(M.Backspace,L.None,function(){return!0},!0);J.unbind(M.Delete,L.None);J.unbind(M.Tab,L.None);qa?(J.unbind(M.Clear,L.None),J.unbind(M.B,L.Meta),J.unbind(M.I,L.Meta),J.unbind(M.U,
L.Meta),J.unbind(M.L,L.MetaShift),J.unbind(M.E,L.MetaShift),J.unbind(M.R,L.MetaShift),J.unbind(M.J,L.MetaShift),ia&&J.unbind(M.C,L.MetaShift),J.unbind(M.Z,L.Meta),J.unbind(M.Z,L.MetaShift)):(J.unbind(M.B,L.Ctrl),J.unbind(M.I,L.Ctrl),J.unbind(M.U,L.Ctrl),J.unbind(M.L,L.CtrlShift),J.unbind(M.E,L.CtrlShift),J.unbind(M.R,L.CtrlShift),J.unbind(M.J,L.CtrlShift),ia&&J.unbind(M.C,L.CtrlAlt),J.unbind(M.Z,L.Ctrl),J.unbind(M.Z,L.CtrlShift));Y.setDefault(null);Y.unbind(M.Enter,L.None)};this.getInputMemberId=
function(){return a};this.getSession=function(){return g};this.getSessionConstraints=function(){return P};this.setUndoManager=function(a){S&&S.unsubscribe(gui.UndoManager.signalUndoStackChanged,r);if(S=a)S.setDocument(B),S.setPlaybackFunction(g.enqueue),S.subscribe(gui.UndoManager.signalUndoStackChanged,r)};this.getUndoManager=function(){return S};this.getMetadataController=function(){return ta};this.getAnnotationController=function(){return X};this.getDirectFormattingController=function(){return $};
this.getHyperlinkClickHandler=function(){return oa};this.getHyperlinkController=function(){return sa};this.getImageController=function(){return pa};this.getSelectionController=function(){return V};this.getTextController=function(){return ea};this.getEventManager=function(){return Q};this.getKeyboardHandlers=function(){return{keydown:J,keypress:Y}};this.destroy=function(a){var c=[la.destroy,ma.destroy,$.destroy,ja.destroy,Q.destroy,oa.destroy,sa.destroy,ta.destroy,V.destroy,ea.destroy,T];ra&&c.unshift(ra.destroy);
runtime.clearTimeout(R);core.Async.destroyAll(c,a)};la=core.Task.createRedrawTask(w);ma=core.Task.createRedrawTask(function(){var c=B.getCursor(a);if(c&&c.getSelectionType()===ops.OdtCursor.RegionSelection&&(c=ca.getImageElements(c.getSelectedRange())[0])){ka.select(c.parentNode);return}ka.clearSelection()});J.bind(M.Left,L.None,D(V.moveCursorToLeft));J.bind(M.Right,L.None,D(V.moveCursorToRight));J.bind(M.Up,L.None,D(V.moveCursorUp));J.bind(M.Down,L.None,D(V.moveCursorDown));J.bind(M.Left,L.Shift,
D(V.extendSelectionToLeft));J.bind(M.Right,L.Shift,D(V.extendSelectionToRight));J.bind(M.Up,L.Shift,D(V.extendSelectionUp));J.bind(M.Down,L.Shift,D(V.extendSelectionDown));J.bind(M.Home,L.None,D(V.moveCursorToLineStart));J.bind(M.End,L.None,D(V.moveCursorToLineEnd));J.bind(M.Home,L.Ctrl,D(V.moveCursorToDocumentStart));J.bind(M.End,L.Ctrl,D(V.moveCursorToDocumentEnd));J.bind(M.Home,L.Shift,D(V.extendSelectionToLineStart));J.bind(M.End,L.Shift,D(V.extendSelectionToLineEnd));J.bind(M.Up,L.CtrlShift,
D(V.extendSelectionToParagraphStart));J.bind(M.Down,L.CtrlShift,D(V.extendSelectionToParagraphEnd));J.bind(M.Home,L.CtrlShift,D(V.extendSelectionToDocumentStart));J.bind(M.End,L.CtrlShift,D(V.extendSelectionToDocumentEnd));qa?(J.bind(M.Left,L.Alt,D(V.moveCursorBeforeWord)),J.bind(M.Right,L.Alt,D(V.moveCursorPastWord)),J.bind(M.Left,L.Meta,D(V.moveCursorToLineStart)),J.bind(M.Right,L.Meta,D(V.moveCursorToLineEnd)),J.bind(M.Home,L.Meta,D(V.moveCursorToDocumentStart)),J.bind(M.End,L.Meta,D(V.moveCursorToDocumentEnd)),
J.bind(M.Left,L.AltShift,D(V.extendSelectionBeforeWord)),J.bind(M.Right,L.AltShift,D(V.extendSelectionPastWord)),J.bind(M.Left,L.MetaShift,D(V.extendSelectionToLineStart)),J.bind(M.Right,L.MetaShift,D(V.extendSelectionToLineEnd)),J.bind(M.Up,L.AltShift,D(V.extendSelectionToParagraphStart)),J.bind(M.Down,L.AltShift,D(V.extendSelectionToParagraphEnd)),J.bind(M.Up,L.MetaShift,D(V.extendSelectionToDocumentStart)),J.bind(M.Down,L.MetaShift,D(V.extendSelectionToDocumentEnd)),J.bind(M.A,L.Meta,D(V.extendSelectionToEntireDocument))):
(J.bind(M.Left,L.Ctrl,D(V.moveCursorBeforeWord)),J.bind(M.Right,L.Ctrl,D(V.moveCursorPastWord)),J.bind(M.Left,L.CtrlShift,D(V.extendSelectionBeforeWord)),J.bind(M.Right,L.CtrlShift,D(V.extendSelectionPastWord)),J.bind(M.A,L.Ctrl,D(V.extendSelectionToEntireDocument)));ua&&(ra=new gui.IOSSafariSupport(Q));Q.subscribe("keydown",J.handleEvent);Q.subscribe("keypress",Y.handleEvent);Q.subscribe("keyup",ga.handleEvent);Q.subscribe("copy",m);Q.subscribe("mousedown",t);Q.subscribe("mousemove",la.trigger);
Q.subscribe("mouseup",G);Q.subscribe("contextmenu",F);Q.subscribe("dragstart",I);Q.subscribe("dragend",H);Q.subscribe("click",oa.handleClick);Q.subscribe("longpress",E);Q.subscribe("drag",v);Q.subscribe("dragstop",z);B.subscribe(ops.OdtDocument.signalOperationEnd,ma.trigger);B.subscribe(ops.Document.signalCursorAdded,ja.registerCursor);B.subscribe(ops.Document.signalCursorRemoved,ja.removeCursor);B.subscribe(ops.OdtDocument.signalOperationEnd,f)}})();
gui.CaretManager=function(e,g){function a(a){return l.hasOwnProperty(a)?l[a]:null}function d(){return Object.keys(l).map(function(a){return l[a]})}function b(a){var b=l[a];b&&(delete l[a],a===e.getInputMemberId()?(h.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,b.ensureVisible),h.unsubscribe(ops.Document.signalCursorMoved,b.refreshCursorBlinking),p.unsubscribe("compositionupdate",b.handleUpdate),p.unsubscribe("compositionend",b.handleUpdate),p.unsubscribe("focus",b.setFocus),p.unsubscribe("blur",
b.removeFocus),n.removeEventListener("focus",b.show,!1),n.removeEventListener("blur",b.hide,!1)):h.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,b.handleUpdate),b.destroy(function(){}))}var l={},n=runtime.getWindow(),h=e.getSession().getOdtDocument(),p=e.getEventManager();this.registerCursor=function(a,b,c){var f=a.getMemberId();a=new gui.Caret(a,g,b,c);l[f]=a;f===e.getInputMemberId()?(runtime.log("Starting to track input on new cursor of "+f),h.subscribe(ops.OdtDocument.signalProcessingBatchEnd,
a.ensureVisible),h.subscribe(ops.Document.signalCursorMoved,a.refreshCursorBlinking),p.subscribe("compositionupdate",a.handleUpdate),p.subscribe("compositionend",a.handleUpdate),p.subscribe("focus",a.setFocus),p.subscribe("blur",a.removeFocus),n.addEventListener("focus",a.show,!1),n.addEventListener("blur",a.hide,!1),a.setOverlayElement(p.getEventTrap())):h.subscribe(ops.OdtDocument.signalProcessingBatchEnd,a.handleUpdate);return a};this.getCaret=a;this.getCarets=d;this.destroy=function(a){var g=
d().map(function(a){return a.destroy});e.getSelectionController().setCaretXPositionLocator(null);h.unsubscribe(ops.Document.signalCursorRemoved,b);l={};core.Async.destroyAll(g,a)};e.getSelectionController().setCaretXPositionLocator(function(){var b=a(e.getInputMemberId()),d;b&&(d=b.getBoundingClientRect());return d?d.right:void 0});h.subscribe(ops.Document.signalCursorRemoved,b)};
gui.EditInfoHandle=function(e){var g=[],a,d=e.ownerDocument,b=d.documentElement.namespaceURI;this.setEdits=function(e){g=e;var n,h,p,m;a.innerHTML="";for(e=0;e<g.length;e+=1)n=d.createElementNS(b,"div"),n.className="editInfo",h=d.createElementNS(b,"span"),h.className="editInfoColor",h.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",g[e].memberid),p=d.createElementNS(b,"span"),p.className="editInfoAuthor",p.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",g[e].memberid),
m=d.createElementNS(b,"span"),m.className="editInfoTime",m.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",g[e].memberid),m.innerHTML=g[e].time,n.appendChild(h),n.appendChild(p),n.appendChild(m),a.appendChild(n)};this.show=function(){a.style.display="block"};this.hide=function(){a.style.display="none"};this.destroy=function(b){e.removeChild(a);b()};a=d.createElementNS(b,"div");a.setAttribute("class","editInfoHandle");a.style.display="none";e.appendChild(a)};
ops.EditInfo=function(e,g){function a(){var a=[],d;for(d in b)b.hasOwnProperty(d)&&a.push({memberid:d,time:b[d].time});a.sort(function(a,b){return a.time-b.time});return a}var d,b={};this.getNode=function(){return d};this.getOdtDocument=function(){return g};this.getEdits=function(){return b};this.getSortedEdits=function(){return a()};this.addEdit=function(a,d){b[a]={time:d}};this.clearEdits=function(){b={}};this.destroy=function(a){e.parentNode&&e.removeChild(d);a()};d=g.getDOMDocument().createElementNS("urn:webodf:names:editinfo",
"editinfo");e.insertBefore(d,e.firstChild)};
gui.EditInfoMarker=function(e,g){function a(a,c){return runtime.setTimeout(function(){n.style.opacity=a},c)}var d=this,b,l,n,h,p,m;this.addEdit=function(b,c){var f=Date.now()-c;e.addEdit(b,c);l.setEdits(e.getSortedEdits());n.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",b);runtime.clearTimeout(p);runtime.clearTimeout(m);1E4>f?(h=a(1,0),p=a(.5,1E4-f),m=a(.2,2E4-f)):1E4<=f&&2E4>f?(h=a(.5,0),m=a(.2,2E4-f)):h=a(.2,0)};this.getEdits=function(){return e.getEdits()};this.clearEdits=function(){e.clearEdits();
l.setEdits([]);n.hasAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")&&n.removeAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")};this.getEditInfo=function(){return e};this.show=function(){n.style.display="block"};this.hide=function(){d.hideHandle();n.style.display="none"};this.showHandle=function(){l.show()};this.hideHandle=function(){l.hide()};this.destroy=function(a){runtime.clearTimeout(h);runtime.clearTimeout(p);runtime.clearTimeout(m);b.removeChild(n);l.destroy(function(c){c?
a(c):e.destroy(a)})};(function(){var a=e.getOdtDocument().getDOMDocument();n=a.createElementNS(a.documentElement.namespaceURI,"div");n.setAttribute("class","editInfoMarker");n.onmouseover=function(){d.showHandle()};n.onmouseout=function(){d.hideHandle()};b=e.getNode();b.appendChild(n);l=new gui.EditInfoHandle(b);g||d.hide()})()};
gui.HyperlinkTooltipView=function(e,g){var a=core.DomUtils,d=odf.OdfUtils,b=runtime.getWindow(),l,n,h;runtime.assert(null!==b,"Expected to be run in an environment which has a global window, like a browser.");this.showTooltip=function(p){var m=p.target||p.srcElement,q=e.getSizer(),c=e.getZoomLevel(),f;a:{for(;m;){if(d.isHyperlink(m))break a;if(d.isParagraph(m)||d.isInlineRoot(m))break;m=m.parentNode}m=null}if(m){a.containsNode(q,h)||q.appendChild(h);f=n;var r;if(g)switch(g()){case gui.KeyboardHandler.Modifier.Ctrl:r=
runtime.tr("Ctrl-click to follow link");break;case gui.KeyboardHandler.Modifier.Meta:r=runtime.tr("\u2318-click to follow link");break;default:r=""}else r="";f.textContent=r;l.textContent=d.getHyperlinkTarget(m);h.style.display="block";f=b.innerWidth-h.offsetWidth-15;m=p.clientX>f?f:p.clientX+15;f=b.innerHeight-h.offsetHeight-10;p=p.clientY>f?f:p.clientY+10;q=q.getBoundingClientRect();m=(m-q.left)/c;p=(p-q.top)/c;h.style.left=m+"px";h.style.top=p+"px"}};this.hideTooltip=function(){h.style.display=
"none"};this.destroy=function(a){h.parentNode&&h.parentNode.removeChild(h);a()};(function(){var a=e.getElement().ownerDocument;l=a.createElement("span");n=a.createElement("span");l.className="webodf-hyperlinkTooltipLink";n.className="webodf-hyperlinkTooltipText";h=a.createElement("div");h.className="webodf-hyperlinkTooltip";h.appendChild(l);h.appendChild(n);e.getElement().appendChild(h)})()};
gui.OdfFieldView=function(e){function g(){var a=odf.OdfSchema.getFields().map(function(a){return a.replace(":","|")}),d=a.join(",\n")+"\n{ background-color: #D0D0D0; }\n",a=a.map(function(a){return a+":empty::after"}).join(",\n")+"\n{ content:' '; white-space: pre; }\n";return d+"\n"+a}var a,d=e.getElement().ownerDocument;this.showFieldHighlight=function(){a.appendChild(d.createTextNode(g()))};this.hideFieldHighlight=function(){for(var b=a.sheet,d=b.cssRules;d.length;)b.deleteRule(d.length-1)};this.destroy=
function(b){a.parentNode&&a.parentNode.removeChild(a);b()};a=function(){var a=d.getElementsByTagName("head").item(0),e=d.createElement("style"),g="";e.type="text/css";e.media="screen, print, handheld, projection";odf.Namespaces.forEachPrefix(function(a,b){g+="@namespace "+a+" url("+b+");\n"});e.appendChild(d.createTextNode(g));a.appendChild(e);return e}()};
gui.ShadowCursor=function(e){var g=e.getDOMDocument().createRange(),a=!0;this.removeFromDocument=function(){};this.getMemberId=function(){return gui.ShadowCursor.ShadowCursorMemberId};this.getSelectedRange=function(){return g};this.setSelectedRange=function(d,b){g=d;a=!1!==b};this.hasForwardSelection=function(){return a};this.getDocument=function(){return e};this.getSelectionType=function(){return ops.OdtCursor.RangeSelection};g.setStart(e.getRootNode(),0)};gui.ShadowCursor.ShadowCursorMemberId="";
gui.SelectionView=function(e){};gui.SelectionView.prototype.rerender=function(){};gui.SelectionView.prototype.show=function(){};gui.SelectionView.prototype.hide=function(){};gui.SelectionView.prototype.destroy=function(e){};
gui.SelectionViewManager=function(e){function g(){return Object.keys(a).map(function(d){return a[d]})}var a={};this.getSelectionView=function(d){return a.hasOwnProperty(d)?a[d]:null};this.getSelectionViews=g;this.removeSelectionView=function(d){a.hasOwnProperty(d)&&(a[d].destroy(function(){}),delete a[d])};this.hideSelectionView=function(d){a.hasOwnProperty(d)&&a[d].hide()};this.showSelectionView=function(d){a.hasOwnProperty(d)&&a[d].show()};this.rerenderSelectionViews=function(){Object.keys(a).forEach(function(d){a[d].rerender()})};
this.registerCursor=function(d,b){var g=d.getMemberId(),n=new e(d);b?n.show():n.hide();return a[g]=n};this.destroy=function(a){function b(g,h){h?a(h):g<e.length?e[g].destroy(function(a){b(g+1,a)}):a()}var e=g();b(0,void 0)}};gui.SessionViewOptions=function(){this.caretBlinksOnRangeSelect=this.caretAvatarsInitiallyVisible=this.editInfoMarkersInitiallyVisible=!0};
(function(){function e(e,a){return void 0!==e?Boolean(e):a}gui.SessionView=function(g,a,d,b,l,n){function h(c){c.memberId===a&&N.getViewport().scrollIntoView(c.annotation.getBoundingClientRect())}function p(){var a=document.getElementsByTagName("head").item(0),c=document.createElement("style");c.type="text/css";c.media="screen, print, handheld, projection";a.appendChild(c);return c}function m(c,b,f){function d(a,b,f){b=a+'[editinfo|memberid="'+c+'"]'+f+b;a:{var e=t.firstChild;for(a=a+'[editinfo|memberid="'+
c+'"]'+f+"{";e;){if(e.nodeType===Node.TEXT_NODE&&0===e.data.indexOf(a)){a=e;break a}e=e.nextSibling}a=null}a?a.data=b:t.appendChild(document.createTextNode(b))}d("div.editInfoMarker","{ background-color: "+f+"; }","");d("span.editInfoColor","{ background-color: "+f+"; }","");d("span.editInfoAuthor",'{ content: "'+b+'"; }',":before");d("dc|creator","{ background-color: "+f+"; }","");d(".webodf-selectionOverlay","{ fill: "+f+"; stroke: "+f+";}","");c===a&&(d(".webodf-touchEnabled .webodf-selectionOverlay",
"{ display: block; }"," > .webodf-draggable"),c=gui.ShadowCursor.ShadowCursorMemberId,d(".webodf-selectionOverlay","{ fill: "+f+"; stroke: "+f+";}",""),d(".webodf-touchEnabled .webodf-selectionOverlay","{ display: block; }"," > .webodf-draggable"))}function q(a){var c,b;for(b in x)x.hasOwnProperty(b)&&(c=x[b],a?c.show():c.hide())}function c(a){l.getCarets().forEach(function(c){a?c.showHandle():c.hideHandle()})}function f(a){var c=a.getMemberId();a=a.getProperties();m(c,a.fullName,a.color)}function r(a){var c=
a.getMemberId(),b=d.getOdtDocument().getMember(c).getProperties();l.registerCursor(a,F,G);n.registerCursor(a,!0);if(a=l.getCaret(c))a.setAvatarImageUrl(b.imageUrl),a.setColor(b.color);runtime.log("+++ View here +++ eagerly created an Caret for '"+c+"'! +++")}function k(c){c=c.getMemberId();var b=n.getSelectionView(a),f=n.getSelectionView(gui.ShadowCursor.ShadowCursorMemberId),d=l.getCaret(a);c===a?(f.hide(),b&&b.show(),d&&d.show()):c===gui.ShadowCursor.ShadowCursorMemberId&&(f.show(),b&&b.hide(),
d&&d.hide())}function u(a){n.removeSelectionView(a)}function v(a){var c=a.paragraphElement,b=a.memberId;a=a.timeStamp;var f,e="",g=c.getElementsByTagNameNS("urn:webodf:names:editinfo","editinfo").item(0);g?(e=g.getAttributeNS("urn:webodf:names:editinfo","id"),f=x[e]):(e=Math.random().toString(),f=new ops.EditInfo(c,d.getOdtDocument()),f=new gui.EditInfoMarker(f,H),g=c.getElementsByTagNameNS("urn:webodf:names:editinfo","editinfo").item(0),g.setAttributeNS("urn:webodf:names:editinfo","id",e),x[e]=f);
f.addEdit(b,new Date(a));I.trigger()}function z(){var c;""!==A.innerHTML&&(A.innerHTML="");!0===b.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)&&(c=d.getOdtDocument().getMember(a))&&(c=c.getProperties().fullName,A.appendChild(document.createTextNode(".annotationWrapper:not([creator = '"+c+"']) .annotationRemoveButton { display: none; }")))}function w(a){var c=Object.keys(x).map(function(a){return x[a]});E.unsubscribe(ops.Document.signalMemberAdded,f);E.unsubscribe(ops.Document.signalMemberUpdated,
f);E.unsubscribe(ops.Document.signalCursorAdded,r);E.unsubscribe(ops.Document.signalCursorRemoved,u);E.unsubscribe(ops.OdtDocument.signalParagraphChanged,v);E.unsubscribe(ops.Document.signalCursorMoved,k);E.unsubscribe(ops.OdtDocument.signalParagraphChanged,n.rerenderSelectionViews);E.unsubscribe(ops.OdtDocument.signalTableAdded,n.rerenderSelectionViews);E.unsubscribe(ops.OdtDocument.signalParagraphStyleModified,n.rerenderSelectionViews);b.unsubscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,
z);E.unsubscribe(ops.Document.signalMemberAdded,z);E.unsubscribe(ops.Document.signalMemberUpdated,z);t.parentNode.removeChild(t);A.parentNode.removeChild(A);(function T(b,f){f?a(f):b<c.length?c[b].destroy(function(a){T(b+1,a)}):a()})(0,void 0)}var t,A,x={},E,N,I,H=e(g.editInfoMarkersInitiallyVisible,!0),F=e(g.caretAvatarsInitiallyVisible,!0),G=e(g.caretBlinksOnRangeSelect,!0);this.showEditInfoMarkers=function(){H||(H=!0,q(H))};this.hideEditInfoMarkers=function(){H&&(H=!1,q(H))};this.showCaretAvatars=
function(){F||(F=!0,c(F))};this.hideCaretAvatars=function(){F&&(F=!1,c(F))};this.getSession=function(){return d};this.getCaret=function(a){return l.getCaret(a)};this.destroy=function(a){var c=[I.destroy,w];E.unsubscribe(ops.OdtDocument.signalAnnotationAdded,h);core.Async.destroyAll(c,a)};E=d.getOdtDocument();N=E.getOdfCanvas();E.subscribe(ops.OdtDocument.signalAnnotationAdded,h);E.subscribe(ops.Document.signalMemberAdded,f);E.subscribe(ops.Document.signalMemberUpdated,f);E.subscribe(ops.Document.signalCursorAdded,
r);E.subscribe(ops.Document.signalCursorRemoved,u);E.subscribe(ops.OdtDocument.signalParagraphChanged,v);E.subscribe(ops.Document.signalCursorMoved,k);E.subscribe(ops.OdtDocument.signalParagraphChanged,n.rerenderSelectionViews);E.subscribe(ops.OdtDocument.signalTableAdded,n.rerenderSelectionViews);E.subscribe(ops.OdtDocument.signalParagraphStyleModified,n.rerenderSelectionViews);b.subscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,z);E.subscribe(ops.Document.signalMemberAdded,z);E.subscribe(ops.Document.signalMemberUpdated,
z);t=p();t.appendChild(document.createTextNode("@namespace editinfo url(urn:webodf:names:editinfo);"));t.appendChild(document.createTextNode("@namespace dc url(http://purl.org/dc/elements/1.1/);"));A=p();z();I=core.Task.createRedrawTask(function(){var a=N.getAnnotationViewManager();a&&(a.rehighlightAnnotations(),E.fixCursorPositions())})}})();
gui.SvgSelectionView=function(e){function g(){var a=f.getRootNode();r!==a&&(r=a,k=f.getCanvas().getSizer(),k.appendChild(v),v.setAttribute("class","webodf-selectionOverlay"),w.setAttribute("class","webodf-draggable"),t.setAttribute("class","webodf-draggable"),w.setAttribute("end","left"),t.setAttribute("end","right"),w.setAttribute("r",8),t.setAttribute("r",8),v.appendChild(z),v.appendChild(w),v.appendChild(t))}function a(a){a=a.getBoundingClientRect();return Boolean(a&&0!==a.height)}function d(c){var b=
A.getTextElements(c,!0,!1),f=c.cloneRange(),d=c.cloneRange();c=c.cloneRange();if(!b.length)return null;var e;a:{e=0;var g=b[e],k=f.startContainer===g?f.startOffset:0,h=k;f.setStart(g,k);for(f.setEnd(g,h);!a(f);){if(g.nodeType===Node.ELEMENT_NODE&&h<g.childNodes.length)h=g.childNodes.length;else if(g.nodeType===Node.TEXT_NODE&&h<g.length)h+=1;else if(b[e])g=b[e],e+=1,k=h=0;else{e=!1;break a}f.setStart(g,k);f.setEnd(g,h)}e=!0}if(!e)return null;a:{e=b.length-1;g=b[e];h=k=d.endContainer===g?d.endOffset:
g.nodeType===Node.TEXT_NODE?g.length:g.childNodes.length;d.setStart(g,k);for(d.setEnd(g,h);!a(d);){if(g.nodeType===Node.ELEMENT_NODE&&0<k)k=0;else if(g.nodeType===Node.TEXT_NODE&&0<k)k-=1;else if(b[e])g=b[e],e-=1,k=h=g.length||g.childNodes.length;else{b=!1;break a}d.setStart(g,k);d.setEnd(g,h)}b=!0}if(!b)return null;c.setStart(f.startContainer,f.startOffset);c.setEnd(d.endContainer,d.endOffset);return{firstRange:f,lastRange:d,fillerRange:c}}function b(a,c){var b={};b.top=Math.min(a.top,c.top);b.left=
Math.min(a.left,c.left);b.right=Math.max(a.right,c.right);b.bottom=Math.max(a.bottom,c.bottom);b.width=b.right-b.left;b.height=b.bottom-b.top;return b}function l(a,c){c&&0<c.width&&0<c.height&&(a=a?b(a,c):c);return a}function n(a){function c(a){I.setUnfilteredPosition(a,0);return t.acceptNode(a)===H&&v.acceptPosition(I)===H?H:F}function b(a){var f=null;c(a)===H&&(f=x.getBoundingClientRect(a));return f}var d=a.commonAncestorContainer,e=a.startContainer,g=a.endContainer,k=a.startOffset,h=a.endOffset,
m,n,r=null,p,q=u.createRange(),v,t=new odf.OdfNodeFilter,w;if(e===d||g===d)return q=a.cloneRange(),r=q.getBoundingClientRect(),q.detach(),r;for(a=e;a.parentNode!==d;)a=a.parentNode;for(n=g;n.parentNode!==d;)n=n.parentNode;v=f.createRootFilter(e);for(d=a.nextSibling;d&&d!==n;)p=b(d),r=l(r,p),d=d.nextSibling;if(A.isParagraph(a))r=l(r,x.getBoundingClientRect(a));else if(a.nodeType===Node.TEXT_NODE)d=a,q.setStart(d,k),q.setEnd(d,d===n?h:d.length),p=q.getBoundingClientRect(),r=l(r,p);else for(w=u.createTreeWalker(a,
NodeFilter.SHOW_TEXT,c,!1),d=w.currentNode=e;d&&d!==g;)q.setStart(d,k),q.setEnd(d,d.length),p=q.getBoundingClientRect(),r=l(r,p),m=d,k=0,d=w.nextNode();m||(m=e);if(A.isParagraph(n))r=l(r,x.getBoundingClientRect(n));else if(n.nodeType===Node.TEXT_NODE)d=n,q.setStart(d,d===a?k:0),q.setEnd(d,h),p=q.getBoundingClientRect(),r=l(r,p);else for(w=u.createTreeWalker(n,NodeFilter.SHOW_TEXT,c,!1),d=w.currentNode=g;d&&d!==m;)if(q.setStart(d,0),q.setEnd(d,h),p=q.getBoundingClientRect(),r=l(r,p),d=w.previousNode())h=
d.length;return r}function h(a,c){var b=a.getBoundingClientRect(),f={width:0};f.top=b.top;f.bottom=b.bottom;f.height=b.height;f.left=f.right=c?b.right:b.left;return f}function p(){var a=e.getSelectedRange(),c;if(c=N&&e.getSelectionType()===ops.OdtCursor.RangeSelection&&!a.collapsed){g();var f=x.getBoundingClientRect(k),l=E.getZoomLevel(),a=d(a),m,r,p,q,u,A;if(a){c=a.firstRange;m=a.lastRange;r=a.fillerRange;p=x.translateRect(h(c,!1),f,l);u=x.translateRect(h(m,!0),f,l);q=(q=n(r))?x.translateRect(q,
f,l):b(p,u);A=q.left;q=p.left+Math.max(0,q.width-(p.left-q.left));f=Math.min(p.top,u.top);l=u.top+u.height;A=[{x:p.left,y:f+p.height},{x:p.left,y:f},{x:q,y:f},{x:q,y:l-u.height},{x:u.right,y:l-u.height},{x:u.right,y:l},{x:A,y:l},{x:A,y:f+p.height},{x:p.left,y:f+p.height}];q="";var I;for(I=0;I<A.length;I+=1)q+=A[I].x+","+A[I].y+" ";z.setAttribute("points",q);w.setAttribute("cx",p.left);w.setAttribute("cy",f+p.height/2);t.setAttribute("cx",u.right);t.setAttribute("cy",l-u.height/2);c.detach();m.detach();
r.detach()}c=Boolean(a)}v.style.display=c?"block":"none"}function m(a){N&&a===e&&G.trigger()}function q(a){a=8/a;w.setAttribute("r",a);t.setAttribute("r",a)}function c(a){k.removeChild(v);k.classList.remove("webodf-virtualSelections");e.getDocument().unsubscribe(ops.Document.signalCursorMoved,m);E.unsubscribe(gui.ZoomHelper.signalZoomChanged,q);a()}var f=e.getDocument(),r,k,u=f.getDOMDocument(),v=u.createElementNS("http://www.w3.org/2000/svg","svg"),z=u.createElementNS("http://www.w3.org/2000/svg",
"polygon"),w=u.createElementNS("http://www.w3.org/2000/svg","circle"),t=u.createElementNS("http://www.w3.org/2000/svg","circle"),A=odf.OdfUtils,x=core.DomUtils,E=f.getCanvas().getZoomHelper(),N=!0,I=e.getDocument().createPositionIterator(f.getRootNode()),H=NodeFilter.FILTER_ACCEPT,F=NodeFilter.FILTER_REJECT,G;this.rerender=function(){N&&G.trigger()};this.show=function(){N=!0;G.trigger()};this.hide=function(){N=!1;G.trigger()};this.destroy=function(a){core.Async.destroyAll([G.destroy,c],a)};(function(){var a=
e.getMemberId();G=core.Task.createRedrawTask(p);g();v.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",a);k.classList.add("webodf-virtualSelections");e.getDocument().subscribe(ops.Document.signalCursorMoved,m);E.subscribe(gui.ZoomHelper.signalZoomChanged,q);q(E.getZoomLevel())})()};
gui.UndoStateRules=function(){function e(a,d){var e=a.length;this.previous=function(){for(e-=1;0<=e;e-=1)if(d(a[e]))return a[e];return null}}function g(a){a=a.spec();var d;a.hasOwnProperty("position")&&(d=a.position);return d}function a(a){return a.isEdit}function d(a,d,e){if(!e)return e=g(a)-g(d),0===e||1===Math.abs(e);a=g(a);d=g(d);e=g(e);return a-d===d-e}this.isEditOperation=a;this.isPartOfOperationSet=function(b,g){var n=void 0!==b.group,h;if(!b.isEdit||0===g.length)return!0;h=g[g.length-1];if(n&&
b.group===h.group)return!0;a:switch(b.spec().optype){case "RemoveText":case "InsertText":h=!0;break a;default:h=!1}if(h&&g.some(a)){if(n){var p;n=b.spec().optype;h=new e(g,a);var m=h.previous(),q=null,c,f;runtime.assert(Boolean(m),"No edit operations found in state");f=m.group;runtime.assert(void 0!==f,"Operation has no group");for(c=1;m&&m.group===f;){if(n===m.spec().optype){p=m;break}m=h.previous()}if(p){for(m=h.previous();m;){if(m.group!==f){if(2===c)break;f=m.group;c+=1}if(n===m.spec().optype){q=
m;break}m=h.previous()}p=d(b,p,q)}else p=!1;return p}p=b.spec().optype;n=new e(g,a);h=n.previous();runtime.assert(Boolean(h),"No edit operations found in state");p=p===h.spec().optype?d(b,h,n.previous()):!1;return p}return!1}};
gui.TrivialUndoManager=function(e){function g(a){0<a.length&&(t=!0,f(a),t=!1)}function a(){z.emit(gui.UndoManager.signalUndoStackChanged,{undoAvailable:p.hasUndoStates(),redoAvailable:p.hasRedoStates()})}function d(){k!==c&&k!==u[u.length-1]&&u.push(k)}function b(a){var c=a.previousSibling||a.nextSibling;a.parentNode.removeChild(a);m.normalizeTextNodes(c)}function l(a){return Object.keys(a).map(function(c){return a[c]})}function n(a){function c(a){var g=a.spec();if(d[g.memberid])switch(g.optype){case "AddCursor":b[g.memberid]||
(b[g.memberid]=a,delete d[g.memberid],e-=1);break;case "MoveCursor":f[g.memberid]||(f[g.memberid]=a)}}var b={},f={},d={},e,g=a.pop();r.getMemberIds().forEach(function(a){d[a]=!0});for(e=Object.keys(d).length;g&&0<e;)g.reverse(),g.forEach(c),g=a.pop();return l(b).concat(l(f))}function h(){var f=q=r.cloneDocumentElement();m.getElementsByTagNameNS(f,"urn:webodf:names:cursor","cursor").forEach(b);m.getElementsByTagNameNS(f,"urn:webodf:names:cursor","anchor").forEach(b);d();k=c=n([c].concat(u));u.length=
0;v.length=0;a()}var p=this,m=core.DomUtils,q,c=[],f,r,k=[],u=[],v=[],z=new core.EventNotifier([gui.UndoManager.signalUndoStackChanged,gui.UndoManager.signalUndoStateCreated,gui.UndoManager.signalUndoStateModified,gui.TrivialUndoManager.signalDocumentRootReplaced]),w=e||new gui.UndoStateRules,t=!1;this.subscribe=function(a,c){z.subscribe(a,c)};this.unsubscribe=function(a,c){z.unsubscribe(a,c)};this.hasUndoStates=function(){return 0<u.length};this.hasRedoStates=function(){return 0<v.length};this.setDocument=
function(a){r=a};this.purgeInitialState=function(){u.length=0;v.length=0;c.length=0;k.length=0;q=null;a()};this.setInitialState=h;this.initialize=function(){q||h()};this.setPlaybackFunction=function(a){f=a};this.onOperationExecuted=function(b){t||(w.isEditOperation(b)&&(k===c||0<v.length)||!w.isPartOfOperationSet(b,k)?(v.length=0,d(),k=[b],u.push(k),z.emit(gui.UndoManager.signalUndoStateCreated,{operations:k}),a()):(k.push(b),z.emit(gui.UndoManager.signalUndoStateModified,{operations:k})))};this.moveForward=
function(c){for(var b=0,f;c&&v.length;)f=v.pop(),u.push(f),g(f),c-=1,b+=1;b&&(k=u[u.length-1],a());return b};this.moveBackward=function(b){for(var f=0;b&&u.length;)v.push(u.pop()),b-=1,f+=1;f&&(r.getMemberIds().forEach(function(a){r.removeCursor(a)}),r.setDocumentElement(q.cloneNode(!0)),z.emit(gui.TrivialUndoManager.signalDocumentRootReplaced,{}),g(c),u.forEach(g),k=u[u.length-1]||c,a());return f}};gui.TrivialUndoManager.signalDocumentRootReplaced="documentRootReplaced";
odf.GraphicProperties=function(e,g,a){var d=this,b=odf.Namespaces.stylens,l=odf.Namespaces.svgns;this.verticalPos=function(){return d.data.value("verticalPos")};this.verticalRel=function(){return d.data.value("verticalRel")};this.horizontalPos=function(){return d.data.value("horizontalPos")};this.horizontalRel=function(){return d.data.value("horizontalRel")};this.strokeWidth=function(){return d.data.value("strokeWidth")};this.data;d.data=new odf.LazyStyleProperties(void 0===a?void 0:a.data,{verticalPos:function(){var a=
e.getAttributeNS(b,"vertical-pos");return""===a?void 0:a},verticalRel:function(){var a=e.getAttributeNS(b,"vertical-rel");return""===a?void 0:a},horizontalPos:function(){var a=e.getAttributeNS(b,"horizontal-pos");return""===a?void 0:a},horizontalRel:function(){var a=e.getAttributeNS(b,"horizontal-rel");return""===a?void 0:a},strokeWidth:function(){var a=e.getAttributeNS(l,"stroke-width");return g.parseLength(a)}})};
odf.ComputedGraphicProperties=function(){var e;this.setGraphicProperties=function(g){e=g};this.verticalPos=function(){return e&&e.verticalPos()||"from-top"};this.verticalRel=function(){return e&&e.verticalRel()||"page"};this.horizontalPos=function(){return e&&e.horizontalPos()||"from-left"};this.horizontalRel=function(){return e&&e.horizontalRel()||"page"}};
odf.PageLayoutProperties=function(e,g,a){var d=this,b=odf.Namespaces.fons;this.pageHeight=function(){return d.data.value("pageHeight")||1123};this.pageWidth=function(){return d.data.value("pageWidth")||794};this.data;d.data=new odf.LazyStyleProperties(void 0===a?void 0:a.data,{pageHeight:function(){var a;e&&(a=e.getAttributeNS(b,"page-height"),a=g.parseLength(a));return a},pageWidth:function(){var a;e&&(a=e.getAttributeNS(b,"page-width"),a=g.parseLength(a));return a}})};
odf.PageLayout=function(e,g,a){this.pageLayout;var d=null;e&&(d=g.getPropertiesElement("page-layout-properties",e));this.pageLayout=new odf.PageLayoutProperties(d,g,a&&a.pageLayout)};odf.PageLayoutCache=function(){};odf.PageLayoutCache.prototype.getPageLayout=function(e){};odf.PageLayoutCache.prototype.getDefaultPageLayout=function(){};
odf.ParagraphProperties=function(e,g,a){var d=this,b=odf.Namespaces.fons;this.marginTop=function(){return d.data.value("marginTop")};this.data;d.data=new odf.LazyStyleProperties(void 0===a?void 0:a.data,{marginTop:function(){var d=e.getAttributeNS(b,"margin-top");return g.parsePositiveLengthOrPercent(d,"marginTop",a&&a.data)}})};
odf.ComputedParagraphProperties=function(){var e={},g=[];this.setStyleChain=function(a){g=a;e={}};this.marginTop=function(){var a,d;if(e.hasOwnProperty("marginTop"))a=e.marginTop;else{for(d=0;void 0===a&&d<g.length;d+=1)a=g[d].marginTop();e.marginTop=a}return a||0}};
odf.TextProperties=function(e,g,a){var d=this,b=odf.Namespaces.fons;this.fontSize=function(){return d.data.value("fontSize")};this.data;d.data=new odf.LazyStyleProperties(void 0===a?void 0:a.data,{fontSize:function(){var d=e.getAttributeNS(b,"font-size");return g.parsePositiveLengthOrPercent(d,"fontSize",a&&a.data)}})};
odf.ComputedTextProperties=function(){var e={},g=[];this.setStyleChain=function(a){g=a;e={}};this.fontSize=function(){var a,d;if(e.hasOwnProperty("fontSize"))a=e.fontSize;else{for(d=0;void 0===a&&d<g.length;d+=1)a=g[d].fontSize();e.fontSize=a}return a||12}};odf.MasterPage=function(e,g){this.pageLayout;var a;e?(a=e.getAttributeNS(odf.Namespaces.stylens,"page-layout-name"),this.pageLayout=g.getPageLayout(a)):this.pageLayout=g.getDefaultPageLayout()};odf.MasterPageCache=function(){};
odf.MasterPageCache.prototype.getMasterPage=function(e){};
odf.StylePileEntry=function(e,g,a,d){this.text;this.paragraph;this.graphic;this.masterPage=function(){var b=e.getAttributeNS(odf.Namespaces.stylens,"master-page-name"),d=null;b&&(d=a.getMasterPage(b));return d};(function(a){var l=e.getAttributeNS(odf.Namespaces.stylens,"family"),n=null;if("graphic"===l||"chart"===l)a.graphic=void 0===d?void 0:d.graphic,n=g.getPropertiesElement("graphic-properties",e,n),null!==n&&(a.graphic=new odf.GraphicProperties(n,g,a.graphic));if("paragraph"===l||"table-cell"===
l||"graphic"===l||"presentation"===l||"chart"===l)a.paragraph=void 0===d?void 0:d.paragraph,n=g.getPropertiesElement("paragraph-properties",e,n),null!==n&&(a.paragraph=new odf.ParagraphProperties(n,g,a.paragraph));if("text"===l||"paragraph"===l||"table-cell"===l||"graphic"===l||"presentation"===l||"chart"===l)a.text=void 0===d?void 0:d.text,n=g.getPropertiesElement("text-properties",e,n),null!==n&&(a.text=new odf.TextProperties(n,g,a.text))})(this)};
odf.StylePile=function(e,g){function a(a,c){var b,h;a.hasAttributeNS(d,"parent-style-name")&&(h=a.getAttributeNS(d,"parent-style-name"),-1===c.indexOf(h)&&(b=m(h,c)));return new odf.StylePileEntry(a,e,g,b)}var d=odf.Namespaces.stylens,b={},l={},n,h={},p={},m;m=function(d,c){var f=h[d],e;!f&&(e=b[d])&&(c.push(d),f=a(e,c),h[d]=f);return f};this.getStyle=function(d){var c=p[d]||h[d],f,e=[];c||(f=l[d],f||(f=b[d])&&e.push(d),f&&(c=a(f,e)));return c};this.addCommonStyle=function(a){var c;a.hasAttributeNS(d,
"name")&&(c=a.getAttributeNS(d,"name"),b.hasOwnProperty(c)||(b[c]=a))};this.addAutomaticStyle=function(a){var c;a.hasAttributeNS(d,"name")&&(c=a.getAttributeNS(d,"name"),l.hasOwnProperty(c)||(l[c]=a))};this.setDefaultStyle=function(b){void 0===n&&(n=a(b,[]))};this.getDefaultStyle=function(){return n}};odf.ComputedGraphicStyle=function(){this.text=new odf.ComputedTextProperties;this.paragraph=new odf.ComputedParagraphProperties;this.graphic=new odf.ComputedGraphicProperties};
odf.ComputedParagraphStyle=function(){this.text=new odf.ComputedTextProperties;this.paragraph=new odf.ComputedParagraphProperties};odf.ComputedTextStyle=function(){this.text=new odf.ComputedTextProperties};
odf.StyleCache=function(e){function g(a,c,b,f){c=b.getAttributeNS(c,"class-names");var d;if(c)for(c=c.split(" "),d=0;d<c.length;d+=1)if(b=c[d])f.push(a),f.push(b)}function a(a,c){var b=v.getStyleName("paragraph",a);void 0!==b&&(c.push("paragraph"),c.push(b));a.namespaceURI!==k||"h"!==a.localName&&"p"!==a.localName||g("paragraph",k,a,c);return c}function d(a,c,b){var f=[],d,e,g,k;for(d=0;d<a.length;d+=2)g=a[d],k=a[d+1],g=h[g],k=g.getStyle(k),void 0!==k&&(k=k[c],void 0!==k&&k!==e&&(f.push(k),e=k));
g=h[b];if(k=g.getDefaultStyle())k=k[c],void 0!==k&&k!==e&&f.push(k);return f}function b(c,f){var d=v.getStyleName("text",c),h=c.parentNode;void 0!==d&&(f.push("text"),f.push(d));"span"===c.localName&&c.namespaceURI===k&&g("text",k,c,f);if(!h||h===e)return f;h.namespaceURI!==k||"p"!==h.localName&&"h"!==h.localName?b(h,f):a(h,f);return f}function l(a){a=a.getAttributeNS(u,"family");return h[a]}var n=this,h,p,m,q,c,f,r,k=odf.Namespaces.textns,u=odf.Namespaces.stylens,v=new odf.StyleInfo,z=new odf.StyleParseUtils,
w,t,A,x,E,N;this.getComputedGraphicStyle=function(a){var c=[];a=v.getStyleName("graphic",a);void 0!==a&&(c.push("graphic"),c.push(a));a=c.join("/");var b=q[a];runtime.assert(0===c.length%2,"Invalid style chain.");void 0===b&&(b=new odf.ComputedGraphicStyle,b.graphic.setGraphicProperties(d(c,"graphic","graphic")[0]),b.text.setStyleChain(d(c,"text","graphic")),b.paragraph.setStyleChain(d(c,"paragraph","graphic")),q[a]=b);return b};this.getComputedParagraphStyle=function(c){c=a(c,[]);var b=c.join("/"),
f=m[b];runtime.assert(0===c.length%2,"Invalid style chain.");void 0===f&&(f=new odf.ComputedParagraphStyle,f.text.setStyleChain(d(c,"text","paragraph")),f.paragraph.setStyleChain(d(c,"paragraph","paragraph")),m[b]=f);return f};this.getComputedTextStyle=function(a){a=b(a,[]);var c=a.join("/"),f=p[c];runtime.assert(0===a.length%2,"Invalid style chain.");void 0===f&&(f=new odf.ComputedTextStyle,f.text.setStyleChain(d(a,"text","text")),p[c]=f);return f};this.getPageLayout=function(a){var c=N[a];c||((c=
E[a])?(c=new odf.PageLayout(c,z,x),N[a]=c):c=x);return c};this.getDefaultPageLayout=function(){return x};this.getMasterPage=function(a){var c=t[a];void 0===c&&((c=w[a])?(c=new odf.MasterPage(c,n),t[a]=c):c=null);return c};this.getDefaultMasterPage=function(){return A};this.update=function(){var a,b,d=null,g=null;p={};m={};q={};w={};t={};N={};E={};c=new odf.StylePile(z,n);f=new odf.StylePile(z,n);r=new odf.StylePile(z,n);h={text:c,paragraph:f,graphic:r};for(a=e.styles.firstElementChild;a;)a.namespaceURI===
u&&((b=l(a))?"style"===a.localName?b.addCommonStyle(a):"default-style"===a.localName&&b.setDefaultStyle(a):"default-page-layout"===a.localName&&(d=a)),a=a.nextElementSibling;x=new odf.PageLayout(d,z);for(a=e.automaticStyles.firstElementChild;a;)a.namespaceURI===u&&((b=l(a))&&"style"===a.localName?b.addAutomaticStyle(a):"page-layout"===a.localName&&(E[a.getAttributeNS(u,"name")]=a)),a=a.nextElementSibling;for(a=e.masterStyles.firstElementChild;a;)a.namespaceURI===u&&"master-page"===a.localName&&(g=
g||a,b=a,d=b.getAttributeNS(u,"name"),0<d.length&&!w.hasOwnProperty(d)&&(w[d]=b)),a=a.nextElementSibling;A=new odf.MasterPage(g,n)}};
ops.OperationTransformMatrix=function(){function e(a){a.position+=a.length;a.length*=-1}function g(a){var b=0>a.length;b&&e(a);return b}function a(a,b){function d(g){a[g]===b&&e.push(g)}var e=[];a&&["style:parent-style-name","style:next-style-name"].forEach(d);return e}function d(a,b){function d(e){a[e]===b&&delete a[e]}a&&["style:parent-style-name","style:next-style-name"].forEach(d)}function b(a){var f={};Object.keys(a).forEach(function(d){f[d]="object"===typeof a[d]?b(a[d]):a[d]});return f}function l(a,
b,d,e){var g,h=!1,l=!1,m,n=[];e&&e.attributes&&(n=e.attributes.split(","));a&&(d||0<n.length)&&Object.keys(a).forEach(function(b){var f=a[b],e;"object"!==typeof f&&(d&&(e=d[b]),void 0!==e?(delete a[b],l=!0,e===f&&(delete d[b],h=!0)):-1!==n.indexOf(b)&&(delete a[b],l=!0))});if(b&&b.attributes&&(d||0<n.length)){m=b.attributes.split(",");for(e=0;e<m.length;e+=1)if(g=m[e],d&&void 0!==d[g]||n&&-1!==n.indexOf(g))m.splice(e,1),e-=1,l=!0;0<m.length?b.attributes=m.join(","):delete b.attributes}return{majorChanged:h,
minorChanged:l}}function n(a){for(var b in a)if(a.hasOwnProperty(b))return!0;return!1}function h(a){for(var b in a)if(a.hasOwnProperty(b)&&("attributes"!==b||0<a.attributes.length))return!0;return!1}function p(a,b,d,e,g){var m=a?a[g]:null,p=b?b[g]:null,q=d?d[g]:null,t=e?e[g]:null,A;A=l(m,p,q,t);m&&!n(m)&&delete a[g];p&&!h(p)&&delete b[g];q&&!n(q)&&delete d[g];t&&!h(t)&&delete e[g];return A}function m(a,b){return{opSpecsA:[a],opSpecsB:[b]}}var q;q={AddCursor:{AddCursor:m,AddMember:m,AddStyle:m,ApplyDirectStyling:m,
InsertText:m,MergeParagraph:m,MoveCursor:m,RemoveCursor:m,RemoveMember:m,RemoveStyle:m,RemoveText:m,SetParagraphStyle:m,SplitParagraph:m,UpdateMember:m,UpdateMetadata:m,UpdateParagraphStyle:m},AddMember:{AddStyle:m,ApplyDirectStyling:m,InsertText:m,MergeParagraph:m,MoveCursor:m,RemoveCursor:m,RemoveStyle:m,RemoveText:m,SetParagraphStyle:m,SplitParagraph:m,UpdateMetadata:m,UpdateParagraphStyle:m},AddStyle:{AddStyle:m,ApplyDirectStyling:m,InsertText:m,MergeParagraph:m,MoveCursor:m,RemoveCursor:m,RemoveMember:m,
RemoveStyle:function(c,b){var e,g=[c],h=[b];c.styleFamily===b.styleFamily&&(e=a(c.setProperties,b.styleName),0<e.length&&(e={optype:"UpdateParagraphStyle",memberid:b.memberid,timestamp:b.timestamp,styleName:c.styleName,removedProperties:{attributes:e.join(",")}},h.unshift(e)),d(c.setProperties,b.styleName));return{opSpecsA:g,opSpecsB:h}},RemoveText:m,SetParagraphStyle:m,SplitParagraph:m,UpdateMember:m,UpdateMetadata:m,UpdateParagraphStyle:m},ApplyDirectStyling:{ApplyDirectStyling:function(a,f,d){var e,
g,h,l,m,q,A,x;l=[a];h=[f];if(!(a.position+a.length<=f.position||a.position>=f.position+f.length)){e=d?a:f;g=d?f:a;if(a.position!==f.position||a.length!==f.length)q=b(e),A=b(g);f=p(g.setProperties,null,e.setProperties,null,"style:text-properties");if(f.majorChanged||f.minorChanged)h=[],a=[],l=e.position+e.length,m=g.position+g.length,g.position<e.position?f.minorChanged&&(x=b(A),x.length=e.position-g.position,a.push(x),g.position=e.position,g.length=m-g.position):e.position<g.position&&f.majorChanged&&
(x=b(q),x.length=g.position-e.position,h.push(x),e.position=g.position,e.length=l-e.position),m>l?f.minorChanged&&(q=A,q.position=l,q.length=m-l,a.push(q),g.length=l-g.position):l>m&&f.majorChanged&&(q.position=m,q.length=l-m,h.push(q),e.length=m-e.position),e.setProperties&&n(e.setProperties)&&h.push(e),g.setProperties&&n(g.setProperties)&&a.push(g),d?(l=h,h=a):l=a}return{opSpecsA:l,opSpecsB:h}},InsertText:function(a,b){b.position<=a.position?a.position+=b.text.length:b.position<=a.position+a.length&&
(a.length+=b.text.length);return{opSpecsA:[a],opSpecsB:[b]}},MergeParagraph:function(a,b){var d=a.position,e=a.position+a.length;d>=b.sourceStartPosition&&(d-=1);e>=b.sourceStartPosition&&(e-=1);a.position=d;a.length=e-d;return{opSpecsA:[a],opSpecsB:[b]}},MoveCursor:m,RemoveCursor:m,RemoveMember:m,RemoveStyle:m,RemoveText:function(a,b){var d=a.position+a.length,e=b.position+b.length,g=[a],h=[b];e<=a.position?a.position-=b.length:b.position<d&&(a.position<b.position?a.length=e<d?a.length-b.length:
b.position-a.position:(a.position=b.position,e<d?a.length=d-e:g=[]));return{opSpecsA:g,opSpecsB:h}},SetParagraphStyle:m,SplitParagraph:function(a,b){b.position<a.position?a.position+=1:b.position<a.position+a.length&&(a.length+=1);return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:m,UpdateMetadata:m,UpdateParagraphStyle:m},InsertText:{InsertText:function(a,b,d){a.position<b.position?b.position+=a.text.length:a.position>b.position?a.position+=b.text.length:d?b.position+=a.text.length:a.position+=b.text.length;
return{opSpecsA:[a],opSpecsB:[b]}},MergeParagraph:function(a,b){a.position>=b.sourceStartPosition?a.position-=1:(a.position<b.sourceStartPosition&&(b.sourceStartPosition+=a.text.length),a.position<b.destinationStartPosition&&(b.destinationStartPosition+=a.text.length));return{opSpecsA:[a],opSpecsB:[b]}},MoveCursor:function(a,b){var d=g(b);a.position<b.position?b.position+=a.text.length:a.position<b.position+b.length&&(b.length+=a.text.length);d&&e(b);return{opSpecsA:[a],opSpecsB:[b]}},RemoveCursor:m,
RemoveMember:m,RemoveStyle:m,RemoveText:function(a,b){var d;d=b.position+b.length;var e=[a],g=[b];d<=a.position?a.position-=b.length:a.position<=b.position?b.position+=a.text.length:(b.length=a.position-b.position,d={optype:"RemoveText",memberid:b.memberid,timestamp:b.timestamp,position:a.position+a.text.length,length:d-a.position},g.unshift(d),a.position=b.position);return{opSpecsA:e,opSpecsB:g}},SetParagraphStyle:function(a,b){b.position>a.position&&(b.position+=a.text.length);return{opSpecsA:[a],
opSpecsB:[b]}},SplitParagraph:function(a,b){a.position<b.sourceParagraphPosition&&(b.sourceParagraphPosition+=a.text.length);a.position<=b.position?b.position+=a.text.length:a.position+=1;return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:m,UpdateMetadata:m,UpdateParagraphStyle:m},MergeParagraph:{MergeParagraph:function(a,b,d){var e=[a],g=[b],h;a.destinationStartPosition===b.destinationStartPosition?(e=[],g=[],a.moveCursor&&(h={optype:"MoveCursor",memberid:a.memberid,timestamp:a.timestamp,position:a.sourceStartPosition-
1},e.push(h)),b.moveCursor&&(h={optype:"MoveCursor",memberid:b.memberid,timestamp:b.timestamp,position:b.sourceStartPosition-1},g.push(h)),a=d?a:b,a={optype:"SetParagraphStyle",memberid:a.memberid,timestamp:a.timestamp,position:a.destinationStartPosition,styleName:a.paragraphStyleName},d?e.push(a):g.push(a)):b.sourceStartPosition===a.destinationStartPosition?(a.destinationStartPosition=b.destinationStartPosition,a.sourceStartPosition-=1,a.paragraphStyleName=b.paragraphStyleName):a.sourceStartPosition===
b.destinationStartPosition?(b.destinationStartPosition=a.destinationStartPosition,b.sourceStartPosition-=1,b.paragraphStyleName=a.paragraphStyleName):a.destinationStartPosition<b.destinationStartPosition?(b.destinationStartPosition-=1,b.sourceStartPosition-=1):(a.destinationStartPosition-=1,a.sourceStartPosition-=1);return{opSpecsA:e,opSpecsB:g}},MoveCursor:function(a,b){var d=b.position,e=b.position+b.length,g=Math.min(d,e),d=Math.max(d,e);g>=a.sourceStartPosition&&(g-=1);d>=a.sourceStartPosition&&
(d-=1);0<=b.length?(b.position=g,b.length=d-g):(b.position=d,b.length=g-d);return{opSpecsA:[a],opSpecsB:[b]}},RemoveCursor:m,RemoveMember:m,RemoveStyle:m,RemoveText:function(a,b){b.position>=a.sourceStartPosition?b.position-=1:(b.position<a.destinationStartPosition&&(a.destinationStartPosition-=b.length),b.position<a.sourceStartPosition&&(a.sourceStartPosition-=b.length));return{opSpecsA:[a],opSpecsB:[b]}},SetParagraphStyle:function(a,b){var d=[a],e=[b];if(b.position>a.sourceStartPosition)b.position-=
1;else if(b.position===a.destinationStartPosition||b.position===a.sourceStartPosition)b.position=a.destinationStartPosition,a.paragraphStyleName=b.styleName;return{opSpecsA:d,opSpecsB:e}},SplitParagraph:function(a,b){var d,e=[a],g=[b];b.position<a.destinationStartPosition?(a.destinationStartPosition+=1,a.sourceStartPosition+=1):b.position>=a.destinationStartPosition&&b.position<a.sourceStartPosition?(b.paragraphStyleName=a.paragraphStyleName,d={optype:"SetParagraphStyle",memberid:a.memberid,timestamp:a.timestamp,
position:a.destinationStartPosition,styleName:a.paragraphStyleName},e.push(d),b.position===a.sourceStartPosition-1&&a.moveCursor&&(d={optype:"MoveCursor",memberid:a.memberid,timestamp:a.timestamp,position:b.position,length:0},e.push(d)),a.destinationStartPosition=b.position+1,a.sourceStartPosition+=1):b.position>=a.sourceStartPosition&&(b.position-=1,b.sourceParagraphPosition-=1);return{opSpecsA:e,opSpecsB:g}},UpdateMember:m,UpdateMetadata:m,UpdateParagraphStyle:m},MoveCursor:{MoveCursor:m,RemoveCursor:function(a,
b){return{opSpecsA:a.memberid===b.memberid?[]:[a],opSpecsB:[b]}},RemoveMember:m,RemoveStyle:m,RemoveText:function(a,b){var d=g(a),k=a.position+a.length,h=b.position+b.length;h<=a.position?a.position-=b.length:b.position<k&&(a.position<b.position?a.length=h<k?a.length-b.length:b.position-a.position:(a.position=b.position,a.length=h<k?k-h:0));d&&e(a);return{opSpecsA:[a],opSpecsB:[b]}},SetParagraphStyle:m,SplitParagraph:function(a,b){var d=g(a);b.position<a.position?a.position+=1:b.position<a.position+
a.length&&(a.length+=1);d&&e(a);return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:m,UpdateMetadata:m,UpdateParagraphStyle:m},RemoveCursor:{RemoveCursor:function(a,b){var d=a.memberid===b.memberid;return{opSpecsA:d?[]:[a],opSpecsB:d?[]:[b]}},RemoveMember:m,RemoveStyle:m,RemoveText:m,SetParagraphStyle:m,SplitParagraph:m,UpdateMember:m,UpdateMetadata:m,UpdateParagraphStyle:m},RemoveMember:{RemoveStyle:m,RemoveText:m,SetParagraphStyle:m,SplitParagraph:m,UpdateMetadata:m,UpdateParagraphStyle:m},RemoveStyle:{RemoveStyle:function(a,
b){var d=a.styleName===b.styleName&&a.styleFamily===b.styleFamily;return{opSpecsA:d?[]:[a],opSpecsB:d?[]:[b]}},RemoveText:m,SetParagraphStyle:function(a,b){var d,e=[a],g=[b];"paragraph"===a.styleFamily&&a.styleName===b.styleName&&(d={optype:"SetParagraphStyle",memberid:a.memberid,timestamp:a.timestamp,position:b.position,styleName:""},e.unshift(d),b.styleName="");return{opSpecsA:e,opSpecsB:g}},SplitParagraph:m,UpdateMember:m,UpdateMetadata:m,UpdateParagraphStyle:function(b,f){var e,g=[b],h=[f];"paragraph"===
b.styleFamily&&(e=a(f.setProperties,b.styleName),0<e.length&&(e={optype:"UpdateParagraphStyle",memberid:b.memberid,timestamp:b.timestamp,styleName:f.styleName,removedProperties:{attributes:e.join(",")}},g.unshift(e)),b.styleName===f.styleName?h=[]:d(f.setProperties,b.styleName));return{opSpecsA:g,opSpecsB:h}}},RemoveText:{RemoveText:function(a,b){var d=a.position+a.length,e=b.position+b.length,g=[a],h=[b];e<=a.position?a.position-=b.length:d<=b.position?b.position-=a.length:b.position<d&&(a.position<
b.position?(a.length=e<d?a.length-b.length:b.position-a.position,d<e?(b.position=a.position,b.length=e-d):h=[]):(d<e?b.length-=a.length:b.position<a.position?b.length=a.position-b.position:h=[],e<d?(a.position=b.position,a.length=d-e):g=[]));return{opSpecsA:g,opSpecsB:h}},SetParagraphStyle:function(a,b){a.position<b.position&&(b.position-=a.length);return{opSpecsA:[a],opSpecsB:[b]}},SplitParagraph:function(a,b){var d=a.position+a.length,e=[a],g=[b];b.position<=a.position?a.position+=1:b.position<
d&&(a.length=b.position-a.position,d={optype:"RemoveText",memberid:a.memberid,timestamp:a.timestamp,position:b.position+1,length:d-b.position},e.unshift(d));a.position+a.length<=b.position?b.position-=a.length:a.position<b.position&&(b.position=a.position);a.position+a.length<b.sourceParagraphPosition&&(b.sourceParagraphPosition-=a.length);return{opSpecsA:e,opSpecsB:g}},UpdateMember:m,UpdateMetadata:m,UpdateParagraphStyle:m},SetParagraphStyle:{SetParagraphStyle:function(a,b,d){a.position===b.position&&
(d?b.styleName=a.styleName:a.styleName=b.styleName);return{opSpecsA:[a],opSpecsB:[b]}},SplitParagraph:function(a,d){var e=[a],g=[d],h;a.position>d.position?a.position+=1:a.position===d.sourceParagraphPosition&&(d.paragraphStyleName=a.styleName,h=b(a),h.position=d.position+1,e.push(h));return{opSpecsA:e,opSpecsB:g}},UpdateMember:m,UpdateMetadata:m,UpdateParagraphStyle:m},SplitParagraph:{SplitParagraph:function(a,b,d){var e,g;a.position<b.position?e=!0:b.position<a.position?g=!0:a.position===b.position&&
(d?e=!0:g=!0);e?(b.position+=1,b.sourceParagraphPosition=a.position<b.sourceParagraphPosition?b.sourceParagraphPosition+1:a.position+1):g&&(a.position+=1,a.sourceParagraphPosition=b.position<b.sourceParagraphPosition?a.sourceParagraphPosition+1:b.position+1);return{opSpecsA:[a],opSpecsB:[b]}},UpdateMember:m,UpdateMetadata:m,UpdateParagraphStyle:m},UpdateMember:{UpdateMetadata:m,UpdateParagraphStyle:m},UpdateMetadata:{UpdateMetadata:function(a,b,d){var e,g=[a],m=[b];e=d?a:b;a=d?b:a;l(a.setProperties||
null,a.removedProperties||null,e.setProperties||null,e.removedProperties||null);e.setProperties&&n(e.setProperties)||e.removedProperties&&h(e.removedProperties)||(d?g=[]:m=[]);a.setProperties&&n(a.setProperties)||a.removedProperties&&h(a.removedProperties)||(d?m=[]:g=[]);return{opSpecsA:g,opSpecsB:m}},UpdateParagraphStyle:m},UpdateParagraphStyle:{UpdateParagraphStyle:function(a,b,d){var e,g=[a],m=[b];a.styleName===b.styleName&&(e=d?a:b,a=d?b:a,p(a.setProperties,a.removedProperties,e.setProperties,
e.removedProperties,"style:paragraph-properties"),p(a.setProperties,a.removedProperties,e.setProperties,e.removedProperties,"style:text-properties"),l(a.setProperties||null,a.removedProperties||null,e.setProperties||null,e.removedProperties||null),e.setProperties&&n(e.setProperties)||e.removedProperties&&h(e.removedProperties)||(d?g=[]:m=[]),a.setProperties&&n(a.setProperties)||a.removedProperties&&h(a.removedProperties)||(d?m=[]:g=[]));return{opSpecsA:g,opSpecsB:m}}}};this.passUnchanged=m;this.extendTransformations=
function(a){Object.keys(a).forEach(function(b){var d=a[b],e,g=q.hasOwnProperty(b);runtime.log((g?"Extending":"Adding")+" map for optypeA: "+b);g||(q[b]={});e=q[b];Object.keys(d).forEach(function(a){var c=e.hasOwnProperty(a);runtime.assert(b<=a,"Wrong order:"+b+", "+a);runtime.log("  "+(c?"Overwriting":"Adding")+" entry for optypeB: "+a);e[a]=d[a]})})};this.transformOpspecVsOpspec=function(a,b){var d=a.optype<=b.optype,e;runtime.log("Crosstransforming:");runtime.log(runtime.toJson(a));runtime.log(runtime.toJson(b));
d||(e=a,a=b,b=e);(e=(e=q[a.optype])&&e[b.optype])?(e=e(a,b,!d),d||null===e||(e={opSpecsA:e.opSpecsB,opSpecsB:e.opSpecsA})):e=null;runtime.log("result:");e?(runtime.log(runtime.toJson(e.opSpecsA)),runtime.log(runtime.toJson(e.opSpecsB))):runtime.log("null");return e}};
ops.OperationTransformer=function(){function e(a,d){for(var b,l,n=[],h=[];0<a.length&&d;){b=a.shift();b=g.transformOpspecVsOpspec(b,d);if(!b)return null;n=n.concat(b.opSpecsA);if(0===b.opSpecsB.length){n=n.concat(a);d=null;break}for(;1<b.opSpecsB.length;){l=e(a,b.opSpecsB.shift());if(!l)return null;h=h.concat(l.opSpecsB);a=l.opSpecsA}d=b.opSpecsB.pop()}d&&h.push(d);return{opSpecsA:n,opSpecsB:h}}var g=new ops.OperationTransformMatrix;this.getOperationTransformMatrix=function(){return g};this.transform=
function(a,d){for(var b,g=[];0<d.length;){b=e(a,d.shift());if(!b)return null;a=b.opSpecsA;g=g.concat(b.opSpecsB)}return{opSpecsA:a,opSpecsB:g}}};var webodf_css='@namespace draw url(urn:oasis:names:tc:opendocument:xmlns:drawing:1.0);@namespace fo url(urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0);@namespace office url(urn:oasis:names:tc:opendocument:xmlns:office:1.0);@namespace presentation url(urn:oasis:names:tc:opendocument:xmlns:presentation:1.0);@namespace style url(urn:oasis:names:tc:opendocument:xmlns:style:1.0);@namespace svg url(urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0);@namespace table url(urn:oasis:names:tc:opendocument:xmlns:table:1.0);@namespace text url(urn:oasis:names:tc:opendocument:xmlns:text:1.0);@namespace webodfhelper url(urn:webodf:names:helper);@namespace cursor url(urn:webodf:names:cursor);@namespace editinfo url(urn:webodf:names:editinfo);@namespace annotation url(urn:webodf:names:annotation);@namespace dc url(http://purl.org/dc/elements/1.1/);@namespace svgns url(http://www.w3.org/2000/svg);office|document > *, office|document-content > * {display: none;}office|body, office|document {display: inline-block;position: relative;}text|p, text|h {display: block;padding: 0;margin: 0;line-height: normal;position: relative;}text|p::after, text|h::after {content: "\\200B";white-space: pre;}*[webodfhelper|containsparagraphanchor] {position: relative;}text|s {white-space: pre;}text|tab {display: inline;white-space: pre;}text|tracked-changes {display: none;}office|binary-data {display: none;}office|text {display: block;text-align: left;overflow: visible;word-wrap: break-word;}office|text::selection {background: transparent;}.webodf-virtualSelections *::selection {background: transparent;}.webodf-virtualSelections *::-moz-selection {background: transparent;}office|text * draw|text-box {display: block;border: 1px solid #d3d3d3;}office|text draw|frame {z-index: 1;}office|spreadsheet {display: block;border-collapse: collapse;empty-cells: show;font-family: sans-serif;font-size: 10pt;text-align: left;page-break-inside: avoid;overflow: hidden;}office|presentation {display: inline-block;text-align: left;}#shadowContent {display: inline-block;text-align: left;}draw|page {display: block;position: relative;overflow: hidden;}presentation|notes, presentation|footer-decl, presentation|date-time-decl {display: none;}@media print {draw|page {border: 1pt solid black;page-break-inside: avoid;}presentation|notes {}}office|spreadsheet text|p {border: 0px;padding: 1px;margin: 0px;}office|spreadsheet table|table {margin: 3px;}office|spreadsheet table|table:after {}office|spreadsheet table|table-row {counter-increment: row;}office|spreadsheet table|table-row:before {width: 3em;background: #cccccc;border: 1px solid black;text-align: center;content: counter(row);display: table-cell;}office|spreadsheet table|table-cell {border: 1px solid #cccccc;}table|table {display: table;}draw|frame table|table {width: 100%;height: 100%;background: white;}table|table-header-rows {display: table-header-group;}table|table-row {display: table-row;}table|table-column {display: table-column;}table|table-cell {width: 0.889in;display: table-cell;word-break: break-all;}draw|frame {display: block;}draw|image {display: block;width: 100%;height: 100%;top: 0px;left: 0px;background-repeat: no-repeat;background-size: 100% 100%;-moz-background-size: 100% 100%;}draw|frame > draw|image:nth-of-type(n+2) {display: none;}text|list:before {display: none;content:"";}text|list {display: block;}text|list-item {display: block;}text|number {display:none;}text|a {color: blue;text-decoration: underline;cursor: pointer;}.webodf-inactiveLinks text|a {cursor: text;}text|note-citation {vertical-align: super;font-size: smaller;}text|note-body {display: none;}text|note:hover text|note-citation {background: #dddddd;}text|note:hover text|note-body {display: block;left:1em;max-width: 80%;position: absolute;background: #ffffaa;}text|bibliography-source {display: none;}svg|title, svg|desc {display: none;}video {width: 100%;height: 100%}cursor|anchor {display: none;}cursor|cursor {display: none;}.webodf-caretOverlay {position: absolute;top: 5%;height: 1em;z-index: 10;padding-left: 1px;pointer-events: none;}.webodf-caretOverlay .caret {position: absolute;border-left: 2px solid black;top: 0;bottom: 0;right: 0;}.webodf-caretOverlay .handle {position: absolute;margin-top: 5px;padding-top: 3px;margin-left: auto;margin-right: auto;width: 64px;height: 68px;border-radius: 5px;opacity: 0.3;text-align: center;background-color: black;box-shadow: 0px 0px 5px rgb(90, 90, 90);border: 1px solid black;top: -85px;right: -32px;}.webodf-caretOverlay .handle > img {box-shadow: 0px 0px 5px rgb(90, 90, 90) inset;background-color: rgb(200, 200, 200);border-radius: 5px;border: 2px solid;height: 60px;width: 60px;display: block;margin: auto;}.webodf-caretOverlay .handle.active {opacity: 0.8;}.webodf-caretOverlay .handle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 43%;}.webodf-caretSizer {display: inline-block;width: 0;visibility: hidden;}#eventTrap {display: block;position: absolute;bottom: 0;left: 0;outline: none;opacity: 0;color: rgba(255, 255, 255, 0);pointer-events: none;white-space: pre;overflow: hidden;}cursor|cursor > #composer {text-decoration: underline;}cursor|cursor[cursor|caret-sizer-active="true"],cursor|cursor[cursor|composing="true"] {display: inline;}editinfo|editinfo {display: inline-block;}.editInfoMarker {position: absolute;width: 10px;height: 100%;left: -20px;opacity: 0.8;top: 0;border-radius: 5px;background-color: transparent;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);}.editInfoMarker:hover {box-shadow: 0px 0px 8px rgba(0, 0, 0, 1);}.editInfoHandle {position: absolute;background-color: black;padding: 5px;border-radius: 5px;opacity: 0.8;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);bottom: 100%;margin-bottom: 10px;z-index: 3;left: -25px;}.editInfoHandle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 5px;}.editInfo {font-family: sans-serif;font-weight: normal;font-style: normal;text-decoration: none;color: white;width: 100%;height: 12pt;}.editInfoColor {float: left;width: 10pt;height: 10pt;border: 1px solid white;}.editInfoAuthor {float: left;margin-left: 5pt;font-size: 10pt;text-align: left;height: 12pt;line-height: 12pt;}.editInfoTime {float: right;margin-left: 30pt;font-size: 8pt;font-style: italic;color: yellow;height: 12pt;line-height: 12pt;}.annotationWrapper {display: inline;position: relative;}.annotationRemoveButton:before {content: "\u00d7";color: white;padding: 5px;line-height: 1em;}.annotationRemoveButton {width: 20px;height: 20px;border-radius: 10px;background-color: black;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);position: absolute;top: -10px;left: -10px;z-index: 3;text-align: center;font-family: sans-serif;font-style: normal;font-weight: normal;text-decoration: none;font-size: 15px;}.annotationRemoveButton:hover {cursor: pointer;box-shadow: 0px 0px 5px rgba(0, 0, 0, 1);}.annotationNote {width: 4cm;position: absolute;display: inline;z-index: 10;top: 0;}.annotationNote > office|annotation {display: block;text-align: left;}.annotationConnector {position: absolute;display: inline;top: 0;z-index: 2;border-top: 1px dashed brown;}.annotationConnector.angular {-moz-transform-origin: left top;-webkit-transform-origin: left top;-ms-transform-origin: left top;transform-origin: left top;}.annotationConnector.horizontal {left: 0;}.annotationConnector.horizontal:before {content: "";display: inline;position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: brown transparent transparent transparent;top: -1px;left: -5px;}office|annotation {width: 100%;height: 100%;display: none;background: rgb(198, 238, 184);background: -moz-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -webkit-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -o-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -ms-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: linear-gradient(180deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);box-shadow: 0 3px 4px -3px #ccc;}office|annotation > dc|creator {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;color: white;background-color: brown;padding: 4px;}office|annotation > dc|date {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;border: 4px solid transparent;color: black;}office|annotation > text|list {display: block;padding: 5px;}office|annotation text|p {font-size: 10pt;color: black;font-weight: normal;font-style: normal;text-decoration: none;font-family: sans-serif;}#annotationsPane {background-color: #EAEAEA;width: 4cm;height: 100%;display: none;position: absolute;outline: 1px solid #ccc;}.webodf-annotationHighlight {background-color: yellow;position: relative;}.webodf-selectionOverlay {position: absolute;pointer-events: none;top: 0;left: 0;top: 0;left: 0;width: 100%;height: 100%;z-index: 15;}.webodf-selectionOverlay > polygon {fill-opacity: 0.3;stroke-opacity: 0.8;stroke-width: 1;fill-rule: evenodd;}.webodf-selectionOverlay > .webodf-draggable {fill-opacity: 0.8;stroke-opacity: 0;stroke-width: 8;pointer-events: all;display: none;-moz-transform-origin: center center;-webkit-transform-origin: center center;-ms-transform-origin: center center;transform-origin: center center;}#imageSelector {display: none;position: absolute;border-style: solid;border-color: black;}#imageSelector > div {width: 5px;height: 5px;display: block;position: absolute;border: 1px solid black;background-color: #ffffff;}#imageSelector > .topLeft {top: -4px;left: -4px;}#imageSelector > .topRight {top: -4px;right: -4px;}#imageSelector > .bottomRight {right: -4px;bottom: -4px;}#imageSelector > .bottomLeft {bottom: -4px;left: -4px;}#imageSelector > .topMiddle {top: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .rightMiddle {top: 50%;right: -4px;margin-top: -2.5px;}#imageSelector > .bottomMiddle {bottom: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .leftMiddle {top: 50%;left: -4px;margin-top: -2.5px;}div.webodf-customScrollbars::-webkit-scrollbar{width: 8px;height: 8px;background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-track{background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-thumb{background-color: #444;border-radius: 4px;}.webodf-hyperlinkTooltip {display: none;color: white;background-color: black;border-radius: 5px;box-shadow: 2px 2px 5px gray;padding: 3px;position: absolute;max-width: 210px;text-align: left;word-break: break-all;z-index: 16;}.webodf-hyperlinkTooltipText {display: block;font-weight: bold;}';
function number_format(e,g,a,d){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");e=isFinite(+e)?+e:0;g=isFinite(+g)?Math.abs(g):0;d="undefined"===typeof d?",":d;a="undefined"===typeof a?".":a;var b="",b=function(a,b){var d=Math.pow(10,b);return""+Math.round(a*d)/d},b=(g?b(e,g):""+Math.round(e)).split(".");3<b[0].length&&(b[0]=b[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,d));(b[1]||"").length<g&&(b[1]=b[1]||"",b[1]+=Array(g-b[1].length+1).join("0"));return b.join(a)}
function findChildNode(e,g,a){var d=[];for(e=e?e.firstElementChild:null;e;)e.localName===a&&e.namespaceURI===g&&d.push(e),e=e.nextElementSibling;return d}function getWindowWidth(){var e=0;if("number"==typeof window.innerWidth)e=window.innerWidth;else var e=document.documentElement.clientWidth,g=document.body.clientWidth,e=0<e?e:g;e||(e=0);return e}
function getWindowHeight(){var e=0;if("number"==typeof window.innerHeight)e=window.innerHeight;else var e=document.documentElement.clientHeight,g=document.body.clientHeight,e=0<e?e:g;e||(e=0);return e}function getScrollLeft(){var e;document.body&&document.body.scrollLeft?e=document.body.scrollLeft:document.documentElement&&document.documentElement.scrollLeft&&(e=document.documentElement.scrollLeft);e||(e=0);return e}
function getScrollTop(){var e;document.body&&document.body.scrollTop?e=document.body.scrollTop:document.documentElement&&document.documentElement.scrollTop&&(e=document.documentElement.scrollTop);e||(e=0);return e}var messagetimer=null;
function show_message(e,g,a,d,b){g||(g=10);a||(a=10);d||(d=5);b||(b=2E3);for(var l=1,n=1;4>=n;n++){var h="layer_message";1<n&&(h="layer_message"+n);if(h=document.getElementById(h)){l=n;break}}h.style.left="1px";h.style.top="1px";h.innerHTML=e;h.style.display="";1==l?(g=getScrollLeft()+g,a=getScrollTop()+a):2==l?(g=getScrollLeft()+(getWindowWidth()-h.clientWidth)/2,a=getScrollTop()+(getWindowHeight()-h.clientHeight)/2):(g=3==l?document.body.offsetWidth-h.clientWidth-5:getScrollLeft()+(getWindowWidth()-
h.clientWidth)/2,a=getScrollTop()+a);g=parseInt(g);a=parseInt(a);h.style.border="1px solid #000000";h.style.padding=d+"px";h.style.left=g+"px";h.style.top=a+"px";messagetimer&&clearTimeout(messagetimer);messagetimer=setTimeout(hide_message,b)}function hide_message(){for(var e=1;4>=e;e++){var g="layer_message";1<e&&(g="layer_message"+e);if(g=document.getElementById(g))g.style.display="none"}};
