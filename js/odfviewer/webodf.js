var gdocumentType,ghyperlinkTooltipView,clicktimer,gstyleParseUtils,godfcontainer,historylist=[];window.addEventListener&&window.addEventListener("hashchange",function(){var m=window.location.hash;if(m)for(var d=0;d<=historylist.length-1;d++)if(historylist[d].url==m){clearTimeout(clicktimer);clicktimer=setTimeout(function(){try{historylist[d].node.scrollIntoView(!0)}catch(g){}},100);break}});var g_errmsg=function(m){proc_g_errmsg&&proc_g_errmsg(m)},webodf_version="0.5.4";function Runtime(){}
Runtime.prototype.getVariable=function(m){};Runtime.prototype.toJson=function(m){};Runtime.prototype.fromJson=function(m){};Runtime.prototype.byteArrayFromString=function(m,d){};Runtime.prototype.byteArrayToString=function(m,d){};Runtime.prototype.read=function(m,d,g,a){};Runtime.prototype.readFile=function(m,d,g){};Runtime.prototype.readFileSync=function(m,d){};Runtime.prototype.loadXML=function(m,d){};Runtime.prototype.writeFile=function(m,d,g){};Runtime.prototype.deleteFile=function(m,d){};
Runtime.prototype.log=function(m,d){};Runtime.prototype.setTimeout=function(m,d){};Runtime.prototype.clearTimeout=function(m){};Runtime.prototype.libraryPaths=function(){};Runtime.prototype.currentDirectory=function(){};Runtime.prototype.setCurrentDirectory=function(m){};Runtime.prototype.type=function(){};Runtime.prototype.getDOMImplementation=function(){};Runtime.prototype.parseXML=function(m){};Runtime.prototype.exit=function(m){};Runtime.prototype.getWindow=function(){};
Runtime.prototype.requestAnimationFrame=function(m){};Runtime.prototype.cancelAnimationFrame=function(m){};Runtime.prototype.assert=function(m,d){};var IS_COMPILED_CODE=!0;
Runtime.byteArrayToString=function(m,d){function g(a){var f="",c,d=a.length;for(c=0;c<d;c+=1)f+=String.fromCharCode(a[c]&255);return f}function a(a){var f="",c,d=a.length,l=[],r,b,e,k;for(c=0;c<d;c+=1)r=a[c],128>r?l.push(r):(c+=1,b=a[c],194<=r&&224>r?l.push((r&31)<<6|b&63):(c+=1,e=a[c],224<=r&&240>r?l.push((r&15)<<12|(b&63)<<6|e&63):(c+=1,k=a[c],240<=r&&245>r&&(r=(r&7)<<18|(b&63)<<12|(e&63)<<6|k&63,r-=65536,l.push((r>>10)+55296,(r&1023)+56320))))),1E3<=l.length&&(f+=String.fromCharCode.apply(null,
l),l.length=0);return f+String.fromCharCode.apply(null,l)}var c;"utf8"===d?c=a(m):("binary"!==d&&this.log("Unsupported encoding: "+d),c=g(m));return c};Runtime.getVariable=function(m){try{return eval(m)}catch(d){}};Runtime.toJson=function(m){return JSON.stringify(m)};Runtime.fromJson=function(m){return JSON.parse(m)};Runtime.getFunctionName=function(m){return void 0===m.name?(m=/function\s+(\w+)/.exec(m))&&m[1]:m.name};
Runtime.assert=function(m,d){if(!m)throw this.log("alert","ASSERTION FAILED:\n"+d),Error(d);};
function BrowserRuntime(m){function d(l){var a=l.length,b,e,k=0;for(b=0;b<a;b+=1)e=l.charCodeAt(b),k+=1+(128<e)+(2048<e),55040<e&&57344>e&&(k+=1,b+=1);return k}function g(l,a,b){var e=l.length,k,q;a=new Uint8Array(new ArrayBuffer(a));b?(a[0]=239,a[1]=187,a[2]=191,q=3):q=0;for(b=0;b<e;b+=1)k=l.charCodeAt(b),128>k?(a[q]=k,q+=1):2048>k?(a[q]=192|k>>>6,a[q+1]=128|k&63,q+=2):55040>=k||57344<=k?(a[q]=224|k>>>12&15,a[q+1]=128|k>>>6&63,a[q+2]=128|k&63,q+=3):(b+=1,k=(k-55296<<10|l.charCodeAt(b)-56320)+65536,
a[q]=240|k>>>18&7,a[q+1]=128|k>>>12&63,a[q+2]=128|k>>>6&63,a[q+3]=128|k&63,q+=4);return a}function a(l){var a=l.length,b=new Uint8Array(new ArrayBuffer(a)),e;for(e=0;e<a;e+=1)b[e]=l.charCodeAt(e)&255;return b}function c(l,a){var b,e,k;void 0!==a?k=l:a=l;m?(e=m.ownerDocument,k&&(b=e.createElement("span"),b.className=k,b.appendChild(e.createTextNode(k)),m.appendChild(b),m.appendChild(e.createTextNode(" "))),b=e.createElement("span"),0<a.length&&"<"===a[0]?b.innerHTML=a:b.appendChild(e.createTextNode(a)),
m.appendChild(b),m.appendChild(e.createElement("br"))):console&&console.log(a);p.enableAlerts&&"alert"===k&&alert(a)}function h(l,f,b){if(0!==b.status||b.responseText)if(200===b.status||0===b.status){if(b.response&&"string"!==typeof b.response)"binary"===f?(b=b.response,b=new Uint8Array(b)):b=String(b.response);else if("binary"===f)if(null!==b.responseBody&&"undefined"!==String(typeof VBArray)){b=(new VBArray(b.responseBody)).toArray();var e=b.length;f=new Uint8Array(new ArrayBuffer(e));for(l=0;l<
e;l+=1)f[l]=b[l];b=f}else{(l=b.getResponseHeader("Content-Length"))&&(l=parseInt(l,10));if(l&&l!==b.responseText.length)a:{e=b.responseText;f=!1;var k=d(e);if("number"===typeof l){if(l!==k&&l!==k+3){e=void 0;break a}f=k+3===l;k=l}e=g(e,k,f)}void 0===e&&(e=a(b.responseText));b=e}else b=b.responseText;b={err:null,data:b}}else b={err:b.responseText||b.statusText,data:null};else b={err:"File "+l+" is empty.",data:null};return b}function f(a,f,b){var e=new XMLHttpRequest;e.open("GET",a,b);e.overrideMimeType&&
("binary"!==f?e.overrideMimeType("text/plain; charset="+f):e.overrideMimeType("text/plain; charset=x-user-defined"));return e}function n(a,c,b){function e(b){var k=document.getElementById("canvas");k&&(k.innerHTML='<div style="font-size:14px;padding:5px">'+b+'<span id="inner_progress"></span></div>')}var k=f(a,c,!0);k.onreadystatechange=function(){var q;4===k.readyState&&(e("Loading the file... Please wait..."),setTimeout(function(){q=h(a,c,k);b(q.err,q.data)},10))};if(a)if(0==a.toLowerCase().indexOf("blob"))e("Loading the file... Please wait...");
else{e("Downloading the file... Please wait...");var q=(new Date).getTime();k.onprogress=function(b){if(q){var k=new Date;if(300>k.getTime()-q)return;q=k.getTime()}k=b.totalSize||b.total||0;0==k&&"undefined"!==typeof g_docsize&&(k=g_docsize||0);1.8446744073709552E19<=k&&(k=0);b=b.position||b.loaded||0;var e=document.getElementById("inner_progress");e&&(e.innerHTML=" ("+number_format(b)+"/"+number_format(k)+")")}}try{k.send(null)}catch(d){e("Loading..."),b(d.message,null)}}var p=this;this.byteArrayFromString=
function(l,f){var b;"utf8"===f?b=g(l,d(l),!1):("binary"!==f&&p.log("unknown encoding: "+f),b=a(l));return b};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.readFile=n;this.read=function(a,f,b,e){n(a,"binary",function(k,q){var a=null;if(q){if("string"===typeof q)throw"This should not happen.";a=q.subarray(f,f+b)}e(k,a)})};this.readFileSync=function(a,c){var b=f(a,c,!1),e;try{b.send(null);e=h(a,c,b);
if(e.err)throw e.err;if(null===e.data)throw"No data read from "+a+".";}catch(k){throw k;}return e.data};this.writeFile=function(a,f,b){var e=new XMLHttpRequest,k;e.open("PUT",a,!0);e.onreadystatechange=function(){4===e.readyState&&(0!==e.status||e.responseText?200<=e.status&&300>e.status||0===e.status?b(null):b("Status "+String(e.status)+": "+e.responseText||e.statusText):b("File "+a+" is empty."))};k=f.buffer&&!e.sendAsBinary?f.buffer:p.byteArrayToString(f,"binary");try{e.sendAsBinary?e.sendAsBinary(k):
e.send(k)}catch(q){p.log("HUH? "+q+" "+f),b(q.message)}};this.deleteFile=function(a,f){var b=new XMLHttpRequest;b.open("DELETE",a,!0);b.onreadystatechange=function(){4===b.readyState&&(200>b.status&&300<=b.status?f(b.responseText):f(null))};b.send(null)};this.loadXML=function(a,f){var b=new XMLHttpRequest;b.open("GET",a,!0);b.overrideMimeType&&b.overrideMimeType("text/xml");b.onreadystatechange=function(){4===b.readyState&&(0!==b.status||b.responseText?200===b.status||0===b.status?f(null,b.responseXML):
f(b.responseText,null):f("File "+a+" is empty.",null))};try{b.send(null)}catch(e){f(e.message,null)}};this.log=c;this.enableAlerts=!0;this.assert=Runtime.assert;this.setTimeout=function(a,f){return setTimeout(function(){a()},f)};this.clearTimeout=function(a){clearTimeout(a)};this.libraryPaths=function(){return["lib"]};this.setCurrentDirectory=function(){};this.currentDirectory=function(){return""};this.type=function(){return"BrowserRuntime"};this.getDOMImplementation=function(){return window.document.implementation};
this.parseXML=function(a){var f=new DOMParser;a&&(a=a.trim());return f.parseFromString(a,"text/xml")};this.exit=function(a){c("Calling exit with code "+String(a)+", but exit() is not implemented.")};this.getWindow=function(){return window};this.requestAnimationFrame=function(a){var f=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,b=0;if(f)f.bind(window),b=f(a);else return setTimeout(a,15);return b};this.cancelAnimationFrame=
function(a){var f=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame;f?(f.bind(window),f(a)):clearTimeout(a)}}
function NodeJSRuntime(){function m(a){var f=a.length,c,b=new Uint8Array(new ArrayBuffer(f));for(c=0;c<f;c+=1)b[c]=a[c];return b}function d(f,l,d){function b(b,k){if(b)return d(b,null);if(!k)return d("No data for "+f+".",null);if("string"===typeof k)return d(b,k);d(b,m(k))}f=c.resolve(h,f);"binary"!==l?a.readFile(f,l,b):a.readFile(f,null,b)}var g=this,a=require("fs"),c=require("path"),h="",f,n;this.byteArrayFromString=function(a,f){var c=new Buffer(a,f),b,e=c.length,k=new Uint8Array(new ArrayBuffer(e));
for(b=0;b<e;b+=1)k[b]=c[b];return k};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.readFile=d;this.loadXML=function(a,f){d(a,"utf-8",function(c,b){if(c)return f(c,null);if(!b)return f("No data for "+a+".",null);f(null,g.parseXML(b))})};this.writeFile=function(f,l,d){l=new Buffer(l);f=c.resolve(h,f);a.writeFile(f,l,"binary",function(b){d(b||null)})};this.deleteFile=function(f,l){f=c.resolve(h,f);
a.unlink(f,l)};this.read=function(f,l,d,b){f=c.resolve(h,f);a.open(f,"r+",666,function(e,k){if(e)b(e,null);else{var q=new Buffer(d);a.read(k,q,0,d,l,function(e){a.close(k);b(e,m(q))})}})};this.readFileSync=function(f,l){var c;c=a.readFileSync(f,"binary"===l?null:l);if(null===c)throw"File "+f+" could not be read.";"binary"===l&&(c=m(c));return c};this.log=function(a,f){var c;void 0!==f?c=a:f=a;"alert"===c&&process.stderr.write("\n!!!!! ALERT !!!!!\n");process.stderr.write(f+"\n");"alert"===c&&process.stderr.write("!!!!! ALERT !!!!!\n")};
this.assert=Runtime.assert;this.setTimeout=function(a,f){return setTimeout(function(){a()},f)};this.clearTimeout=function(a){clearTimeout(a)};this.libraryPaths=function(){return[__dirname]};this.setCurrentDirectory=function(a){h=a};this.currentDirectory=function(){return h};this.type=function(){return"NodeJSRuntime"};this.getDOMImplementation=function(){return n};this.parseXML=function(a){a&&(a=a.trim());return f.parseFromString(a,"text/xml")};this.exit=process.exit;this.getWindow=function(){return null};
this.requestAnimationFrame=function(a){return setTimeout(a,15)};this.cancelAnimationFrame=function(a){clearTimeout(a)};f=new (require("xmldom").DOMParser);n=g.parseXML("<a/>").implementation}
function RhinoRuntime(){var m=this,d={},g=d.javax.xml.parsers.DocumentBuilderFactory.newInstance(),a,c,h="";g.setValidating(!1);g.setNamespaceAware(!0);g.setExpandEntityReferences(!1);g.setSchema(null);c=d.org.xml.sax.EntityResolver({resolveEntity:function(a,c){var h=new d.java.io.FileReader(c);return new d.org.xml.sax.InputSource(h)}});a=g.newDocumentBuilder();a.setEntityResolver(c);this.byteArrayFromString=function(a,c){var d,l=a.length,h=new Uint8Array(new ArrayBuffer(l));for(d=0;d<l;d+=1)h[d]=
a.charCodeAt(d)&255;return h};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.loadXML=function(f,c){var h=new d.java.io.File(f),l=null;try{l=a.parse(h)}catch(g){return print(g),c(g,null)}c(null,l)};this.readFile=function(a,c,g){h&&(a=h+"/"+a);var l=new d.java.io.File(a),r="binary"===c?"latin1":c;l.isFile()?((a=readFile(a,r))&&"binary"===c&&(a=m.byteArrayFromString(a,"binary")),g(null,a)):g(a+" is not a file.",
null)};this.writeFile=function(a,c,g){h&&(a=h+"/"+a);a=new d.java.io.FileOutputStream(a);var l,r=c.length;for(l=0;l<r;l+=1)a.write(c[l]);a.close();g(null)};this.deleteFile=function(a,c){h&&(a=h+"/"+a);var g=new d.java.io.File(a),l=a+Math.random(),l=new d.java.io.File(l);g.rename(l)?(l.deleteOnExit(),c(null)):c("Could not delete "+a)};this.read=function(a,c,g,l){h&&(a=h+"/"+a);var r;r=a;var b="binary";(new d.java.io.File(r)).isFile()?("binary"===b&&(b="latin1"),r=readFile(r,b)):r=null;r?l(null,this.byteArrayFromString(r.substring(c,
c+g),"binary")):l("Cannot read "+a,null)};this.readFileSync=function(a,c){if(!c)return"";var d=readFile(a,c);if(null===d)throw"File could not be read.";return d};this.log=function(a,c){var d;void 0!==c?d=a:c=a;"alert"===d&&print("\n!!!!! ALERT !!!!!");print(c);"alert"===d&&print("!!!!! ALERT !!!!!")};this.assert=Runtime.assert;this.setTimeout=function(a){a();return 0};this.clearTimeout=function(){};this.libraryPaths=function(){return["lib"]};this.setCurrentDirectory=function(a){h=a};this.currentDirectory=
function(){return h};this.type=function(){return"RhinoRuntime"};this.getDOMImplementation=function(){return a.getDOMImplementation()};this.parseXML=function(c){c=new d.java.io.StringReader(c);c=new d.org.xml.sax.InputSource(c);return a.parse(c)};this.exit=quit;this.getWindow=function(){return null};this.requestAnimationFrame=function(a){a();return 0};this.cancelAnimationFrame=function(){}}
Runtime.create=function(){return"undefined"!==String(typeof window)?new BrowserRuntime(window.document.getElementById("logoutput")):"undefined"!==String(typeof require)?new NodeJSRuntime:new RhinoRuntime};var runtime=Runtime.create(),core={},gui={},xmldom={},odf={},ops={},webodf={};(function(){webodf.Version="undefined"!==String(typeof webodf_version)?webodf_version:"From Source"})();
(function(){function m(a,c,f){var d=a+"/manifest.json",b,e;runtime.log("Loading manifest: "+d);try{b=runtime.readFileSync(d,"utf-8")}catch(k){if(f)runtime.log("No loadable manifest found.");else throw console.log(String(k)),k;return}f=JSON.parse(b);for(e in f)f.hasOwnProperty(e)&&(c[e]={dir:a,deps:f[e]})}function d(a,c,f){function d(q){if(!k[q]&&!f(q)){if(e[q])throw"Circular dependency detected for "+q+".";e[q]=!0;if(!c[q])throw"Missing dependency information for class "+q+".";var a=c[q],h=a.deps,
g,n=h.length;for(g=0;g<n;g+=1)d(h[g]);e[q]=!1;k[q]=!0;b.push(a.dir+"/"+q.replace(".","/")+".js")}}var b=[],e={},k={};a.forEach(d);return b}function g(a,c){return c+("\n//# sourceURL="+a)}function a(a){var c,f;for(c=0;c<a.length;c+=1)f=runtime.readFileSync(a[c],"utf-8"),f=g(a[c],f),eval(f)}function c(a){a=a.split(".");var c,d=f,h=a.length;for(c=0;c<h;c+=1){if(!d.hasOwnProperty(a[c]))return!1;d=d[a[c]]}return!0}var h,f={core:core,gui:gui,xmldom:xmldom,odf:odf,ops:ops};runtime.loadClasses=function(f,
g){if(IS_COMPILED_CODE||0===f.length)return g&&g();var l;if(!(l=h)){l=[];var r=runtime.libraryPaths(),b;runtime.currentDirectory()&&-1===r.indexOf(runtime.currentDirectory())&&m(runtime.currentDirectory(),l,!0);for(b=0;b<r.length;b+=1)m(r[b],l)}h=l;f=d(f,h,c);if(0===f.length)return g&&g();if("BrowserRuntime"===runtime.type()&&g){l=f;r=document.currentScript||document.documentElement.lastChild;b=document.createDocumentFragment();var e,k;for(k=0;k<l.length;k+=1)e=document.createElement("script"),e.type=
"text/javascript",e.charset="utf-8",e.async=!1,e.setAttribute("src",l[k]),b.appendChild(e);g&&(e.onload=g);r.parentNode.insertBefore(b,r)}else a(f),g&&g()};runtime.loadClass=function(a,c){runtime.loadClasses([a],c)}})();(function(){var m=function(d){return d};runtime.getTranslator=function(){return m};runtime.setTranslator=function(d){m=d};runtime.tr=function(d){var g=m(d);return g&&"string"===String(typeof g)?g:d}})();
(function(m){function d(d){if(d.length){var a=d[0];runtime.readFile(a,"utf8",function(c,h){function f(){var a;(a=eval(m))&&runtime.exit(a)}var n="",n=a.lastIndexOf("/"),m=h,n=-1!==n?a.substring(0,n):".";runtime.setCurrentDirectory(n);c?(runtime.log(c),runtime.exit(1)):null===m?(runtime.log("No code found for "+a),runtime.exit(1)):f.apply(null,d)})}}m=m?Array.prototype.slice.call(m):[];"NodeJSRuntime"===runtime.type()?d(process.argv.slice(2)):"RhinoRuntime"===runtime.type()?d(m):d(m.slice(1))})("undefined"!==
String(typeof arguments)&&arguments);(function(){core.Async=function(){return{forEach:function(m,d,g){function a(a){f!==h&&(a?(f=h,g(a)):(f+=1,f===h&&g(null)))}var c,h=m.length,f=0;for(c=0;c<h;c+=1)d(m[c],a)},destroyAll:function(m,d){function g(a,c){if(c)d(c);else if(a<m.length)m[a](function(c){g(a+1,c)});else d()}g(0,void 0)}}}()})();
function makeBase64(){function m(b){var k,e=b.length,q=new Uint8Array(new ArrayBuffer(e));for(k=0;k<e;k+=1)q[k]=b.charCodeAt(k)&255;return q}function d(b){var k,e="",q,a=b.length-2;for(q=0;q<a;q+=3)k=b[q]<<16|b[q+1]<<8|b[q+2],e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k>>>18],e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k>>>12&63],e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k>>>6&63],e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k&
63];q===a+1?(k=b[q]<<4,e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k>>>6],e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k&63],e+="=="):q===a&&(k=b[q]<<10|b[q+1]<<2,e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k>>>12],e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k>>>6&63],e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[k&63],e+="=");return e}function g(b){b=b.replace(/[^A-Za-z0-9+\/]+/g,
"");var k=b.length,e=new Uint8Array(new ArrayBuffer(3*k)),a=b.length%4,c=0,f,s;for(f=0;f<k;f+=4)s=(q[b.charAt(f)]||0)<<18|(q[b.charAt(f+1)]||0)<<12|(q[b.charAt(f+2)]||0)<<6|(q[b.charAt(f+3)]||0),e[c]=s>>16,e[c+1]=s>>8&255,e[c+2]=s&255,c+=3;k=3*k-[0,0,2,1][a];return e.subarray(0,k)}function a(b){var k,e,q=b.length,a=0,c=new Uint8Array(new ArrayBuffer(3*q));for(k=0;k<q;k+=1)e=b[k],128>e?c[a++]=e:(2048>e?c[a++]=192|e>>>6:(c[a++]=224|e>>>12&15,c[a++]=128|e>>>6&63),c[a++]=128|e&63);return c.subarray(0,
a)}function c(b){var k,e,q,a,c=b.length,s=new Uint8Array(new ArrayBuffer(c)),f=0;for(k=0;k<c;k+=1)e=b[k],128>e?s[f++]=e:(k+=1,q=b[k],224>e?s[f++]=(e&31)<<6|q&63:(k+=1,a=b[k],s[f++]=(e&15)<<12|(q&63)<<6|a&63));return s.subarray(0,f)}function h(k){return d(m(k))}function f(k){return String.fromCharCode.apply(String,g(k))}function n(k){return c(m(k))}function p(k){k=c(k);for(var b="",e=0;e<k.length;)b+=String.fromCharCode.apply(String,k.subarray(e,e+45E3)),e+=45E3;return b}function l(k,b,e){var q,a,
c,s="";for(c=b;c<e;c+=1)b=k.charCodeAt(c)&255,128>b?s+=String.fromCharCode(b):(c+=1,q=k.charCodeAt(c)&255,224>b?s+=String.fromCharCode((b&31)<<6|q&63):(c+=1,a=k.charCodeAt(c)&255,s+=String.fromCharCode((b&15)<<12|(q&63)<<6|a&63)));return s}function r(k,b){function e(){var c=a+1E5;c>k.length&&(c=k.length);q+=l(k,a,c);a=c;c=a===k.length;b(q,c)&&!c&&runtime.setTimeout(e,0)}var q="",a=0;1E5>k.length?b(l(k,0,k.length),!0):("string"!==typeof k&&(k=k.slice()),e())}function b(k){return a(m(k))}function e(k){return String.fromCharCode.apply(String,
a(k))}function k(k){return String.fromCharCode.apply(String,a(m(k)))}var q=function(k){var b={},e,q;e=0;for(q=k.length;e<q;e+=1)b[k.charAt(e)]=e;return b}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),x,A,v=runtime.getWindow(),t,B;v&&v.btoa?(t=v.btoa,x=function(b){return t(k(b))}):(t=h,x=function(k){return d(b(k))});v&&v.atob?(B=v.atob,A=function(k){k=B(k);return l(k,0,k.length)}):(B=f,A=function(k){return p(g(k))});core.Base64=function(){this.convertByteArrayToBase64=this.convertUTF8ArrayToBase64=
d;this.convertBase64ToByteArray=this.convertBase64ToUTF8Array=g;this.convertUTF16ArrayToByteArray=this.convertUTF16ArrayToUTF8Array=a;this.convertByteArrayToUTF16Array=this.convertUTF8ArrayToUTF16Array=c;this.convertUTF8StringToBase64=h;this.convertBase64ToUTF8String=f;this.convertUTF8StringToUTF16Array=n;this.convertByteArrayToUTF16String=this.convertUTF8ArrayToUTF16String=p;this.convertUTF8StringToUTF16String=r;this.convertUTF16StringToByteArray=this.convertUTF16StringToUTF8Array=b;this.convertUTF16ArrayToUTF8String=
e;this.convertUTF16StringToUTF8String=k;this.convertUTF16StringToBase64=x;this.convertBase64ToUTF16String=A;this.fromBase64=f;this.toBase64=h;this.atob=B;this.btoa=t;this.utob=k;this.btou=r;this.encode=x;this.encodeURI=function(k){return x(k).replace(/[+\/]/g,function(k){return"+"===k?"-":"_"}).replace(/\\=+$/,"")};this.decode=function(k){return A(k.replace(/[\-_]/g,function(k){return"-"===k?"+":"/"}))};return this};return core.Base64}core.Base64=makeBase64();
core.ByteArray=function(m){this.pos=0;this.data=m;this.readUInt32LE=function(){this.pos+=4;var d=this.data,g=this.pos;return d[--g]<<24|d[--g]<<16|d[--g]<<8|d[--g]};this.readUInt16LE=function(){this.pos+=2;var d=this.data,g=this.pos;return d[--g]<<8|d[--g]}};
core.ByteArrayWriter=function(m){function d(f){f>c-a&&(c=Math.max(2*c,a+f),f=new Uint8Array(new ArrayBuffer(c)),f.set(h),h=f)}var g=this,a=0,c=1024,h=new Uint8Array(new ArrayBuffer(c));this.appendByteArrayWriter=function(a){g.appendByteArray(a.getByteArray())};this.appendByteArray=function(c){var g=c.length;d(g);h.set(c,a);a+=g};this.appendArray=function(c){var g=c.length;d(g);h.set(c,a);a+=g};this.appendUInt16LE=function(a){g.appendArray([a&255,a>>8&255])};this.appendUInt32LE=function(a){g.appendArray([a&
255,a>>8&255,a>>16&255,a>>24&255])};this.appendString=function(a){g.appendByteArray(runtime.byteArrayFromString(a,m))};this.getLength=function(){return a};this.getByteArray=function(){var c=new Uint8Array(new ArrayBuffer(a));c.set(h.subarray(0,a));return c}};
core.CSSUnits=function(){var m=this,d={"in":1,cm:2.54,mm:25.4,pt:72,pc:12,px:96};this.convert=function(g,a,c){return g*d[c]/d[a]};this.convertMeasure=function(d,a){var c,h;d&&a&&(c=parseFloat(d),h=d.replace(c.toString(),""),c=m.convert(c,h,a));return c};this.getUnits=function(d){return d.substr(d.length-2,d.length)}};
(function(){function m(){var a,c,d,f,n,m,l,r,b;void 0===g&&(c=(a=runtime.getWindow())&&a.document,m=c.documentElement,l=c.body,g={rangeBCRIgnoresElementBCR:!1,unscaledRangeClientRects:!1,elementBCRIgnoresBodyScroll:!1},c&&(f=c.createElement("div"),f.style.position="absolute",f.style.left="-99999px",f.style.transform="scale(2)",f.style["-webkit-transform"]="scale(2)",n=c.createElement("div"),f.appendChild(n),l.appendChild(f),a=c.createRange(),a.selectNode(n),g.rangeBCRIgnoresElementBCR=0===a.getClientRects().length,
n.appendChild(c.createTextNode("Rect transform test")),c=n.getBoundingClientRect(),d=a.getBoundingClientRect(),g.unscaledRangeClientRects=2<Math.abs(c.height-d.height),f.style.transform="",f.style["-webkit-transform"]="",c=m.style.overflow,d=l.style.overflow,r=l.style.height,b=l.scrollTop,m.style.overflow="visible",l.style.overflow="visible",l.style.height="200%",l.scrollTop=l.scrollHeight,g.elementBCRIgnoresBodyScroll=a.getBoundingClientRect().top!==n.getBoundingClientRect().top,l.scrollTop=b,l.style.height=
r,l.style.overflow=d,m.style.overflow=c,a.detach(),l.removeChild(f),a=Object.keys(g).map(function(b){return b+":"+String(g[b])}).join(", "),runtime.log("Detected browser quirks - "+a)));return g}function d(a,c,d){for(a=a?a.firstElementChild:null;a;){if(a.localName===d&&a.namespaceURI===c)return a;a=a.nextElementSibling}return null}var g;core.DomUtilsImpl=function(){function a(k,b){for(var e=0,a;k.parentNode!==b;)runtime.assert(null!==k.parentNode,"parent is null"),k=k.parentNode;for(a=b.firstChild;a!==
k;)e+=1,a=a.nextSibling;return e}function c(k,b){return 0>=k.compareBoundaryPoints(Range.START_TO_START,b)&&0<=k.compareBoundaryPoints(Range.END_TO_END,b)}function h(k,b){return 0>=k.compareBoundaryPoints(Range.END_TO_START,b)&&0<=k.compareBoundaryPoints(Range.START_TO_END,b)}function f(k,b){var e=null;k.nodeType===Node.TEXT_NODE&&(0===k.length?(k.parentNode.removeChild(k),b.nodeType===Node.TEXT_NODE&&(e=b)):(b.nodeType===Node.TEXT_NODE&&(k.appendData(b.data),b.parentNode.removeChild(b)),e=k));return e}
function g(k){for(var b=k.parentNode;k.firstChild;)b.insertBefore(k.firstChild,k);b.removeChild(k);return b}function p(k,b){for(var e=k.parentNode,a=k.firstChild,c;a;)c=a.nextSibling,p(a,b),a=c;e&&b(k)&&g(k);return e}function l(k,b){return k===b||Boolean(k.compareDocumentPosition(b)&Node.DOCUMENT_POSITION_CONTAINED_BY)}function r(k,b){return m().unscaledRangeClientRects?k:k/b}function b(k,e,a){Object.keys(e).forEach(function(c){var f=c.split(":"),d=f[1],l=a(f[0]),f=e[c],h=typeof f;"object"===h?Object.keys(f).length&&
(c=l?k.getElementsByTagNameNS(l,d)[0]||k.ownerDocument.createElementNS(l,c):k.getElementsByTagName(d)[0]||k.ownerDocument.createElement(c),k.appendChild(c),b(c,f,a)):l&&(runtime.assert("number"===h||"string"===h,"attempting to map unsupported type '"+h+"' (key: "+c+")"),k.setAttributeNS(l,c,String(f)))})}var e=null;this.splitBoundaries=function(k){var b,e=[],c,f,d;if(k.startContainer.nodeType===Node.TEXT_NODE||k.endContainer.nodeType===Node.TEXT_NODE){c=k.endContainer;f=k.endContainer.nodeType!==
Node.TEXT_NODE?k.endOffset===k.endContainer.childNodes.length:!1;d=k.endOffset;b=k.endContainer;if(d<b.childNodes.length)for(b=b.childNodes.item(d),d=0;b.firstChild;)b=b.firstChild;else for(;b.lastChild;)b=b.lastChild,d=b.nodeType===Node.TEXT_NODE?b.textContent.length:b.childNodes.length;b===c&&(c=null);k.setEnd(b,d);d=k.endContainer;0!==k.endOffset&&d.nodeType===Node.TEXT_NODE&&(b=d,k.endOffset!==b.length&&(e.push(b.splitText(k.endOffset)),e.push(b)));d=k.startContainer;0!==k.startOffset&&d.nodeType===
Node.TEXT_NODE&&(b=d,k.startOffset!==b.length&&(d=b.splitText(k.startOffset),e.push(b),e.push(d),k.setStart(d,0)));if(null!==c){for(d=k.endContainer;d.parentNode&&d.parentNode!==c;)d=d.parentNode;f=f?c.childNodes.length:a(d,c);k.setEnd(c,f)}}return e};this.containsRange=c;this.rangesIntersect=h;this.rangeIntersection=function(b,e){var a;h(b,e)&&(a=b.cloneRange(),-1===b.compareBoundaryPoints(Range.START_TO_START,e)&&a.setStart(e.startContainer,e.startOffset),1===b.compareBoundaryPoints(Range.END_TO_END,
e)&&a.setEnd(e.endContainer,e.endOffset));return a};this.getNodesInRange=function(b,e,a){var c=[],f=b.commonAncestorContainer,f=f.nodeType===Node.TEXT_NODE?f.parentNode:f;a=b.startContainer.ownerDocument.createTreeWalker(f,a,e,!1);var d,l;b.endContainer.childNodes[b.endOffset-1]?(d=b.endContainer.childNodes[b.endOffset-1],l=Node.DOCUMENT_POSITION_PRECEDING|Node.DOCUMENT_POSITION_CONTAINED_BY):(d=b.endContainer,l=Node.DOCUMENT_POSITION_PRECEDING);if(b.startContainer.childNodes[b.startOffset])b=b.startContainer.childNodes[b.startOffset],
a.currentNode=b;else{var h=b.startContainer;b.startOffset===(h.nodeType===Node.TEXT_NODE?h.length:h.childNodes.length)?(b=b.startContainer,a.currentNode=b,a.lastChild(),b=a.nextNode()):(b=b.startContainer,a.currentNode=b)}if(b){b=a.currentNode;if(b!==f)for(b=b.parentNode;b&&b!==f;)e(b)===NodeFilter.FILTER_REJECT&&(a.currentNode=b),b=b.parentNode;b=a.currentNode;switch(e(b)){case NodeFilter.FILTER_REJECT:for(b=a.nextSibling();!b&&a.parentNode();)b=a.nextSibling();break;case NodeFilter.FILTER_SKIP:b=
a.nextNode()}for(;b;){e=d.compareDocumentPosition(b);if(0!==e&&0===(e&l))break;c.push(b);b=a.nextNode()}}return c};this.normalizeTextNodes=function(b){b&&b.nextSibling&&(b=f(b,b.nextSibling));b&&b.previousSibling&&f(b.previousSibling,b)};this.rangeContainsNode=function(b,e){var a=e.ownerDocument.createRange(),f=e.ownerDocument.createRange(),d;a.setStart(b.startContainer,b.startOffset);a.setEnd(b.endContainer,b.endOffset);f.selectNodeContents(e);d=c(a,f);a.detach();f.detach();return d};this.mergeIntoParent=
g;this.removeUnwantedNodes=p;this.getElementsByTagNameNS=function(b,e,a){var c=[];b=b.getElementsByTagNameNS(e,a);c.length=a=b.length;for(e=0;e<a;e+=1)c[e]=b.item(e);return c};this.getElementsByTagName=function(b,e){var a=[],c,f,d;c=b.getElementsByTagName(e);a.length=d=c.length;for(f=0;f<d;f+=1)a[f]=c.item(f);return a};this.containsNode=function(b,e){return b===e||b.contains(e)};this.comparePoints=function(b,e,c,f){if(b===c)return f-e;var d=b.compareDocumentPosition(c);2===d?d=-1:4===d?d=1:10===d?
(e=a(b,c),d=e<f?1:-1):(f=a(c,b),d=f<e?-1:1);return d};this.adaptRangeDifferenceToZoomLevel=r;this.translateRect=function(b,e,a){return{top:r(b.top-e.top,a),left:r(b.left-e.left,a),bottom:r(b.bottom-e.top,a),right:r(b.right-e.left,a),width:r(b.width,a),height:r(b.height,a)}};this.getBoundingClientRect=function(b){var a=b.ownerDocument,c=m(),f=a.body;if((!1===c.unscaledRangeClientRects||c.rangeBCRIgnoresElementBCR)&&b.nodeType===Node.ELEMENT_NODE)return b=b.getBoundingClientRect(),c.elementBCRIgnoresBodyScroll?
{left:b.left+f.scrollLeft,right:b.right+f.scrollLeft,top:b.top+f.scrollTop,bottom:b.bottom+f.scrollTop,width:b.width,height:b.height}:b;var d;e?d=e:e=d=a.createRange();c=d;c.selectNode(b);return c.getBoundingClientRect()};this.mapKeyValObjOntoNode=function(b,e,a){Object.keys(e).forEach(function(c){var f=c.split(":"),d=f[1],f=a(f[0]),l=e[c];f?(d=b.getElementsByTagNameNS(f,d)[0],d||(d=b.ownerDocument.createElementNS(f,c),b.appendChild(d)),d.textContent=l):runtime.log("Key ignored: "+c)})};this.removeKeyElementsFromNode=
function(b,e,a){e.forEach(function(e){var c=e.split(":"),q=c[1];(c=a(c[0]))?(q=b.getElementsByTagNameNS(c,q)[0])?q.parentNode.removeChild(q):runtime.log("Element for "+e+" not found."):runtime.log("Property Name ignored: "+e)})};this.getKeyValRepresentationOfNode=function(b,e){for(var a={},c=b.firstElementChild,f;c;){if(f=e(c.namespaceURI))a[f+":"+c.localName]=c.textContent;c=c.nextElementSibling}return a};this.mapObjOntoNode=b;this.cloneEvent=function(b){var e=Object.create(null);Object.keys(b.constructor.prototype).forEach(function(a){e[a]=
b[a]});null==e.clientX&&(e=Object.create(null),Object.keys(b).forEach(function(a){e[a]=b[a]}));e.prototype=b.constructor.prototype;return e};this.getDirectChild=d;(function(b){var e,a;a=runtime.getWindow();null!==a&&(e=a.navigator.appVersion.toLowerCase(),a=-1===e.indexOf("chrome")&&(-1!==e.indexOf("applewebkit")||-1!==e.indexOf("safari")),e=-1!==e.indexOf("msie")||-1!==e.indexOf("trident"),a||e)&&(b.containsNode=l)})(this)};core.DomUtils=new core.DomUtilsImpl})();
core.Cursor=function(m,d){function g(b){b.parentNode&&(n.push(b.previousSibling),n.push(b.nextSibling),b.parentNode.removeChild(b))}function a(b,e,k){if(e.nodeType===Node.TEXT_NODE){runtime.assert(Boolean(e),"putCursorIntoTextNode: invalid container");var a=e.parentNode;runtime.assert(Boolean(a),"putCursorIntoTextNode: container without parent");runtime.assert(0<=k&&k<=e.length,"putCursorIntoTextNode: offset is out of bounds");0===k?a.insertBefore(b,e):(k!==e.length&&e.splitText(k),a.insertBefore(b,
e.nextSibling))}else e.nodeType===Node.ELEMENT_NODE&&e.insertBefore(b,e.childNodes.item(k));n.push(b.previousSibling);n.push(b.nextSibling)}var c=m.createElementNS("urn:webodf:names:cursor","cursor"),h=m.createElementNS("urn:webodf:names:cursor","anchor"),f,n=[],p=m.createRange(),l,r=core.DomUtils;this.getNode=function(){return c};this.getAnchorNode=function(){return h.parentNode?h:c};this.getSelectedRange=function(){l?(p.setStartBefore(c),p.collapse(!0)):(p.setStartAfter(f?h:c),p.setEndBefore(f?
c:h));return p};this.setSelectedRange=function(b,e){p&&p!==b&&p.detach();p=b;f=!1!==e;(l=b.collapsed)?(g(h),g(c),a(c,b.startContainer,b.startOffset)):(g(h),g(c),a(f?c:h,b.endContainer,b.endOffset),a(f?h:c,b.startContainer,b.startOffset));n.forEach(r.normalizeTextNodes);n.length=0};this.hasForwardSelection=function(){return f};this.remove=function(){g(c);n.forEach(r.normalizeTextNodes);n.length=0};c.setAttributeNS("urn:webodf:names:cursor","memberId",d);h.setAttributeNS("urn:webodf:names:cursor","memberId",
d)};core.Destroyable=function(){};core.Destroyable.prototype.destroy=function(m){};core.EventSource=function(){};core.EventSource.prototype.subscribe=function(m,d){};core.EventSource.prototype.unsubscribe=function(m,d){};
core.EventNotifier=function(m){function d(a){runtime.assert(!g.hasOwnProperty(a),'Duplicated event ids: "'+a+'" registered more than once.');g[a]=[]}var g={};this.emit=function(a,c){var d,f;runtime.assert(g.hasOwnProperty(a),'unknown event fired "'+a+'"');f=g[a];for(d=0;d<f.length;d+=1)f[d](c)};this.subscribe=function(a,c){runtime.assert(g.hasOwnProperty(a),'tried to subscribe to unknown event "'+a+'"');g[a].push(c)};this.unsubscribe=function(a,c){var d;runtime.assert(g.hasOwnProperty(a),'tried to unsubscribe from unknown event "'+
a+'"');d=g[a].indexOf(c);runtime.assert(-1!==d,'tried to unsubscribe unknown callback from event "'+a+'"');-1!==d&&g[a].splice(d,1)};this.register=d;m&&m.forEach(d)};
core.ScheduledTask=function(m,d,g){function a(){f&&(g(h),f=!1)}function c(){a();m.apply(void 0,n);n=null}var h,f=!1,n=[],p=!1;this.trigger=function(){runtime.assert(!1===p,"Can't trigger destroyed ScheduledTask instance");n=Array.prototype.slice.call(arguments);f||(f=!0,h=d(c))};this.triggerImmediate=function(){runtime.assert(!1===p,"Can't trigger destroyed ScheduledTask instance");n=Array.prototype.slice.call(arguments);c()};this.processRequests=function(){f&&c()};this.cancel=a;this.restart=function(){runtime.assert(!1===
p,"Can't trigger destroyed ScheduledTask instance");a();f=!0;h=d(c)};this.destroy=function(c){a();p=!0;c()}};
(function(){var m;core.Task={};core.Task.SUPPRESS_MANUAL_PROCESSING=!1;core.Task.processTasks=function(){core.Task.SUPPRESS_MANUAL_PROCESSING||m.performRedraw()};core.Task.createRedrawTask=function(d){return new core.ScheduledTask(d,m.requestRedrawTask,m.cancelRedrawTask)};core.Task.createTimeoutTask=function(d,g){return new core.ScheduledTask(d,function(a){return runtime.setTimeout(a,g)},runtime.clearTimeout)};m=new function(){var d={};this.requestRedrawTask=function(g){var a=runtime.requestAnimationFrame(function(){g();
delete d[a]});d[a]=g;return a};this.performRedraw=function(){Object.keys(d).forEach(function(g){d[g]();runtime.cancelAnimationFrame(parseInt(g,10))});d={}};this.cancelRedrawTask=function(g){runtime.cancelAnimationFrame(g);delete d[g]}}})();
core.EventSubscriptions=function(){function m(a,c,d){a.subscribe(c,d);g.push({eventSource:a,eventid:c,callback:d})}function d(){var f=[];g.forEach(function(a){a.eventSource.unsubscribe(a.eventid,a.callback)});g.length=0;Object.keys(c).forEach(function(a){c[a].forEach(function(a){f.push(a.task.destroy)});delete c[a]});core.Async.destroyAll(f,function(){});a=new core.EventNotifier}var g=[],a=new core.EventNotifier,c={},h=0;this.addSubscription=m;this.addFrameSubscription=function(f,d,g){var l,r,b,e;
c.hasOwnProperty(d)||(c[d]=[]);b=c[d];for(e=0;e<b.length;e+=1)if(b[e].eventSource===f){l=b[e];break}l||(r="s"+h,h+=1,a.register(r),l={frameEventId:r,eventSource:f,task:core.Task.createRedrawTask(function(){a.emit(r,void 0)})},b.push(l),m(f,d,l.task.trigger));a.subscribe(l.frameEventId,g)};this.unsubscribeAll=d;this.destroy=function(a){d();a()}};core.LazyProperty=function(m){var d,g=!1;this.value=function(){g||(d=m(),g=!0);return d};this.reset=function(){g=!1}};
core.LoopWatchDog=function(m,d){var g=Date.now(),a=0;this.check=function(){var c;if(m&&(c=Date.now(),c-g>m))throw runtime.log("alert","watchdog timeout"),"timeout!";if(0<d&&(a+=1,a>d))throw runtime.log("alert","watchdog loop overflow"),"loop overflow";}};core.NodeFilterChain=function(m){var d=NodeFilter.FILTER_REJECT,g=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(a){var c;for(c=0;c<m.length;c+=1)if(m[c].acceptNode(a)===d)return d;return g}};
core.PositionIterator=function(m,d,g,a){function c(){this.acceptNode=function(b){return!b||b.nodeType===k&&0===b.length?A:x}}function h(b){this.acceptNode=function(e){return!e||e.nodeType===k&&0===e.length?A:b.acceptNode(e)}}function f(){var e=r.currentNode,a=e.nodeType;b=a===k?e.length-1:a===q?1:0}function n(){if(null===r.previousSibling()){if(!r.parentNode()||r.currentNode===m)return r.firstChild(),!1;b=0}else f();return!0}function p(){var a=r.currentNode,c;c=e(a);if(a!==m)for(a=a.parentNode;a&&
a!==m;)e(a)===A&&(r.currentNode=a,c=A),a=a.parentNode;c===A?(b=r.currentNode.nodeType===k?a.length:1,a=l.nextPosition()):a=c===x?!0:l.nextPosition();a&&runtime.assert(e(r.currentNode)===x,"moveToAcceptedNode did not result in walker being on an accepted node");return a}var l=this,r,b,e,k=Node.TEXT_NODE,q=Node.ELEMENT_NODE,x=NodeFilter.FILTER_ACCEPT,A=NodeFilter.FILTER_REJECT;this.nextPosition=function(){var e=r.currentNode,a=e.nodeType;if(e===m)return!1;if(0===b&&a===q)null===r.firstChild()&&(b=1);
else if(a===k&&b+1<e.length)b+=1;else if(null!==r.nextSibling())b=0;else if(r.parentNode())b=1;else return!1;return!0};this.previousPosition=function(){var e=!0,a=r.currentNode;0===b?e=n():a.nodeType===k?b-=1:null!==r.lastChild()?f():a===m?e=!1:b=0;return e};this.previousNode=n;this.container=function(){var e=r.currentNode,a=e.nodeType;0===b&&a!==k&&(e=e.parentNode);return e};this.rightNode=function(){var a=r.currentNode,c=a.nodeType;if(c===k&&b===a.length)for(a=a.nextSibling;a&&e(a)!==x;)a=a.nextSibling;
else c===q&&1===b&&(a=null);return a};this.leftNode=function(){var a=r.currentNode;if(0===b)for(a=a.previousSibling;a&&e(a)!==x;)a=a.previousSibling;else if(a.nodeType===q)for(a=a.lastChild;a&&e(a)!==x;)a=a.previousSibling;return a};this.getCurrentNode=function(){return r.currentNode};this.unfilteredDomOffset=function(){if(r.currentNode.nodeType===k)return b;for(var e=0,a=r.currentNode,a=1===b?a.lastChild:a.previousSibling;a;)e+=1,a=a.previousSibling;return e};this.getPreviousSibling=function(){var b=
r.currentNode,e=r.previousSibling();r.currentNode=b;return e};this.getNextSibling=function(){var b=r.currentNode,e=r.nextSibling();r.currentNode=b;return e};this.setPositionBeforeElement=function(e){runtime.assert(Boolean(e),"setPositionBeforeElement called without element");r.currentNode=e;b=0;return p()};this.setUnfilteredPosition=function(e,a){runtime.assert(Boolean(e),"PositionIterator.setUnfilteredPosition called without container");r.currentNode=e;e.nodeType===k?(b=a,runtime.assert(a<=e.length,
"Error in setPosition: "+a+" > "+e.length),runtime.assert(0<=a,"Error in setPosition: "+a+" < 0"),a===e.length&&(r.nextSibling()?b=0:r.parentNode()?b=1:runtime.assert(!1,"Error in setUnfilteredPosition: position not valid."))):a<e.childNodes.length?(r.currentNode=e.childNodes.item(a),b=0):b=1;return p()};this.moveToEnd=function(){r.currentNode=m;b=1};this.moveToEndOfNode=function(e){e.nodeType===k?l.setUnfilteredPosition(e,e.length):(r.currentNode=e,b=1)};this.isBeforeNode=function(){return 0===b};
this.getNodeFilter=function(){return e};e=(g?new h(g):new c).acceptNode;e.acceptNode=e;d=d||NodeFilter.SHOW_ALL;runtime.assert(m.nodeType!==Node.TEXT_NODE,"Internet Explorer doesn't allow tree walker roots to be text nodes");r=m.ownerDocument.createTreeWalker(m,d,e,a);b=0;null===r.firstChild()&&(b=1)};core.PositionFilter=function(){};core.PositionFilter.FilterResult={FILTER_ACCEPT:1,FILTER_REJECT:2,FILTER_SKIP:3};core.PositionFilter.prototype.acceptPosition=function(m){};
core.PositionFilterChain=function(){var m=[],d=core.PositionFilter.FilterResult.FILTER_ACCEPT,g=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(a){var c;for(c=0;c<m.length;c+=1)if(m[c].acceptPosition(a)===g)return g;return d};this.addFilter=function(a){m.push(a)}};core.StepDirection={PREVIOUS:1,NEXT:2};
core.StepIterator=function(m,d){function g(){b=null;k=e=void 0}function a(){void 0===k&&(k=m.acceptPosition(d)===l);return k}function c(b,e){g();return d.setUnfilteredPosition(b,e)}function h(){b||(b=d.container());return b}function f(){void 0===e&&(e=d.unfilteredDomOffset());return e}function n(){for(g();d.nextPosition();)if(g(),a())return!0;return!1}function p(){for(g();d.previousPosition();)if(g(),a())return!0;return!1}var l=core.PositionFilter.FilterResult.FILTER_ACCEPT,r=core.StepDirection.NEXT,
b,e,k;this.isStep=a;this.setPosition=c;this.container=h;this.offset=f;this.nextStep=n;this.previousStep=p;this.advanceStep=function(b){return b===r?n():p()};this.roundToClosestStep=function(){var b,e,k=a();k||(b=h(),e=f(),k=p(),k||(c(b,e),k=n()));return k};this.roundToPreviousStep=function(){var b=a();b||(b=p());return b};this.roundToNextStep=function(){var b=a();b||(b=n());return b};this.leftNode=function(){return d.leftNode()};this.snapshot=function(){return new core.StepIterator.StepSnapshot(h(),
f())};this.restore=function(b){c(b.container,b.offset)}};core.StepIterator.StepSnapshot=function(m,d){this.container=m;this.offset=d};core.TestData;core.AsyncTestData;core.UnitTest=function(){};core.UnitTest.prototype.setUp=function(){};core.UnitTest.prototype.tearDown=function(){};core.UnitTest.prototype.description=function(){};core.UnitTest.prototype.tests=function(){};core.UnitTest.prototype.asyncTests=function(){};
core.UnitTest.provideTestAreaDiv=function(){var m=runtime.getWindow().document,d=m.getElementById("testarea");runtime.assert(!d,'Unclean test environment, found a div with id "testarea".');d=m.createElement("div");d.setAttribute("id","testarea");m.body.appendChild(d);return d};
core.UnitTest.cleanupTestAreaDiv=function(){var m=runtime.getWindow().document,d=m.getElementById("testarea");runtime.assert(!!d&&d.parentNode===m.body,'Test environment broken, found no div with id "testarea" below body.');m.body.removeChild(d)};core.UnitTest.createXmlDocument=function(m,d,g){var a="<?xml version='1.0' encoding='UTF-8'?>",a=a+("<"+m);Object.keys(g).forEach(function(c){a+=" xmlns:"+c+'="'+g[c]+'"'});a+=">";a+=d;a+="</"+m+">";return runtime.parseXML(a)};
core.UnitTest.createOdtDocument=function(m,d){return core.UnitTest.createXmlDocument("office:document",m,d)};
core.UnitTestLogger=function(){var m=[],d=0,g=0,a="",c="";this.startTest=function(h,f){m=[];d=0;a=h;c=f;g=Date.now()};this.endTest=function(){var h=Date.now();return{description:c,suite:[a,c],success:0===d,log:m,time:h-g}};this.debug=function(a){m.push({category:"debug",message:a})};this.fail=function(a){d+=1;m.push({category:"fail",message:a})};this.pass=function(a){m.push({category:"pass",message:a})}};
core.UnitTestRunner=function(m,d){function g(b){l+=1;e?d.debug(b):d.fail(b)}function a(b,e){var a;try{if(b.length!==e.length)return g("array of length "+b.length+" should be "+e.length+" long"),!1;for(a=0;a<b.length;a+=1)if(b[a]!==e[a])return g(b[a]+" should be "+e[a]+" at array index "+a),!1}catch(c){return!1}return!0}function c(b,e,a){var d=b.attributes,f=d.length,l,h,n;for(l=0;l<f;l+=1)if(h=d.item(l),"xmlns"!==h.prefix&&"urn:webodf:names:steps"!==h.namespaceURI){n=e.getAttributeNS(h.namespaceURI,
h.localName);if(!e.hasAttributeNS(h.namespaceURI,h.localName))return g("Attribute "+h.localName+" with value "+h.value+" was not present"),!1;if(n!==h.value)return g("Attribute "+h.localName+" was "+n+" should be "+h.value),!1}return a?!0:c(e,b,!0)}function h(b,e){var a,d;a=b.nodeType;d=e.nodeType;if(a!==d)return g("Nodetype '"+a+"' should be '"+d+"'"),!1;if(a===Node.TEXT_NODE){if(b.data===e.data)return!0;g("Textnode data '"+b.data+"' should be '"+e.data+"'");return!1}runtime.assert(a===Node.ELEMENT_NODE,
"Only textnodes and elements supported.");if(b.namespaceURI!==e.namespaceURI)return g("namespace '"+b.namespaceURI+"' should be '"+e.namespaceURI+"'"),!1;if(b.localName!==e.localName)return g("localName '"+b.localName+"' should be '"+e.localName+"'"),!1;if(!c(b,e,!1))return!1;a=b.firstChild;for(d=e.firstChild;a;){if(!d)return g("Nodetype '"+a.nodeType+"' is unexpected here."),!1;if(!h(a,d))return!1;a=a.nextSibling;d=d.nextSibling}return d?(g("Nodetype '"+d.nodeType+"' is missing here."),!1):!0}function f(e,
c,d){if(0===c)return e===c&&1/e===1/c;if(e===c)return!0;if(null===e||null===c)return!1;if("number"===typeof c&&isNaN(c))return"number"===typeof e&&isNaN(e);if("number"===typeof c&&"number"===typeof e){if(e===c)return!0;void 0===d&&(d=1E-4);runtime.assert("number"===typeof d,"Absolute tolerance not given as number.");runtime.assert(0<=d,"Absolute tolerance should be given as positive number, was "+d);e=Math.abs(e-c);return e<=d}return Object.prototype.toString.call(c)===Object.prototype.toString.call([])?
a(e,c):"object"===typeof c&&"object"===typeof e?c.constructor===Element||c.constructor===Node?h(e,c):b(e,c):!1}function n(b){if(0===b&&0>1/b)return"-0";if("object"===typeof b)try{return JSON.stringify(b)}catch(e){}return String(b)}function p(b,e,a,c){"string"===typeof e&&"string"===typeof a||d.debug("WARN: shouldBe() expects string arguments");var l,h;try{h=eval(e)}catch(r){l=r}b=eval(a);l?g(e+" should be "+b+". Threw exception "+l):f(h,b,c)?d.pass(e+" is "+a):String(typeof h)===String(typeof b)?
g(e+" should be "+n(b)+". Was "+n(h)+"."):g(e+" should be "+b+" (of type "+typeof b+"). Was "+h+" (of type "+typeof h+").")}var l=0,r,b,e=!1;this.resourcePrefix=function(){return m};this.beginExpectFail=function(){r=l;e=!0};this.endExpectFail=function(){var b=r===l;e=!1;l=r;b&&(l+=1,d.fail("Expected at least one failed test, but none registered."))};b=function(b,e){var c=Object.keys(b),d=Object.keys(e);c.sort();d.sort();return a(c,d)&&Object.keys(b).every(function(a){var c=b[a],d=e[a];return f(c,
d)?!0:(g(c+" should be "+d+" for key "+a),!1)})};this.areNodesEqual=h;this.shouldBeNull=function(b,e){p(b,e,"null")};this.shouldBeNonNull=function(b,e){var a,c;try{c=eval(e)}catch(f){a=f}a?g(e+" should be non-null. Threw exception "+a):null!==c?d.pass(e+" is non-null."):g(e+" should be non-null. Was "+c)};this.shouldBe=p;this.testFailed=g;this.countFailedTests=function(){return l};this.name=function(b){var e,a,c=[],d=b.length;c.length=d;for(e=0;e<d;e+=1){a=Runtime.getFunctionName(b[e])||"";if(""===
a)throw"Found a function without a name.";c[e]={f:b[e],name:a}}return c}};
core.UnitTester=function(){function m(a,c){return"<span style='color:blue;cursor:pointer' onclick='"+c+"'>"+a+"</span>"}function d(a){g.reporter&&g.reporter(a)}var g=this,a=0,c=new core.UnitTestLogger,h={},f="BrowserRuntime"===runtime.type();this.resourcePrefix="";this.reporter=function(a){var c,d;f?runtime.log("<span>Running "+m(a.description,'runTest("'+a.suite[0]+'","'+a.description+'")')+"</span>"):runtime.log("Running "+a.description);if(!a.success)for(c=0;c<a.log.length;c+=1)d=a.log[c],runtime.log(d.category,
d.message)};this.runTests=function(n,p,l){function r(f){function g(){m&&e.endExpectFail();d(c.endTest());k.tearDown();q[n]=B===e.countFailedTests();r(f.slice(1))}var n,m;if(0===f.length)h[b]=q,a+=e.countFailedTests(),p();else if(A=f[0].f,n=f[0].name,m=!0===f[0].expectFail,B=e.countFailedTests(),l.length&&-1===l.indexOf(n))r(f.slice(1));else{k.setUp();c.startTest(b,n);m&&e.beginExpectFail();try{A(g)}catch(u){e.testFailed("Unexpected exception encountered: "+u.toString()+"\n"+u.stack),g()}}}var b=Runtime.getFunctionName(n)||
"",e=new core.UnitTestRunner(g.resourcePrefix,c),k=new n(e),q={},x,A,v,t,B;if(h.hasOwnProperty(b))runtime.log("Test "+b+" has already run.");else{f?runtime.log("<span>Running "+m(b,'runSuite("'+b+'");')+": "+k.description()+"</span>"):runtime.log("Running "+b+": "+k.description);v=k.tests();for(x=0;x<v.length;x+=1)if(A=v[x].f,n=v[x].name,t=!0===v[x].expectFail,!l.length||-1!==l.indexOf(n)){B=e.countFailedTests();k.setUp();c.startTest(b,n);t&&e.beginExpectFail();try{A()}catch(u){e.testFailed("Unexpected exception encountered: "+
u.toString()+"\n"+u.stack)}t&&e.endExpectFail();d(c.endTest());k.tearDown();q[n]=B===e.countFailedTests()}r(k.asyncTests())}};this.failedTestsCount=function(){return a};this.results=function(){return h}};
core.Utils=function(){function m(d,g){if(g&&Array.isArray(g)){d=d||[];if(!Array.isArray(d))throw"Destination is not an array.";d=d.concat(g.map(function(a){return m(null,a)}))}else if(g&&"object"===typeof g){d=d||{};if("object"!==typeof d)throw"Destination is not an object.";Object.keys(g).forEach(function(a){d[a]=m(d[a],g[a])})}else d=g;return d}this.hashString=function(d){var g=0,a,c;a=0;for(c=d.length;a<c;a+=1)g=(g<<5)-g+d.charCodeAt(a),g|=0;return g};this.mergeObjects=function(d,g){Object.keys(g).forEach(function(a){d[a]=
m(d[a],g[a])});return d}};
core.Zip=function(m,d){function g(a,c){a&&0==a.indexOf("./")&&(a=a.substring(2));var b=n.file(a);b?c(null,b.asUint8Array()):c(a+" not found.",null)}function a(a,c){g(a,function(b,e){if(b||null===e)return c(b,null);var a=runtime.byteArrayToString(e,"utf8");c(null,a)})}function c(a,c){try{a(n.generate({type:"uint8array",compression:"DEFLATE"}))}catch(b){c(b.message)}}function h(a,d){c(function(b){runtime.writeFile(a,b,d)},d)}var f=this,n,p=new core.Base64;this.load=g;this.isexist=function(a){if(n.files[a])return!0};
this.save=function(a,c,b,e,k){k||(k=!1);n.file(a,c,{date:e,base64:k,compression:b?"DEFLATE":"STORE"})};this.remove=function(a){var c=null!==n.file(a);n.remove(a);return c};this.write=function(a){h(m,a)};this.writeAs=h;this.createByteArray=c;this.loadContentXmlAsFragments=function(c,d){a(c,function(b,e){if(b)return d.rootElementReady(b);d.rootElementReady(null,e,!0)})};this.loadAsString=a;this.loadAsDOM=function(c,d){a(c,function(b,e){if(b||null===e)d(b,null);else if(6291456<e.length)g_errmsg("Sorry, It takes too much time to run.");
else{var a=(new DOMParser).parseFromString(e.trim(),"text/xml");d(null,a)}})};this.loadAsDataURL=function(a,c,b){if(a&&1E3>a.length){var e=(a||"").toLowerCase().trim();if(0==e.indexOf("http://")||0==e.indexOf("https://")){b(null,a);return}}g(a,function(e,d){if(e||!d)return b(e,null);var f=0,h;c||(c=80===d[1]&&78===d[2]&&71===d[3]?"image/png":255===d[0]&&216===d[1]&&255===d[2]?"image/jpeg":71===d[0]&&73===d[1]&&70===d[2]?"image/gif":"");c||(c=getmimetype2(a)||"application/octet-stream");for(h="data:"+
c+";base64,";f<d.length;)h+=p.convertUTF8ArrayToBase64(d.subarray(f,Math.min(f+45E3,d.length))),f+=45E3;b(null,h)})};this.getEntries=function(){return Object.keys(n.files).map(function(a){return{filename:a,date:n.files[a].date}})};n=new externs.JSZip;null!==d&&runtime.readFile(m,"binary",function(a,c){"string"===typeof c&&(a="file was read as a string. Should be Uint8Array.");if(a||!c||0===c.length)d("File '"+m+"' cannot be read. Err: "+(a||"[none]"),f);else try{n.load(c,{checkCRC32:!1}),d(null,f)}catch(b){d(b.message,
f)}})};core.SimpleClientRect=null;gui.CommonConstraints={EDIT:{ANNOTATIONS:{ONLY_DELETE_OWN:"onlyDeleteOwn"},REVIEW_MODE:"reviewMode"}};
gui.SessionConstraints=function(){function m(a){d.hasOwnProperty(a)||(d[a]=!1,g.register(a))}var d={},g=new core.EventNotifier;this.registerConstraint=m;this.subscribe=function(a,c){m(a);g.subscribe(a,c)};this.unsubscribe=function(a,c){g.unsubscribe(a,c)};this.setState=function(a,c){runtime.assert(!0===d.hasOwnProperty(a),"No such constraint");d[a]!==c&&(d[a]=c,g.emit(a,c))};this.getState=function(a){runtime.assert(!0===d.hasOwnProperty(a),"No such constraint");return d[a]}};
gui.BlacklistNamespaceNodeFilter=function(m){var d={},g=NodeFilter.FILTER_REJECT,a=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(c){return!c||d.hasOwnProperty(c.namespaceURI)?g:a};(function(){m.forEach(function(a){d[a]=!0})})()};
odf.Namespaces={namespaceMap:{config:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",db:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dc:"http://purl.org/dc/elements/1.1/",dr3d:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",draw:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chart:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fo:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",form:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",math:"http://www.w3.org/1998/Math/MathML",
meta:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",number:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",office:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentation:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",style:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svg:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",table:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",text:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",xforms:"http://www.w3.org/2002/xforms",
xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},prefixMap:{},configns:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",dbns:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dcns:"http://purl.org/dc/elements/1.1/",dr3dns:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",drawns:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chartns:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fons:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",formns:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",
mathns:"http://www.w3.org/1998/Math/MathML",metans:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",numberns:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",officens:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentationns:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",stylens:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svgns:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",tablens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",textns:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",
xformsns:"http://www.w3.org/2002/xforms",xlinkns:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/XML/1998/namespace"};(function(){var m=odf.Namespaces.namespaceMap,d=odf.Namespaces.prefixMap,g;for(g in m)m.hasOwnProperty(g)&&(d[m[g]]=g)})();odf.Namespaces.forEachPrefix=function(m){var d=odf.Namespaces.namespaceMap,g;for(g in d)d.hasOwnProperty(g)&&m(g,d[g])};
odf.Namespaces.lookupNamespaceURI=function(m){var d=null;odf.Namespaces.namespaceMap.hasOwnProperty(m)&&(d=odf.Namespaces.namespaceMap[m]);return d};odf.Namespaces.lookupPrefix=function(m){var d=odf.Namespaces.prefixMap;return d.hasOwnProperty(m)?d[m]:null};odf.Namespaces.lookupNamespaceURI.lookupNamespaceURI=odf.Namespaces.lookupNamespaceURI;
(function(){odf.OdfSchemaImpl=function(){var m=[["config:config-item","uncategorized"],["form:item","object"],["form:option","uncategorized"],["math:math","field"],["meta:user-defined","uncategorized"],["number:currency-symbol","uncategorized"],["number:embedded-text","uncategorized"],["number:text","uncategorized"],["presentation:date-time-decl","uncategorized"],["presentation:footer-decl","uncategorized"],["presentation:header-decl","uncategorized"],["svg:desc","text"],["svg:title","text"],["table:desc",
"uncategorized"],["table:title","uncategorized"],["text:a","text"],["text:author-initials","field"],["text:author-name","field"],["text:bibliography-mark","field"],["text:bookmark-ref","field"],["text:chapter","field"],["text:character-count","field"],["text:conditional-text","field"],["text:creation-date","field"],["text:creation-time","field"],["text:creator","field"],["text:database-display","field"],["text:database-name","field"],["text:database-row-number","field"],["text:date","field"],["text:dde-connection",
"field"],["text:description","field"],["text:editing-cycles","field"],["text:editing-duration","field"],["text:execute-macro","uncategorized"],["text:expression","uncategorized"],["text:file-name","field"],["text:h","text"],["text:hidden-paragraph","text"],["text:hidden-text","text"],["text:image-count","field"],["text:index-entry-span","uncategorized"],["text:index-title-template","uncategorized"],["text:initial-creator","field"],["text:keywords","field"],["text:linenumbering-separator","style"],
["text:measure","uncategorized"],["text:meta","uncategorized"],["text:meta-field","uncategorized"],["text:modification-date","field"],["text:modification-time","field"],["text:note-citation","field"],["text:note-continuation-notice-backward","style"],["text:note-continuation-notice-forward","style"],["text:note-ref","field"],["text:object-count","field"],["text:p","text"],["text:page-continuation","uncategorized"],["text:page-count","field"],["text:page-number","field"],["text:page-variable-get",
"field"],["text:page-variable-set","field"],["text:paragraph-count","field"],["text:placeholder","field"],["text:print-date","field"],["text:print-time","field"],["text:printed-by","field"],["text:reference-ref","field"],["text:ruby-base","text"],["text:ruby-text","text"],["text:script","text"],["text:sender-city","field"],["text:sender-company","field"],["text:sender-country","field"],["text:sender-email","field"],["text:sender-fax","field"],["text:sender-firstname","field"],["text:sender-initials",
"field"],["text:sender-lastname","field"],["text:sender-phone-private","field"],["text:sender-phone-work","field"],["text:sender-position","field"],["text:sender-postal-code","field"],["text:sender-state-or-province","field"],["text:sender-street","field"],["text:sender-title","field"],["text:sequence","uncategorized"],["text:sequence-ref","uncategorized"],["text:sheet-name","uncategorized"],["text:span","text"],["text:subject","field"],["text:table-count","field"],["text:table-formula","deprecated"],
["text:template-name","uncategorized"],["text:text-input","field"],["text:time","field"],["text:title","field"],["text:user-defined","field"],["text:user-field-get","field"],["text:user-field-input","field"],["text:variable-get","field"],["text:variable-input","field"],["text:variable-set","field"],["text:word-count","field"],["xforms:model","uncategorized"]],d={};this.isTextContainer=function(g,a){return"text"===d[g+":"+a]};this.isField=function(g,a){return"field"===d[g+":"+a]};this.getFields=function(){return m.filter(function(d){return"field"===
d[1]}).map(function(d){return d[0]})};(function(){m.forEach(function(g){var a=g[1],c=g[0].split(":");g=c[0];var c=c[1],h=odf.Namespaces.lookupNamespaceURI(g);h?d[h+":"+c]=a:runtime.log("DEBUG: OdfSchema - unknown prefix '"+g+"'")})})()};odf.OdfSchema=new odf.OdfSchemaImpl})();
odf.OdfUtilsImpl=function(){function m(b){return"image"===(b&&b.localName)&&b.namespaceURI===K}function d(b){return null!==b&&b.nodeType===Node.ELEMENT_NODE&&"frame"===b.localName&&b.namespaceURI===K&&"as-char"===b.getAttributeNS(J,"anchor-type")}function g(b){var e;(e="annotation"===(b&&b.localName)&&b.namespaceURI===odf.Namespaces.officens)||(e="div"===(b&&b.localName)&&"annotationWrapper"===b.className);return e}function a(b){return"a"===(b&&b.localName)&&b.namespaceURI===J}function c(b){var e=
b&&b.localName;return("p"===e||"h"===e)&&b.namespaceURI===J}function h(b,e){for(b&&void 0!==e&&!c(b)&&b.childNodes.item(e)&&(b=b.childNodes.item(e));b&&!c(b);)b=b.parentNode;return b}function f(b,e){for(;b&&b!==e;){if(b.namespaceURI===odf.Namespaces.officens&&"annotation"===b.localName)return b;b=b.parentNode}return null}function n(b){return/^[ \t\r\n]+$/.test(b)}function p(b){if(null===b||b.nodeType!==Node.ELEMENT_NODE)return!1;var e=b.localName;return R.isTextContainer(b.namespaceURI,e)||"span"===
e&&"webodf-annotationHighlight"===b.className}function l(b){return null===b||b.nodeType!==Node.ELEMENT_NODE?!1:R.isField(b.namespaceURI,b.localName)}function r(b){var e=b&&b.localName,a=!1;e&&(b=b.namespaceURI,b===J&&(a="s"===e||"tab"===e||"line-break"===e));return a}function b(b){return r(b)||l(b)||d(b)||g(b)}function e(b){var e=b&&b.localName,a=!1;e&&(b=b.namespaceURI,b===J&&(a="s"===e));return a}function k(b){return-1!==P.indexOf(b.namespaceURI)}function q(b){if(r(b)||l(b))return!1;if(p(b.parentNode)&&
b.nodeType===Node.TEXT_NODE)return 0===b.textContent.length;for(b=b.firstChild;b;){if(k(b)||!q(b))return!1;b=b.nextSibling}return!0}function x(b){for(;null!==b.firstChild&&p(b);)b=b.firstChild;return b}function A(b){for(;null!==b.lastChild&&p(b);)b=b.lastChild;return b}function v(b){for(;!c(b)&&null===b.previousSibling;)b=b.parentNode;return c(b)?null:A(b.previousSibling)}function t(b){for(;!c(b)&&null===b.nextSibling;)b=b.parentNode;return c(b)?null:x(b.nextSibling)}function B(a){for(var c=!1;a;)if(a.nodeType===
Node.TEXT_NODE)if(0===a.length)a=v(a);else return!n(a.data.substr(a.length-1,1));else b(a)?(c=!1===e(a),a=null):a=v(a);return c}function u(e){var a=!1,c;for(e=e&&x(e);e;){c=e.nodeType===Node.TEXT_NODE?e.length:0;if(0<c&&!n(e.data)){a=!0;break}if(b(e)){a=!0;break}e=t(e)}return a}function w(b,e){return n(b.data.substr(e))?!u(t(b)):!1}function D(e,a){var c=e.data,k;if(!n(c[a])||b(e.parentNode))return!1;0<a?n(c[a-1])||(k=!0):B(v(e))&&(k=!0);return!0===k?w(e,a)?!1:!0:!1}function F(b){return(b=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px)|(%))/.exec(b))?
{value:parseFloat(b[1]),unit:b[3]}:null}function C(b){return(b=F(b))&&(0>b.value||"%"===b.unit)?null:b}function H(b){return(b=F(b))&&"%"!==b.unit?null:b}function s(b){switch(b.namespaceURI){case odf.Namespaces.drawns:case odf.Namespaces.svgns:case odf.Namespaces.dr3dns:return!1;case odf.Namespaces.textns:switch(b.localName){case "note-body":case "ruby-text":return!1}break;case odf.Namespaces.officens:switch(b.localName){case "annotation":case "binary-data":case "event-listeners":return!1}break;default:switch(b.localName){case "cursor":case "editinfo":return!1}}return!0}
function z(b){return Boolean(h(b)&&(!n(b.textContent)||D(b,0)))}function y(b,e){for(;0<e.length&&!W.rangeContainsNode(b,e[0]);)e.shift();for(;0<e.length&&!W.rangeContainsNode(b,e[e.length-1]);)e.pop()}function M(e,a,c){var k;k=W.getNodesInRange(e,function(e){var a=NodeFilter.FILTER_REJECT;if(r(e.parentNode)||l(e.parentNode)||g(e))a=NodeFilter.FILTER_REJECT;else if(e.nodeType===Node.TEXT_NODE){if(c||z(e))a=NodeFilter.FILTER_ACCEPT}else if(b(e))a=NodeFilter.FILTER_ACCEPT;else if(s(e)||p(e))a=NodeFilter.FILTER_SKIP;
return a},NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);a||y(e,k);return k}function E(b,e,a){for(;b;){if(a(b)){e[0]!==b&&e.unshift(b);break}if(g(b))break;b=b.parentNode}}function I(b,e){var a=b;if(e<a.childNodes.length-1)a=a.childNodes[e+1];else{for(;!a.nextSibling;)a=a.parentNode;a=a.nextSibling}for(;a.firstChild;)a=a.firstChild;return a}var J=odf.Namespaces.textns,K=odf.Namespaces.drawns,G=odf.Namespaces.xlinkns,W=core.DomUtils,P=[odf.Namespaces.dbns,odf.Namespaces.dcns,odf.Namespaces.dr3dns,odf.Namespaces.drawns,
odf.Namespaces.chartns,odf.Namespaces.formns,odf.Namespaces.numberns,odf.Namespaces.officens,odf.Namespaces.presentationns,odf.Namespaces.stylens,odf.Namespaces.svgns,odf.Namespaces.tablens,odf.Namespaces.textns],R=odf.OdfSchema;this.isImage=m;this.isCharacterFrame=d;this.isInlineRoot=g;this.isTextSpan=function(b){return"span"===(b&&b.localName)&&b.namespaceURI===J};this.isHyperlink=a;this.getHyperlinkTarget=function(b){return b.getAttributeNS(G,"href")||""};this.isParagraph=c;this.getParagraphElement=
h;this.getParentAnnotation=f;this.isWithinAnnotation=function(b,e){return Boolean(f(b,e))};this.getAnnotationCreator=function(b){return(b=b.getElementsByTagNameNS(odf.Namespaces.dcns,"creator")[0])?b.textContent:""};this.isListItem=function(b){return"list-item"===(b&&b.localName)&&b.namespaceURI===J};this.isLineBreak=function(b){return"line-break"===(b&&b.localName)&&b.namespaceURI===J};this.isODFWhitespace=n;this.isGroupingElement=p;this.isFieldElement=l;this.isCharacterElement=r;this.isAnchoredAsCharacterElement=
b;this.isSpaceElement=e;this.isODFNode=k;this.hasNoODFContent=q;this.firstChild=x;this.lastChild=A;this.previousNode=v;this.nextNode=t;this.scanLeftForNonSpace=B;this.lookLeftForCharacter=function(e){var a,c=a=0;e.nodeType===Node.TEXT_NODE&&(c=e.length);0<c?(a=e.data,a=n(a.substr(c-1,1))?1===c?B(v(e))?2:0:n(a.substr(c-2,1))?0:2:1):b(e)&&(a=1);return a};this.lookRightForCharacter=function(e){var a=!1,c=0;e&&e.nodeType===Node.TEXT_NODE&&(c=e.length);0<c?a=!n(e.data.substr(0,1)):b(e)&&(a=!0);return a};
this.scanLeftForAnyCharacter=function(e){var a=!1,c;for(e=e&&A(e);e;){c=e.nodeType===Node.TEXT_NODE?e.length:0;if(0<c&&!n(e.data)){a=!0;break}if(b(e)){a=!0;break}e=v(e)}return a};this.scanRightForAnyCharacter=u;this.isTrailingWhitespace=w;this.isSignificantWhitespace=D;this.isDowngradableSpaceElement=function(b){return e(b)?B(v(b))&&u(t(b)):!1};this.parseLength=F;this.parseNonNegativeLength=C;this.parseFoFontSize=function(b){var e;e=(e=F(b))&&(0>=e.value||"%"===e.unit)?null:e;return e||H(b)};this.parseFoLineHeight=
function(b){return C(b)||H(b)};this.isTextContentContainingNode=s;this.getTextNodes=function(b,e){var a;a=W.getNodesInRange(b,function(b){var e=NodeFilter.FILTER_REJECT;b.nodeType===Node.TEXT_NODE?z(b)&&(e=NodeFilter.FILTER_ACCEPT):s(b)&&(e=NodeFilter.FILTER_SKIP);return e},NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);e||y(b,a);return a};this.getTextElements=M;this.getParagraphElements=function(b){var e;e=W.getNodesInRange(b,function(b){var e=NodeFilter.FILTER_REJECT;if(c(b))e=NodeFilter.FILTER_ACCEPT;
else if(s(b)||p(b))e=NodeFilter.FILTER_SKIP;return e},NodeFilter.SHOW_ELEMENT);E(b.startContainer,e,c);return e};this.getImageElements=function(b){var e;e=W.getNodesInRange(b,function(b){var e=NodeFilter.FILTER_SKIP;m(b)&&(e=NodeFilter.FILTER_ACCEPT);return e},NodeFilter.SHOW_ELEMENT);E(b.startContainer,e,m);return e};this.getHyperlinkElements=function(b){var e=[],k=b.cloneRange();b.collapsed&&b.endContainer.nodeType===Node.ELEMENT_NODE&&(b=I(b.endContainer,b.endOffset),b.nodeType===Node.TEXT_NODE&&
k.setEnd(b,1));M(k,!0,!1).forEach(function(b){for(b=b.parentNode;!c(b);){if(a(b)&&-1===e.indexOf(b)){e.push(b);break}b=b.parentNode}});k.detach();return e};this.getNormalizedFontFamilyName=function(b){/^(["'])(?:.|[\n\r])*?\1$/.test(b)||(b=b.replace(/^[ \t\r\n\f]*((?:.|[\n\r])*?)[ \t\r\n\f]*$/,"$1"),/[ \t\r\n\f]/.test(b)&&(b="'"+b.replace(/[ \t\r\n\f]+/g," ")+"'"));return b}};odf.OdfUtils=new odf.OdfUtilsImpl;
gui.OdfTextBodyNodeFilter=function(){var m=odf.OdfUtils,d=Node.TEXT_NODE,g=NodeFilter.FILTER_REJECT,a=NodeFilter.FILTER_ACCEPT,c=odf.Namespaces.textns;this.acceptNode=function(h){if(h.nodeType===d){if(!m.isGroupingElement(h.parentNode))return g}else if(h.namespaceURI===c&&"tracked-changes"===h.localName)return g;return a}};xmldom.LSSerializerFilter=function(){};xmldom.LSSerializerFilter.prototype.acceptNode=function(m){};
odf.OdfNodeFilter=function(){this.acceptNode=function(m){return"http://www.w3.org/1999/xhtml"===m.namespaceURI?NodeFilter.FILTER_SKIP:m.namespaceURI&&m.namespaceURI.match(/^urn:webodf:/)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}};xmldom.XPathIterator=function(){};xmldom.XPathIterator.prototype.next=function(){};xmldom.XPathIterator.prototype.reset=function(){};xmldom.XPathAtom;
function createXPathSingleton(){function m(a,b,e){return-1!==a&&(a<b||-1===b)&&(a<e||-1===e)}function d(a){for(var b=[],e=0,c=a.length,d;e<c;){var f=a,h=c,g=b,n="",p=[],u=f.indexOf("[",e),w=f.indexOf("/",e),D=f.indexOf("=",e);m(w,u,D)?(n=f.substring(e,w),e=w+1):m(u,w,D)?(n=f.substring(e,u),e=l(f,u,p)):m(D,w,u)?(n=f.substring(e,D),e=D):(n=f.substring(e,h),e=h);g.push({location:n,predicates:p});if(e<c&&"="===a[e]){d=a.substring(e+1,c);if(2<d.length&&("'"===d[0]||'"'===d[0]))d=d.slice(1,d.length-1);
else try{d=parseInt(d,10)}catch(F){}e=c}}return{steps:b,value:d}}function g(){var a=null,b=!1;this.setNode=function(b){a=b};this.reset=function(){b=!1};this.next=function(){var e=b?null:a;b=!0;return e}}function a(a,b,e){this.reset=function(){a.reset()};this.next=function(){for(var c=a.next();c;){c.nodeType===Node.ELEMENT_NODE&&(c=c.getAttributeNodeNS(b,e));if(c)break;c=a.next()}return c}}function c(a,b){var e=a.next(),c=null;this.reset=function(){a.reset();e=a.next();c=null};this.next=function(){for(;e;){if(c)if(b&&
c.firstChild)c=c.firstChild;else{for(;!c.nextSibling&&c!==e;)c=c.parentNode;c===e?e=a.next():c=c.nextSibling}else{do(c=e.firstChild)||(e=a.next());while(e&&!c)}if(c&&c.nodeType===Node.ELEMENT_NODE)return c}return null}}function h(a,b){this.reset=function(){a.reset()};this.next=function(){for(var e=a.next();e&&!b(e);)e=a.next();return e}}function f(a,b,e){b=b.split(":",2);var c=e(b[0]),d=b[1];return new h(a,function(b){return b.localName===d&&b.namespaceURI===c})}function n(a,b,e){var c=new g,d=p(c,
b,e),f=b.value;return void 0===f?new h(a,function(b){c.setNode(b);d.reset();return null!==d.next()}):new h(a,function(b){c.setNode(b);d.reset();return(b=d.next())?b.nodeValue===f:!1})}var p,l;l=function(a,b,e){for(var c=b,f=a.length,h=0;c<f;)"]"===a[c]?(h-=1,0>=h&&e.push(d(a.substring(b,c)))):"["===a[c]&&(0>=h&&(b=c+1),h+=1),c+=1;return c};p=function(d,b,e){var k,q,h,l;for(k=0;k<b.steps.length;k+=1){h=b.steps[k];q=h.location;if(""===q)d=new c(d,!1);else if("@"===q[0]){q=q.substr(1).split(":",2);l=
e(q[0]);if(!l)throw"No namespace associated with the prefix "+q[0];d=new a(d,l,q[1])}else"."!==q&&(d=new c(d,!1),-1!==q.indexOf(":")&&(d=f(d,q,e)));for(q=0;q<h.predicates.length;q+=1)l=h.predicates[q],d=n(d,l,e)}return d};return{getODFElementsWithXPath:function(a,b,e){var c=a.ownerDocument,f=[],h=null;if(c&&"function"===typeof c.evaluate)for(e=c.evaluate(b,a,e,XPathResult.UNORDERED_NODE_ITERATOR_TYPE,null),h=e.iterateNext();null!==h;)h.nodeType===Node.ELEMENT_NODE&&f.push(h),h=e.iterateNext();else{f=
new g;f.setNode(a);a=d(b);f=p(f,a,e);a=[];for(e=f.next();e;)a.push(e),e=f.next();f=a}return f}}}xmldom.XPath=createXPathSingleton();
odf.StyleInfo=function(){function m(b,e){var a,c,k,d,f,q=0;if(a=C[b.localName])if(k=a[b.namespaceURI])q=k.length;for(a=0;a<q;a+=1)c=k[a],d=c.ns,f=c.localname,(c=b.getAttributeNS(d,f))&&b.setAttributeNS(d,D[d]+f,e+c);for(k=b.firstElementChild;k;)m(k,e),k=k.nextElementSibling}function d(b,e){var a,c,k,f,q,h=0;if(a=C[b.localName])if(k=a[b.namespaceURI])h=k.length;for(a=0;a<h;a+=1)if(c=k[a],f=c.ns,q=c.localname,c=b.getAttributeNS(f,q))c=c.replace(e,""),b.setAttributeNS(f,D[f]+q,c);for(k=b.firstElementChild;k;)d(k,
e),k=k.nextElementSibling}function g(b,e){var a,c,k,d,f,q=0;if(a=C[b.localName])if(k=a[b.namespaceURI])q=k.length;for(a=0;a<q;a+=1)if(d=k[a],c=d.ns,f=d.localname,c=b.getAttributeNS(c,f))e=e||{},d=d.keyname,e.hasOwnProperty(d)?e[d][c]=1:(f={},f[c]=1,e[d]=f);return e}function a(b,e){var c,k;g(b,e);for(c=b.firstChild;c;)c.nodeType===Node.ELEMENT_NODE&&(k=c,a(k,e)),c=c.nextSibling}function c(b,e,a){this.key=b;this.name=e;this.family=a;this.requires={}}function h(b,e,a){var k=b+'"'+e,d=a[k];d||(d=a[k]=
new c(k,b,e));return d}function f(b,e,a){var c,k,d,q,l,g=0;c=b.getAttributeNS(B,"name");q=b.getAttributeNS(B,"family");c&&q&&(e=h(c,q,a));if(e){if(c=C[b.localName])if(d=c[b.namespaceURI])g=d.length;for(c=0;c<g;c+=1)if(q=d[c],k=q.ns,l=q.localname,k=b.getAttributeNS(k,l))q=q.keyname,q=h(k,q,a),e.requires[q.key]=q}for(b=b.firstElementChild;b;)f(b,e,a),b=b.nextElementSibling;return a}function n(b,e){var a=e[b.family];a||(a=e[b.family]={});a[b.name]=1;Object.keys(b.requires).forEach(function(a){n(b.requires[a],
e)})}function p(b,e){var a=f(b,null,{});Object.keys(a).forEach(function(b){b=a[b];var c=e[b.family];c&&c.hasOwnProperty(b.name)&&n(b,e)})}function l(b,e){function a(e){(e=d.getAttributeNS(B,e))&&(b[e]=!0)}var c=["font-name","font-name-asian","font-name-complex"],k,d;for(k=e&&e.firstElementChild;k;)d=k,c.forEach(a),l(b,d),k=k.nextElementSibling}function r(b,e){function a(b){var c=d.getAttributeNS(B,b);c&&e.hasOwnProperty(c)&&d.setAttributeNS(B,"style:"+b,e[c])}var c=["font-name","font-name-asian",
"font-name-complex"],k,d;for(k=b&&b.firstElementChild;k;)d=k,c.forEach(a),r(d,e),k=k.nextElementSibling}var b=odf.Namespaces.chartns,e=odf.Namespaces.dbns,k=odf.Namespaces.dr3dns,q=odf.Namespaces.drawns,x=odf.Namespaces.formns,A=odf.Namespaces.numberns,v=odf.Namespaces.officens,t=odf.Namespaces.presentationns,B=odf.Namespaces.stylens,u=odf.Namespaces.tablens,w=odf.Namespaces.textns,D={"urn:oasis:names:tc:opendocument:xmlns:chart:1.0":"chart:","urn:oasis:names:tc:opendocument:xmlns:database:1.0":"db:",
"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0":"dr3d:","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":"draw:","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":"fo:","urn:oasis:names:tc:opendocument:xmlns:form:1.0":"form:","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":"number:","urn:oasis:names:tc:opendocument:xmlns:office:1.0":"office:","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0":"presentation:","urn:oasis:names:tc:opendocument:xmlns:style:1.0":"style:","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0":"svg:",
"urn:oasis:names:tc:opendocument:xmlns:table:1.0":"table:","urn:oasis:names:tc:opendocument:xmlns:text:1.0":"chart:","http://www.w3.org/XML/1998/namespace":"xml:"},F={text:[{ens:B,en:"tab-stop",ans:B,a:"leader-text-style"},{ens:B,en:"drop-cap",ans:B,a:"style-name"},{ens:w,en:"notes-configuration",ans:w,a:"citation-body-style-name"},{ens:w,en:"notes-configuration",ans:w,a:"citation-style-name"},{ens:w,en:"a",ans:w,a:"style-name"},{ens:w,en:"alphabetical-index",ans:w,a:"style-name"},{ens:w,en:"linenumbering-configuration",
ans:w,a:"style-name"},{ens:w,en:"list-level-style-number",ans:w,a:"style-name"},{ens:w,en:"ruby-text",ans:w,a:"style-name"},{ens:w,en:"span",ans:w,a:"style-name"},{ens:w,en:"a",ans:w,a:"visited-style-name"},{ens:B,en:"text-properties",ans:B,a:"text-line-through-text-style"},{ens:w,en:"alphabetical-index-source",ans:w,a:"main-entry-style-name"},{ens:w,en:"index-entry-bibliography",ans:w,a:"style-name"},{ens:w,en:"index-entry-chapter",ans:w,a:"style-name"},{ens:w,en:"index-entry-link-end",ans:w,a:"style-name"},
{ens:w,en:"index-entry-link-start",ans:w,a:"style-name"},{ens:w,en:"index-entry-page-number",ans:w,a:"style-name"},{ens:w,en:"index-entry-span",ans:w,a:"style-name"},{ens:w,en:"index-entry-tab-stop",ans:w,a:"style-name"},{ens:w,en:"index-entry-text",ans:w,a:"style-name"},{ens:w,en:"index-title-template",ans:w,a:"style-name"},{ens:w,en:"list-level-style-bullet",ans:w,a:"style-name"},{ens:w,en:"outline-level-style",ans:w,a:"style-name"}],paragraph:[{ens:q,en:"caption",ans:q,a:"text-style-name"},{ens:q,
en:"circle",ans:q,a:"text-style-name"},{ens:q,en:"connector",ans:q,a:"text-style-name"},{ens:q,en:"control",ans:q,a:"text-style-name"},{ens:q,en:"custom-shape",ans:q,a:"text-style-name"},{ens:q,en:"ellipse",ans:q,a:"text-style-name"},{ens:q,en:"frame",ans:q,a:"text-style-name"},{ens:q,en:"line",ans:q,a:"text-style-name"},{ens:q,en:"measure",ans:q,a:"text-style-name"},{ens:q,en:"path",ans:q,a:"text-style-name"},{ens:q,en:"polygon",ans:q,a:"text-style-name"},{ens:q,en:"polyline",ans:q,a:"text-style-name"},
{ens:q,en:"rect",ans:q,a:"text-style-name"},{ens:q,en:"regular-polygon",ans:q,a:"text-style-name"},{ens:v,en:"annotation",ans:q,a:"text-style-name"},{ens:x,en:"column",ans:x,a:"text-style-name"},{ens:B,en:"style",ans:B,a:"next-style-name"},{ens:u,en:"body",ans:u,a:"paragraph-style-name"},{ens:u,en:"even-columns",ans:u,a:"paragraph-style-name"},{ens:u,en:"even-rows",ans:u,a:"paragraph-style-name"},{ens:u,en:"first-column",ans:u,a:"paragraph-style-name"},{ens:u,en:"first-row",ans:u,a:"paragraph-style-name"},
{ens:u,en:"last-column",ans:u,a:"paragraph-style-name"},{ens:u,en:"last-row",ans:u,a:"paragraph-style-name"},{ens:u,en:"odd-columns",ans:u,a:"paragraph-style-name"},{ens:u,en:"odd-rows",ans:u,a:"paragraph-style-name"},{ens:w,en:"notes-configuration",ans:w,a:"default-style-name"},{ens:w,en:"alphabetical-index-entry-template",ans:w,a:"style-name"},{ens:w,en:"bibliography-entry-template",ans:w,a:"style-name"},{ens:w,en:"h",ans:w,a:"style-name"},{ens:w,en:"illustration-index-entry-template",ans:w,a:"style-name"},
{ens:w,en:"index-source-style",ans:w,a:"style-name"},{ens:w,en:"object-index-entry-template",ans:w,a:"style-name"},{ens:w,en:"p",ans:w,a:"style-name"},{ens:w,en:"table-index-entry-template",ans:w,a:"style-name"},{ens:w,en:"table-of-content-entry-template",ans:w,a:"style-name"},{ens:w,en:"table-index-entry-template",ans:w,a:"style-name"},{ens:w,en:"user-index-entry-template",ans:w,a:"style-name"},{ens:B,en:"page-layout-properties",ans:B,a:"register-truth-ref-style-name"}],chart:[{ens:b,en:"axis",ans:b,
a:"style-name"},{ens:b,en:"chart",ans:b,a:"style-name"},{ens:b,en:"data-label",ans:b,a:"style-name"},{ens:b,en:"data-point",ans:b,a:"style-name"},{ens:b,en:"equation",ans:b,a:"style-name"},{ens:b,en:"error-indicator",ans:b,a:"style-name"},{ens:b,en:"floor",ans:b,a:"style-name"},{ens:b,en:"footer",ans:b,a:"style-name"},{ens:b,en:"grid",ans:b,a:"style-name"},{ens:b,en:"legend",ans:b,a:"style-name"},{ens:b,en:"mean-value",ans:b,a:"style-name"},{ens:b,en:"plot-area",ans:b,a:"style-name"},{ens:b,en:"regression-curve",
ans:b,a:"style-name"},{ens:b,en:"series",ans:b,a:"style-name"},{ens:b,en:"stock-gain-marker",ans:b,a:"style-name"},{ens:b,en:"stock-loss-marker",ans:b,a:"style-name"},{ens:b,en:"stock-range-line",ans:b,a:"style-name"},{ens:b,en:"subtitle",ans:b,a:"style-name"},{ens:b,en:"title",ans:b,a:"style-name"},{ens:b,en:"wall",ans:b,a:"style-name"}],section:[{ens:w,en:"alphabetical-index",ans:w,a:"style-name"},{ens:w,en:"bibliography",ans:w,a:"style-name"},{ens:w,en:"illustration-index",ans:w,a:"style-name"},
{ens:w,en:"index-title",ans:w,a:"style-name"},{ens:w,en:"object-index",ans:w,a:"style-name"},{ens:w,en:"section",ans:w,a:"style-name"},{ens:w,en:"table-of-content",ans:w,a:"style-name"},{ens:w,en:"table-index",ans:w,a:"style-name"},{ens:w,en:"user-index",ans:w,a:"style-name"}],ruby:[{ens:w,en:"ruby",ans:w,a:"style-name"}],table:[{ens:e,en:"query",ans:e,a:"style-name"},{ens:e,en:"table-representation",ans:e,a:"style-name"},{ens:u,en:"background",ans:u,a:"style-name"},{ens:u,en:"table",ans:u,a:"style-name"}],
"table-column":[{ens:e,en:"column",ans:e,a:"style-name"},{ens:u,en:"table-column",ans:u,a:"style-name"}],"table-row":[{ens:e,en:"query",ans:e,a:"default-row-style-name"},{ens:e,en:"table-representation",ans:e,a:"default-row-style-name"},{ens:u,en:"table-row",ans:u,a:"style-name"}],"table-cell":[{ens:e,en:"column",ans:e,a:"default-cell-style-name"},{ens:u,en:"table-column",ans:u,a:"default-cell-style-name"},{ens:u,en:"table-row",ans:u,a:"default-cell-style-name"},{ens:u,en:"body",ans:u,a:"style-name"},
{ens:u,en:"covered-table-cell",ans:u,a:"style-name"},{ens:u,en:"even-columns",ans:u,a:"style-name"},{ens:u,en:"covered-table-cell",ans:u,a:"style-name"},{ens:u,en:"even-columns",ans:u,a:"style-name"},{ens:u,en:"even-rows",ans:u,a:"style-name"},{ens:u,en:"first-column",ans:u,a:"style-name"},{ens:u,en:"first-row",ans:u,a:"style-name"},{ens:u,en:"last-column",ans:u,a:"style-name"},{ens:u,en:"last-row",ans:u,a:"style-name"},{ens:u,en:"odd-columns",ans:u,a:"style-name"},{ens:u,en:"odd-rows",ans:u,a:"style-name"},
{ens:u,en:"table-cell",ans:u,a:"style-name"}],graphic:[{ens:k,en:"cube",ans:q,a:"style-name"},{ens:k,en:"extrude",ans:q,a:"style-name"},{ens:k,en:"rotate",ans:q,a:"style-name"},{ens:k,en:"scene",ans:q,a:"style-name"},{ens:k,en:"sphere",ans:q,a:"style-name"},{ens:q,en:"caption",ans:q,a:"style-name"},{ens:q,en:"circle",ans:q,a:"style-name"},{ens:q,en:"connector",ans:q,a:"style-name"},{ens:q,en:"control",ans:q,a:"style-name"},{ens:q,en:"custom-shape",ans:q,a:"style-name"},{ens:q,en:"ellipse",ans:q,a:"style-name"},
{ens:q,en:"frame",ans:q,a:"style-name"},{ens:q,en:"g",ans:q,a:"style-name"},{ens:q,en:"line",ans:q,a:"style-name"},{ens:q,en:"measure",ans:q,a:"style-name"},{ens:q,en:"page-thumbnail",ans:q,a:"style-name"},{ens:q,en:"path",ans:q,a:"style-name"},{ens:q,en:"polygon",ans:q,a:"style-name"},{ens:q,en:"polyline",ans:q,a:"style-name"},{ens:q,en:"rect",ans:q,a:"style-name"},{ens:q,en:"regular-polygon",ans:q,a:"style-name"},{ens:v,en:"annotation",ans:q,a:"style-name"}],presentation:[{ens:k,en:"cube",ans:t,
a:"style-name"},{ens:k,en:"extrude",ans:t,a:"style-name"},{ens:k,en:"rotate",ans:t,a:"style-name"},{ens:k,en:"scene",ans:t,a:"style-name"},{ens:k,en:"sphere",ans:t,a:"style-name"},{ens:q,en:"caption",ans:t,a:"style-name"},{ens:q,en:"circle",ans:t,a:"style-name"},{ens:q,en:"connector",ans:t,a:"style-name"},{ens:q,en:"control",ans:t,a:"style-name"},{ens:q,en:"custom-shape",ans:t,a:"style-name"},{ens:q,en:"ellipse",ans:t,a:"style-name"},{ens:q,en:"frame",ans:t,a:"style-name"},{ens:q,en:"g",ans:t,a:"style-name"},
{ens:q,en:"line",ans:t,a:"style-name"},{ens:q,en:"measure",ans:t,a:"style-name"},{ens:q,en:"page-thumbnail",ans:t,a:"style-name"},{ens:q,en:"path",ans:t,a:"style-name"},{ens:q,en:"polygon",ans:t,a:"style-name"},{ens:q,en:"polyline",ans:t,a:"style-name"},{ens:q,en:"rect",ans:t,a:"style-name"},{ens:q,en:"regular-polygon",ans:t,a:"style-name"},{ens:v,en:"annotation",ans:t,a:"style-name"}],"drawing-page":[{ens:q,en:"page",ans:q,a:"style-name"},{ens:t,en:"notes",ans:q,a:"style-name"},{ens:B,en:"handout-master",
ans:q,a:"style-name"},{ens:B,en:"master-page",ans:q,a:"style-name"}],"list-style":[{ens:w,en:"list",ans:w,a:"style-name"},{ens:w,en:"numbered-paragraph",ans:w,a:"style-name"},{ens:w,en:"list-item",ans:w,a:"style-override"},{ens:B,en:"style",ans:B,a:"list-style-name"}],data:[{ens:B,en:"style",ans:B,a:"data-style-name"},{ens:B,en:"style",ans:B,a:"percentage-data-style-name"},{ens:t,en:"date-time-decl",ans:B,a:"data-style-name"},{ens:w,en:"creation-date",ans:B,a:"data-style-name"},{ens:w,en:"creation-time",
ans:B,a:"data-style-name"},{ens:w,en:"database-display",ans:B,a:"data-style-name"},{ens:w,en:"date",ans:B,a:"data-style-name"},{ens:w,en:"editing-duration",ans:B,a:"data-style-name"},{ens:w,en:"expression",ans:B,a:"data-style-name"},{ens:w,en:"meta-field",ans:B,a:"data-style-name"},{ens:w,en:"modification-date",ans:B,a:"data-style-name"},{ens:w,en:"modification-time",ans:B,a:"data-style-name"},{ens:w,en:"print-date",ans:B,a:"data-style-name"},{ens:w,en:"print-time",ans:B,a:"data-style-name"},{ens:w,
en:"table-formula",ans:B,a:"data-style-name"},{ens:w,en:"time",ans:B,a:"data-style-name"},{ens:w,en:"user-defined",ans:B,a:"data-style-name"},{ens:w,en:"user-field-get",ans:B,a:"data-style-name"},{ens:w,en:"user-field-input",ans:B,a:"data-style-name"},{ens:w,en:"variable-get",ans:B,a:"data-style-name"},{ens:w,en:"variable-input",ans:B,a:"data-style-name"},{ens:w,en:"variable-set",ans:B,a:"data-style-name"}],"page-layout":[{ens:t,en:"notes",ans:B,a:"page-layout-name"},{ens:B,en:"handout-master",ans:B,
a:"page-layout-name"},{ens:B,en:"master-page",ans:B,a:"page-layout-name"}]},C,H=xmldom.XPath;this.collectUsedFontFaces=l;this.changeFontFaceNames=r;this.UsedStyleList=function(b,e){var c={};this.uses=function(b){var e=b.localName,a=b.getAttributeNS(q,"name")||b.getAttributeNS(B,"name");b="style"===e?b.getAttributeNS(B,"family"):b.namespaceURI===A?"data":e;return(b=c[b])?0<b[a]:!1};a(b,c);e&&p(e,c)};this.getStyleName=function(b,e){var a,c,k=C[e.localName];if(k&&(k=k[e.namespaceURI]))for(c=0;c<k.length;c+=
1)if(k[c].keyname===b&&(k=k[c],e.hasAttributeNS(k.ns,k.localname))){a=e.getAttributeNS(k.ns,k.localname);break}return a};this.hasDerivedStyles=function(b,e,a){var c=a.getAttributeNS(B,"name");a=a.getAttributeNS(B,"family");return H.getODFElementsWithXPath(b,"//style:*[@style:parent-style-name='"+c+"'][@style:family='"+a+"']",e).length?!0:!1};this.prefixStyleNames=function(b,e,a){var c;if(b){for(c=b.firstChild;c;){if(c.nodeType===Node.ELEMENT_NODE){var k=c,d=e,f=k.getAttributeNS(q,"name"),h=void 0;
f?h=q:(f=k.getAttributeNS(B,"name"))&&(h=B);h&&k.setAttributeNS(h,D[h]+"name",d+f)}c=c.nextSibling}m(b,e);a&&m(a,e)}};this.removePrefixFromStyleNames=function(b,e,a){var c=new RegExp("^"+e);if(b){for(e=b.firstChild;e;){if(e.nodeType===Node.ELEMENT_NODE){var k=e,f=c,h=k.getAttributeNS(q,"name"),l=void 0;h?l=q:(h=k.getAttributeNS(B,"name"))&&(l=B);l&&(h=h.replace(f,""),k.setAttributeNS(l,D[l]+"name",h))}e=e.nextSibling}d(b,c);a&&d(a,c)}};this.determineStylesForNode=g;C=function(){var b,e,a,c,k,d={},
f,q,h,l;for(a in F)if(F.hasOwnProperty(a))for(c=F[a],e=c.length,b=0;b<e;b+=1)k=c[b],h=k.en,l=k.ens,d.hasOwnProperty(h)?f=d[h]:d[h]=f={},f.hasOwnProperty(l)?q=f[l]:f[l]=q=[],q.push({ns:k.ans,localname:k.a,keyname:a});return d}()};"function"!==typeof Object.create&&(Object.create=function(m){var d=function(){};d.prototype=m;return new d});
xmldom.LSSerializer=function(){function m(a){var d=a||{},f=function(a){var b={},e;for(e in a)a.hasOwnProperty(e)&&(b[a[e]]=e);return b}(a),g=[d],m=[f],l=0;this.push=function(){l+=1;d=g[l]=Object.create(d);f=m[l]=Object.create(f)};this.pop=function(){g.pop();m.pop();l-=1;d=g[l];f=m[l]};this.getLocalNamespaceDefinitions=function(){return f};this.getQName=function(a){var b=a.namespaceURI,e=0,c;if(!b)return a.localName;if(c=f[b])return c+":"+a.localName;do{c||!a.prefix?(c="ns"+e,e+=1):c=a.prefix;if(d[c]===
b)break;if(!d[c]){d[c]=b;f[b]=c;break}c=null}while(null===c);return c+":"+a.localName}}function d(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")}function g(c,h){var f="",n=a.filter?a.filter.acceptNode(h):NodeFilter.FILTER_ACCEPT,m;if(n===NodeFilter.FILTER_ACCEPT&&h.nodeType===Node.ELEMENT_NODE){c.push();m=c.getQName(h);var l,r=h.attributes,b,e,k,q="",x;l="<"+m;b=r.length;for(e=0;e<b;e+=1)k=r.item(e),"http://www.w3.org/2000/xmlns/"!==
k.namespaceURI&&(x=a.filter?a.filter.acceptNode(k):NodeFilter.FILTER_ACCEPT,x===NodeFilter.FILTER_ACCEPT&&(x=c.getQName(k),k="string"===typeof k.value?d(k.value):k.value,q+=" "+(x+'="'+k+'"')));b=c.getLocalNamespaceDefinitions();for(e in b)b.hasOwnProperty(e)&&((r=b[e])?"xmlns"!==r&&(l+=" xmlns:"+b[e]+'="'+e+'"'):l+=' xmlns="'+e+'"');f+=l+(q+">")}if(n===NodeFilter.FILTER_ACCEPT||n===NodeFilter.FILTER_SKIP){for(n=h.firstChild;n;)f+=g(c,n),n=n.nextSibling;h.nodeValue&&(f+=d(h.nodeValue))}m&&(f+="</"+
m+">",c.pop());return f}var a=this;this.filter=null;this.writeToString=function(a,d){if(!a)return"";var f=new m(d);return g(f,a)}};
(function(){function m(a){var b,e=n.length;for(b=0;b<e;b+=1)if("urn:oasis:names:tc:opendocument:xmlns:office:1.0"===a.namespaceURI&&a.localName===n[b])return b;return-1}function d(a,b){var e=new c.UsedStyleList(a,b),k=new odf.OdfNodeFilter;this.acceptNode=function(a){var c=k.acceptNode(a);c===NodeFilter.FILTER_ACCEPT&&a.parentNode===b&&a.nodeType===Node.ELEMENT_NODE&&(c=e.uses(a)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT);return c}}function g(a,b){var e=new d(a,b);this.acceptNode=function(b){var a=
e.acceptNode(b);a!==NodeFilter.FILTER_ACCEPT||!b.parentNode||b.parentNode.namespaceURI!==odf.Namespaces.textns||"s"!==b.parentNode.localName&&"tab"!==b.parentNode.localName||(a=NodeFilter.FILTER_REJECT);return a}}function a(a,b){if(b){var e=m(b),c,d=a.firstChild;if(-1!==e){for(;d;){c=m(d);if(-1!==c&&c>e)break;d=d.nextSibling}a.insertBefore(b,d)}}}var c=new odf.StyleInfo,h=core.DomUtils,f=odf.Namespaces.stylens,n="meta settings scripts font-face-decls styles automatic-styles master-styles body".split(" "),
p=Date.now()+"_webodf_",l=new core.Base64;odf.ODFElement=function(){};odf.ODFDocumentElement=function(){};odf.ODFDocumentElement.prototype=new odf.ODFElement;odf.ODFDocumentElement.prototype.constructor=odf.ODFDocumentElement;odf.ODFDocumentElement.prototype.automaticStyles;odf.ODFDocumentElement.prototype.body;odf.ODFDocumentElement.prototype.fontFaceDecls=null;odf.ODFDocumentElement.prototype.manifest=null;odf.ODFDocumentElement.prototype.masterStyles;odf.ODFDocumentElement.prototype.meta;odf.ODFDocumentElement.prototype.settings=
null;odf.ODFDocumentElement.prototype.styles;odf.ODFDocumentElement.namespaceURI="urn:oasis:names:tc:opendocument:xmlns:office:1.0";odf.ODFDocumentElement.localName="document";odf.AnnotationElement=function(){};odf.AnnotationElement.prototype.annotationEndElement;odf.OdfPart=function(a,b,e,c){var d=this;this.size=0;this.type=null;this.name=a;this.container=e;this.url=null;this.mimetype=b;this.onstatereadychange=this.document=null;this.onchange;this.EMPTY=0;this.LOADING=1;this.DONE=2;this.state=this.EMPTY;
this.data="";this.load=function(){null!==c&&(this.mimetype=b,a||(a=""),c.loadAsDataURL(a,b,function(b,e){b&&runtime.log(b);d.url=e;if(d.onchange)d.onchange(d,b);if(d.onstatereadychange)d.onstatereadychange(d)}))}};odf.OdfPart.prototype.load=function(){};odf.OdfPart.prototype.getUrl=function(){return this.data?"data:;base64,"+l.toBase64(this.data):null};odf.OdfContainer=function b(e,k){function q(b){for(var e=b.firstChild,a;e;)a=e.nextSibling,e.nodeType===Node.ELEMENT_NODE?q(e):e.nodeType===Node.PROCESSING_INSTRUCTION_NODE&&
b.removeChild(e),e=a}function n(b){var e={},a,c,k=b.ownerDocument.createNodeIterator(b,NodeFilter.SHOW_ELEMENT,null,!1);for(b=k.nextNode();b;)"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI&&("annotation"===b.localName?(a=b.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","name"))&&(e.hasOwnProperty(a)?runtime.log("Warning: annotation name used more than once with <office:annotation/>: '"+a+"'"):e[a]=b):"annotation-end"===b.localName&&((a=b.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"name"))?e.hasOwnProperty(a)?(c=e[a],c.annotationEndElement?runtime.log("Warning: annotation name used more than once with <office:annotation-end/>: '"+a+"'"):c.annotationEndElement=b):runtime.log("Warning: annotation end without an annotation start, name: '"+a+"'"):runtime.log("Warning: annotation end without a name found"))),b=k.nextNode()}function m(b,e){for(var a=b&&b.firstChild;a;)a.nodeType===Node.ELEMENT_NODE&&a.setAttributeNS("urn:webodf:names:scope","scope",e),a=a.nextSibling}function v(b,
e){for(var a=U.rootElement.meta,a=a&&a.firstChild;a&&(a.namespaceURI!==b||a.localName!==e);)a=a.nextSibling;for(a=a&&a.firstChild;a&&a.nodeType!==Node.TEXT_NODE;)a=a.nextSibling;return a?a.data:null}function t(b){var e={},a;for(b=b.firstChild;b;)b.nodeType===Node.ELEMENT_NODE&&b.namespaceURI===f&&"font-face"===b.localName&&(a=b.getAttributeNS(f,"name"),e[a]=b),b=b.nextSibling;return e}function B(b,e){var a=null,c,k,d;if(b)for(a=b.cloneNode(!0),c=a.firstElementChild;c;)k=c.nextElementSibling,(d=c.getAttributeNS("urn:webodf:names:scope",
"scope"))&&d!==e&&a.removeChild(c),c=k;return a}function u(b,e){var a,k,d,s=null,q={};if(b)for(e.forEach(function(b){c.collectUsedFontFaces(q,b)}),s=b.cloneNode(!0),a=s.firstElementChild;a;)k=a.nextElementSibling,d=a.getAttributeNS(f,"name"),q[d]||s.removeChild(a),a=k;return s}function w(b){var e=U.rootElement.ownerDocument,a;if(b){q(b.documentElement);try{a=e.importNode(b.documentElement,!0)}catch(c){}}return a}function D(b){U.state=b;if(U.onchange)U.onchange(U);if(U.onstatereadychange)U.onstatereadychange(U)}
function F(b){da=null;U.rootElement=b;b.fontFaceDecls=h.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls");b.styles=h.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles");b.automaticStyles=h.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles");b.masterStyles=h.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles");b.body=h.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"body");b.meta=h.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta");b.settings=h.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","settings");b.scripts=h.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","scripts");n(b)}function C(e){var k=w(e),d=U.rootElement,f;k&&"document-styles"===k.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===k.namespaceURI?(d.fontFaceDecls=h.getDirectChild(k,"urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"font-face-decls"),a(d,d.fontFaceDecls),f=h.getDirectChild(k,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles"),d.styles=f||e.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles"),a(d,d.styles),f=h.getDirectChild(k,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),d.automaticStyles=f||e.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),m(d.automaticStyles,"document-styles"),a(d,d.automaticStyles),k=h.getDirectChild(k,
"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),d.masterStyles=k||e.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),a(d,d.masterStyles),c.prefixStyleNames(d.automaticStyles,p,d.masterStyles)):D(b.INVALID)}function H(e){e=w(e);var k,d,s,q;if(e&&"document-content"===e.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===e.namespaceURI){k=U.rootElement;s=h.getDirectChild(e,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls");
if(k.fontFaceDecls&&s){q=k.fontFaceDecls;var l,g,M,y,n={};d=t(q);y=t(s);for(s=s.firstElementChild;s;){l=s.nextElementSibling;if(s.namespaceURI===f&&"font-face"===s.localName)if(g=s.getAttributeNS(f,"name"),d.hasOwnProperty(g)){if(!s.isEqualNode(d[g])){M=g;for(var p=d,u=y,z=0,x=void 0,x=M=M.replace(/\d+$/,"");p.hasOwnProperty(x)||u.hasOwnProperty(x);)z+=1,x=M+z;M=x;s.setAttributeNS(f,"style:name",M);q.appendChild(s);d[M]=s;delete y[g];n[g]=M}}else q.appendChild(s),d[g]=s,delete y[g];s=l}q=n}else s&&
(k.fontFaceDecls=s,a(k,s));d=h.getDirectChild(e,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles");m(d,"document-content");q&&c.changeFontFaceNames(d,q);if(k.automaticStyles&&d)for(q=d.firstChild;q;)k.automaticStyles.appendChild(q),q=d.firstChild;else d&&(k.automaticStyles=d,a(k,d));e=h.getDirectChild(e,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","body");if(null===e)throw"<office:body/> tag is mising.";k.body=e;a(k,k.body)}else D(b.INVALID)}function s(b){b=w(b);var e;b&&
"document-meta"===b.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI&&(e=U.rootElement,e.meta=h.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),a(e,e.meta))}function z(b){b=w(b);var e;b&&"document-settings"===b.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI&&(e=U.rootElement,e.settings=h.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","settings"),a(e,e.settings))}function y(b){b=w(b);var e;
if(b&&"manifest"===b.localName&&"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"===b.namespaceURI)for(e=U.rootElement,e.manifest=b,b=e.manifest.firstElementChild;b;)"file-entry"===b.localName&&"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"===b.namespaceURI&&(S[b.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","full-path")]=b.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","media-type")),b=b.nextElementSibling}function M(b,e,a){b=h.getElementsByTagName(b,
e);var c;for(c=0;c<b.length;c+=1)e=b[c],a.hasOwnProperty(e.namespaceURI)||e.parentNode.removeChild(e)}function E(b){M(b,"script",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:office:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:table:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:text:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":!0});M(b,"style",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":!0,
"urn:oasis:names:tc:opendocument:xmlns:style:1.0":!0})}function I(b){var e=b.firstElementChild,a=[],c,k,d,f=b.attributes,s=f.length;for(c=0;c<s;c+=1)d=f.item(c),k=d.localName.substr(0,2).toLowerCase(),null===d.namespaceURI&&"on"===k&&a.push(d);s=a.length;for(c=0;c<s;c+=1)b.removeAttributeNode(a[c]);for(;e;)I(e),e=e.nextElementSibling}function J(e){var a=e.shift();if(a){var c=(new Date).getTime();$.loadAsDOM(a.path,function(k,d){d&&(E(d),I(d.documentElement));a.handler(d);if(5E3<(new Date).getTime()-
c)g_errmsg("Sorry, It takes too much time to run.");else{if(U.state===b.INVALID){k?runtime.log("ERROR: Unable to load "+a.path+" - "+k):runtime.log("ERROR: Unable to load "+a.path);if("content.xml"==a.path)return;J(e)}k&&runtime.log("DEBUG: Unable to load "+a.path+" - "+k);J(e)}})}else n(U.rootElement),D(b.DONE)}function K(b){var e="";odf.Namespaces.forEachPrefix(function(b,a){e+=" xmlns:"+b+'="'+a+'"'});return'<?xml version="1.0" encoding="UTF-8"?><office:'+b+" "+e+' office:version="1.2">'}function G(){var b=
new xmldom.LSSerializer,e=K("document-meta");b.filter=new odf.OdfNodeFilter;e+=b.writeToString(U.rootElement.meta,odf.Namespaces.namespaceMap);return e+"</office:document-meta>"}function W(b,e){var a=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:file-entry");a.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:full-path",b);a.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:media-type",e);return a}function P(){var b=
runtime.parseXML('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2"></manifest:manifest>'),e=b.documentElement,a=new xmldom.LSSerializer,c;for(c in S)S.hasOwnProperty(c)&&e.appendChild(W(c,S[c]));a.filter=new odf.OdfNodeFilter;return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n'+a.writeToString(b,odf.Namespaces.namespaceMap)}function R(){var b,e,a,k=odf.Namespaces.namespaceMap,f=new xmldom.LSSerializer,s=K("document-styles");
e=B(U.rootElement.automaticStyles,"document-styles");a=U.rootElement.masterStyles.cloneNode(!0);b=u(U.rootElement.fontFaceDecls,[a,U.rootElement.styles,e]);c.removePrefixFromStyleNames(e,p,a);f.filter=new d(a,e);s+=f.writeToString(b,k);s+=f.writeToString(U.rootElement.styles,k);s+=f.writeToString(e,k);s+=f.writeToString(a,k);return s+"</office:document-styles>"}function ba(){var b,e,a=odf.Namespaces.namespaceMap,c=new xmldom.LSSerializer,k=K("document-content");e=B(U.rootElement.automaticStyles,"document-content");
b=u(U.rootElement.fontFaceDecls,[e]);c.filter=new g(U.rootElement.body,e);k+=c.writeToString(b,a);k+=c.writeToString(e,a);k+=c.writeToString(U.rootElement.body,a);return k+"</office:document-content>"}function ca(e,a){runtime.loadXML(e,function(e,c){if(e)a(e);else if(c){E(c);I(c.documentElement);var k=w(c);k&&"document"===k.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===k.namespaceURI?(F(k),D(b.DONE)):D(b.INVALID)}else a("No DOM was loaded.")})}function L(b,e){var c;c=U.rootElement;
var k=c.meta;k||(c.meta=k=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),a(c,k));c=k;b&&h.mapKeyValObjOntoNode(c,b,odf.Namespaces.lookupNamespaceURI);e&&h.removeKeyElementsFromNode(c,e,odf.Namespaces.lookupNamespaceURI)}function Y(e,a){function c(b,e){var a;e||(e=b);a=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",e);s[b]=a;s.appendChild(a)}var k=new core.Zip("",null),d="application/vnd.oasis.opendocument."+e+(!0===a?"-template":""),
f=runtime.byteArrayFromString(d,"utf8"),s=U.rootElement,q=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",e);k.save("mimetype",f,!1,new Date);c("meta");c("settings");c("scripts");c("fontFaceDecls","font-face-decls");c("styles");c("automaticStyles","automatic-styles");c("masterStyles","master-styles");c("body");s.body.appendChild(q);S["/"]=d;S["settings.xml"]="text/xml";S["meta.xml"]="text/xml";S["styles.xml"]="text/xml";S["content.xml"]="text/xml";D(b.DONE);return k}function ea(){var b,
e=new Date,a="";U.rootElement.settings&&U.rootElement.settings.firstElementChild&&(b=new xmldom.LSSerializer,a=K("document-settings"),b.filter=new odf.OdfNodeFilter,a+=b.writeToString(U.rootElement.settings,odf.Namespaces.namespaceMap),a+="</office:document-settings>");(b=a)?(b=runtime.byteArrayFromString(b,"utf8"),$.save("settings.xml",b,!0,e)):$.remove("settings.xml");a=runtime.getWindow();b="WebODF/"+webodf.Version;a&&(b=b+" "+a.navigator.userAgent);L({"meta:generator":b},null);b=runtime.byteArrayFromString(G(),
"utf8");$.save("meta.xml",b,!0,e);b=runtime.byteArrayFromString(R(),"utf8");$.save("styles.xml",b,!0,e);b=runtime.byteArrayFromString(ba(),"utf8");$.save("content.xml",b,!0,e);b=runtime.byteArrayFromString(P(),"utf8");$.save("META-INF/manifest.xml",b,!0,e)}function X(b,e){ea();$.writeAs(b,function(b){e(b)})}var U=this,$,S={},da,T="";this.onstatereadychange=k;this.state=this.onchange=null;this.rootElement;this.getMetadata=v;this.setRootElement=F;this.getContentElement=function(){var b;da||(b=U.rootElement.body,
da=h.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","text")||h.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","presentation")||h.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","spreadsheet"));if(!da)throw g_errmsg('<div style="margin:0px 30px">An error has occurred. Please check whether the file format supports. or Reopen a file.</div>'),"Could not find content element in <office:body/>.";return da};this.getDocumentType=function(){var b=
U.getContentElement();return b&&b.localName};this.isTemplate=function(){return"-template"===S["/"].substr(-9)};this.setIsTemplate=function(b){var e=S["/"],a="-template"===e.substr(-9);b!==a&&(e=b?e+"-template":e.substr(0,e.length-9),S["/"]=e,b=runtime.byteArrayFromString(e,"utf8"),$.save("mimetype",b,!1,new Date))};this.getPart=function(b){return new odf.OdfPart(b,S[b],U,$)};this.getPartData=function(b,e){$.load(b,e)};this.getPartData2=function(b,e){$.loadAsString(b,e)};this.setMetadata=L;this.incrementEditingCycles=
function(){var b=v(odf.Namespaces.metans,"editing-cycles"),b=b?parseInt(b,10):0;isNaN(b)&&(b=0);L({"meta:editing-cycles":b+1},null);return b+1};this.createByteArray=function(b,e){ea();$.createByteArray(b,e)};this.saveAs=X;this.save=function(b){X(T,b)};this.getUrl=function(){return T};this.setBlob=function(b,e,a){a=l.convertBase64ToByteArray(a);$.save(b,a,!1,new Date);S.hasOwnProperty(b)&&runtime.log(b+" has been overwritten.");S[b]=e};this.removeBlob=function(b){var e=$.remove(b);runtime.assert(e,
"file is not found: "+b);delete S[b]};this.state=b.LOADING;this.rootElement=function(b){var e=document.createElementNS(b.namespaceURI,b.localName),a;b=new b.Type;for(a in b)b.hasOwnProperty(a)&&(e[a]=b[a]);return e}({Type:odf.ODFDocumentElement,namespaceURI:odf.ODFDocumentElement.namespaceURI,localName:odf.ODFDocumentElement.localName});e===odf.OdfContainer.DocumentType.TEXT?$=Y("text"):e===odf.OdfContainer.DocumentType.TEXT_TEMPLATE?$=Y("text",!0):e===odf.OdfContainer.DocumentType.PRESENTATION?$=
Y("presentation"):e===odf.OdfContainer.DocumentType.PRESENTATION_TEMPLATE?$=Y("presentation",!0):e===odf.OdfContainer.DocumentType.SPREADSHEET?$=Y("spreadsheet"):e===odf.OdfContainer.DocumentType.SPREADSHEET_TEMPLATE?$=Y("spreadsheet",!0):(T=e,$=new core.Zip(T,function(e,a){$=a;e?ca(T,function(a){e&&($.error=e+"\n"+a,console.log($.error),D(b.INVALID))}):J([{path:"styles.xml",handler:C},{path:"content.xml",handler:H},{path:"meta.xml",handler:s},{path:"settings.xml",handler:z},{path:"META-INF/manifest.xml",
handler:y}])}))};odf.OdfContainer.EMPTY=0;odf.OdfContainer.LOADING=1;odf.OdfContainer.DONE=2;odf.OdfContainer.INVALID=3;odf.OdfContainer.SAVING=4;odf.OdfContainer.MODIFIED=5;odf.OdfContainer.getContainer=function(b){return new odf.OdfContainer(b,null)}})();odf.OdfContainer.DocumentType={TEXT:1,TEXT_TEMPLATE:2,PRESENTATION:3,PRESENTATION_TEMPLATE:4,SPREADSHEET:5,SPREADSHEET_TEMPLATE:6};gui.AnnotatableCanvas=function(){};gui.AnnotatableCanvas.prototype.refreshSize=function(){};
gui.AnnotatableCanvas.prototype.getZoomLevel=function(){};gui.AnnotatableCanvas.prototype.getSizer=function(){};
gui.AnnotationViewManager=function(m,d,g,a){function c(b){var a=b.annotationEndElement,c=l.createRange(),d=b.getAttributeNS(odf.Namespaces.officens,"name");a&&(c.setStart(b,b.childNodes.length),c.setEnd(a,0),b=r.getTextNodes(c,!1),b.forEach(function(b){var e;a:{for(e=b.parentNode;e.namespaceURI!==odf.Namespaces.officens||"body"!==e.localName;){if("http://www.w3.org/1999/xhtml"===e.namespaceURI&&"webodf-annotationHighlight"===e.className&&e.getAttribute("annotation")===d){e=!0;break a}e=e.parentNode}e=
!1}e||(e=l.createElement("span"),e.className="webodf-annotationHighlight",e.setAttribute("annotation",d),b.parentNode.replaceChild(e,b),e.appendChild(b))}));c.detach()}function h(e){var a=m.getSizer();e?(g.style.display="inline-block",a.style.paddingRight=b.getComputedStyle(g).width):(g.style.display="none",a.style.paddingRight=0);m.refreshSize()}function f(){p.sort(function(b,a){return 0!==(b.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_FOLLOWING)?-1:1})}function n(){var b;for(b=0;b<p.length;b+=
1){var a=p[b],c=a.parentNode,d=c.nextElementSibling,f=d.nextElementSibling,h=c.parentNode,l=0,l=p[p.indexOf(a)-1],n=void 0,a=m.getZoomLevel();c.style.left=(g.getBoundingClientRect().left-h.getBoundingClientRect().left)/a+"px";c.style.width=g.getBoundingClientRect().width/a+"px";d.style.width=parseFloat(c.style.left)-30+"px";l&&(n=l.parentNode.getBoundingClientRect(),20>=(h.getBoundingClientRect().top-n.bottom)/a?c.style.top=Math.abs(h.getBoundingClientRect().top-n.bottom)/a+20+"px":c.style.top="0px");
f.style.left=d.getBoundingClientRect().width/a+"px";var d=f.style,h=f.getBoundingClientRect().left/a,l=f.getBoundingClientRect().top/a,n=c.getBoundingClientRect().left/a,u=c.getBoundingClientRect().top/a,r=0,D=0,r=n-h,r=r*r,D=u-l,D=D*D,h=Math.sqrt(r+D);d.width=h+"px";l=Math.asin((c.getBoundingClientRect().top-f.getBoundingClientRect().top)/(a*parseFloat(f.style.width)));f.style.transform="rotate("+l+"rad)";f.style.MozTransform="rotate("+l+"rad)";f.style.WebkitTransform="rotate("+l+"rad)";f.style.msTransform=
"rotate("+l+"rad)"}}var p=[],l=d.ownerDocument,r=odf.OdfUtils,b=runtime.getWindow();runtime.assert(Boolean(b),"Expected to be run in an environment which has a global window, like a browser.");this.rerenderAnnotations=n;this.rehighlightAnnotations=function(){p.forEach(function(b){c(b)})};this.getMinimumHeightForAnnotationPane=function(){return"none"!==g.style.display&&0<p.length?(p[p.length-1].parentNode.getBoundingClientRect().bottom-g.getBoundingClientRect().top)/m.getZoomLevel()+"px":null};this.addAnnotation=
function(b){h(!0);p.push(b);f();var k=l.createElement("div"),d=l.createElement("div"),g=l.createElement("div"),m=l.createElement("div"),v;k.className="annotationWrapper";k.setAttribute("creator",r.getAnnotationCreator(b));b.parentNode.insertBefore(k,b);d.className="annotationNote";d.appendChild(b);a&&(v=l.createElement("div"),v.className="annotationRemoveButton",d.appendChild(v));g.className="annotationConnector horizontal";m.className="annotationConnector angular";k.appendChild(d);k.appendChild(g);
k.appendChild(m);b.annotationEndElement&&c(b);n()};this.forgetAnnotations=function(){for(;p.length;){var b=p[0],a=p.indexOf(b),c=b.parentNode.parentNode;"div"===c.localName&&(c.parentNode.insertBefore(b,c),c.parentNode.removeChild(c));for(var b=b.getAttributeNS(odf.Namespaces.officens,"name"),b=l.querySelectorAll('span.webodf-annotationHighlight[annotation="'+b+'"]'),d=c=void 0,c=0;c<b.length;c+=1){for(d=b.item(c);d.firstChild;)d.parentNode.insertBefore(d.firstChild,d);d.parentNode.removeChild(d)}-1!==
a&&p.splice(a,1);0===p.length&&h(!1)}}};gui.Viewport=function(){};gui.Viewport.prototype.scrollIntoView=function(m,d){};
gui.SingleScrollViewport=function(m){this.scrollIntoView=function(d,g){var a,c,h,f;f=m.offsetHeight-m.clientHeight;h=m.offsetWidth-m.clientWidth;var n=m.getBoundingClientRect();if(d&&n){a=n.left+5;c=n.top+5;h=n.right-(h+5);f=n.bottom-(f+5);if(g||d.top<c)m.scrollTop-=c-d.top;else if(d.top>f||d.bottom>f)m.scrollTop=d.bottom-d.top<=f-c?m.scrollTop+(d.bottom-f):m.scrollTop+(d.top-c);d.left<a?m.scrollLeft-=a-d.left:d.right>h&&(m.scrollLeft=d.right-d.left<=h-a?m.scrollLeft+(d.right-h):m.scrollLeft-(a-d.left))}}};
(function(){function m(c,d,f,g,p){var l,r=0,b;for(b in c)if(c.hasOwnProperty(b)){if(r===f){l=b;break}r+=1}l?d.getPartData(c[l].href,function(b,k){if(b)runtime.log(b);else if(k){var q="@font-face { font-family: "+(c[l].family||l)+"; src: url(data:application/x-font-ttf;charset=binary;base64,"+a.convertUTF8ArrayToBase64(k)+') format("truetype"); }';try{g.insertRule(q,g.cssRules.length)}catch(r){runtime.log("Problem inserting rule in CSS: "+runtime.toJson(r)+"\nRule: "+q)}}else runtime.log("missing font data for "+
c[l].href);m(c,d,f+1,g,p)}):p&&p()}var d=xmldom.XPath,g=odf.OdfUtils,a=new core.Base64;odf.FontLoader=function(){this.loadFonts=function(a,h){for(var f=a.rootElement.fontFaceDecls;h.cssRules.length;)h.deleteRule(h.cssRules.length-1);if(f){var n={},p,l,r,b;if(f)for(f=d.getODFElementsWithXPath(f,"style:font-face[svg:font-face-src]",odf.Namespaces.lookupNamespaceURI),p=0;p<f.length;p+=1)l=f[p],r=l.getAttributeNS(odf.Namespaces.stylens,"name"),b=g.getNormalizedFontFamilyName(l.getAttributeNS(odf.Namespaces.svgns,
"font-family")),l=d.getODFElementsWithXPath(l,"svg:font-face-src/svg:font-face-uri",odf.Namespaces.lookupNamespaceURI),0<l.length&&(l=l[0].getAttributeNS(odf.Namespaces.xlinkns,"href"),n[r]={href:l,family:b});m(n,a,0,h)}}}})();
odf.Formatting=function(){function m(b){return(b=D[b])?u.mergeObjects({},b):{}}function d(){for(var e=b.rootElement.fontFaceDecls,a={},c,d,e=e&&e.firstElementChild;e;){if(c=e.getAttributeNS(q,"name"))if((d=e.getAttributeNS(k,"font-family"))||0<e.getElementsByTagNameNS(k,"font-face-uri").length)a[c]=d;e=e.nextElementSibling}return a}function g(e){for(var a=b.rootElement.styles.firstElementChild;a;){if(a.namespaceURI===q&&"default-style"===a.localName&&a.getAttributeNS(q,"family")===e)return a;a=a.nextElementSibling}return null}
function a(e,a,c){var d,k,f;c=c||[b.rootElement.automaticStyles,b.rootElement.styles];for(f=0;f<c.length;f+=1)for(d=c[f],d=d.firstElementChild;d;){k=d.getAttributeNS(q,"name");if(d.namespaceURI===q&&"style"===d.localName&&d.getAttributeNS(q,"family")===a&&k===e||"list-style"===a&&d.namespaceURI===x&&"list-style"===d.localName&&k===e||"data"===a&&d.namespaceURI===A&&k===e)return d;d=d.nextElementSibling}return null}function c(b){for(var e,a,c,d,k={},f=b.firstElementChild;f;){if(f.namespaceURI===q)for(c=
k[f.nodeName]={},a=f.attributes,e=0;e<a.length;e+=1)d=a.item(e),c[d.name]=d.value;f=f.nextElementSibling}a=b.attributes;for(e=0;e<a.length;e+=1)d=a.item(e),k[d.name]=d.value;return k}function h(e,d){for(var k=b.rootElement.styles,f,h={},l=e.getAttributeNS(q,"family"),M=e;M;)f=c(M),h=u.mergeObjects(f,h),M=(f=M.getAttributeNS(q,"parent-style-name"))?a(f,l,[k]):null;if(M=g(l))f=c(M),h=u.mergeObjects(f,h);!1!==d&&(f=m(l),h=u.mergeObjects(f,h));return h}function f(b,a){function c(b){Object.keys(b).forEach(function(e){Object.keys(b[e]).forEach(function(b){h+=
"|"+e+":"+b+"|"})})}for(var d=b.nodeType===Node.TEXT_NODE?b.parentNode:b,k,f=[],h="",q=!1;d;)!q&&t.isGroupingElement(d)&&(q=!0),(k=e.determineStylesForNode(d))&&f.push(k),d=d.parentNode;q&&(f.forEach(c),a&&(a[h]=f));return q?f:void 0}function n(e){var c={orderedStyles:[],styleProperties:{}};e.forEach(function(e){Object.keys(e).forEach(function(d){var k=Object.keys(e[d])[0],f={name:k,family:d,displayName:void 0,isCommonStyle:!1},l;(l=a(k,d))?(d=h(l),c.styleProperties=u.mergeObjects(d,c.styleProperties),
f.displayName=l.getAttributeNS(q,"display-name")||void 0,f.isCommonStyle=l.parentNode===b.rootElement.styles):runtime.log("No style element found for '"+k+"' of family '"+d+"'");c.orderedStyles.push(f)})});return c}function p(b,e){var a={},c=[];e||(e={});b.forEach(function(b){f(b,a)});Object.keys(a).forEach(function(b){e[b]||(e[b]=n(a[b]));c.push(e[b])});return c}function l(e){for(var a=b.rootElement.masterStyles.firstElementChild;a&&(a.namespaceURI!==q||"master-page"!==a.localName||a.getAttributeNS(q,
"name")!==e);)a=a.nextElementSibling;return a}function r(b,e){var a;b&&(a=w.convertMeasure(b,"px"));void 0===a&&e&&(a=w.convertMeasure(e,"px"));return a}var b,e=new odf.StyleInfo,k=odf.Namespaces.svgns,q=odf.Namespaces.stylens,x=odf.Namespaces.textns,A=odf.Namespaces.numberns,v=odf.Namespaces.fons,t=odf.OdfUtils,B=core.DomUtils,u=new core.Utils,w=new core.CSSUnits,D={paragraph:{"style:paragraph-properties":{"fo:text-align":"left"}}};this.getSystemDefaultStyleAttributes=m;this.setOdfContainer=function(e){b=
e};this.getFontMap=d;this.getAvailableParagraphStyles=function(){for(var e=b.rootElement.styles,a,c,d=[],e=e&&e.firstElementChild;e;)"style"===e.localName&&e.namespaceURI===q&&(a=e.getAttributeNS(q,"family"),"paragraph"===a&&(a=e.getAttributeNS(q,"name"),c=e.getAttributeNS(q,"display-name")||a,a&&c&&d.push({name:a,displayName:c}))),e=e.nextElementSibling;return d};this.isStyleUsed=function(a){var c,d=b.rootElement;c=e.hasDerivedStyles(d,odf.Namespaces.lookupNamespaceURI,a);a=(new e.UsedStyleList(d.styles)).uses(a)||
(new e.UsedStyleList(d.automaticStyles)).uses(a)||(new e.UsedStyleList(d.body)).uses(a);return c||a};this.getDefaultStyleElement=g;this.getStyleElement=a;this.getStyleAttributes=c;this.getInheritedStyleAttributes=h;this.getFirstCommonParentStyleNameOrSelf=function(e){var c=b.rootElement.styles,d;if(d=a(e,"paragraph",[b.rootElement.automaticStyles]))if(e=d.getAttributeNS(q,"parent-style-name"),!e)return null;return(d=a(e,"paragraph",[c]))?e:null};this.hasParagraphStyle=function(b){return Boolean(a(b,
"paragraph"))};this.getAppliedStyles=p;this.getAppliedStylesForElement=function(b,e){return p([b],e)[0]};this.updateStyle=function(e,a){var c,f;B.mapObjOntoNode(e,a,odf.Namespaces.lookupNamespaceURI);(c=(c=a["style:text-properties"])&&c["style:font-name"])&&!d().hasOwnProperty(c)&&(f=e.ownerDocument.createElementNS(q,"style:font-face"),f.setAttributeNS(q,"style:name",c),f.setAttributeNS(k,"svg:font-family",c),b.rootElement.fontFaceDecls.appendChild(f))};this.createDerivedStyleObject=function(e,d,
k){var f=a(e,d);runtime.assert(Boolean(f),"No style element found for '"+e+"' of family '"+d+"'");e=f.parentNode===b.rootElement.styles?{"style:parent-style-name":e}:c(f);e["style:family"]=d;u.mergeObjects(e,k);return e};this.getDefaultTabStopDistance=function(){for(var b=g("paragraph"),b=b&&b.firstElementChild,e;b;)b.namespaceURI===q&&"paragraph-properties"===b.localName&&(e=b.getAttributeNS(q,"tab-stop-distance")),b=b.nextElementSibling;e||(e="1.25cm");return t.parseNonNegativeLength(e)};this.getMasterPageElement=
l;this.getContentSize=function(e,c){var d,k,f,h,g,n,m,p,u,x;a:{k=a(e,c);runtime.assert("paragraph"===c||"table"===c,"styleFamily must be either paragraph or table");if(k){if(k=k.getAttributeNS(q,"master-page-name"))(d=l(k))||runtime.log("WARN: No master page definition found for "+k);d||(d=l("Standard"));d||(d=b.rootElement.masterStyles.getElementsByTagNameNS(q,"master-page")[0])||runtime.log("WARN: Document has no master pages defined");if(d)for(k=d.getAttributeNS(q,"page-layout-name"),f=b.rootElement.automaticStyles.getElementsByTagNameNS(q,
"page-layout"),h=0;h<f.length;h+=1)if(d=f.item(h),d.getAttributeNS(q,"name")===k)break a}d=null}d||(d=B.getDirectChild(b.rootElement.styles,q,"default-page-layout"));(d=B.getDirectChild(d,q,"page-layout-properties"))?("landscape"===d.getAttributeNS(q,"print-orientation")?(k="29.7cm",f="21.001cm"):(k="21.001cm",f="29.7cm"),k=r(d.getAttributeNS(v,"page-width"),k),f=r(d.getAttributeNS(v,"page-height"),f),h=r(d.getAttributeNS(v,"margin")),void 0===h?(h=r(d.getAttributeNS(v,"margin-left"),"2cm"),g=r(d.getAttributeNS(v,
"margin-right"),"2cm"),n=r(d.getAttributeNS(v,"margin-top"),"2cm"),m=r(d.getAttributeNS(v,"margin-bottom"),"2cm")):h=g=n=m=h,p=r(d.getAttributeNS(v,"padding")),void 0===p?(p=r(d.getAttributeNS(v,"padding-left"),"0cm"),u=r(d.getAttributeNS(v,"padding-right"),"0cm"),x=r(d.getAttributeNS(v,"padding-top"),"0cm"),d=r(d.getAttributeNS(v,"padding-bottom"),"0cm")):p=u=x=d=p):(k=r("21.001cm"),f=r("29.7cm"),h=g=n=m=h=r("2cm"),p=u=x=d=p=r("0cm"));return{width:k-h-g-p-u,height:f-n-m-x-d}}};odf.Formatting.StyleMetadata;
odf.Formatting.StyleData;odf.Formatting.AppliedStyle;
(function(){var m=odf.Namespaces.stylens,d=odf.Namespaces.textns,g={graphic:"draw","drawing-page":"draw",paragraph:"text",presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"};odf.StyleTreeNode=function(a){this.derivedStyles={};this.element=a};odf.StyleTree=function(a,c){function h(a){var b,e,c,f={};if(!a)return f;for(a=a.firstElementChild;a;){if(e=a.namespaceURI!==m||"style"!==a.localName&&
"default-style"!==a.localName?a.namespaceURI===d&&"list-style"===a.localName?"list":a.namespaceURI!==m||"page-layout"!==a.localName&&"default-page-layout"!==a.localName?void 0:"page":a.getAttributeNS(m,"family"))(b=a.getAttributeNS(m,"name"))||(b=""),f.hasOwnProperty(e)?c=f[e]:f[e]=c={},c[b]=a;a=a.nextElementSibling}return f}function f(a,b){if(a.hasOwnProperty(b))return a[b];var e=null,c=Object.keys(a),d;for(d=0;d<c.length&&!(e=f(a[c[d]].derivedStyles,b));d+=1);return e}function n(a,b,e){var c,d,
h;if(!b.hasOwnProperty(a))return null;c=new odf.StyleTreeNode(b[a]);d=c.element.getAttributeNS(m,"parent-style-name");h=null;d&&(h=f(e,d)||n(d,b,e));h?h.derivedStyles[a]=c:e[a]=c;delete b[a];return c}function p(a,b){a&&Object.keys(a).forEach(function(e){n(e,a,b)})}var l={};this.getStyleTree=function(){return l};(function(){var d,b,e;b=h(a);e=h(c);Object.keys(g).forEach(function(a){d=l[a]={};p(b[a],d);p(e[a],d)})})()}})();odf.StyleTree.Tree;
(function(){function m(a,c){try{a.insertRule(c,a.cssRules.length)}catch(d){runtime.log("cannot load rule: "+c+" - "+d)}}function d(a,c){this.listCounterCount=0;this.contentRules=a;this.counterIdStack=[];this.continuedCounterIdStack=c}function g(a){function c(e,d,f,g){var n=d.namespaceURI===h&&"list"===d.localName,r=d.namespaceURI===h&&"list-item"===d.localName;if(n||r){if(n){var n=f+=1,B,u,w;g.listCounterCount+=1;r=e+"-level"+n+"-"+g.listCounterCount;d.setAttributeNS("urn:webodf:names:helper","counter-id",
r);B=g.continuedCounterIdStack.shift();B||(B=r,b+=r+" 1 ",u='text|list[webodfhelper|counter-id="'+r+'"] > text|list-item:first-child > :not(text|list):first-child:before',u+="{",u+="counter-increment: "+B+" 0;",u+="}",m(a,u));for(;g.counterIdStack.length>=n;)g.counterIdStack.pop();g.counterIdStack.push(B);w=g.contentRules[n.toString()]||"";for(u=1;u<=n;u+=1)w=w.replace(u+"webodf-listLevel",g.counterIdStack[u-1]);u='text|list[webodfhelper|counter-id="'+r+'"] > text|list-item > :not(text|list):first-child:before';
u+="{";u+=w;u+="counter-increment: "+B+";";u+="}";m(a,u)}for(d=d.firstElementChild;d;)c(e,d,f,g),d=d.nextElementSibling}else g.continuedCounterIdStack=[]}var g=0,b="",e={};this.createCounterRules=function(b,a,h){var n=a.getAttributeNS(f,"id"),m=[];h&&(h=h.getAttributeNS("urn:webodf:names:helper","counter-id"),m=e[h].slice(0));b=new d(b,m);n?n="Y"+n:(g+=1,n="X"+g);c(n,a,0,b);e[n+"-level1-1"]=b.counterIdStack};this.initialiseCreatedCounters=function(){var e;e="office|document{"+("counter-reset: "+b+
";");e+="}";m(a,e)}}var a=odf.Namespaces.fons,c=odf.Namespaces.stylens,h=odf.Namespaces.textns,f=odf.Namespaces.xmlns,n={1:"decimal",a:"lower-latin",A:"upper-latin",i:"lower-roman",I:"upper-roman"};odf.ListStyleToCss=function(){function d(b){var a=k.parseLength(b);return a?e.convert(a.value,a.unit,"px"):(runtime.log("Could not parse value '"+b+"'."),0)}function l(b){return b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function r(b,a){var e;b&&(e=b.getAttributeNS(h,"style-name"));return e===a}function b(b,
e,a){e=e.getElementsByTagNameNS(h,"list");b=new g(b);var d,k,m,p,w,D,F={},C;for(C=0;C<e.length;C+=1){d=e.item(C);if(m=core.DomUtils.getDirectChild(d,h,"list-header"))try{d.parentNode.insertBefore(m.cloneNode(!0),d),m.parentNode.removeChild(m)}catch(H){}if(D=d.getAttributeNS(h,"style-name")){m=d.getAttributeNS(h,"continue-numbering");p=d.getAttributeNS(h,"continue-list");(w=d.getAttributeNS(f,"id"))&&(F[w]=d);w=a[D].element.firstElementChild;for(var s=void 0,z={};w;){var s=(s=w.getAttributeNS(h,"level"))&&
parseInt(s,10),y=w,M="",E=void 0,I=void 0,J=E=void 0;if("list-level-style-number"===y.localName){var M=y.getAttributeNS(c,"num-format"),E=y.getAttributeNS(c,"num-suffix")||"",I=y.getAttributeNS(c,"num-prefix")||"",K="",G=y.getAttributeNS(h,"level"),W=y.getAttributeNS(h,"display-levels");I&&(K+='"'+l(I)+'"\n');if(n.hasOwnProperty(M))for(G=G?parseInt(G,10):1,W=W?parseInt(W,10):1;0<W;)K+=" counter("+(G-W+1)+"webodf-listLevel,"+n[M]+")",1<W&&(K+='"."'),W-=1;else K=M?K+(' "'+M+'"'):K+' ""';M="content:"+
K+' "'+l(E)+'"'}else"list-level-style-image"===y.localName?M="content: none":"list-level-style-bullet"===y.localName&&(M=y.getAttributeNS(h,"bullet-char"),M='content: "'+l(M)+'"');if(E=y.getElementsByTagNameNS(c,"list-level-properties")[0])I=E.getAttributeNS(h,"list-level-position-and-space-mode"),"label-alignment"===I&&((E=E.getElementsByTagNameNS(c,"list-level-label-alignment")[0])&&(J=E.getAttributeNS(h,"label-followed-by")),"space"===J&&(M+=' "\\a0"'));z[s]="\n"+M+";\n";w=w.nextElementSibling}w=
z;m&&!p&&r(k,D)?b.createCounterRules(w,d,k):p&&r(F[p],D)?b.createCounterRules(w,d,F[p]):b.createCounterRules(w,d);k=d}}b.initialiseCreatedCounters()}var e=new core.CSSUnits,k=odf.OdfUtils;this.applyListStyles=function(e,k,f){var l,g;(l=k.list)&&Object.keys(l).forEach(function(b){g=l[b];for(var k=g.element.firstElementChild;k;){if(k.namespaceURI===h){for(var f=e,n=k,r='text|list[text|style-name="'+b+'"]',x=n.getAttributeNS(h,"level"),H=void 0,s=void 0,z=s=void 0,y=void 0,M=void 0,E=H=void 0,I=void 0,
J=void 0,A=void 0,y=void 0,z=(s=n.getElementsByTagNameNS(c,"list-level-properties")[0])&&s.getAttributeNS(h,"list-level-position-and-space-mode"),y=s&&s.getElementsByTagNameNS(c,"list-level-label-alignment")[0],H=x=x&&parseInt(x,10);1<H;)r+=" > text|list-item > text|list",H-=1;H=s&&s.getAttributeNS(a,"text-align")||"left";switch(H){case "end":H="right";break;case "start":H="left"}"label-alignment"===z?(M=y&&y.getAttributeNS(a,"margin-left")||"0px",J=y&&y.getAttributeNS(a,"text-indent")||"0px",A=y&&
y.getAttributeNS(h,"label-followed-by"),y=d(M)):(M=s&&s.getAttributeNS(h,"space-before")||"0px",E=s&&s.getAttributeNS(h,"min-label-width")||"0px",I=s&&s.getAttributeNS(h,"min-label-distance")||"0px",y=d(M)+d(E));s=r+" > text|list-item";s+="{";s+="margin-left: "+y+"px;";s+="}";m(f,s);s=r+" > text|list-item > text|list";s+="{";s+="margin-left: "+-y+"px;";s+="}";m(f,s);s=r+" > text|list-item > :not(text|list):first-child:before";s+="{";s+="text-align: "+H+";";s+="display: inline-block;";"label-alignment"===
z?(s+="margin-left: "+J+";","listtab"===A&&(s+="padding-right: 0.2cm;")):(s+="min-width: "+E+";",s+="margin-left: "+(0===parseFloat(E)?"":"-")+E+";",s+="padding-right: "+I+";");s+="}";m(f,s)}k=k.nextElementSibling}});b(e,f,l)}}})();odf.LazyStyleProperties=function(m,d){var g={};this.value=function(a){var c;g.hasOwnProperty(a)?c=g[a]:(c=d[a](),void 0===c&&m&&(c=m.value(a)),g[a]=c);return c};this.reset=function(a){m=a;g={}}};
odf.StyleParseUtils=function(){function m(d){var a,c;d=(d=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px))/.exec(d))?{value:parseFloat(d[1]),unit:d[3]}:null;c=d&&d.unit;"px"===c?a=d.value:"cm"===c?a=d.value/2.54*96:"mm"===c?a=d.value/25.4*96:"in"===c?a=96*d.value:"pt"===c?a=d.value/.75:"pc"===c&&(a=16*d.value);return a}var d=odf.Namespaces.stylens;this.parseLength=m;this.parsePositiveLengthOrPercent=function(d,a,c){var h;d&&(h=parseFloat(d.substr(0,
d.indexOf("%"))),isNaN(h)&&(h=void 0));var f;void 0!==h?(c&&(f=c.value(a)),h=void 0===f?void 0:f/100*h):h=m(d);return h};this.getPropertiesElement=function(g,a,c){for(a=c?c.nextElementSibling:a.firstElementChild;null!==a&&(a.localName!==g||a.namespaceURI!==d);)a=a.nextElementSibling;return a};this.parseAttributeList=function(d){d&&(d=d.replace(/^\s*(.*?)\s*$/g,"$1"));return d&&0<d.length?d.split(/\s+/):[]}};
odf.Style2CSS=function(){function m(b,e,a){var c=[];a=a.derivedStyles;var d;var k=v[b],f;void 0===k?e=null:(f=e?"["+k+'|style-name="'+e+'"]':"","presentation"===k&&(k="draw",f=e?'[presentation|style-name="'+e+'"]':""),e=k+"|"+t[b].join(f+","+k+"|")+f);null!==e&&c.push(e);for(d in a)a.hasOwnProperty(d)&&(e=m(b,d,a[d]),c=c.concat(e));return c}function d(b){var e="",a="",e=null;if("default-style"===b.localName)return null;e=b.getAttributeNS(r,"parent-style-name");a=b.getAttributeNS(r,"family");return e=
P.getODFElementsWithXPath(G,e?"//style:*[@style:name='"+e+"'][@style:family='"+a+"']":"//style:default-style[@style:family='"+a+"']",odf.Namespaces.lookupNamespaceURI)[0]}function g(b,e){var a="",c,k,f;for(c=0;c<e.length;c+=1)if(k=e[c],f=b.getAttributeNS(k[0],k[1])){f=f.trim();if(M.hasOwnProperty(k[1])){var h=f,s=h.indexOf(" "),l=void 0;f=void 0;-1!==s?(l=h.substring(0,s),f=h.substring(s)):(l=h,f="");(l=J.parseLength(l))&&"pt"===l.unit&&.75>l.value&&(h="0.75pt"+f);f=h}else if(E.hasOwnProperty(k[1])){var h=
b,s=k[0],l=k[1],q=J.parseLength(f),g=void 0,y=void 0,n=void 0,m=void 0,n=void 0;if(q&&"%"===q.unit){g=q.value/100;y=d(h.parentNode);for(m="0";y;){if(n=x.getDirectChild(y,r,"paragraph-properties"))if(n=J.parseLength(n.getAttributeNS(s,l))){if("%"!==n.unit){m=n.value*g+n.unit;break}g*=n.value/100}y=d(y)}f=m}}k[2]&&(a+=k[2]+":"+f+";")}return a}function a(b,e,a,c){return e+e+a+a+c+c}function c(b,e){var a=[b],d=e.derivedStyles;Object.keys(d).forEach(function(b){b=c(b,d[b]);a=a.concat(b)});return a}function h(b,
e,a,d){function k(e,a){var c=[],d;e.forEach(function(b){f.forEach(function(e){c.push("draw|page[webodfhelper|page-style-name='"+e+"'] draw|frame[presentation|class='"+b+"']")})});0<c.length&&(d=c.join(",")+"{visibility:"+a+";}",b.insertRule(d,b.cssRules.length))}var f=c(e,d),h=[],s=[];["page-number","date-time","header","footer"].forEach(function(b){var e;e=a.getAttributeNS(q,"display-"+b);"true"===e?h.push(b):"false"===e&&s.push(b)});k(h,"visible");k(s,"hidden")}function f(b,c,M,E){var t,v;if("page"===
c){var G=E.element,$="",S,P;P=S="";M=x.getDirectChild(G,r,"page-layout-properties");var T;if(M)if(T=G.getAttributeNS(r,"name"),$+=g(M,z),(S=x.getDirectChild(M,r,"background-image"))&&(P=S.getAttributeNS(k,"href"))&&($=$+("background-image: url('odfkit:"+P+"');")+g(S,u)),"presentation"===K)for(G=(G=x.getDirectChild(G.parentNode.parentNode,l,"master-styles"))&&G.firstElementChild;G;){if(G.namespaceURI===r&&"master-page"===G.localName&&G.getAttributeNS(r,"page-layout-name")===T){P=G.getAttributeNS(r,
"name");S='draw|page[draw|master-page-name="'+P+'"] {'+$+"}";P='office|body, draw|page[draw|master-page-name="'+P+'"] {'+g(M,y)+" }";try{b.insertRule(S,b.cssRules.length)}catch(Q){console.log(Q)}try{b.insertRule(P,b.cssRules.length)}catch(ha){console.log(ha)}}G=G.nextElementSibling}else"text"===K&&(S="office|text {"+$+"}",P="office|body {width: "+M.getAttributeNS(p,"page-width")+";}",b.insertRule(S,b.cssRules.length),b.insertRule(P,b.cssRules.length))}else if($=m(c,M,E).join(","),T="","Internet_20_link"!=
E.element.getAttributeNS(r,"name")){if(G=x.getDirectChild(E.element,r,"text-properties")){var Z=G,aa=v="";S="";P=1;G=""+g(Z,B);t=Z.getAttributeNS(r,"text-underline-style");"solid"===t&&(v+=" underline");t=Z.getAttributeNS(r,"text-line-through-style");"solid"===t&&(v+=" line-through");v.length&&(G=G+("text-decoration:"+v+";\n")+("text-decoration-line:"+v+";\n"),G+="-moz-text-decoration-line:"+v+";\n");t=Z.getAttributeNS(r,"text-line-through-type");switch(t){case "double":aa+=" double";break;case "single":aa+=
" single"}aa&&(G+="text-decoration-style:"+aa+";\n",G+="-moz-text-decoration-style:"+aa+";\n");if(v=Z.getAttributeNS(r,"font-name")||Z.getAttributeNS(p,"font-family"))t=I[v],G+="font-family: "+(t||v)+";";if(t=Z.getAttributeNS(r,"text-position"))v=A.parseAttributeList(t),t=v[0],v=v[1],G+="vertical-align: "+t+"\n; ",v&&(P=parseFloat(v)/100);Z.hasAttributeNS(p,"color")&&(t=Z.getAttributeNS(p,"color"),t=(t||"").toLowerCase(),"#ffffff"==t||"white"==t||"ffffff"==t||"#fff"==t||"fff"==t)&&(G+="color: #D8D8D8;");
if(Z.hasAttributeNS(p,"font-size")||1!==P){for(Z=Z.parentNode;Z;){if(t=(t=x.getDirectChild(Z,r,"text-properties"))?J.parseFoFontSize(t.getAttributeNS(p,"font-size")):null){if("%"!==t.unit){S="font-size: "+t.value*P+t.unit+";";break}P*=t.value/100}Z=d(Z)}S||(S="font-size: "+parseFloat(W)*P+R.getUnits(W)+";")}G+=S;T+=G}if(G=x.getDirectChild(E.element,r,"paragraph-properties"))S=G,G=""+g(S,w),(P=x.getDirectChild(S,r,"background-image"))&&(Z=P.getAttributeNS(k,"href"))&&(G=G+("background-image: url('odfkit:"+
Z+"');")+g(P,u)),(S=S.getAttributeNS(p,"line-height"))&&"normal"!==S&&(S=J.parseFoLineHeight(S),G="%"!==S.unit?G+("line-height: "+S.value+S.unit+";"):G+("line-height: "+S.value/100+";")),T+=G;if(G=x.getDirectChild(E.element,r,"graphic-properties"))Z=G,G=""+g(Z,D),S=Z.getAttributeNS(n,"opacity"),P=Z.getAttributeNS(n,"fill"),Z=Z.getAttributeNS(n,"fill-color"),"solid"===P||"hatch"===P||Z&&S?Z&&"none"!==Z?(S=isNaN(parseFloat(S))?1:parseFloat(S)/100,P=Z.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,a),(Z=
(P=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(P))?{r:parseInt(P[1],16),g:parseInt(P[2],16),b:parseInt(P[3],16)}:null)&&(G+="background-color: rgba("+Z.r+","+Z.g+","+Z.b+","+S+");")):G+="background: none;":"none"===P&&(G+="background: none;"),T+=G;if(G=x.getDirectChild(E.element,r,"drawing-page-properties"))S=G,P=""+g(S,D),"true"===S.getAttributeNS(q,"background-visible")&&(P+="background: none;"),T+=P,h(b,M,G,E);if(G=x.getDirectChild(E.element,r,"table-cell-properties"))M=T,T=""+g(G,F),T=M+
T;if(G=x.getDirectChild(E.element,r,"table-row-properties"))M=T,T=""+g(G,H),T=M+T;if(G=x.getDirectChild(E.element,r,"table-column-properties"))M=T,T=""+g(G,C),T=M+T;if(G=x.getDirectChild(E.element,r,"table-properties"))M=T,T=""+g(G,s),G=G.getAttributeNS(e,"border-model"),"collapsing"===G?T+="border-collapse:collapse;":"separating"===G&&(T+="border-collapse:separate;"),T=M+T;0!==T.length&&b.insertRule($+"{"+T+"}",b.cssRules.length)}for(var fa in E.derivedStyles)E.derivedStyles.hasOwnProperty(fa)&&
f(b,c,fa,E.derivedStyles[fa])}var n=odf.Namespaces.drawns,p=odf.Namespaces.fons,l=odf.Namespaces.officens,r=odf.Namespaces.stylens,b=odf.Namespaces.svgns,e=odf.Namespaces.tablens,k=odf.Namespaces.xlinkns,q=odf.Namespaces.presentationns,x=core.DomUtils,A=new odf.StyleParseUtils,v={graphic:"draw","drawing-page":"draw",paragraph:"text",presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"},
t={graphic:"circle connected control custom-shape ellipse frame g line measure page page-thumbnail path polygon polyline rect regular-polygon".split(" "),paragraph:"alphabetical-index-entry-template h illustration-index-entry-template index-source-style object-index-entry-template p table-index-entry-template table-of-content-entry-template user-index-entry-template".split(" "),presentation:"caption circle connector control custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),
"drawing-page":"caption circle connector control page custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),ruby:["ruby","ruby-text"],section:"alphabetical-index bibliography illustration-index index-title object-index section table-of-content table-index user-index".split(" "),table:["background","table"],"table-cell":"body covered-table-cell even-columns even-rows first-column first-row last-column last-row odd-columns odd-rows table-cell".split(" "),
"table-column":["table-column"],"table-row":["table-row"],text:"a index-entry-chapter index-entry-link-end index-entry-link-start index-entry-page-number index-entry-span index-entry-tab-stop index-entry-text index-title-template linenumbering-configuration list-level-style-number list-level-style-bullet outline-level-style span".split(" "),list:["list-item"]},B=[[p,"color","color"],[p,"background-color","background-color"],[p,"font-weight","font-weight"],[p,"font-style","font-style"]],u=[[r,"repeat",
"background-repeat"]],w=[[p,"background-color","background-color"],[p,"text-align","text-align"],[p,"text-indent","text-indent"],[p,"padding","padding"],[p,"padding-left","padding-left"],[p,"padding-right","padding-right"],[p,"padding-top","padding-top"],[p,"padding-bottom","padding-bottom"],[p,"border-left","border-left"],[p,"border-right","border-right"],[p,"border-top","border-top"],[p,"border-bottom","border-bottom"],[p,"margin","margin"],[p,"margin-left","margin-left"],[p,"margin-right","margin-right"],
[p,"margin-top","margin-top"],[p,"margin-bottom","margin-bottom"],[p,"border","border"]],D=[[p,"background-color","background-color"],[p,"min-height","min-height"],[n,"stroke","border"],[b,"stroke-color","border-color"],[b,"stroke-width","border-width"],[p,"border","border"],[p,"border-left","border-left"],[p,"border-right","border-right"],[p,"border-top","border-top"],[p,"border-bottom","border-bottom"]],F=[[p,"background-color","background-color"],[p,"border-left","border-left"],[p,"border-right",
"border-right"],[p,"border-top","border-top"],[p,"border-bottom","border-bottom"],[p,"border","border"]],C=[[r,"column-width","width"]],H=[[r,"row-height","height"],[p,"keep-together",null]],s=[[r,"width","width"],[p,"margin-left","margin-left"],[p,"margin-right","margin-right"],[p,"margin-top","margin-top"],[p,"margin-bottom","margin-bottom"]],z=[[p,"background-color","background-color"],[p,"padding","padding"],[p,"padding-left","padding-left"],[p,"padding-right","padding-right"],[p,"padding-top",
"padding-top"],[p,"padding-bottom","padding-bottom"],[p,"border","border"],[p,"border-left","border-left"],[p,"border-right","border-right"],[p,"border-top","border-top"],[p,"border-bottom","border-bottom"],[p,"margin","margin"],[p,"margin-left","margin-left"],[p,"margin-right","margin-right"],[p,"margin-top","margin-top"],[p,"margin-bottom","margin-bottom"]],y=[[p,"page-width","width"],[p,"page-height","height"]],M={border:!0,"border-left":!0,"border-right":!0,"border-top":!0,"border-bottom":!0,
"stroke-width":!0},E={margin:!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"margin-bottom":!0},I={},J=odf.OdfUtils,K,G,W,P=xmldom.XPath,R=new core.CSSUnits;gstyleParseUtils=A;this.style2css=function(b,e,a,c,d){function k(b,e){h="@namespace "+b+" url("+e+");";try{a.insertRule(h,a.cssRules.length)}catch(c){}}var h,s,l;for(G=e;a.cssRules.length;)a.deleteRule(a.cssRules.length-1);odf.Namespaces.forEachPrefix(k);k("webodfhelper","urn:webodf:names:helper");I=c;K=b;W=runtime.getWindow().getComputedStyle(document.body,
null).getPropertyValue("font-size")||"12pt";e=0;for(l in v)if(v.hasOwnProperty(l))for(s in b=d[l],b)if(b.hasOwnProperty(s)){e++;if(1E3<e){e=0;break}f(a,l,s,b[s])}}};
(function(){function m(d,g){var a=this;this.getDistance=function(c){var d=a.x-c.x;c=a.y-c.y;return Math.sqrt(d*d+c*c)};this.getCenter=function(c){return new m((a.x+c.x)/2,(a.y+c.y)/2)};this.x;this.y;a.x=d;a.y=g}gui.ZoomHelper=function(){function d(b,a,c,d){b=d?"translate3d("+b+"px, "+a+"px, 0) scale3d("+c+", "+c+", 1)":"translate("+b+"px, "+a+"px) scale("+c+")";e.style.WebkitTransform=b;e.style.MozTransform=b;e.style.msTransform=b;e.style.OTransform=b;e.style.transform=b}function g(b){b?d(-k.x,-k.y,
A,!0):(d(0,0,A,!0),d(0,0,A,!1))}function a(b){if(t&&F){var e=t.style.overflow,a=t.classList.contains("webodf-customScrollbars");b&&a||!b&&!a||(b?(t.classList.add("webodf-customScrollbars"),t.style.overflow="hidden",runtime.requestAnimationFrame(function(){t.style.overflow=e})):t.classList.remove("webodf-customScrollbars"))}}function c(){d(-k.x,-k.y,A,!0);t.scrollLeft=0;t.scrollTop=0;C=B.style.overflow;B.style.overflow="visible";a(!1)}function h(){d(0,0,A,!0);t.scrollLeft=k.x;t.scrollTop=k.y;B.style.overflow=
C||"";a(!0)}function f(b){return new m(b.pageX-e.offsetLeft,b.pageY-e.offsetTop)}function n(b){if(q){k.x-=b.x-q.x;k.y-=b.y-q.y;var a=k;k=new m(Math.min(Math.max(a.x,e.offsetLeft),(e.offsetLeft+e.offsetWidth)*A-t.clientWidth),Math.min(Math.max(a.y,e.offsetTop),(e.offsetTop+e.offsetHeight)*A-t.clientHeight))}q=b}function p(b){var e=b.touches.length,a=0<e?f(b.touches[0]):null;b=1<e?f(b.touches[1]):null;a&&b?(x=a.getDistance(b),v=A,q=a.getCenter(b),c(),D=w.PINCH):a&&(q=a,D=w.SCROLL)}function l(b){var a=
b.touches.length,d=0<a?f(b.touches[0]):null,a=1<a?f(b.touches[1]):null;if(d&&a)if(b.preventDefault(),D===w.SCROLL)D=w.PINCH,c(),x=d.getDistance(a);else{b=d.getCenter(a);d=d.getDistance(a)/x;n(b);var a=A,l=Math.min(4,e.offsetParent.clientWidth/e.offsetWidth);A=v*d;A=Math.min(Math.max(A,l),4);d=A/a;k.x+=(d-1)*(b.x+k.x);k.y+=(d-1)*(b.y+k.y);g(!0)}else d&&(D===w.PINCH?(D=w.SCROLL,h()):n(d))}function r(){D===w.PINCH&&(u.emit(gui.ZoomHelper.signalZoomChanged,A),h(),g(!1));D=w.NONE}function b(){t&&(t.removeEventListener("touchstart",
p,!1),t.removeEventListener("touchmove",l,!1),t.removeEventListener("touchend",r,!1))}var e,k,q,x,A,v,t,B,u=new core.EventNotifier([gui.ZoomHelper.signalZoomChanged]),w={NONE:0,SCROLL:1,PINCH:2},D=w.NONE,F=runtime.getWindow().hasOwnProperty("ontouchstart"),C="";this.subscribe=function(b,a){u.subscribe(b,a)};this.unsubscribe=function(b,a){u.unsubscribe(b,a)};this.getZoomLevel=function(){return A};this.setZoomLevel=function(b){e&&(A=b,g(!1),u.emit(gui.ZoomHelper.signalZoomChanged,A))};this.destroy=
function(e){b();a(!1);e()};this.setZoomableElement=function(c){b();e=c;t=e.offsetParent;B=e.parentNode;g(!1);t&&(t.addEventListener("touchstart",p,!1),t.addEventListener("touchmove",l,!1),t.addEventListener("touchend",r,!1));a(!0)};v=A=1;k=new m(0,0)};gui.ZoomHelper.signalZoomChanged="zoomChanged"})();ops.Canvas=function(){};ops.Canvas.prototype.getZoomLevel=function(){};ops.Canvas.prototype.getElement=function(){};ops.Canvas.prototype.getSizer=function(){};ops.Canvas.prototype.getZoomHelper=function(){};
(function(){function m(){function b(d){e=!0;runtime.setTimeout(function(){try{d()}catch(k){runtime.log(String(k)+"\n"+k.stack)}e=!1;var f=document.getElementById("documentName");0<a.length?(f&&c&&0==a.length%2&&(f.innerHTML="Loading... "+a.length+" Remained."),b(a.pop())):f&&c&&(f.innerHTML=c||"")},10)}var a=[],e=!1,c;this.clearQueue=function(){a.length=0};this.addToQueue=function(d){if(0===a.length&&!e){if(!c){var k=document.getElementById("documentName");k&&(c=k.innerHTML)}return b(d)}a.push(d)}}
function d(b){function a(){for(;0<e.cssRules.length;)e.deleteRule(0);e.insertRule("#shadowContent draw|page {display:none;}",0);e.insertRule("office|presentation draw|page {display:none;}",1);e.insertRule("#shadowContent draw|page:nth-of-type("+c+") {display:block;}",2);e.insertRule("office|presentation draw|page:nth-of-type("+c+") {display:block;}",3)}var e=b.sheet,c=1;this.showFirstPage=function(){c=1;a()};this.showNextPage=function(){c+=1;a()};this.showPreviousPage=function(){1<c&&(c-=1,a())};
this.showPage=function(b){0<b&&(c=b,a())};this.css=b;this.destroy=function(a){b.parentNode.removeChild(b);a()}}function g(b){for(;b.firstChild;)b.removeChild(b.firstChild)}function a(b){b=b.sheet;for(var a=b.cssRules;a.length;)b.deleteRule(a.length-1)}function c(b,a,e){var c=new odf.Style2CSS,d=new odf.ListStyleToCss;e=e.sheet;var k=(new odf.StyleTree(b.rootElement.styles,b.rootElement.automaticStyles)).getStyleTree();c.style2css(b.getDocumentType(),b.rootElement,e,a.getFontMap(),k);d.applyListStyles(e,
k,b.rootElement.body)}function h(b,a){(new odf.FontLoader).loadFonts(b,a.sheet)}function f(b,a,e){var c=null;b=b.rootElement.body.getElementsByTagNameNS(s,e+"-decl");e=a.getAttributeNS(s,"use-"+e+"-name");var d;if(e&&0<b.length)for(a=0;a<b.length;a+=1)if(d=b[a],d.getAttributeNS(s,"name")===e){c=d.textContent;break}return c}function n(b,a,e,c){var d=b.ownerDocument;a=y.getElementsByTagNameNS(b,a,e);for(b=0;b<a.length;b+=1)g(a[b]),c&&(e=a[b],e.appendChild(d.createTextNode(c)))}function p(b,a,e){a.setAttributeNS("urn:webodf:names:helper",
"styleid",b);var c,d=a.getAttributeNS(C,"anchor-type"),k=a.getAttributeNS(D,"x"),f=a.getAttributeNS(D,"y"),h=a.getAttributeNS(D,"width"),l=a.getAttributeNS(D,"height"),s=a.getAttributeNS(B,"min-height"),q=a.getAttributeNS(B,"min-width");if("as-char"===d||"char"===d||"paragraph"===d)c="display: inline-block;";else if(d||k||f)c="position: absolute;";else if(h||l||s||q)c="display: block;";var g=a.getAttributeNS(t,"transform"),n,m,p;g&&(d=function(b){(n=g.match(new RegExp(b+"(.*?)\\((.*?)\\)","i")))&&
n[2]&&(m=parseFloat(n[2]),isNaN(m)||(arr2=180/Math.PI*m*-1,-360<=arr2&&360>=arr2&&(p+=b+"("+arr2.toFixed(2)+"deg) ")))},p="",(n=g.match(/translate(.*?)\((.*?)\)/i))&&n[2]&&(m=n[2].trim().split(" "),2!=m.length&&(m=n[2].trim().split(",")),2==m.length&&(c="position: absolute;",p+="translate("+m[0]+","+m[1]+") ")),d("rotate"),d("skewX"),p&&(c+="transform: "+p+"; -webkit-transform: "+p+"; transform-origin: left top; -webkit-transform-origin: left top;"));"custom-shape"==a.localName&&(c+="border-width: 0.028cm; ",
y.getDirectChild(a,D,"title")&&(c+="background-color: transparent; "));k&&(c+="left: "+k+";");f&&(c+="top: "+f+";");h&&(c+="width: "+h+";");l&&(c+="height: "+l+";");s&&(c+="min-height: "+s+";");q&&(c+="min-width: "+q+";");c&&(c="draw|"+a.localName+'[webodfhelper|styleid="'+b+'"] {'+c+"}",e.insertRule(c,e.cssRules.length));!gdocumentType&&godfcontainer&&(gdocumentType=godfcontainer.getDocumentType());f&&l&&"text"==gdocumentType&&(f=gstyleParseUtils.parseLength(f),l=gstyleParseUtils.parseLength(l),
f=parseInt(f+l),!isNaN(f)&&document.getElementsByTagName("document")[0]&&f>document.getElementsByTagName("document")[0].clientHeight&&e.insertRule("office|document{height: "+(f+15)+"px;}",e.cssRules.length))}function l(b){for(b=b.firstChild;b;){if(b.namespaceURI===u&&"binary-data"===b.localName)return"data:image/png;base64,"+b.textContent.replace(/[\r\n\s]/g,"");b=b.nextSibling}return""}function r(b,a,e,c){function d(a){a&&(a='draw|image[webodfhelper|styleid="'+b+'"] {'+("background-image: url("+
a+");")+"}",c.insertRule(a,c.cssRules.length))}function k(b){d(b.url)}e.setAttributeNS("urn:webodf:names:helper","styleid",b);var f=e.getAttributeNS(H,"href"),h;if(f)try{h=a.getPart(f),h.onchange=k,h.load()}catch(s){runtime.log("slight problem: "+String(s))}else f=l(e),d(f)}function b(b){var a=b.ownerDocument;y.getElementsByTagNameNS(b,C,"line-break").forEach(function(b){b.hasChildNodes()||b.appendChild(a.createElement("br"))})}function e(b){var a=b.ownerDocument;y.getElementsByTagNameNS(b,C,"s").forEach(function(b){for(var e,
c;b.firstChild;)b.removeChild(b.firstChild);b.appendChild(a.createTextNode(" "));c=parseInt(b.getAttributeNS(C,"c"),10);if(1<c)for(b.removeAttributeNS(C,"c"),e=1;e<c;e+=1)b.parentNode.insertBefore(b.cloneNode(!0),b)})}function k(b){y.getElementsByTagNameNS(b,C,"tab").forEach(function(b){b.textContent="\t"})}function q(b,a){function e(b,c,f){c||(c="");var l=h.documentElement.namespaceURI;f||"video/"===c.substr(0,6)?(d=h.createElementNS(l,"video"),d.setAttribute("controls","controls"),k=h.createElementNS(l,
"source"),b&&k.setAttribute("src",b),c&&k.setAttribute("type",c),d.appendChild(k),a.parentNode.appendChild(d)):a.innerHTML="<br>&nbsp;Unrecognised Plugin"}function c(b,d){d&&0<=(d+"").indexOf("not found")?a.innerHTML="<br>&nbsp;Media File Not Found.":e(b.url,b.mimetype)}var d,k,f,h=a.ownerDocument,s;if(f=a.getAttributeNS(H,"href"))if(0==f.indexOf("http"))e(f,"",!0);else try{s=b.getPart(f),s.onchange=c,s.load()}catch(q){runtime.log("slight problem: "+String(q))}else runtime.log("using MP4 data fallback"),
f=l(a),e(f,"video/mp4")}function x(b){var a=b.getElementsByTagName("head")[0],e,c;e=b.styleSheets.length;for(c=a.firstElementChild;c&&("style"!==c.localName||!c.hasAttribute("webodfcss"));)c=c.nextElementSibling;if(c)return e=parseInt(c.getAttribute("webodfcss"),10),c.setAttribute("webodfcss",e+1),c;"string"===String(typeof webodf_css)?e=webodf_css:(c="webodf.css",runtime.currentDirectory&&(c=runtime.currentDirectory(),0<c.length&&"/"!==c.substr(-1)&&(c+="/"),c+="../webodf.css"),e=runtime.readFileSync(c,
"utf-8"));c=b.createElementNS(a.namespaceURI,"style");c.setAttribute("media","screen, print, handheld, projection");c.setAttribute("type","text/css");c.setAttribute("webodfcss","1");c.appendChild(b.createTextNode(e));a.appendChild(c);return c}function A(b){var a=parseInt(b.getAttribute("webodfcss"),10);1===a?b.parentNode.removeChild(b):b.setAttribute("count",a-1)}function v(b){var a=b.getElementsByTagName("head")[0],e=b.createElementNS(a.namespaceURI,"style"),c="";e.setAttribute("type","text/css");
e.setAttribute("media","screen, print, handheld, projection");odf.Namespaces.forEachPrefix(function(b,a){c+="@namespace "+b+" url("+a+");\n"});c+="@namespace webodfhelper url(urn:webodf:names:helper);\n";e.appendChild(b.createTextNode(c));a.appendChild(e);return e}var t=odf.Namespaces.drawns,B=odf.Namespaces.fons,u=odf.Namespaces.officens,w=odf.Namespaces.stylens,D=odf.Namespaces.svgns,F=odf.Namespaces.tablens,C=odf.Namespaces.textns,H=odf.Namespaces.xlinkns,s=odf.Namespaces.presentationns,z=xmldom.XPath,
y=core.DomUtils;odf.OdfCanvas=function(l,E){function I(b,a,e){function c(b,a,e,d){ma.addToQueue(function(){r(b,a,e,d)})}function d(){var b,a;document.body.getElementsByTagNameNS("http://www.w3.org/1998/Math/MathML","math")[0]&&(document.body.insertAdjacentHTML("afterbegin","<div style='border: 0; clip: rect(0 0 0 0); height: 1px; margin: -1px; overflow: hidden; padding: 0; position: absolute; width: 1px;'><math xmlns='http://www.w3.org/1998/Math/MathML'><mspace height='23px' width='77px'></mspace></math></div>"),
a=document.body.firstChild,b=a.firstChild.firstChild.getBoundingClientRect(),document.body.removeChild(a),1<Math.abs(b.height-23)||1<Math.abs(b.width-77))&&(b=document.createElement("link"),b.href="//iblogbox.github.io/js/odfviewer/mathml.css",b.rel="stylesheet",document.head.appendChild(b))}function k(a){a>h.length-1?M&&d():(q=h.item(a),(g=q.getAttributeNS(H,"href"))?b.getPartData2(g+"/content.xml",function(d,f){f&&0<=f.indexOf("</math>")?(M=!0,f=f.replace(/<\?xml(.*?)\?>/gi,""),m=document.createElement("span"),
m.setAttribute("style","white-space:nowrap;"),m.innerHTML=f,q.parentNode.insertBefore(m,q)):(l=q.parentNode.getElementsByTagNameNS(t,"image"))&&l[0]&&(g=l[0].getAttributeNS(H,"href")||"",0!=g.indexOf("ObjectReplacements/")&&0!=g.indexOf("./ObjectReplacements/")||c("image2"+String(a),b,l[0],e));k(a+1)}):k(a+1))}var f,h,l,q,g;h=a.getElementsByTagNameNS(t,"image");for(f=0;f<h.length;f+=1)q=h.item(f),g=q.getAttributeNS(H,"href")||"",0!=g.indexOf("ObjectReplacements/")&&0!=g.indexOf("./ObjectReplacements/")&&
c("image"+String(f),b,q,e);var n,y,m,M=!1;h=a.getElementsByTagNameNS(t,"object");k(0);!gdocumentType&&godfcontainer&&(gdocumentType=godfcontainer.getDocumentType());if("presentation"==gdocumentType&&document.getElementsByTagName("document")[0]&&2E3>document.getElementsByTagName("document")[0].clientWidth){var p=function(b){m=document.createElement("canvas");m.setAttribute("style","border:0px solid red; left:0px; top:0px; position: absolute; background: transparent;");m.width=w;m.height=w+Math.floor(.4*
w);b.parentNode.insertBefore(m,b.nextSibling);u=m.getContext("2d");console.log("Canvas Created.")},u,x,z,E,I,w=document.getElementsByTagName("document")[0].clientWidth;h=a.getElementsByTagNameNS(t,"g");for(f=0;f<h.length;f+=1)for(u="",q=h.item(f),n=findChildNode(q,t,"line"),y=0;y<n.length;y+=1)0!=y||u||p(q),x=n[y].getAttributeNS(D,"x1"),z=n[y].getAttributeNS(D,"y1"),E=n[y].getAttributeNS(D,"x2"),I=n[y].getAttributeNS(D,"y2"),x=parseInt(gstyleParseUtils.parseLength(x)),z=parseInt(gstyleParseUtils.parseLength(z)),
E=parseInt(gstyleParseUtils.parseLength(E)),I=parseInt(gstyleParseUtils.parseLength(I)),u.beginPath(),u.moveTo(x,z),u.lineTo(E,I),u.stroke()}if("presentation"==gdocumentType){ghyperlinkTooltipView||(ghyperlinkTooltipView=new gui.HyperlinkTooltipView(ba));h=a.getElementsByTagNameNS(C,"a");for(f=0;f<h.length;f+=1)if(q=h.item(f),n=(q.getAttributeNS(H,"href")||"").toLowerCase().trim())q.addEventListener("click",function(){window.open(this.getAttributeNS(H,"href"))}),q.addEventListener("mousemove",function(b){ghyperlinkTooltipView&&
ghyperlinkTooltipView.showTooltip(b)}),q.addEventListener("mouseout",function(){ghyperlinkTooltipView&&ghyperlinkTooltipView.hideTooltip()});h=a.getElementsByTagNameNS(s,"date-time-decl");for(f=0;f<h.length;f+=1)q=h.item(f),q.parentNode.removeChild(q)}}function B(b,a){function e(b,a){ma.addToQueue(function(){q(b,a)})}var c,d,k;d=a.getElementsByTagNameNS(t,"plugin");for(c=0;c<d.length;c+=1)k=d.item(c),e(b,k)}function K(){var b;b=X.firstChild;var a=ga.getZoomLevel();b&&(X.style.WebkitTransformOrigin=
"0% 0%",X.style.MozTransformOrigin="0% 0%",X.style.msTransformOrigin="0% 0%",X.style.OTransformOrigin="0% 0%",X.style.transformOrigin="0% 0%",da&&((b=da.getMinimumHeightForAnnotationPane())?X.style.minHeight=b:X.style.removeProperty("min-height")),l.style.width=Math.round(a*X.offsetWidth)+"px",l.style.height=Math.round(a*X.offsetHeight)+"px",l.style.display="inline-block")}function G(a,c){var d=Z.sheet;g(l);X=ca.createElementNS(l.namespaceURI,"div");X.style.display="inline-block";X.style.background=
"white";X.style.setProperty("float","left","important");X.appendChild(c);l.appendChild(X);U=ca.createElementNS(l.namespaceURI,"div");U.id="annotationsPane";aa=ca.createElementNS(l.namespaceURI,"div");aa.id="shadowContent";aa.style.position="absolute";aa.style.top=0;aa.style.left=0;a.getContentElement().appendChild(aa);var h=c.body,q,m=[],r;for(q=h.firstElementChild;q&&q!==h;)if(q.namespaceURI===t&&(m[m.length]=q),q.firstElementChild)q=q.firstElementChild;else{for(;q&&q!==h&&!q.nextElementSibling;)q=
q.parentNode;q&&q.nextElementSibling&&(q=q.nextElementSibling)}for(r=0;r<m.length;r+=1)q=m[r],p("frame"+String(r),q,d);m=z.getODFElementsWithXPath(h,".//*[*[@text:anchor-type='paragraph']]",odf.Namespaces.lookupNamespaceURI);for(q=0;q<m.length;q+=1)h=m[q],h.setAttributeNS&&h.setAttributeNS("urn:webodf:names:helper","containsparagraphanchor",!0);h=Y;q=aa;var x,E,A,H,v=0,R;r=a.rootElement.ownerDocument;if((m=c.body.firstElementChild)&&m.namespaceURI===u&&("presentation"===m.localName||"drawing"===m.localName))for(m=
m.firstElementChild;m;){if(x=(x=m.getAttributeNS(t,"master-page-name"))?h.getMasterPageElement(x):null){E=m.getAttributeNS("urn:webodf:names:helper","styleid");A=r.createElementNS(t,"draw:page");R=x.firstElementChild;for(v=0;R;)"true"!==R.getAttributeNS(s,"placeholder")&&(H=R.cloneNode(!0),A.appendChild(H)),R=R.nextElementSibling,v+=1;R=H=v=void 0;for(var K=y.getElementsByTagNameNS(A,t,"frame"),v=0;v<K.length;v+=1)H=K[v],(R=H.getAttributeNS(s,"class"))&&!/^(date-time|footer|header|page-number)$/.test(R)&&
H.parentNode.removeChild(H);H=y.getElementsByTagNameNS(A,t,"*");for(v=0;v<H.length;v+=1)p(E+"_"+v,H[v],d);q.appendChild(A);v=String(q.getElementsByTagNameNS(t,"page").length);n(A,C,"page-number",v);n(A,s,"header",f(a,m,"header"));n(A,s,"footer",f(a,m,"footer"));p(E,A,d);A.setAttributeNS("urn:webodf:names:helper","page-style-name",m.getAttributeNS(t,"style-name"));A.setAttributeNS(t,"draw:master-page-name",x.getAttributeNS(w,"name"))}m=m.nextElementSibling}h=c.body;r=y.getElementsByTagNameNS(h,F,"table-cell");
for(q=0;q<r.length;q+=1)if(x=r[q],x.hasAttributeNS(F,"number-columns-repeated")&&(E=x.getAttributeNS(F,"number-columns-repeated"),!(100<E)))for(m=1;m<E;m++)x.parentNode.insertBefore(x.cloneNode(!0),x.nextSibling);r=y.getElementsByTagNameNS(h,F,"covered-table-cell");for(q=0;q<r.length;q+=1)if(x=r[q],E=x.hasAttributeNS(F,"number-columns-repeated")?x.getAttributeNS(F,"number-columns-repeated"):1,!(100<E)){for(m=0;m<E;m++)A=document.createElementNS(F,"table:table-cell"),x.parentNode.insertBefore(A,x);
x.parentNode.removeChild(x)}r=y.getElementsByTagNameNS(h,t,"control");for(q=0;q<r.length;q+=1)x=r[q],x.parentNode.removeChild(x);b(c.body);e(c.body);k(c.body);I(a,c.body,d);B(a,c.body);X.insertBefore(aa,X.firstChild);ga.setZoomableElement(X)}function W(b){$?(U.parentNode||X.appendChild(U),da&&da.forgetAnnotations(),da=new gui.AnnotationViewManager(ba,b.body,U,S),y.getElementsByTagNameNS(b.body,u,"annotation").forEach(da.addAnnotation),da.rerenderAnnotations(),K()):U.parentNode&&(X.removeChild(U),
da.forgetAnnotations(),K())}function P(b){function e(){a(Q);a(ha);a(Z);g(l);l.style.display="inline-block";var d=L.rootElement;l.ownerDocument.importNode(d,!0);Y.setOdfContainer(L);h(L,Q);c(L,Y,ha);G(L,d);W(d);b||ma.addToQueue(function(){var b=[L];if(fa.hasOwnProperty("statereadychange")){var a=fa.statereadychange,e;for(e=0;e<a.length;e+=1)a[e].apply(null,b)}})}L.state===odf.OdfContainer.DONE?e():(runtime.log("WARNING: refreshOdf called but ODF was not DONE."),pa=runtime.setTimeout(function V(){L.state===
odf.OdfContainer.DONE?e():(g_errmsg(),pa=runtime.setTimeout(V,1E3))},300))}function R(b){ma.clearQueue();l.innerHTML=runtime.tr("Loading")+"...";l.removeAttribute("style");godfcontainer=L=new odf.OdfContainer(b,function(b){L=b;P(!1)})}runtime.assert(null!==l&&void 0!==l,"odf.OdfCanvas constructor needs DOM element");runtime.assert(null!==l.ownerDocument&&void 0!==l.ownerDocument,"odf.OdfCanvas constructor needs DOM");var ba=this,ca=l.ownerDocument,L,Y=new odf.Formatting,ea,X=null,U=null,$=!1,S=!1,
da=null,T,Q,ha,Z,aa,fa={},pa,ka,ia=!1,la=!1,ma=new m,ga=new gui.ZoomHelper,ja=E||new gui.SingleScrollViewport(l.parentNode);this.refreshCSS=function(){ia=!0;ka.trigger()};this.refreshSize=function(){ka.trigger()};this.odfContainer=function(){return L};this.setOdfContainer=function(b,a){L=b;P(!0===a)};this.load=this.load=R;this.save=function(b){L.save(b)};this.addListener=function(b,a){switch(b){case "click":var e=b;l.addEventListener?l.addEventListener(e,a,!1):l.attachEvent?l.attachEvent("on"+e,a):
l["on"+e]=a;break;default:e=fa.hasOwnProperty(b)?fa[b]:fa[b]=[],a&&-1===e.indexOf(a)&&e.push(a)}};this.getFormatting=function(){return Y};this.getAnnotationViewManager=function(){return da};this.refreshAnnotations=function(){W(L.rootElement)};this.rerenderAnnotations=function(){da&&(la=!0,ka.trigger())};this.getSizer=function(){return X};this.enableAnnotations=function(b,a){b!==$&&($=b,S=a,L&&W(L.rootElement))};this.addAnnotation=function(b){da&&(da.addAnnotation(b),K())};this.forgetAnnotations=function(){da&&
(da.forgetAnnotations(),K())};this.getZoomHelper=function(){return ga};this.setZoomLevel=function(b){ga.setZoomLevel(b)};this.getZoomLevel=function(){return ga.getZoomLevel()};this.fitToContainingElement=function(b,a){var e=ga.getZoomLevel(),c=l.offsetHeight/e,e=b/(l.offsetWidth/e);a/c<e&&(e=a/c);ga.setZoomLevel(e)};this.fitToWidth=function(b){var a=l.offsetWidth/ga.getZoomLevel();ga.setZoomLevel(b/a)};this.fitSmart=function(b,a){var e,c;c=ga.getZoomLevel();e=l.offsetWidth/c;c=l.offsetHeight/c;e=
b/e;void 0!==a&&a/c<e&&(e=a/c);ga.setZoomLevel(Math.min(1,e))};this.fitToHeight=function(b){var a=l.offsetHeight/ga.getZoomLevel();ga.setZoomLevel(b/a)};this.showFirstPage=function(){ea.showFirstPage()};this.showNextPage=function(){ea.showNextPage()};this.showPreviousPage=function(){ea.showPreviousPage()};this.showPage=function(b){ea.showPage(b);godfcontainer&&"spreadsheet"==godfcontainer.getDocumentType()||K()};this.getElement=function(){return l};this.getViewport=function(){return ja};this.addCssForFrameWithImage=
function(b){var a=b.getAttributeNS(t,"name"),e=b.firstElementChild;p(a,b,Z.sheet);e&&r(a+"img",L,e,Z.sheet)};this.destroy=function(b){var a=ca.getElementsByTagName("head")[0],e=[ea.destroy,ka.destroy];runtime.clearTimeout(pa);U&&U.parentNode&&U.parentNode.removeChild(U);ga.destroy(function(){X&&(l.removeChild(X),X=null)});A(T);a.removeChild(Q);a.removeChild(ha);a.removeChild(Z);core.Async.destroyAll(e,b)};T=x(ca);ea=new d(v(ca));Q=v(ca);ha=v(ca);Z=v(ca);ka=core.Task.createRedrawTask(function(){ia&&
(c(L,Y,ha),ia=!1);la&&(da&&da.rerenderAnnotations(),la=!1);K()});ga.subscribe(gui.ZoomHelper.signalZoomChanged,K)}})();
odf.StepUtils=function(){this.getContentBounds=function(m){var d=m.container(),g,a;runtime.assert(m.isStep(),"Step iterator must be on a step");d.nodeType===Node.TEXT_NODE&&0<m.offset()?g=m.offset():(d=m.leftNode())&&d.nodeType===Node.TEXT_NODE&&(g=d.length);d&&(d.nodeType===Node.TEXT_NODE?(runtime.assert(0<g,"Empty text node found"),a={container:d,startOffset:g-1,endOffset:g}):a={container:d,startOffset:0,endOffset:d.childNodes.length});return a}};
ops.MemberProperties=function(){this.fullName;this.color;this.imageUrl};
ops.Member=function(m,d){var g=new ops.MemberProperties;this.getMemberId=function(){return m};this.getProperties=function(){return g};this.setProperties=function(a){Object.keys(a).forEach(function(c){g[c]=a[c]})};this.removeProperties=function(a){Object.keys(a).forEach(function(a){"fullName"!==a&&"color"!==a&&"imageUrl"!==a&&g.hasOwnProperty(a)&&delete g[a]})};runtime.assert(Boolean(m),"No memberId was supplied!");d.fullName||(d.fullName=runtime.tr("Unknown Author"));d.color||(d.color="black");d.imageUrl||
(d.imageUrl="avatar-joe.png");g=d};ops.Document=function(){};ops.Document.prototype.getMemberIds=function(){};ops.Document.prototype.removeCursor=function(m){};ops.Document.prototype.getDocumentElement=function(){};ops.Document.prototype.getRootNode=function(){};ops.Document.prototype.getDOMDocument=function(){};ops.Document.prototype.cloneDocumentElement=function(){};ops.Document.prototype.setDocumentElement=function(m){};ops.Document.prototype.subscribe=function(m,d){};
ops.Document.prototype.unsubscribe=function(m,d){};ops.Document.prototype.getCanvas=function(){};ops.Document.prototype.createRootFilter=function(m){};ops.Document.prototype.createPositionIterator=function(m){};ops.Document.signalCursorAdded="cursor/added";ops.Document.signalCursorRemoved="cursor/removed";ops.Document.signalCursorMoved="cursor/moved";ops.Document.signalMemberAdded="member/added";ops.Document.signalMemberUpdated="member/updated";ops.Document.signalMemberRemoved="member/removed";
ops.OdtCursor=function(m,d){var g=this,a={},c,h,f=new core.EventNotifier([ops.OdtCursor.signalCursorUpdated]);this.removeFromDocument=function(){h.remove()};this.subscribe=function(a,c){f.subscribe(a,c)};this.unsubscribe=function(a,c){f.unsubscribe(a,c)};this.getMemberId=function(){return m};this.getNode=function(){return h.getNode()};this.getAnchorNode=function(){return h.getAnchorNode()};this.getSelectedRange=function(){return h.getSelectedRange()};this.setSelectedRange=function(a,c){h.setSelectedRange(a,
c);f.emit(ops.OdtCursor.signalCursorUpdated,g)};this.hasForwardSelection=function(){return h.hasForwardSelection()};this.getDocument=function(){return d};this.getSelectionType=function(){return c};this.setSelectionType=function(d){a.hasOwnProperty(d)?c=d:runtime.log("Invalid selection type: "+d)};this.resetSelectionType=function(){g.setSelectionType(ops.OdtCursor.RangeSelection)};h=new core.Cursor(d.getDOMDocument(),m);a[ops.OdtCursor.RangeSelection]=!0;a[ops.OdtCursor.RegionSelection]=!0;g.resetSelectionType()};
ops.OdtCursor.RangeSelection="Range";ops.OdtCursor.RegionSelection="Region";ops.OdtCursor.signalCursorUpdated="cursorUpdated";
(function(){var m=0;ops.StepsCache=function(d,g,a){function c(b,e){var c=this;this.nodeId=b;this.steps=-1;this.node=e;this.previousBookmark=this.nextBookmark=null;this.setIteratorPosition=function(b){b.setPositionBeforeElement(e);a(c.steps,b)}}function h(b,e,c){var d=this;this.nodeId=b;this.steps=e;this.node=c;this.previousBookmark=this.nextBookmark=null;this.setIteratorPosition=function(b){b.setUnfilteredPosition(c,0);a(d.steps,b)}}function f(b,a){var e="["+b.nodeId;a&&(e+=" => "+a.nodeId);return e+
"]"}function n(){for(var b=A,a,e,c,h=new core.LoopWatchDog(0,1E5),l={};b;){h.check();(a=b.previousBookmark)?runtime.assert(a.nextBookmark===b,"Broken bookmark link to previous @"+f(a,b)):(runtime.assert(b===A,"Broken bookmark link @"+f(b)),runtime.assert(void 0===v||A===A||A.steps<=v,"Base point is damaged @"+f(b)));(e=b.nextBookmark)&&runtime.assert(e.previousBookmark===b,"Broken bookmark link to next @"+f(b,e));if(void 0===v||b===A||b.steps<=v)runtime.assert(x.containsNode(d,b.node),"Disconnected node is being reported as undamaged @"+
f(b)),a&&(c=b.node.compareDocumentPosition(a.node),runtime.assert(0===c||0!==(c&B),"Bookmark order with previous does not reflect DOM order @"+f(a,b))),e&&x.containsNode(d,e.node)&&(c=b.node.compareDocumentPosition(e.node),runtime.assert(0===c||0!==(c&t),"Bookmark order with next does not reflect DOM order @"+f(b,e)));b=b.nextBookmark}Object.keys(k).forEach(function(b){var a=k[b];(void 0===v||b<=v)&&runtime.assert(a.steps<=b,"Bookmark step of "+a.steps+" exceeds cached step lookup for "+b+" @"+f(a));
runtime.assert(!1===l.hasOwnProperty(a.nodeId),"Bookmark "+f(a)+" appears twice in cached step lookup at steps "+l[a.nodeId]+" and "+b);l[a.nodeId]=b})}function p(b){var a="";b.nodeType===Node.ELEMENT_NODE&&(a=b.getAttributeNS("urn:webodf:names:steps","nodeId")||"");return a}function l(b){var a=m.toString();b.setAttributeNS("urn:webodf:names:steps","nodeId",a);m+=1;return a}function r(b){var a,e,c=new core.LoopWatchDog(0,1E4);void 0!==v&&b>v&&(b=v);for(a=Math.floor(b/g)*g;!e&&0<=a;)e=k[a],a-=g;for(e=
e||A;e.nextBookmark&&e.nextBookmark.steps<=b;)c.check(),e=e.nextBookmark;runtime.assert(-1===b||e.steps<=b,"Bookmark @"+f(e)+" at step "+e.steps+" exceeds requested step of "+b);return e}function b(b){b.previousBookmark&&(b.previousBookmark.nextBookmark=b.nextBookmark);b.nextBookmark&&(b.nextBookmark.previousBookmark=b.previousBookmark)}function e(b){for(var a,e=null;!e&&b&&b!==d;)(a=p(b))&&(e=q[a])&&e.node!==b&&(runtime.log("Cloned node detected. Creating new bookmark"),e=null,b.removeAttributeNS("urn:webodf:names:steps",
"nodeId")),b=b.parentNode;return e}var k={},q={},x=core.DomUtils,A,v,t=Node.DOCUMENT_POSITION_FOLLOWING,B=Node.DOCUMENT_POSITION_PRECEDING,u;this.updateBookmark=function(a,e){var f,h=Math.ceil(a/g)*g,m,s,n;if(void 0!==v&&v<a){m=r(v);for(s=m.nextBookmark;s&&s.steps<=a;)f=s.nextBookmark,n=Math.ceil(s.steps/g)*g,k[n]===s&&delete k[n],x.containsNode(d,s.node)?s.steps=a+1:(b(s),delete q[s.nodeId]),s=f;v=a}else m=r(a);s=p(e)||l(e);f=q[s];f?f.node!==e&&(runtime.log("Cloned node detected. Creating new bookmark"),
s=l(e),f=q[s]=new c(s,e)):f=q[s]=new c(s,e);s=f;s.steps!==a&&(f=Math.ceil(s.steps/g)*g,f!==h&&k[f]===s&&delete k[f],s.steps=a);if(m!==s&&m.nextBookmark!==s){if(m.steps===s.steps)for(;0!==(s.node.compareDocumentPosition(m.node)&t)&&m!==A;)m=m.previousBookmark;m!==s&&m.nextBookmark!==s&&(b(s),f=m.nextBookmark,s.nextBookmark=m.nextBookmark,s.previousBookmark=m,m.nextBookmark=s,f&&(f.previousBookmark=s))}m=k[h];if(!m||s.steps>m.steps)k[h]=s;u()};this.setToClosestStep=function(b,a){var e;u();e=r(b);e.setIteratorPosition(a);
return e.steps};this.setToClosestDomPoint=function(b,a,c){var f,h;u();if(b===d&&0===a)f=A;else if(b===d&&a===d.childNodes.length)for(h in f=A,k)k.hasOwnProperty(h)&&(b=k[h],b.steps>f.steps&&(f=b));else if(f=e(b.childNodes.item(a)||b),!f)for(c.setUnfilteredPosition(b,a);!f&&c.previousNode();)f=e(c.getCurrentNode());f=f||A;void 0!==v&&f.steps>v&&(f=r(v));f.setIteratorPosition(c);return f.steps};this.damageCacheAfterStep=function(b){0>b&&(b=-1);void 0===v?v=b:b<v&&(v=b);u()};(function(){var b=p(d)||
l(d);A=new h(b,0,d);u=ops.StepsCache.ENABLE_CACHE_VERIFICATION?n:function(){}})()};ops.StepsCache.ENABLE_CACHE_VERIFICATION=!1;ops.StepsCache.Bookmark=function(){};ops.StepsCache.Bookmark.prototype.nodeId;ops.StepsCache.Bookmark.prototype.node;ops.StepsCache.Bookmark.prototype.steps;ops.StepsCache.Bookmark.prototype.previousBookmark;ops.StepsCache.Bookmark.prototype.nextBookmark;ops.StepsCache.Bookmark.prototype.setIteratorPosition=function(d){}})();
(function(){ops.OdtStepsTranslator=function(m,d,g,a){function c(b,a,e){var c=a.getCurrentNode();a.isBeforeNode()&&r.isParagraph(c)&&(e||(b+=1),l.updateBookmark(b,c))}function h(b,a){do{if(g.acceptPosition(a)===k){c(b,a,!0);break}c(b-1,a,!1)}while(a.nextPosition())}function f(){var b=m();b!==p&&(p&&runtime.log("Undo detected. Resetting steps cache"),p=b,l=new ops.StepsCache(p,a,h),e=d(p))}function n(b,a){if(!a||g.acceptPosition(b)===k)return!0;for(;b.previousPosition();)if(g.acceptPosition(b)===k){if(a(q,
b.container(),b.unfilteredDomOffset()))return!0;break}for(;b.nextPosition();)if(g.acceptPosition(b)===k){if(a(x,b.container(),b.unfilteredDomOffset()))return!0;break}return!1}var p,l,r=odf.OdfUtils,b=core.DomUtils,e,k=core.PositionFilter.FilterResult.FILTER_ACCEPT,q=core.StepDirection.PREVIOUS,x=core.StepDirection.NEXT;this.convertStepsToDomPoint=function(b){var a,d;if(isNaN(b))throw new TypeError("Requested steps is not numeric ("+b+")");if(0>b)throw new RangeError("Requested steps is negative ("+
b+")");f();for(a=l.setToClosestStep(b,e);a<b&&e.nextPosition();)(d=g.acceptPosition(e)===k)&&(a+=1),c(a,e,d);if(a!==b)throw new RangeError("Requested steps ("+b+") exceeds available steps ("+a+")");return{node:e.container(),offset:e.unfilteredDomOffset()}};this.convertDomPointToSteps=function(a,d,h){var q;f();b.containsNode(p,a)||(d=0>b.comparePoints(p,0,a,d),a=p,d=d?0:p.childNodes.length);e.setUnfilteredPosition(a,d);n(e,h)||e.setUnfilteredPosition(a,d);h=e.container();d=e.unfilteredDomOffset();
a=l.setToClosestDomPoint(h,d,e);if(0>b.comparePoints(e.container(),e.unfilteredDomOffset(),h,d))return 0<a?a-1:a;for(;(e.container()!==h||e.unfilteredDomOffset()!==d)&&e.nextPosition();)(q=g.acceptPosition(e)===k)&&(a+=1),c(a,e,q);return a+0};this.prime=function(){var b,a;f();for(b=l.setToClosestStep(0,e);e.nextPosition();)(a=g.acceptPosition(e)===k)&&(b+=1),c(b,e,a)};this.handleStepsInserted=function(b){f();l.damageCacheAfterStep(b.position)};this.handleStepsRemoved=function(b){f();l.damageCacheAfterStep(b.position-
1)};f()}})();ops.Operation=function(){};ops.Operation.prototype.init=function(m){};ops.Operation.prototype.isEdit;ops.Operation.prototype.group;ops.Operation.prototype.execute=function(m){};ops.Operation.prototype.spec=function(){};
ops.TextPositionFilter=function(){function m(a,g,m){var l,r;if(g){if(d.isInlineRoot(g)&&d.isGroupingElement(m))return h;l=d.lookLeftForCharacter(g);if(1===l||2===l&&(d.scanRightForAnyCharacter(m)||d.scanRightForAnyCharacter(d.nextNode(a))))return c}else if(d.isInlineRoot(a.previousSibling)&&d.isGroupingElement(a))return c;l=null===g&&d.isParagraph(a);r=d.lookRightForCharacter(m);if(l)return r?c:d.scanRightForAnyCharacter(m)?h:c;if(!r)return h;g=g||d.previousNode(a);return d.scanLeftForAnyCharacter(g)?
h:c}var d=odf.OdfUtils,g=Node.ELEMENT_NODE,a=Node.TEXT_NODE,c=core.PositionFilter.FilterResult.FILTER_ACCEPT,h=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(f){var n=f.container(),p=n.nodeType,l,r,b;if(p!==g&&p!==a)return h;if(p===a){p=f.unfilteredDomOffset();l=n.data;runtime.assert(p!==l.length,"Unexpected offset.");if(0<p){f=l[p-1];if(!d.isODFWhitespace(f))return c;if(1<p)if(f=l[p-2],!d.isODFWhitespace(f))r=c;else{if(!d.isODFWhitespace(l.substr(0,p)))return h}else b=
d.previousNode(n),d.scanLeftForNonSpace(b)&&(r=c);if(r===c)return d.isTrailingWhitespace(n,p)?h:c;r=l[p];return d.isODFWhitespace(r)?h:d.scanLeftForAnyCharacter(d.previousNode(n))?h:c}b=f.leftNode();r=n;n=n.parentNode;r=m(n,b,r)}else d.isGroupingElement(n)?(b=f.leftNode(),r=f.rightNode(),r=m(n,b,r)):r=h;return r}};
ops.OdtDocument=function(m){function d(b){return new core.PositionIterator(b,C,z,!1)}function g(){var b=m.odfContainer().getContentElement(),a=b&&b.localName;runtime.assert("text"===a,"Unsupported content element type '"+a+"' for OdtDocument");return b}function a(){return b.getDocumentElement().ownerDocument}function c(b){for(;b&&!(b.namespaceURI===odf.Namespaces.officens&&"text"===b.localName||b.namespaceURI===odf.Namespaces.officens&&"annotation"===b.localName);)b=b.parentNode;return b}function h(b){this.acceptPosition=
function(a){a=a.container();var e;e="string"===typeof b?x[b].getNode():b;return c(a)===c(e)?t:B}}function f(b,a,e,c){c=d(c);var k;1===e.length?k=e[0]:(k=new core.PositionFilterChain,e.forEach(k.addFilter));e=new core.StepIterator(k,c);e.setPosition(b,a);return e}function n(b){var a=d(g());b=D.convertStepsToDomPoint(b);a.setUnfilteredPosition(b.node,b.offset);return a}function p(b){return b===u}function l(b){var a,c=[],d,f=2;runtime.assert(b.isStep(),"positionIterator is not at a step");do{if(a=e.getContentBounds(b))if(a=
a.container,k.isDowngradableSpaceElement(a)){for(d=a.lastChild;a.firstChild;)c.push(a.firstChild),a.parentNode.insertBefore(a.firstChild,a);a.parentNode.removeChild(a);b.setPosition(d,d.nodeType===Node.TEXT_NODE?d.length:d.childNodes.length);b.roundToPreviousStep()}f-=1}while(0<f&&b.nextStep());c.forEach(q.normalizeTextNodes)}function r(b,a,e){b=b.childNodes.item(a)||b;return(b=k.getParagraphElement(b))&&q.containsNode(e,b)?b:e}var b=this,e,k=odf.OdfUtils,q=core.DomUtils,x={},A={},v=new core.EventNotifier([ops.Document.signalMemberAdded,
ops.Document.signalMemberUpdated,ops.Document.signalMemberRemoved,ops.Document.signalCursorAdded,ops.Document.signalCursorRemoved,ops.Document.signalCursorMoved,ops.OdtDocument.signalParagraphChanged,ops.OdtDocument.signalParagraphStyleModified,ops.OdtDocument.signalCommonStyleCreated,ops.OdtDocument.signalCommonStyleDeleted,ops.OdtDocument.signalTableAdded,ops.OdtDocument.signalOperationStart,ops.OdtDocument.signalOperationEnd,ops.OdtDocument.signalProcessingBatchStart,ops.OdtDocument.signalProcessingBatchEnd,
ops.OdtDocument.signalUndoStackChanged,ops.OdtDocument.signalStepsInserted,ops.OdtDocument.signalStepsRemoved,ops.OdtDocument.signalMetadataUpdated,ops.OdtDocument.signalAnnotationAdded]),t=core.PositionFilter.FilterResult.FILTER_ACCEPT,B=core.PositionFilter.FilterResult.FILTER_REJECT,u=core.StepDirection.NEXT,w,D,F,C=NodeFilter.SHOW_ALL,H=new gui.BlacklistNamespaceNodeFilter(["urn:webodf:names:cursor","urn:webodf:names:editinfo"]),s=new gui.OdfTextBodyNodeFilter,z=new core.NodeFilterChain([H,s]);
this.createPositionIterator=d;this.getDocumentElement=function(){return m.odfContainer().rootElement};this.getDOMDocument=function(){return this.getDocumentElement().ownerDocument};this.cloneDocumentElement=function(){var a=b.getDocumentElement(),e=m.getAnnotationViewManager();e&&e.forgetAnnotations();a=a.cloneNode(!0);m.refreshAnnotations();return a};this.setDocumentElement=function(b){var a=m.odfContainer();a.setRootElement(b);m.setOdfContainer(a,!0);m.refreshCSS()};this.getDOMDocument=a;this.getRootElement=
c;this.createStepIterator=f;this.getIteratorAtPosition=n;this.convertCursorStepToDomPoint=function(b){return D.convertStepsToDomPoint(b)};this.convertDomPointToCursorStep=function(b,a,e){var c;e===u&&(c=p);return D.convertDomPointToSteps(b,a,c)};this.convertDomToCursorRange=function(b){var a;a=D.convertDomPointToSteps(b.anchorNode,b.anchorOffset);b=b.anchorNode===b.focusNode&&b.anchorOffset===b.focusOffset?a:D.convertDomPointToSteps(b.focusNode,b.focusOffset);return{position:a,length:b-a}};this.convertCursorToDomRange=
function(b,e){var c=a().createRange(),d,k;d=D.convertStepsToDomPoint(b);e?(k=D.convertStepsToDomPoint(b+e),0<e?(c.setStart(d.node,d.offset),c.setEnd(k.node,k.offset)):(c.setStart(k.node,k.offset),c.setEnd(d.node,d.offset))):c.setStart(d.node,d.offset);return c};this.upgradeWhitespacesAtPosition=function(b){var a=n(b),a=new core.StepIterator(w,a),c,d=2;runtime.assert(a.isStep(),"positionIterator is not at a step (requested step: "+b+")");do{if(c=e.getContentBounds(a))if(b=c.container,c=c.startOffset,
b.nodeType===Node.TEXT_NODE&&k.isSignificantWhitespace(b,c)){runtime.assert(" "===b.data[c],"upgradeWhitespaceToElement: textNode.data[offset] should be a literal space");var f=b.ownerDocument.createElementNS(odf.Namespaces.textns,"text:s"),h=b.parentNode,l=b;f.appendChild(b.ownerDocument.createTextNode(" "));1===b.length?h.replaceChild(f,b):(b.deleteData(c,1),0<c&&(c<b.length&&b.splitText(c),l=b.nextSibling),h.insertBefore(f,l));b=f;a.setPosition(b,b.childNodes.length);a.roundToPreviousStep()}d-=
1}while(0<d&&a.nextStep())};this.downgradeWhitespaces=l;this.downgradeWhitespacesAtPosition=function(b){b=n(b);b=new core.StepIterator(w,b);l(b)};this.getTextNodeAtStep=function(e,c){var d=n(e),k=d.container(),f,h=0,l=null;k.nodeType===Node.TEXT_NODE?(f=k,h=d.unfilteredDomOffset(),0<f.length&&(0<h&&(f=f.splitText(h)),f.parentNode.insertBefore(a().createTextNode(""),f),f=f.previousSibling,h=0)):(f=a().createTextNode(""),h=0,k.insertBefore(f,d.rightNode()));if(c){if(x[c]&&b.getCursorPosition(c)===e){for(l=
x[c].getNode();l.nextSibling&&"cursor"===l.nextSibling.localName;)l.parentNode.insertBefore(l.nextSibling,l);0<f.length&&f.nextSibling!==l&&(f=a().createTextNode(""),h=0);l.parentNode.insertBefore(f,l)}}else for(;f.nextSibling&&"cursor"===f.nextSibling.localName;)f.parentNode.insertBefore(f.nextSibling,f);for(;f.previousSibling&&f.previousSibling.nodeType===Node.TEXT_NODE;)d=f.previousSibling,d.appendData(f.data),h=d.length,f=d,f.parentNode.removeChild(f.nextSibling);for(;f.nextSibling&&f.nextSibling.nodeType===
Node.TEXT_NODE;)d=f.nextSibling,f.appendData(d.data),f.parentNode.removeChild(d);return{textNode:f,offset:h}};this.fixCursorPositions=function(){Object.keys(x).forEach(function(a){var e=x[a],d=c(e.getNode()),k=b.createRootFilter(d),h,l,q,s=!1;q=e.getSelectedRange();h=r(q.startContainer,q.startOffset,d);l=f(q.startContainer,q.startOffset,[w,k],h);q.collapsed?d=l:(h=r(q.endContainer,q.endOffset,d),d=f(q.endContainer,q.endOffset,[w,k],h));l.isStep()&&d.isStep()?l.container()!==d.container()||l.offset()!==
d.offset()||q.collapsed&&e.getAnchorNode()===e.getNode()||(s=!0,q.setStart(l.container(),l.offset()),q.collapse(!0)):(s=!0,runtime.assert(l.roundToClosestStep(),"No walkable step found for cursor owned by "+a),q.setStart(l.container(),l.offset()),runtime.assert(d.roundToClosestStep(),"No walkable step found for cursor owned by "+a),q.setEnd(d.container(),d.offset()));s&&(e.setSelectedRange(q,e.hasForwardSelection()),b.emit(ops.Document.signalCursorMoved,e))})};this.getCursorPosition=function(b){return(b=
x[b])?D.convertDomPointToSteps(b.getNode(),0):0};this.getCursorSelection=function(b){b=x[b];var a=0,e=0;b&&(a=D.convertDomPointToSteps(b.getNode(),0),e=D.convertDomPointToSteps(b.getAnchorNode(),0));return{position:e,length:a-e}};this.getPositionFilter=function(){return w};this.getOdfCanvas=function(){return m};this.getCanvas=function(){return m};this.getRootNode=g;this.addMember=function(b){runtime.assert(void 0===A[b.getMemberId()],"This member already exists");A[b.getMemberId()]=b};this.getMember=
function(b){return A.hasOwnProperty(b)?A[b]:null};this.removeMember=function(b){delete A[b]};this.getCursor=function(b){return x[b]};this.getMemberIds=function(){var b=[],a;for(a in x)x.hasOwnProperty(a)&&b.push(x[a].getMemberId());return b};this.addCursor=function(a){runtime.assert(Boolean(a),"OdtDocument::addCursor without cursor");var e=a.getMemberId(),c=b.convertCursorToDomRange(0,0);runtime.assert("string"===typeof e,"OdtDocument::addCursor has cursor without memberid");runtime.assert(!x[e],
"OdtDocument::addCursor is adding a duplicate cursor with memberid "+e);a.setSelectedRange(c,!0);x[e]=a};this.removeCursor=function(a){var e=x[a];return e?(e.removeFromDocument(),delete x[a],b.emit(ops.Document.signalCursorRemoved,a),!0):!1};this.moveCursor=function(a,e,c,d){a=x[a];e=b.convertCursorToDomRange(e,c);a&&(a.setSelectedRange(e,0<=c),a.setSelectionType(d||ops.OdtCursor.RangeSelection))};this.getFormatting=function(){return m.getFormatting()};this.emit=function(b,a){v.emit(b,a)};this.subscribe=
function(b,a){v.subscribe(b,a)};this.unsubscribe=function(b,a){v.unsubscribe(b,a)};this.createRootFilter=function(b){return new h(b)};this.close=function(b){b()};this.destroy=function(b){b()};w=new ops.TextPositionFilter;e=new odf.StepUtils;D=new ops.OdtStepsTranslator(g,d,w,500);v.subscribe(ops.OdtDocument.signalStepsInserted,D.handleStepsInserted);v.subscribe(ops.OdtDocument.signalStepsRemoved,D.handleStepsRemoved);v.subscribe(ops.OdtDocument.signalOperationEnd,function(a){var e=a.spec(),c=e.memberid,
d=(new Date(e.timestamp)).toISOString(),f=m.odfContainer(),k={setProperties:{},removedProperties:[]};a.isEdit&&("UpdateMetadata"===e.optype&&(k.setProperties=JSON.parse(JSON.stringify(e.setProperties)),e.removedProperties&&(k.removedProperties=e.removedProperties.attributes.split(","))),e=b.getMember(c).getProperties().fullName,f.setMetadata({"dc:creator":e,"dc:date":d},null),k.setProperties["dc:creator"]=e,k.setProperties["dc:date"]=d,F||(k.setProperties["meta:editing-cycles"]=f.incrementEditingCycles(),
f.setMetadata(null,["meta:editing-duration","meta:document-statistic"])),F=a,b.emit(ops.OdtDocument.signalMetadataUpdated,k))});v.subscribe(ops.OdtDocument.signalProcessingBatchEnd,core.Task.processTasks)};ops.OdtDocument.signalParagraphChanged="paragraph/changed";ops.OdtDocument.signalTableAdded="table/added";ops.OdtDocument.signalCommonStyleCreated="style/created";ops.OdtDocument.signalCommonStyleDeleted="style/deleted";ops.OdtDocument.signalParagraphStyleModified="paragraphstyle/modified";
ops.OdtDocument.signalOperationStart="operation/start";ops.OdtDocument.signalOperationEnd="operation/end";ops.OdtDocument.signalProcessingBatchStart="router/batchstart";ops.OdtDocument.signalProcessingBatchEnd="router/batchend";ops.OdtDocument.signalUndoStackChanged="undo/changed";ops.OdtDocument.signalStepsInserted="steps/inserted";ops.OdtDocument.signalStepsRemoved="steps/removed";ops.OdtDocument.signalMetadataUpdated="metadata/updated";ops.OdtDocument.signalAnnotationAdded="annotation/added";
ops.OpAddAnnotation=function(){function m(a,c,f){var h=a.getTextNodeAtStep(f,d);h&&(a=h.textNode,f=a.parentNode,h.offset!==a.length&&a.splitText(h.offset),f.insertBefore(c,a.nextSibling),0===a.length&&f.removeChild(a))}var d,g,a,c,h,f;this.init=function(f){d=f.memberid;g=parseInt(f.timestamp,10);a=parseInt(f.position,10);c=parseInt(f.length,10)||0;h=f.name};this.isEdit=!0;this.group=void 0;this.execute=function(n){var p=n.getCursor(d),l,r;f=n.getDOMDocument();var b=new Date(g),e,k,q;e=f.createElementNS(odf.Namespaces.officens,
"office:annotation");e.setAttributeNS(odf.Namespaces.officens,"office:name",h);l=f.createElementNS(odf.Namespaces.dcns,"dc:creator");l.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",d);l.textContent=n.getMember(d).getProperties().fullName;r=f.createElementNS(odf.Namespaces.dcns,"dc:date");r.appendChild(f.createTextNode(b.toISOString()));b=f.createElementNS(odf.Namespaces.textns,"text:list");k=f.createElementNS(odf.Namespaces.textns,"text:list-item");q=f.createElementNS(odf.Namespaces.textns,
"text:p");k.appendChild(q);b.appendChild(k);e.appendChild(l);e.appendChild(r);e.appendChild(b);c&&(l=f.createElementNS(odf.Namespaces.officens,"office:annotation-end"),l.setAttributeNS(odf.Namespaces.officens,"office:name",h),e.annotationEndElement=l,m(n,l,a+c));m(n,e,a);n.emit(ops.OdtDocument.signalStepsInserted,{position:a});p&&(l=f.createRange(),r=e.getElementsByTagNameNS(odf.Namespaces.textns,"p")[0],l.selectNodeContents(r),p.setSelectedRange(l,!1),p.setSelectionType(ops.OdtCursor.RangeSelection),
n.emit(ops.Document.signalCursorMoved,p));n.getOdfCanvas().addAnnotation(e);n.fixCursorPositions();n.emit(ops.OdtDocument.signalAnnotationAdded,{memberId:d,annotation:e});return!0};this.spec=function(){return{optype:"AddAnnotation",memberid:d,timestamp:g,position:a,length:c,name:h}}};ops.OpAddAnnotation.Spec;ops.OpAddAnnotation.InitSpec;
ops.OpAddCursor=function(){var m,d;this.init=function(g){m=g.memberid;d=g.timestamp};this.isEdit=!1;this.group=void 0;this.execute=function(d){var a=d.getCursor(m);if(a)return!1;a=new ops.OdtCursor(m,d);d.addCursor(a);d.emit(ops.Document.signalCursorAdded,a);return!0};this.spec=function(){return{optype:"AddCursor",memberid:m,timestamp:d}}};ops.OpAddCursor.Spec;ops.OpAddCursor.InitSpec;
ops.OpAddMember=function(){var m,d,g;this.init=function(a){m=a.memberid;d=parseInt(a.timestamp,10);g=a.setProperties};this.isEdit=!1;this.group=void 0;this.execute=function(a){var c;if(a.getMember(m))return!1;c=new ops.Member(m,g);a.addMember(c);a.emit(ops.Document.signalMemberAdded,c);return!0};this.spec=function(){return{optype:"AddMember",memberid:m,timestamp:d,setProperties:g}}};ops.OpAddMember.Spec;ops.OpAddMember.InitSpec;
ops.OpAddStyle=function(){var m,d,g,a,c,h,f=odf.Namespaces.stylens;this.init=function(f){m=f.memberid;d=f.timestamp;g=f.styleName;a=f.styleFamily;c="true"===f.isAutomaticStyle||!0===f.isAutomaticStyle;h=f.setProperties};this.isEdit=!0;this.group=void 0;this.execute=function(d){var m=d.getOdfCanvas().odfContainer(),l=d.getFormatting(),r=d.getDOMDocument().createElementNS(f,"style:style");if(!r)return!1;h&&l.updateStyle(r,h);r.setAttributeNS(f,"style:family",a);r.setAttributeNS(f,"style:name",g);c?
m.rootElement.automaticStyles.appendChild(r):m.rootElement.styles.appendChild(r);d.getOdfCanvas().refreshCSS();c||d.emit(ops.OdtDocument.signalCommonStyleCreated,{name:g,family:a});return!0};this.spec=function(){return{optype:"AddStyle",memberid:m,timestamp:d,styleName:g,styleFamily:a,isAutomaticStyle:c,setProperties:h}}};ops.OpAddStyle.Spec;ops.OpAddStyle.InitSpec;
odf.ObjectNameGenerator=function(m,d){function g(b,a){var e={};this.generateName=function(){var c=a(),d=0,f;do f=b+d,d+=1;while(e[f]||c[f]);e[f]=!0;return f}}function a(){var b={};[m.rootElement.automaticStyles,m.rootElement.styles].forEach(function(a){for(a=a.firstElementChild;a;)a.namespaceURI===c&&"style"===a.localName&&(b[a.getAttributeNS(c,"name")]=!0),a=a.nextElementSibling});return b}var c=odf.Namespaces.stylens,h=odf.Namespaces.drawns,f=odf.Namespaces.xlinkns,n=(new core.Utils).hashString(d),
p=null,l=null,r=null,b={},e={};this.generateStyleName=function(){null===p&&(p=new g("auto"+n+"_",function(){return a()}));return p.generateName()};this.generateFrameName=function(){var a,e,c;if(null===l){e=m.rootElement.body.getElementsByTagNameNS(h,"frame");for(a=0;a<e.length;a+=1)c=e.item(a),b[c.getAttributeNS(h,"name")]=!0;l=new g("fr"+n+"_",function(){return b})}return l.generateName()};this.generateImageName=function(){var b,a,c;if(null===r){c=m.rootElement.body.getElementsByTagNameNS(h,"image");
for(b=0;b<c.length;b+=1)a=c.item(b),a=a.getAttributeNS(f,"href"),a=a.substring(9,a.lastIndexOf(".")),e[a]=!0;r=new g("img"+n+"_",function(){return e})}return r.generateName()}};
odf.TextStyleApplicator=function(m,d,g){function a(a){function c(b,a){return"object"===typeof b&&"object"===typeof a?Object.keys(b).every(function(d){return c(b[d],a[d])}):b===a}var b={};this.isStyleApplied=function(e){e=d.getAppliedStylesForElement(e,b).styleProperties;return c(a,e)}}function c(a){var c={};this.applyStyleToContainer=function(b){var e;e=b.getAttributeNS(n,"style-name");var f=b.ownerDocument;e=e||"";if(!c.hasOwnProperty(e)){var h=e,x;x=e?d.createDerivedStyleObject(e,"text",a):a;f=
f.createElementNS(p,"style:style");d.updateStyle(f,x);f.setAttributeNS(p,"style:name",m.generateStyleName());f.setAttributeNS(p,"style:family","text");f.setAttributeNS("urn:webodf:names:scope","scope","document-content");g.appendChild(f);c[h]=f}e=c[e].getAttributeNS(p,"name");b.setAttributeNS(n,"text:style-name",e)}}function h(a,c){var b=a.ownerDocument,e=a.parentNode,d,h,g,m=new core.LoopWatchDog(1E4);h=[];h.push(a);for(g=a.nextSibling;g&&f.rangeContainsNode(c,g);)m.check(),h.push(g),g=g.nextSibling;
"span"!==e.localName||e.namespaceURI!==n?(d=b.createElementNS(n,"text:span"),e.insertBefore(d,a),b=!1):(a.previousSibling&&!f.rangeContainsNode(c,e.firstChild)?(d=e.cloneNode(!1),e.parentNode.insertBefore(d,e.nextSibling)):d=e,b=!0);h.forEach(function(b){b.parentNode!==d&&d.appendChild(b)});if(g&&b)for(h=d.cloneNode(!1),d.parentNode.insertBefore(h,d.nextSibling);g;)m.check(),b=g.nextSibling,h.appendChild(g),g=b;return d}var f=core.DomUtils,n=odf.Namespaces.textns,p=odf.Namespaces.stylens;this.applyStyle=
function(d,f,b){var e={},k,q,g,m;runtime.assert(b&&b.hasOwnProperty("style:text-properties"),"applyStyle without any text properties");e["style:text-properties"]=b["style:text-properties"];g=new c(e);m=new a(e);d.forEach(function(b){k=m.isStyleApplied(b);!1===k&&(q=h(b,f),g.applyStyleToContainer(q))})}};
ops.OpApplyDirectStyling=function(){function m(a,c,h){var b=a.getOdfCanvas().odfContainer(),e=n.splitBoundaries(c),k=f.getTextNodes(c,!1);(new odf.TextStyleApplicator(new odf.ObjectNameGenerator(b,d),a.getFormatting(),b.rootElement.automaticStyles)).applyStyle(k,c,h);e.forEach(n.normalizeTextNodes)}var d,g,a,c,h,f=odf.OdfUtils,n=core.DomUtils;this.init=function(f){d=f.memberid;g=f.timestamp;a=parseInt(f.position,10);c=parseInt(f.length,10);h=f.setProperties};this.isEdit=!0;this.group=void 0;this.execute=
function(n){var l=n.convertCursorToDomRange(a,c),r=f.getParagraphElements(l);m(n,l,h);l.detach();n.getOdfCanvas().refreshCSS();n.fixCursorPositions();r.forEach(function(b){n.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:b,memberId:d,timeStamp:g})});n.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"ApplyDirectStyling",memberid:d,timestamp:g,position:a,length:c,setProperties:h}}};ops.OpApplyDirectStyling.Spec;ops.OpApplyDirectStyling.InitSpec;
ops.OpApplyHyperlink=function(){function m(a){for(;a;){if(n.isHyperlink(a))return!0;a=a.parentNode}return!1}var d,g,a,c,h,f=core.DomUtils,n=odf.OdfUtils;this.init=function(f){d=f.memberid;g=f.timestamp;a=f.position;c=f.length;h=f.hyperlink};this.isEdit=!0;this.group=void 0;this.execute=function(p){var l=p.getDOMDocument(),r=p.convertCursorToDomRange(a,c),b=f.splitBoundaries(r),e=[],k=n.getTextNodes(r,!1);if(0===k.length)return!1;k.forEach(function(b){var a=n.getParagraphElement(b);runtime.assert(!1===
m(b),"The given range should not contain any link.");var c=h,d=l.createElementNS(odf.Namespaces.textns,"text:a");d.setAttributeNS(odf.Namespaces.xlinkns,"xlink:type","simple");d.setAttributeNS(odf.Namespaces.xlinkns,"xlink:href",c);b.parentNode.insertBefore(d,b);d.appendChild(b);-1===e.indexOf(a)&&e.push(a)});b.forEach(f.normalizeTextNodes);r.detach();p.fixCursorPositions();p.getOdfCanvas().refreshSize();p.getOdfCanvas().rerenderAnnotations();e.forEach(function(b){p.emit(ops.OdtDocument.signalParagraphChanged,
{paragraphElement:b,memberId:d,timeStamp:g})});return!0};this.spec=function(){return{optype:"ApplyHyperlink",memberid:d,timestamp:g,position:a,length:c,hyperlink:h}}};ops.OpApplyHyperlink.Spec;ops.OpApplyHyperlink.InitSpec;
ops.OpInsertImage=function(){var m,d,g,a,c,h,f,n,p=odf.Namespaces.drawns,l=odf.Namespaces.svgns,r=odf.Namespaces.textns,b=odf.Namespaces.xlinkns,e=odf.OdfUtils;this.init=function(b){m=b.memberid;d=b.timestamp;g=b.position;a=b.filename;c=b.frameWidth;h=b.frameHeight;f=b.frameStyleName;n=b.frameName};this.isEdit=!0;this.group=void 0;this.execute=function(k){var q=k.getOdfCanvas(),x=k.getTextNodeAtStep(g,m),A,v;if(!x)return!1;A=x.textNode;v=e.getParagraphElement(A);var x=x.offset!==A.length?A.splitText(x.offset):
A.nextSibling,t=k.getDOMDocument(),B=t.createElementNS(p,"draw:image"),t=t.createElementNS(p,"draw:frame");B.setAttributeNS(b,"xlink:href",a);B.setAttributeNS(b,"xlink:type","simple");B.setAttributeNS(b,"xlink:show","embed");B.setAttributeNS(b,"xlink:actuate","onLoad");t.setAttributeNS(p,"draw:style-name",f);t.setAttributeNS(p,"draw:name",n);t.setAttributeNS(r,"text:anchor-type","as-char");t.setAttributeNS(l,"svg:width",c);t.setAttributeNS(l,"svg:height",h);t.appendChild(B);A.parentNode.insertBefore(t,
x);k.emit(ops.OdtDocument.signalStepsInserted,{position:g});0===A.length&&A.parentNode.removeChild(A);q.addCssForFrameWithImage(t);q.refreshCSS();k.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:v,memberId:m,timeStamp:d});q.rerenderAnnotations();return!0};this.spec=function(){return{optype:"InsertImage",memberid:m,timestamp:d,filename:a,position:g,frameWidth:c,frameHeight:h,frameStyleName:f,frameName:n}}};ops.OpInsertImage.Spec;ops.OpInsertImage.InitSpec;
ops.OpInsertTable=function(){function m(b,e){var d;if(1===l.length)d=l[0];else if(3===l.length)switch(b){case 0:d=l[0];break;case a-1:d=l[2];break;default:d=l[1]}else d=l[b];if(1===d.length)return d[0];if(3===d.length)switch(e){case 0:return d[0];case c-1:return d[2];default:return d[1]}return d[e]}var d,g,a,c,h,f,n,p,l,r=odf.OdfUtils;this.init=function(b){d=b.memberid;g=b.timestamp;h=b.position;a=b.initialRows;c=b.initialColumns;f=b.tableName;n=b.tableStyleName;p=b.tableColumnStyleName;l=b.tableCellStyleMatrix};
this.isEdit=!0;this.group=void 0;this.execute=function(b){var e=b.getTextNodeAtStep(h),k=b.getRootNode();if(e){var l=b.getDOMDocument(),x=l.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table"),A=l.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-column"),v,t,B,u;n&&x.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",n);f&&x.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:name",f);A.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0",
"table:number-columns-repeated",c);p&&A.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",p);x.appendChild(A);for(B=0;B<a;B+=1){A=l.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-row");for(u=0;u<c;u+=1)v=l.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-cell"),(t=m(B,u))&&v.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",t),t=l.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0",
"text:p"),v.appendChild(t),A.appendChild(v);x.appendChild(A)}e=r.getParagraphElement(e.textNode);k.insertBefore(x,e.nextSibling);b.emit(ops.OdtDocument.signalStepsInserted,{position:h});b.getOdfCanvas().refreshSize();b.emit(ops.OdtDocument.signalTableAdded,{tableElement:x,memberId:d,timeStamp:g});b.getOdfCanvas().rerenderAnnotations();return!0}return!1};this.spec=function(){return{optype:"InsertTable",memberid:d,timestamp:g,position:h,initialRows:a,initialColumns:c,tableName:f,tableStyleName:n,tableColumnStyleName:p,
tableCellStyleMatrix:l}}};ops.OpInsertTable.Spec;ops.OpInsertTable.InitSpec;
ops.OpInsertText=function(){function m(a){return"\t"!==a&&f.isODFWhitespace(a)}var d,g,a,c,h,f=odf.OdfUtils;this.init=function(f){d=f.memberid;g=f.timestamp;a=f.position;h=f.text;c="true"===f.moveCursor||!0===f.moveCursor};this.isEdit=!0;this.group=void 0;this.execute=function(n){var p,l,r,b=null,e=n.getDOMDocument(),k,q=0,x,A=n.getCursor(d),v;n.upgradeWhitespacesAtPosition(a);if(p=n.getTextNodeAtStep(a)){l=p.textNode;b=l.nextSibling;r=l.parentNode;k=f.getParagraphElement(l);for(v=0;v<h.length;v+=
1){if(!(x="\t"===h[v])){x=h;var t=v;x=m(x[t])&&(0===t||t===x.length-1||m(x[t-1]))}x&&(0===q?(p.offset!==l.length&&(b=l.splitText(p.offset)),0<v&&l.appendData(h.substring(0,v))):q<v&&(q=h.substring(q,v),r.insertBefore(e.createTextNode(q),b)),q=v+1,"\t"===h[v]?(x=e.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:tab"),x.appendChild(e.createTextNode("\t"))):(" "!==h[v]&&runtime.log("WARN: InsertText operation contains non-tab, non-space whitespace character (character code "+h.charCodeAt(v)+
")"),x=e.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:s"),x.appendChild(e.createTextNode(" "))),r.insertBefore(x,b))}0===q?l.insertData(p.offset,h):q<h.length&&(p=h.substring(q),r.insertBefore(e.createTextNode(p),b));r=l.parentNode;b=l.nextSibling;r.removeChild(l);r.insertBefore(l,b);0===l.length&&l.parentNode.removeChild(l);n.emit(ops.OdtDocument.signalStepsInserted,{position:a});A&&c&&(n.moveCursor(d,a+h.length,0),n.emit(ops.Document.signalCursorMoved,A));n.downgradeWhitespacesAtPosition(a);
n.downgradeWhitespacesAtPosition(a+h.length);n.getOdfCanvas().refreshSize();n.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:k,memberId:d,timeStamp:g});n.getOdfCanvas().rerenderAnnotations();return!0}return!1};this.spec=function(){return{optype:"InsertText",memberid:d,timestamp:g,position:a,text:h,moveCursor:c}}};ops.OpInsertText.Spec;ops.OpInsertText.InitSpec;
odf.CollapsingRules=function(m){function d(c){return a.isODFNode(c)||"br"===c.localName&&a.isLineBreak(c.parentNode)||c.nodeType===Node.TEXT_NODE&&a.isODFNode(c.parentNode)}function g(h){var f;h.nodeType===Node.TEXT_NODE?(f=h.parentNode,f.removeChild(h)):f=c.removeUnwantedNodes(h,d);if(h=f)h=f,h=!a.isParagraph(h)&&h!==m&&a.hasNoODFContent(h);return h?g(f):f}var a=odf.OdfUtils,c=core.DomUtils;this.mergeChildrenIntoParent=g};
ops.OpMergeParagraph=function(){function m(b){return r.isGroupingElement(b)&&r.hasNoODFContent(b)}function d(b){if(b.nodeType===Node.TEXT_NODE){if(0===b.length)return runtime.log("WARN: Empty text node found during merge operation"),!0;if(r.isODFWhitespace(b.data)&&!1===r.isSignificantWhitespace(b,0))return!0;b="#text"}else b=(b.prefix?b.prefix+":":"")+b.localName;runtime.log("WARN: Unexpected text element found near paragraph boundary ["+b+"]");return!1}function g(a){a.collapsed||(b.splitBoundaries(a),
a=r.getTextElements(a,!1,!0).filter(d),a.forEach(function(b){b.parentNode.removeChild(b)}))}function a(b,a,e){b=b.convertCursorStepToDomPoint(a);var c=r.getParagraphElement(b.node,b.offset);runtime.assert(Boolean(c),"Paragraph not found at step "+a);e&&e.setPosition(b.node,b.offset);return c}var c,h,f,n,p,l,r=odf.OdfUtils,b=core.DomUtils,e=odf.Namespaces.textns;this.init=function(b){c=b.memberid;h=b.timestamp;f=b.moveCursor;n=b.paragraphStyleName;p=parseInt(b.sourceStartPosition,10);l=parseInt(b.destinationStartPosition,
10)};this.isEdit=!0;this.group=void 0;this.execute=function(d){var q,r,A=d.getCursor(c);q=d.getRootNode();var v=new odf.CollapsingRules(q),t=d.createStepIterator(q,0,[d.getPositionFilter()],q),B;runtime.assert(l<p,"Destination paragraph ("+l+") must be before source paragraph ("+p+")");r=a(d,l);q=a(d,p,t);t.previousStep();runtime.assert(b.containsNode(r,t.container()),"Destination paragraph must be adjacent to the source paragraph");B=r.ownerDocument.createRange();t.setPosition(r,r.childNodes.length);
t.roundToPreviousStep();B.setStart(t.container(),t.offset());B.setEnd(r,r.childNodes.length);g(B);B=r.childNodes.length;var u=q.ownerDocument.createRange();t.setPosition(q,0);t.roundToNextStep();u.setStart(q,0);u.setEnd(t.container(),t.offset());g(u);for(u=q.firstChild;u;)"editinfo"===u.localName?q.removeChild(u):(r.appendChild(u),b.removeUnwantedNodes(u,m)),u=q.firstChild;runtime.assert(0===q.childNodes.length,"Source paragraph should be empty before it is removed");v.mergeChildrenIntoParent(q);
d.emit(ops.OdtDocument.signalStepsRemoved,{position:p-1});t.setPosition(r,B);t.roundToClosestStep();t.previousStep()||t.roundToNextStep();d.downgradeWhitespaces(t);n?r.setAttributeNS(e,"text:style-name",n):r.removeAttributeNS(e,"style-name");A&&f&&(d.moveCursor(c,p-1,0),d.emit(ops.Document.signalCursorMoved,A));d.fixCursorPositions();d.getOdfCanvas().refreshSize();d.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:r,memberId:c,timeStamp:h});d.getOdfCanvas().rerenderAnnotations();return!0};
this.spec=function(){return{optype:"MergeParagraph",memberid:c,timestamp:h,moveCursor:f,paragraphStyleName:n,sourceStartPosition:p,destinationStartPosition:l}}};ops.OpMergeParagraph.Spec;ops.OpMergeParagraph.InitSpec;
ops.OpMoveCursor=function(){var m,d,g,a,c;this.init=function(h){m=h.memberid;d=h.timestamp;g=h.position;a=h.length||0;c=h.selectionType||ops.OdtCursor.RangeSelection};this.isEdit=!1;this.group=void 0;this.execute=function(d){var f=d.getCursor(m),n;if(!f)return!1;n=d.convertCursorToDomRange(g,a);f.setSelectedRange(n,0<=a);f.setSelectionType(c);d.emit(ops.Document.signalCursorMoved,f);return!0};this.spec=function(){return{optype:"MoveCursor",memberid:m,timestamp:d,position:g,length:a,selectionType:c}}};
ops.OpMoveCursor.Spec;ops.OpMoveCursor.InitSpec;
ops.OpRemoveAnnotation=function(){var m,d,g,a,c=core.DomUtils;this.init=function(c){m=c.memberid;d=c.timestamp;g=parseInt(c.position,10);a=parseInt(c.length,10)};this.isEdit=!0;this.group=void 0;this.execute=function(a){function d(a){p.parentNode.insertBefore(a,p)}for(var m=a.getIteratorAtPosition(g).container(),p;m.namespaceURI!==odf.Namespaces.officens||"annotation"!==m.localName;)m=m.parentNode;if(null===m)return!1;p=m;m=p.annotationEndElement;a.getOdfCanvas().forgetAnnotations();c.getElementsByTagNameNS(p,
"urn:webodf:names:cursor","cursor").forEach(d);c.getElementsByTagNameNS(p,"urn:webodf:names:cursor","anchor").forEach(d);p.parentNode.removeChild(p);m&&m.parentNode.removeChild(m);a.emit(ops.OdtDocument.signalStepsRemoved,{position:0<g?g-1:g});a.fixCursorPositions();a.getOdfCanvas().refreshAnnotations();return!0};this.spec=function(){return{optype:"RemoveAnnotation",memberid:m,timestamp:d,position:g,length:a}}};ops.OpRemoveAnnotation.Spec;ops.OpRemoveAnnotation.InitSpec;
ops.OpRemoveBlob=function(){var m,d,g;this.init=function(a){m=a.memberid;d=a.timestamp;g=a.filename};this.isEdit=!0;this.group=void 0;this.execute=function(a){a.getOdfCanvas().odfContainer().removeBlob(g);return!0};this.spec=function(){return{optype:"RemoveBlob",memberid:m,timestamp:d,filename:g}}};ops.OpRemoveBlob.Spec;ops.OpRemoveBlob.InitSpec;
ops.OpRemoveCursor=function(){var m,d;this.init=function(g){m=g.memberid;d=g.timestamp};this.isEdit=!1;this.group=void 0;this.execute=function(d){return d.removeCursor(m)?!0:!1};this.spec=function(){return{optype:"RemoveCursor",memberid:m,timestamp:d}}};ops.OpRemoveCursor.Spec;ops.OpRemoveCursor.InitSpec;
ops.OpRemoveHyperlink=function(){var m,d,g,a,c=core.DomUtils,h=odf.OdfUtils;this.init=function(c){m=c.memberid;d=c.timestamp;g=c.position;a=c.length};this.isEdit=!0;this.group=void 0;this.execute=function(f){var n=f.convertCursorToDomRange(g,a),p=h.getHyperlinkElements(n);runtime.assert(1===p.length,"The given range should only contain a single link.");p=c.mergeIntoParent(p[0]);n.detach();f.fixCursorPositions();f.getOdfCanvas().refreshSize();f.getOdfCanvas().rerenderAnnotations();f.emit(ops.OdtDocument.signalParagraphChanged,
{paragraphElement:h.getParagraphElement(p),memberId:m,timeStamp:d});return!0};this.spec=function(){return{optype:"RemoveHyperlink",memberid:m,timestamp:d,position:g,length:a}}};ops.OpRemoveHyperlink.Spec;ops.OpRemoveHyperlink.InitSpec;
ops.OpRemoveMember=function(){var m,d;this.init=function(g){m=g.memberid;d=parseInt(g.timestamp,10)};this.isEdit=!1;this.group=void 0;this.execute=function(d){if(!d.getMember(m))return!1;d.removeMember(m);d.emit(ops.Document.signalMemberRemoved,m);return!0};this.spec=function(){return{optype:"RemoveMember",memberid:m,timestamp:d}}};ops.OpRemoveMember.Spec;ops.OpRemoveMember.InitSpec;
ops.OpRemoveStyle=function(){var m,d,g,a;this.init=function(c){m=c.memberid;d=c.timestamp;g=c.styleName;a=c.styleFamily};this.isEdit=!0;this.group=void 0;this.execute=function(c){var d=c.getFormatting().getStyleElement(g,a);if(!d)return!1;d.parentNode.removeChild(d);c.getOdfCanvas().refreshCSS();c.emit(ops.OdtDocument.signalCommonStyleDeleted,{name:g,family:a});return!0};this.spec=function(){return{optype:"RemoveStyle",memberid:m,timestamp:d,styleName:g,styleFamily:a}}};ops.OpRemoveStyle.Spec;ops.OpRemoveStyle.InitSpec;
ops.OpRemoveText=function(){var m,d,g,a,c=odf.OdfUtils,h=core.DomUtils;this.init=function(c){runtime.assert(0<=c.length,"OpRemoveText only supports positive lengths");m=c.memberid;d=c.timestamp;g=parseInt(c.position,10);a=parseInt(c.length,10)};this.isEdit=!0;this.group=void 0;this.execute=function(f){var n,p,l,r=f.getCursor(m),b=new odf.CollapsingRules(f.getRootNode());f.upgradeWhitespacesAtPosition(g);f.upgradeWhitespacesAtPosition(g+a);n=f.convertCursorToDomRange(g,a);h.splitBoundaries(n);p=c.getTextElements(n,
!1,!0);l=c.getParagraphElement(n.startContainer,n.startOffset);runtime.assert(void 0!==l,"Attempting to remove text outside a paragraph element");n.detach();p.forEach(function(a){a.parentNode?(runtime.assert(h.containsNode(l,a),"RemoveText only supports removing elements within the same paragraph"),b.mergeChildrenIntoParent(a)):runtime.log("WARN: text element has already been removed from it's container")});f.emit(ops.OdtDocument.signalStepsRemoved,{position:g});f.downgradeWhitespacesAtPosition(g);
f.fixCursorPositions();f.getOdfCanvas().refreshSize();f.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:l,memberId:m,timeStamp:d});r&&(r.resetSelectionType(),f.emit(ops.Document.signalCursorMoved,r));f.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"RemoveText",memberid:m,timestamp:d,position:g,length:a}}};ops.OpRemoveText.Spec;ops.OpRemoveText.InitSpec;
ops.OpSetBlob=function(){var m,d,g,a,c;this.init=function(h){m=h.memberid;d=h.timestamp;g=h.filename;a=h.mimetype;c=h.content};this.isEdit=!0;this.group=void 0;this.execute=function(d){d.getOdfCanvas().odfContainer().setBlob(g,a,c);return!0};this.spec=function(){return{optype:"SetBlob",memberid:m,timestamp:d,filename:g,mimetype:a,content:c}}};ops.OpSetBlob.Spec;ops.OpSetBlob.InitSpec;
ops.OpSetParagraphStyle=function(){function m(a,c,d){var h=[a.getPositionFilter()],g=d.container();d=d.unfilteredDomOffset();return!1===a.createStepIterator(g,d,h,c).previousStep()}var d,g,a,c,h=odf.OdfUtils;this.init=function(f){d=f.memberid;g=f.timestamp;a=f.position;c=f.styleName};this.isEdit=!0;this.group=void 0;this.execute=function(f){var n,p;n=f.getIteratorAtPosition(a);return(p=h.getParagraphElement(n.container()))?(runtime.assert(m(f,p,n),"SetParagraphStyle position should be the first position in the paragraph"),
c?p.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:style-name",c):p.removeAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","style-name"),f.getOdfCanvas().refreshSize(),f.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:p,timeStamp:g,memberId:d}),f.getOdfCanvas().rerenderAnnotations(),!0):!1};this.spec=function(){return{optype:"SetParagraphStyle",memberid:d,timestamp:g,position:a,styleName:c}}};ops.OpSetParagraphStyle.Spec;ops.OpSetParagraphStyle.InitSpec;
ops.OpSplitParagraph=function(){var m,d,g,a,c,h,f=odf.OdfUtils,n=odf.Namespaces.textns;this.init=function(f){m=f.memberid;d=f.timestamp;a=f.position;g=f.sourceParagraphPosition;h=f.paragraphStyleName;c="true"===f.moveCursor||!0===f.moveCursor};this.isEdit=!0;this.group=void 0;this.execute=function(g){var l,r,b,e,k,q,x,A=g.getCursor(m);g.upgradeWhitespacesAtPosition(a);l=g.getTextNodeAtStep(a);if(!l)return!1;r=f.getParagraphElement(l.textNode);if(!r)return!1;b=f.isListItem(r.parentNode)?r.parentNode:
r;0===l.offset?(x=l.textNode.previousSibling,q=null):(x=l.textNode,q=l.offset>=l.textNode.length?null:l.textNode.splitText(l.offset));for(e=l.textNode;e!==b;){e=e.parentNode;k=e.cloneNode(!1);q&&k.appendChild(q);if(x)for(;x&&x.nextSibling;)k.appendChild(x.nextSibling);else for(;e.firstChild;)k.appendChild(e.firstChild);e.parentNode.insertBefore(k,e.nextSibling);x=e;q=k}f.isListItem(q)&&(q=q.childNodes.item(0));h?q.setAttributeNS(n,"text:style-name",h):q.removeAttributeNS(n,"style-name");0===l.textNode.length&&
l.textNode.parentNode.removeChild(l.textNode);g.emit(ops.OdtDocument.signalStepsInserted,{position:a});A&&c&&(g.moveCursor(m,a+1,0),g.emit(ops.Document.signalCursorMoved,A));g.fixCursorPositions();g.getOdfCanvas().refreshSize();g.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:r,memberId:m,timeStamp:d});g.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:q,memberId:m,timeStamp:d});g.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"SplitParagraph",
memberid:m,timestamp:d,position:a,sourceParagraphPosition:g,paragraphStyleName:h,moveCursor:c}}};ops.OpSplitParagraph.Spec;ops.OpSplitParagraph.InitSpec;
ops.OpUpdateMember=function(){function m(c){var f="//dc:creator[@editinfo:memberid='"+d+"']";c=xmldom.XPath.getODFElementsWithXPath(c.getRootNode(),f,function(a){return"editinfo"===a?"urn:webodf:names:editinfo":odf.Namespaces.lookupNamespaceURI(a)});for(f=0;f<c.length;f+=1)c[f].textContent=a.fullName}var d,g,a,c;this.init=function(h){d=h.memberid;g=parseInt(h.timestamp,10);a=h.setProperties;c=h.removedProperties};this.isEdit=!1;this.group=void 0;this.execute=function(h){var f=h.getMember(d);if(!f)return!1;
c&&f.removeProperties(c);a&&(f.setProperties(a),a.fullName&&m(h));h.emit(ops.Document.signalMemberUpdated,f);return!0};this.spec=function(){return{optype:"UpdateMember",memberid:d,timestamp:g,setProperties:a,removedProperties:c}}};ops.OpUpdateMember.Spec;ops.OpUpdateMember.InitSpec;
ops.OpUpdateMetadata=function(){var m,d,g,a;this.init=function(c){m=c.memberid;d=parseInt(c.timestamp,10);g=c.setProperties;a=c.removedProperties};this.isEdit=!0;this.group=void 0;this.execute=function(c){c=c.getOdfCanvas().odfContainer();var d=null;a&&(d=a.attributes.split(","));c.setMetadata(g,d);return!0};this.spec=function(){return{optype:"UpdateMetadata",memberid:m,timestamp:d,setProperties:g,removedProperties:a}}};ops.OpUpdateMetadata.Spec;ops.OpUpdateMetadata.InitSpec;
ops.OpUpdateParagraphStyle=function(){function m(a,c){var d,f,b=c?c.split(","):[];for(d=0;d<b.length;d+=1)f=b[d].split(":"),a.removeAttributeNS(odf.Namespaces.lookupNamespaceURI(f[0]),f[1])}var d,g,a,c,h,f=odf.Namespaces.stylens;this.init=function(f){d=f.memberid;g=f.timestamp;a=f.styleName;c=f.setProperties;h=f.removedProperties};this.isEdit=!0;this.group=void 0;this.execute=function(d){var g=d.getFormatting(),l,r,b;return(l=""!==a?g.getStyleElement(a,"paragraph"):g.getDefaultStyleElement("paragraph"))?
(r=l.getElementsByTagNameNS(f,"paragraph-properties").item(0),b=l.getElementsByTagNameNS(f,"text-properties").item(0),c&&g.updateStyle(l,c),h&&(g=h["style:paragraph-properties"],r&&g&&(m(r,g.attributes),0===r.attributes.length&&l.removeChild(r)),g=h["style:text-properties"],b&&g&&(m(b,g.attributes),0===b.attributes.length&&l.removeChild(b)),m(l,h.attributes)),d.getOdfCanvas().refreshCSS(),d.emit(ops.OdtDocument.signalParagraphStyleModified,a),d.getOdfCanvas().rerenderAnnotations(),!0):!1};this.spec=
function(){return{optype:"UpdateParagraphStyle",memberid:d,timestamp:g,styleName:a,setProperties:c,removedProperties:h}}};ops.OpUpdateParagraphStyle.Spec;ops.OpUpdateParagraphStyle.InitSpec;
ops.OperationFactory=function(){function m(d){return function(a){return new d}}var d;this.register=function(g,a){d[g]=a};this.create=function(g){var a=null,c=d[g.optype];c&&(a=c(g),a.init(g));return a};d={AddMember:m(ops.OpAddMember),UpdateMember:m(ops.OpUpdateMember),RemoveMember:m(ops.OpRemoveMember),AddCursor:m(ops.OpAddCursor),ApplyDirectStyling:m(ops.OpApplyDirectStyling),SetBlob:m(ops.OpSetBlob),RemoveBlob:m(ops.OpRemoveBlob),InsertImage:m(ops.OpInsertImage),InsertTable:m(ops.OpInsertTable),
InsertText:m(ops.OpInsertText),RemoveText:m(ops.OpRemoveText),MergeParagraph:m(ops.OpMergeParagraph),SplitParagraph:m(ops.OpSplitParagraph),SetParagraphStyle:m(ops.OpSetParagraphStyle),UpdateParagraphStyle:m(ops.OpUpdateParagraphStyle),AddStyle:m(ops.OpAddStyle),RemoveStyle:m(ops.OpRemoveStyle),MoveCursor:m(ops.OpMoveCursor),RemoveCursor:m(ops.OpRemoveCursor),AddAnnotation:m(ops.OpAddAnnotation),RemoveAnnotation:m(ops.OpRemoveAnnotation),UpdateMetadata:m(ops.OpUpdateMetadata),ApplyHyperlink:m(ops.OpApplyHyperlink),
RemoveHyperlink:m(ops.OpRemoveHyperlink)}};ops.OperationFactory.SpecConstructor;ops.OperationRouter=function(){};ops.OperationRouter.prototype.setOperationFactory=function(m){};ops.OperationRouter.prototype.setPlaybackFunction=function(m){};ops.OperationRouter.prototype.push=function(m){};ops.OperationRouter.prototype.close=function(m){};ops.OperationRouter.prototype.subscribe=function(m,d){};ops.OperationRouter.prototype.unsubscribe=function(m,d){};
ops.OperationRouter.prototype.hasLocalUnsyncedOps=function(){};ops.OperationRouter.prototype.hasSessionHostConnection=function(){};ops.OperationRouter.signalProcessingBatchStart="router/batchstart";ops.OperationRouter.signalProcessingBatchEnd="router/batchend";
ops.TrivialOperationRouter=function(){var m=new core.EventNotifier([ops.OperationRouter.signalProcessingBatchStart,ops.OperationRouter.signalProcessingBatchEnd]),d,g,a=0;this.setOperationFactory=function(a){d=a};this.setPlaybackFunction=function(a){g=a};this.push=function(c){a+=1;m.emit(ops.OperationRouter.signalProcessingBatchStart,{});c.forEach(function(c){c=c.spec();c.timestamp=Date.now();c=d.create(c);c.group="g"+a;g(c)});m.emit(ops.OperationRouter.signalProcessingBatchEnd,{})};this.close=function(a){a()};
this.subscribe=function(a,d){m.subscribe(a,d)};this.unsubscribe=function(a,d){m.unsubscribe(a,d)};this.hasLocalUnsyncedOps=function(){return!1};this.hasSessionHostConnection=function(){return!0}};
ops.Session=function(m){function d(a){c.emit(ops.OdtDocument.signalProcessingBatchStart,a)}function g(a){c.emit(ops.OdtDocument.signalProcessingBatchEnd,a)}var a=new ops.OperationFactory,c=new ops.OdtDocument(m),h=null;this.setOperationFactory=function(c){a=c;h&&h.setOperationFactory(a)};this.setOperationRouter=function(f){h&&(h.unsubscribe(ops.OperationRouter.signalProcessingBatchStart,d),h.unsubscribe(ops.OperationRouter.signalProcessingBatchEnd,g));h=f;h.subscribe(ops.OperationRouter.signalProcessingBatchStart,
d);h.subscribe(ops.OperationRouter.signalProcessingBatchEnd,g);f.setPlaybackFunction(function(a){c.emit(ops.OdtDocument.signalOperationStart,a);return a.execute(c)?(c.emit(ops.OdtDocument.signalOperationEnd,a),!0):!1});f.setOperationFactory(a)};this.getOperationFactory=function(){return a};this.getOdtDocument=function(){return c};this.enqueue=function(a){h.push(a)};this.close=function(a){h.close(function(d){d?a(d):c.close(a)})};this.destroy=function(a){c.destroy(a)};this.setOperationRouter(new ops.TrivialOperationRouter)};
gui.AnnotationController=function(m,d,g){function a(){var b=n.getCursor(g),b=b&&b.getNode(),a=!1;b&&(a=!r.isWithinAnnotation(b,n.getRootNode()));a!==p&&(p=a,l.emit(gui.AnnotationController.annotatableChanged,p))}function c(b){b.getMemberId()===g&&a()}function h(b){b===g&&a()}function f(b){b.getMemberId()===g&&a()}var n=m.getOdtDocument(),p=!1,l=new core.EventNotifier([gui.AnnotationController.annotatableChanged]),r=odf.OdfUtils,b=core.StepDirection.NEXT;this.isAnnotatable=function(){return p};this.addAnnotation=
function(){var b=new ops.OpAddAnnotation,a=n.getCursorSelection(g),c=a.length,a=a.position;p&&(a=0<=c?a:a+c,c=Math.abs(c),b.init({memberid:g,position:a,length:c,name:g+Date.now()}),m.enqueue([b]))};this.removeAnnotation=function(a){var c,f;c=n.getMember(g).getProperties().fullName;if(!0!==d.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)||c===r.getAnnotationCreator(a))c=n.convertDomPointToCursorStep(a,0,b),f=n.convertDomPointToCursorStep(a,a.childNodes.length),a=new ops.OpRemoveAnnotation,
a.init({memberid:g,position:c,length:f-c}),f=new ops.OpMoveCursor,f.init({memberid:g,position:0<c?c-1:c,length:0}),m.enqueue([a,f])};this.subscribe=function(b,a){l.subscribe(b,a)};this.unsubscribe=function(b,a){l.unsubscribe(b,a)};this.destroy=function(b){n.unsubscribe(ops.Document.signalCursorAdded,c);n.unsubscribe(ops.Document.signalCursorRemoved,h);n.unsubscribe(ops.Document.signalCursorMoved,f);b()};d.registerConstraint(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN);n.subscribe(ops.Document.signalCursorAdded,
c);n.subscribe(ops.Document.signalCursorRemoved,h);n.subscribe(ops.Document.signalCursorMoved,f);a()};gui.AnnotationController.annotatableChanged="annotatable/changed";
gui.Avatar=function(m,d){var g=this,a,c,h;this.setColor=function(a){c.style.borderColor=a};this.setImageUrl=function(a){g.isVisible()?c.src=a:h=a};this.isVisible=function(){return"block"===a.style.display};this.show=function(){h&&(c.src=h,h=void 0);a.style.display="block"};this.hide=function(){a.style.display="none"};this.markAsFocussed=function(c){c?a.classList.add("active"):a.classList.remove("active")};this.destroy=function(c){m.removeChild(a);c()};(function(){var f=m.ownerDocument;a=f.createElement("div");
c=f.createElement("img");a.appendChild(c);a.style.display=d?"block":"none";a.className="handle";m.appendChild(a)})()};gui.StepInfo=function(){};gui.StepInfo.VisualDirection={LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1};gui.StepInfo.prototype.token;gui.StepInfo.prototype.container=function(){};gui.StepInfo.prototype.offset=function(){};gui.StepInfo.prototype.direction;gui.StepInfo.prototype.visualDirection;gui.VisualStepScanner=function(){};gui.VisualStepScanner.prototype.token;
gui.VisualStepScanner.prototype.process=function(m,d,g){};
gui.GuiStepUtils=function(){function m(c){c=g.getContentBounds(c);var f,h=null;if(c)if(c.container.nodeType===Node.TEXT_NODE)f=c.container.ownerDocument.createRange(),f.setStart(c.container,c.startOffset),f.setEnd(c.container,c.endOffset),(h=0<f.getClientRects().length?f.getBoundingClientRect():null)&&" "===c.container.data.substring(c.startOffset,c.endOffset)&&1>=h.width&&(h=null),f.detach();else if(d.isCharacterElement(c.container)||d.isCharacterFrame(c.container))h=a.getBoundingClientRect(c.container);
return h}var d=odf.OdfUtils,g=new odf.StepUtils,a=core.DomUtils,c=core.StepDirection.NEXT,h=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT,f=gui.StepInfo.VisualDirection.RIGHT_TO_LEFT;this.getContentRect=m;this.moveToFilteredStep=function(a,d,l){function g(b,a){a.process(t,q,x)&&(b=!0,!A&&a.token&&(A=a.token));return b}var b=d===c,e,k,q,x,A,v=a.snapshot();e=!1;var t;do e=m(a),t={token:a.snapshot(),container:a.container,offset:a.offset,direction:d,visualDirection:d===c?h:f},k=a.nextStep()?m(a):null,a.restore(t.token),
b?(q=e,x=k):(q=k,x=e),e=l.reduce(g,!1);while(!e&&a.advanceStep(d));e||l.forEach(function(b){!A&&b.token&&(A=b.token)});a.restore(A||v);return Boolean(A)}};
gui.Caret=function(m,d,g,a){function c(){b.style.opacity="0"===b.style.opacity?"1":"0";w.trigger()}function h(){x.selectNodeContents(q);return x.getBoundingClientRect()}function f(b){return s[b]!==H[b]}function n(){Object.keys(H).forEach(function(b){s[b]=H[b]})}function p(){if(!1===H.isShown||m.getSelectionType()!==ops.OdtCursor.RangeSelection||!a&&!m.getSelectedRange().collapsed)H.visibility="hidden",b.style.visibility="hidden",w.cancel();else if(H.visibility="visible",b.style.visibility="visible",
!1===H.isFocused)b.style.opacity="1",w.cancel();else{if(D||f("visibility"))b.style.opacity="1",w.cancel();w.trigger()}if(C||F){var c;c=m.getNode();var l,g,s=v.getBoundingClientRect(A.getSizer()),q=!1,u=0;c.removeAttributeNS("urn:webodf:names:cursor","caret-sizer-active");if(0<c.getClientRects().length)g=h(),u=g.left-v.getBoundingClientRect(c).left,q=!0;else if(B.setPosition(c,0),g=t.getContentRect(B),!g&&B.nextStep()&&(l=t.getContentRect(B))&&(g=l,q=!0),g||(c.setAttributeNS("urn:webodf:names:cursor",
"caret-sizer-active","true"),g=h(),q=!0),!g)for(runtime.log("WARN: No suitable client rectangle found for visual caret for "+m.getMemberId());c;){if(0<c.getClientRects().length){g=v.getBoundingClientRect(c);q=!0;break}c=c.parentNode}g=v.translateRect(g,s,A.getZoomLevel());c={top:g.top,height:g.height,right:q?g.left:g.right,width:v.adaptRangeDifferenceToZoomLevel(u,A.getZoomLevel())};8>c.height&&(c={top:c.top-(8-c.height)/2,height:8,right:c.right});r.style.height=c.height+"px";r.style.top=c.top+"px";
r.style.left=c.right-c.width+"px";r.style.width=c.width?c.width+"px":"";k&&(c=runtime.getWindow().getComputedStyle(m.getNode(),null),c.font?k.style.font=c.font:(k.style.fontStyle=c.fontStyle,k.style.fontVariant=c.fontVariant,k.style.fontWeight=c.fontWeight,k.style.fontSize=c.fontSize,k.style.lineHeight=c.lineHeight,k.style.fontFamily=c.fontFamily))}H.isShown&&F&&d.scrollIntoView(b.getBoundingClientRect());f("isFocused")&&e.markAsFocussed(H.isFocused);n();C=F=D=!1}function l(b){r.parentNode.removeChild(r);
q.parentNode.removeChild(q);b()}var r,b,e,k,q,x,A=m.getDocument().getCanvas(),v=core.DomUtils,t=new gui.GuiStepUtils,B,u,w,D=!1,F=!1,C=!1,H={isFocused:!1,isShown:!0,visibility:"hidden"},s={isFocused:!H.isFocused,isShown:!H.isShown,visibility:"hidden"};this.handleUpdate=function(){C=!0;u.trigger()};this.refreshCursorBlinking=function(){D=!0;u.trigger()};this.setFocus=function(){H.isFocused=!0;u.trigger()};this.removeFocus=function(){H.isFocused=!1;u.trigger()};this.show=function(){H.isShown=!0;u.trigger()};
this.hide=function(){H.isShown=!1;u.trigger()};this.setAvatarImageUrl=function(b){e.setImageUrl(b)};this.setColor=function(a){b.style.borderColor=a;e.setColor(a)};this.getCursor=function(){return m};this.getFocusElement=function(){return b};this.toggleHandleVisibility=function(){e.isVisible()?e.hide():e.show()};this.showHandle=function(){e.show()};this.hideHandle=function(){e.hide()};this.setOverlayElement=function(b){k=b;r.appendChild(b);C=!0;u.trigger()};this.ensureVisible=function(){F=!0;u.trigger()};
this.getBoundingClientRect=function(){return v.getBoundingClientRect(r)};this.destroy=function(b){core.Async.destroyAll([u.destroy,w.destroy,e.destroy,l],b)};(function(){var a=m.getDocument(),d=[a.createRootFilter(m.getMemberId()),a.getPositionFilter()],f=a.getDOMDocument();x=f.createRange();q=f.createElement("span");q.className="webodf-caretSizer";q.textContent="|";m.getNode().appendChild(q);r=f.createElement("div");r.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",m.getMemberId());
r.className="webodf-caretOverlay";b=f.createElement("div");b.className="caret";r.appendChild(b);e=new gui.Avatar(r,g);A.getSizer().appendChild(r);B=a.createStepIterator(m.getNode(),0,d,a.getRootNode());u=core.Task.createRedrawTask(p);w=core.Task.createTimeoutTask(c,500);u.triggerImmediate()})()};
odf.TextSerializer=function(){function m(a){var c="",h=d.filter?d.filter.acceptNode(a):NodeFilter.FILTER_ACCEPT,f=a.nodeType,n;if((h===NodeFilter.FILTER_ACCEPT||h===NodeFilter.FILTER_SKIP)&&g.isTextContentContainingNode(a))for(n=a.firstChild;n;)c+=m(n),n=n.nextSibling;h===NodeFilter.FILTER_ACCEPT&&(f===Node.ELEMENT_NODE&&g.isParagraph(a)?c+="\n":f===Node.TEXT_NODE&&a.textContent&&(c+=a.textContent));return c}var d=this,g=odf.OdfUtils;this.filter=null;this.writeToString=function(a){if(!a)return"";
a=m(a);"\n"===a[a.length-1]&&(a=a.substr(0,a.length-1));return a}};gui.MimeDataExporter=function(){var m;this.exportRangeToDataTransfer=function(d,g){var a;a=g.startContainer.ownerDocument.createElement("span");a.appendChild(g.cloneContents());a=m.writeToString(a);try{d.setData("text/plain",a)}catch(c){d.setData("Text",a)}};m=new odf.TextSerializer;m.filter=new odf.OdfNodeFilter};
gui.Clipboard=function(m){this.setDataFromRange=function(d,g){var a,c=d.clipboardData;a=runtime.getWindow();!c&&a&&(c=a.clipboardData);c?(a=!0,m.exportRangeToDataTransfer(c,g),d.preventDefault()):a=!1;return a}};
gui.SessionContext=function(m,d){var g=m.getOdtDocument(),a=odf.OdfUtils;this.isLocalCursorWithinOwnAnnotation=function(){var c=g.getCursor(d),h;if(!c)return!1;h=c&&c.getNode();c=g.getMember(d).getProperties().fullName;return(h=a.getParentAnnotation(h,g.getRootNode()))&&a.getAnnotationCreator(h)===c?!0:!1}};
gui.StyleSummary=function(m){function d(a,d){var g=a+"|"+d,p;c.hasOwnProperty(g)||(p=[],m.forEach(function(c){c=(c=c.styleProperties[a])&&c[d];-1===p.indexOf(c)&&p.push(c)}),c[g]=p);return c[g]}function g(a,c,g){return function(){var m=d(a,c);return g.length>=m.length&&m.every(function(a){return-1!==g.indexOf(a)})}}function a(a,c){var g=d(a,c);return 1===g.length?g[0]:void 0}var c={};this.getPropertyValues=d;this.getCommonValue=a;this.isBold=g("style:text-properties","fo:font-weight",["bold"]);this.isItalic=
g("style:text-properties","fo:font-style",["italic"]);this.hasUnderline=g("style:text-properties","style:text-underline-style",["solid"]);this.hasStrikeThrough=g("style:text-properties","style:text-line-through-style",["solid"]);this.fontSize=function(){var c=a("style:text-properties","fo:font-size");return c&&parseFloat(c)};this.fontName=function(){return a("style:text-properties","style:font-name")};this.isAlignedLeft=g("style:paragraph-properties","fo:text-align",["left","start"]);this.isAlignedCenter=
g("style:paragraph-properties","fo:text-align",["center"]);this.isAlignedRight=g("style:paragraph-properties","fo:text-align",["right","end"]);this.isAlignedJustified=g("style:paragraph-properties","fo:text-align",["justify"]);this.text={isBold:this.isBold,isItalic:this.isItalic,hasUnderline:this.hasUnderline,hasStrikeThrough:this.hasStrikeThrough,fontSize:this.fontSize,fontName:this.fontName};this.paragraph={isAlignedLeft:this.isAlignedLeft,isAlignedCenter:this.isAlignedCenter,isAlignedRight:this.isAlignedRight,
isAlignedJustified:this.isAlignedJustified}};
gui.DirectFormattingController=function(m,d,g,a,c,h,f){function n(){return Y.value().styleSummary}function p(){return Y.value().enabledFeatures}function l(b){var a;b.collapsed?(a=b.startContainer,a.hasChildNodes()&&b.startOffset<a.childNodes.length&&(a=a.childNodes.item(b.startOffset)),b=[a]):b=W.getTextElements(b,!0,!1);return b}function r(){var b=K.getCursor(a),e=b&&b.getSelectedRange(),c=[],c=[],f=!0,k={directTextStyling:!0,directParagraphStyling:!0};e&&(c=l(e),0===c.length&&(c=[e.startContainer,
e.endContainer],f=!1),c=K.getFormatting().getAppliedStyles(c));void 0!==c[0]&&ca&&(c[0].styleProperties=G.mergeObjects(c[0].styleProperties,ca));!0===d.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(k.directTextStyling=k.directParagraphStyling=g.isLocalCursorWithinOwnAnnotation());k.directTextStyling&&(k.directTextStyling=f&&void 0!==b&&b.getSelectionType()===ops.OdtCursor.RangeSelection);return{enabledFeatures:k,appliedStyles:c,styleSummary:new gui.StyleSummary(c)}}function b(b,a){var e={};Object.keys(b).forEach(function(c){var d=
b[c](),f=a[c]();d!==f&&(e[c]=f)});return e}function e(){var a,e;e=L.styleSummary;var c=Y.value(),d=c.styleSummary,f=L.enabledFeatures,k=c.enabledFeatures;a=b(e.text,d.text);e=b(e.paragraph,d.paragraph);f=!(k.directTextStyling===f.directTextStyling&&k.directParagraphStyling===f.directParagraphStyling);L=c;f&&P.emit(gui.DirectFormattingController.enabledChanged,k);0<Object.keys(a).length&&P.emit(gui.DirectFormattingController.textStylingChanged,a);0<Object.keys(e).length&&P.emit(gui.DirectFormattingController.paragraphStylingChanged,
e)}function k(){Y.reset();e()}function q(b){("string"===typeof b?b:b.getMemberId())===a&&Y.reset()}function x(){Y.reset()}function A(b){var e=K.getCursor(a);b=b.paragraphElement;e&&W.getParagraphElement(e.getNode())===b&&Y.reset()}function v(b,a){a(!b());return!0}function t(b){if(p().directTextStyling){var e=K.getCursorSelection(a),c={"style:text-properties":b};0!==e.length?(b=new ops.OpApplyDirectStyling,b.init({memberid:a,position:e.position,length:e.length,setProperties:c}),m.enqueue([b])):(ca=
G.mergeObjects(ca||{},c),Y.reset())}}function B(b,a){var e={};e[b]=a;t(e)}function u(b){b=b.spec();ca&&b.memberid===a&&"SplitParagraph"!==b.optype&&(ca=null,Y.reset())}function w(b){B("fo:font-weight",b?"bold":"normal")}function D(b){B("fo:font-style",b?"italic":"normal")}function F(b){B("style:text-underline-style",b?"solid":"none")}function C(b){B("style:text-line-through-style",b?"solid":"none")}function H(b){if(p().directParagraphStyling){var e=K.getCursor(a).getSelectedRange(),e=W.getParagraphElements(e),
d=K.getFormatting(),f=[],k={},h;e.forEach(function(e){var l=K.convertDomPointToCursorStep(e,0,ba),g=e.getAttributeNS(odf.Namespaces.textns,"style-name"),s;e=g?k.hasOwnProperty(g)?k[g]:void 0:h;e||(e=c.generateStyleName(),g?(k[g]=e,s=d.createDerivedStyleObject(g,"paragraph",{})):(h=e,s={}),s=b(s),g=new ops.OpAddStyle,g.init({memberid:a,styleName:e.toString(),styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:s}),f.push(g));g=new ops.OpSetParagraphStyle;g.init({memberid:a,styleName:e.toString(),
position:l});f.push(g)});m.enqueue(f)}}function s(b){H(function(a){return G.mergeObjects(a,b)})}function z(b){s({"style:paragraph-properties":{"fo:text-align":b}})}function y(b,a){var e=K.getFormatting().getDefaultTabStopDistance(),c=a["style:paragraph-properties"],d;c&&(c=c["fo:margin-left"],d=W.parseLength(c));return G.mergeObjects(a,{"style:paragraph-properties":{"fo:margin-left":d&&d.unit===e.unit?d.value+b*e.value+d.unit:b*e.value+e.unit}})}function M(b,a){var e=l(b),e=0===e.length?[b.startContainer]:
e,e=K.getFormatting().getAppliedStyles(e),c=0<e.length?e[0].styleProperties:void 0,d=K.getFormatting().getAppliedStylesForElement(a).styleProperties;if(!c||"text"!==c["style:family"]||!c["style:text-properties"])return!1;if(!d||!d["style:text-properties"])return!0;c=c["style:text-properties"];d=d["style:text-properties"];return!Object.keys(c).every(function(b){return c[b]===d[b]})}function E(){}function I(){return!1}var J=this,K=m.getOdtDocument(),G=new core.Utils,W=odf.OdfUtils,P=new core.EventNotifier([gui.DirectFormattingController.enabledChanged,
gui.DirectFormattingController.textStylingChanged,gui.DirectFormattingController.paragraphStylingChanged]),R=odf.Namespaces.textns,ba=core.StepDirection.NEXT,ca=null,L,Y;this.enabledFeatures=p;this.formatTextSelection=t;this.createCursorStyleOp=function(b,e,c){var d=null,f=ca;c&&(f=(c=Y.value().appliedStyles[0])&&c.styleProperties);f&&f["style:text-properties"]&&(d=new ops.OpApplyDirectStyling,d.init({memberid:a,position:b,length:e,setProperties:{"style:text-properties":f["style:text-properties"]}}),
ca=null,Y.reset());return d};this.setBold=w;this.setItalic=D;this.setHasUnderline=F;this.setHasStrikethrough=C;this.setFontSize=function(b){B("fo:font-size",b+"pt")};this.setFontName=function(b){B("style:font-name",b)};this.getAppliedStyles=function(){return Y.value().appliedStyles};this.toggleBold=v.bind(J,function(){return n().isBold()},w);this.toggleItalic=v.bind(J,function(){return n().isItalic()},D);this.toggleUnderline=v.bind(J,function(){return n().hasUnderline()},F);this.toggleStrikethrough=
v.bind(J,function(){return n().hasStrikeThrough()},C);this.isBold=function(){return n().isBold()};this.isItalic=function(){return n().isItalic()};this.hasUnderline=function(){return n().hasUnderline()};this.hasStrikeThrough=function(){return n().hasStrikeThrough()};this.fontSize=function(){return n().fontSize()};this.fontName=function(){return n().fontName()};this.isAlignedLeft=function(){return n().isAlignedLeft()};this.isAlignedCenter=function(){return n().isAlignedCenter()};this.isAlignedRight=
function(){return n().isAlignedRight()};this.isAlignedJustified=function(){return n().isAlignedJustified()};this.alignParagraphLeft=function(){z("left");return!0};this.alignParagraphCenter=function(){z("center");return!0};this.alignParagraphRight=function(){z("right");return!0};this.alignParagraphJustified=function(){z("justify");return!0};this.indent=function(){H(y.bind(null,1));return!0};this.outdent=function(){H(y.bind(null,-1));return!0};this.createParagraphStyleOps=function(b){if(!p().directParagraphStyling)return[];
var e=K.getCursor(a),d=e.getSelectedRange(),f=[],k,h;e.hasForwardSelection()?(k=e.getAnchorNode(),h=e.getNode()):(k=e.getNode(),h=e.getAnchorNode());e=W.getParagraphElement(h);runtime.assert(Boolean(e),"DirectFormattingController: Cursor outside paragraph");var l=e,g=[K.getPositionFilter(),K.createRootFilter(a)];if(!1!==K.createStepIterator(d.endContainer,d.endOffset,g,l).nextStep())return f;h!==k&&(e=W.getParagraphElement(k));if(!ca&&!M(d,e))return f;d=(d=Y.value().appliedStyles[0])&&d.styleProperties;
if(!d)return f;if(e=e.getAttributeNS(R,"style-name"))d={"style:text-properties":d["style:text-properties"]},d=K.getFormatting().createDerivedStyleObject(e,"paragraph",d);k=c.generateStyleName();e=new ops.OpAddStyle;e.init({memberid:a,styleName:k,styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:d});f.push(e);e=new ops.OpSetParagraphStyle;e.init({memberid:a,styleName:k,position:b});f.push(e);return f};this.subscribe=function(b,a){P.subscribe(b,a)};this.unsubscribe=function(b,a){P.unsubscribe(b,
a)};this.destroy=function(b){K.unsubscribe(ops.Document.signalCursorAdded,q);K.unsubscribe(ops.Document.signalCursorRemoved,q);K.unsubscribe(ops.Document.signalCursorMoved,q);K.unsubscribe(ops.OdtDocument.signalParagraphStyleModified,x);K.unsubscribe(ops.OdtDocument.signalParagraphChanged,A);K.unsubscribe(ops.OdtDocument.signalOperationEnd,u);K.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,e);d.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,k);b()};(function(){K.subscribe(ops.Document.signalCursorAdded,
q);K.subscribe(ops.Document.signalCursorRemoved,q);K.subscribe(ops.Document.signalCursorMoved,q);K.subscribe(ops.OdtDocument.signalParagraphStyleModified,x);K.subscribe(ops.OdtDocument.signalParagraphChanged,A);K.subscribe(ops.OdtDocument.signalOperationEnd,u);K.subscribe(ops.OdtDocument.signalProcessingBatchEnd,e);d.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,k);Y=new core.LazyProperty(r);L=Y.value();h||(J.formatTextSelection=E,J.setBold=E,J.setItalic=E,J.setHasUnderline=E,J.setHasStrikethrough=
E,J.setFontSize=E,J.setFontName=E,J.toggleBold=I,J.toggleItalic=I,J.toggleUnderline=I,J.toggleStrikethrough=I);f||(J.alignParagraphCenter=E,J.alignParagraphJustified=E,J.alignParagraphLeft=E,J.alignParagraphRight=E,J.createParagraphStyleOps=function(){return[]},J.indent=E,J.outdent=E)})()};gui.DirectFormattingController.enabledChanged="enabled/changed";gui.DirectFormattingController.textStylingChanged="textStyling/changed";gui.DirectFormattingController.paragraphStylingChanged="paragraphStyling/changed";
gui.DirectFormattingController.SelectionInfo=function(){this.enabledFeatures;this.appliedStyles;this.styleSummary};
gui.KeyboardHandler=function(){function m(a,h){h||(h=d.None);switch(a){case gui.KeyboardHandler.KeyCode.LeftMeta:case gui.KeyboardHandler.KeyCode.RightMeta:case gui.KeyboardHandler.KeyCode.MetaInMozilla:h|=d.Meta;break;case gui.KeyboardHandler.KeyCode.Ctrl:h|=d.Ctrl;break;case gui.KeyboardHandler.KeyCode.Alt:h|=d.Alt;break;case gui.KeyboardHandler.KeyCode.Shift:h|=d.Shift}return a+":"+h}var d=gui.KeyboardHandler.Modifier,g=null,a={};this.setDefault=function(a){g=a};this.bind=function(c,d,f,g){c=m(c,
d);runtime.assert(g||!1===a.hasOwnProperty(c),"tried to overwrite the callback handler of key combo: "+c);a[c]=f};this.unbind=function(c,d){var f=m(c,d);delete a[f]};this.reset=function(){g=null;a={}};this.handleEvent=function(c){var h=c.keyCode,f=d.None;c.metaKey&&(f|=d.Meta);c.ctrlKey&&(f|=d.Ctrl);c.altKey&&(f|=d.Alt);c.shiftKey&&(f|=d.Shift);h=m(h,f);h=a[h];f=!1;h?f=h():null!==g&&(f=g(c));f&&(c.preventDefault?c.preventDefault():c.returnValue=!1)}};
gui.KeyboardHandler.Modifier={None:0,Meta:1,Ctrl:2,Alt:4,CtrlAlt:6,Shift:8,MetaShift:9,CtrlShift:10,AltShift:12};gui.KeyboardHandler.KeyCode={Backspace:8,Tab:9,Clear:12,Enter:13,Shift:16,Ctrl:17,Alt:18,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Delete:46,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LeftMeta:91,RightMeta:93,MetaInMozilla:224};
gui.HyperlinkClickHandler=function(m,d,g){function a(a){for(;null!==a;){if(b.isHyperlink(a))return a;if(b.isParagraph(a))break;a=a.parentNode}return null}function c(){var b=m();runtime.assert(Boolean(b.classList),"Document container has no classList element");b.classList.remove("webodf-inactiveLinks")}function h(){var b=m();runtime.assert(Boolean(b.classList),"Document container has no classList element");b.classList.add("webodf-inactiveLinks")}function f(){e.removeEventListener("focus",h,!1);q.forEach(function(b){d.unbind(b.keyCode,
b.modifier);g.unbind(b.keyCode,b.modifier)});q.length=0}function n(b){f();if(b!==p.None){e.addEventListener("focus",h,!1);switch(b){case p.Ctrl:q.push({keyCode:l.Ctrl,modifier:p.None});break;case p.Meta:q.push({keyCode:l.LeftMeta,modifier:p.None}),q.push({keyCode:l.RightMeta,modifier:p.None}),q.push({keyCode:l.MetaInMozilla,modifier:p.None})}q.forEach(function(b){d.bind(b.keyCode,b.modifier,c);g.bind(b.keyCode,b.modifier,h)})}}var p=gui.KeyboardHandler.Modifier,l=gui.KeyboardHandler.KeyCode,r=xmldom.XPath,
b=odf.OdfUtils,e=runtime.getWindow(),k=p.None,q=[];runtime.assert(null!==e,"Expected to be run in an environment which has a global window, like a browser.");this.handleClick=function(c){var d=c.target||c.srcElement,f,h,l;c.ctrlKey?f=p.Ctrl:c.metaKey&&(f=p.Meta);if(k===p.None||k===f)if(f=a(d))h=b.getHyperlinkTarget(f),""!==h&&("#"===h[0]?(h=h.substring(1),f=m(),l=r.getODFElementsWithXPath(f,"//text:bookmark-start[@text:name='"+h+"']",odf.Namespaces.lookupNamespaceURI),0===l.length&&(l=r.getODFElementsWithXPath(f,
"//text:bookmark[@text:name='"+h+"']",odf.Namespaces.lookupNamespaceURI)),0<l.length&&(clearTimeout(clicktimer),clicktimer=setTimeout(function(){function b(a){for(var e=0;e<=historylist.length-1;e++)if(historylist[e].url==a.url)return;historylist.push(a)}b({url:"#S"+h,node:d});b({url:"#"+h,node:l[0]});history.pushState(null,null,"#S"+h);history.pushState(null,null,"#"+h);l[0].scrollIntoView(!0)},100))):e.open(h),c.preventDefault?c.preventDefault():c.returnValue=!1)};this.setModifier=function(b){k!==
b&&(runtime.assert(b===p.None||b===p.Ctrl||b===p.Meta,"Unsupported KeyboardHandler.Modifier value: "+b),k=b,k!==p.None?h():c(),n(k))};this.getModifier=function(){return k};this.destroy=function(b){h();f();b()}};
gui.EventManager=function(m){function d(b){function a(b,e,c){var d,f=!1;d="on"+e;b.attachEvent&&(b.attachEvent(d,c),f=!0);!f&&b.addEventListener&&(b.addEventListener(e,c,!1),f=!0);f&&!u[e]||!b.hasOwnProperty(d)||(b[d]=c)}function e(b,a,c){var d="on"+a;b.detachEvent&&b.detachEvent(d,c);b.removeEventListener&&b.removeEventListener(a,c,!1);b[d]===c&&(b[d]=null)}function c(a){if(-1===f.indexOf(a)){f.push(a);if(d.filters.every(function(b){return b(a)}))try{k.emit(b,a)}catch(e){runtime.log("Error occurred while processing "+
b+":\n"+e.message+"\n"+e.stack)}runtime.setTimeout(function(){f.splice(f.indexOf(a),1)},0)}}var d=this,f=[],k=new core.EventNotifier([b]);this.filters=[];this.subscribe=function(a){k.subscribe(b,a)};this.unsubscribe=function(a){k.unsubscribe(b,a)};this.destroy=function(){e(B,b,c);e(C,b,c);e(H,b,c)};w[b]&&a(B,b,c);a(C,b,c);a(H,b,c)}function g(b,a,e){function c(a){e(a,d,function(a){a.type=b;f.emit(b,a)})}var d={},f=new core.EventNotifier([b]);this.subscribe=function(a){f.subscribe(b,a)};this.unsubscribe=
function(a){f.unsubscribe(b,a)};this.destroy=function(){a.forEach(function(b){s.unsubscribe(b,c)})};(function(){a.forEach(function(b){s.subscribe(b,c)})})()}function a(b){runtime.clearTimeout(b);delete z[b]}function c(b,e){var c=runtime.setTimeout(function(){b();a(c)},e);z[c]=!0;return c}function h(b,e,d){var f=b.touches.length,k=b.touches[0],h=e.timer;"touchmove"===b.type||"touchend"===b.type?h&&a(h):"touchstart"===b.type&&(1!==f?runtime.clearTimeout(h):h=c(function(){d({clientX:k.clientX,clientY:k.clientY,
pageX:k.pageX,pageY:k.pageY,target:b.target||b.srcElement||null,detail:1})},400));e.timer=h}function f(b,a,e){var c=b.touches[0],d=b.target||b.srcElement||null,f=a.target;1!==b.touches.length||"touchend"===b.type?f=null:"touchstart"===b.type&&"webodf-draggable"===d.getAttribute("class")?f=d:"touchmove"===b.type&&f&&(b.preventDefault(),b.stopPropagation(),e({clientX:c.clientX,clientY:c.clientY,pageX:c.pageX,pageY:c.pageY,target:f,detail:1}));a.target=f}function n(b,a,e){var c=b.target||b.srcElement||
null,d=a.dragging;"drag"===b.type?d=!0:"touchend"===b.type&&d&&(d=!1,b=b.changedTouches[0],e({clientX:b.clientX,clientY:b.clientY,pageX:b.pageX,pageY:b.pageY,target:c,detail:1}));a.dragging=d}function p(){H.classList.add("webodf-touchEnabled");s.unsubscribe("touchstart",p)}function l(b){var a=b.scrollX,e=b.scrollY;this.restore=function(){b.scrollX===a&&b.scrollY===e||b.scrollTo(a,e)}}function r(b){var a=b.scrollTop,e=b.scrollLeft;this.restore=function(){if(b.scrollTop!==a||b.scrollLeft!==e)b.scrollTop=
a,b.scrollLeft=e}}function b(b,a){var e=F[b]||D[b]||null;!e&&a&&(e=F[b]=new d(b));return e}function e(a,e){b(a,!0).subscribe(e)}function k(a,e){var c=b(a,!1);c&&c.unsubscribe(e)}function q(){return m.getDOMDocument().activeElement===C}function x(){q()&&C.blur();C.setAttribute("disabled","true")}function A(){C.removeAttribute("disabled")}function v(b){for(var a=[];b;)(b.scrollWidth>b.clientWidth||b.scrollHeight>b.clientHeight)&&a.push(new r(b)),b=b.parentNode;a.push(new l(B));return a}function t(){var b;
q()||(b=v(C),A(),C.focus(),b.forEach(function(b){b.restore()}))}var B=runtime.getWindow(),u={beforecut:!0,beforepaste:!0,longpress:!0,drag:!0,dragstop:!0},w={mousedown:!0,mouseup:!0,focus:!0},D={},F={},C,H=m.getCanvas().getElement(),s=this,z={};this.addFilter=function(a,e){b(a,!0).filters.push(e)};this.removeFilter=function(a,e){var c=b(a,!0),d=c.filters.indexOf(e);-1!==d&&c.filters.splice(d,1)};this.subscribe=e;this.unsubscribe=k;this.hasFocus=q;this.focus=t;this.getEventTrap=function(){return C};
this.setEditing=function(b){var a=q();a&&C.blur();b?C.removeAttribute("readOnly"):C.setAttribute("readOnly","true");a&&t()};this.destroy=function(b){k("touchstart",p);Object.keys(z).forEach(function(b){a(parseInt(b,10))});z.length=0;Object.keys(D).forEach(function(b){D[b].destroy()});D={};k("mousedown",x);k("mouseup",A);k("contextmenu",A);Object.keys(F).forEach(function(b){F[b].destroy()});F={};C.parentNode.removeChild(C);b()};(function(){var b=m.getOdfCanvas().getSizer(),a=b.ownerDocument;runtime.assert(Boolean(B),
"EventManager requires a window object to operate correctly");C=a.createElement("textarea");C.id="eventTrap";C.setAttribute("tabindex","-1");C.setAttribute("readOnly","true");C.setAttribute("rows","1");b.appendChild(C);e("mousedown",x);e("mouseup",A);e("contextmenu",A);D.longpress=new g("longpress",["touchstart","touchmove","touchend"],h);D.drag=new g("drag",["touchstart","touchmove","touchend"],f);D.dragstop=new g("dragstop",["drag","touchend"],n);e("touchstart",p)})()};
gui.IOSSafariSupport=function(m){function d(){g.innerHeight!==g.outerHeight&&(a.style.display="none",runtime.requestAnimationFrame(function(){a.style.display="block"}))}var g=runtime.getWindow(),a=m.getEventTrap();this.destroy=function(c){m.unsubscribe("focus",d);a.removeAttribute("autocapitalize");a.style.WebkitTransform="";c()};m.subscribe("focus",d);a.setAttribute("autocapitalize","off");a.style.WebkitTransform="translateX(-10000px)"};
gui.HyperlinkController=function(m,d,g,a){function c(){var a=!0;!0===d.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(a=g.isLocalCursorWithinOwnAnnotation());a!==l&&(l=a,p.emit(gui.HyperlinkController.enabledChanged,l))}function h(d){d.getMemberId()===a&&c()}var f=odf.OdfUtils,n=m.getOdtDocument(),p=new core.EventNotifier([gui.HyperlinkController.enabledChanged]),l=!1;this.isEnabled=function(){return l};this.subscribe=function(a,b){p.subscribe(a,b)};this.unsubscribe=function(a,b){p.unsubscribe(a,
b)};this.addHyperlink=function(c,b){if(l){var e=n.getCursorSelection(a),d=new ops.OpApplyHyperlink,f=[];if(0===e.length||b)b=b||c,d=new ops.OpInsertText,d.init({memberid:a,position:e.position,text:b}),e.length=b.length,f.push(d);d=new ops.OpApplyHyperlink;d.init({memberid:a,position:e.position,length:e.length,hyperlink:c});f.push(d);m.enqueue(f)}};this.removeHyperlinks=function(){if(l){var c=n.createPositionIterator(n.getRootNode()),b=n.getCursor(a).getSelectedRange(),e=f.getHyperlinkElements(b),
d=b.collapsed&&1===e.length,h=n.getDOMDocument().createRange(),g=[],p,v;0!==e.length&&(e.forEach(function(b){h.selectNodeContents(b);p=n.convertDomToCursorRange({anchorNode:h.startContainer,anchorOffset:h.startOffset,focusNode:h.endContainer,focusOffset:h.endOffset});v=new ops.OpRemoveHyperlink;v.init({memberid:a,position:p.position,length:p.length});g.push(v)}),d||(d=e[0],-1===b.comparePoint(d,0)&&(h.setStart(d,0),h.setEnd(b.startContainer,b.startOffset),p=n.convertDomToCursorRange({anchorNode:h.startContainer,
anchorOffset:h.startOffset,focusNode:h.endContainer,focusOffset:h.endOffset}),0<p.length&&(v=new ops.OpApplyHyperlink,v.init({memberid:a,position:p.position,length:p.length,hyperlink:f.getHyperlinkTarget(d)}),g.push(v))),e=e[e.length-1],c.moveToEndOfNode(e),c=c.unfilteredDomOffset(),1===b.comparePoint(e,c)&&(h.setStart(b.endContainer,b.endOffset),h.setEnd(e,c),p=n.convertDomToCursorRange({anchorNode:h.startContainer,anchorOffset:h.startOffset,focusNode:h.endContainer,focusOffset:h.endOffset}),0<p.length&&
(v=new ops.OpApplyHyperlink,v.init({memberid:a,position:p.position,length:p.length,hyperlink:f.getHyperlinkTarget(e)}),g.push(v)))),m.enqueue(g),h.detach())}};this.destroy=function(a){n.unsubscribe(ops.Document.signalCursorMoved,h);d.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);a()};n.subscribe(ops.Document.signalCursorMoved,h);d.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);c()};gui.HyperlinkController.enabledChanged="enabled/changed";
gui.ImageController=function(m,d,g,a,c){function h(){var b=!0;!0===d.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(b=g.isLocalCursorWithinOwnAnnotation());b!==k&&(k=b,e.emit(gui.ImageController.enabledChanged,k))}function f(b){b.getMemberId()===a&&h()}var n={"image/gif":".gif","image/jpeg":".jpg","image/png":".png"},p=odf.Namespaces.textns,l=m.getOdtDocument(),r=odf.OdfUtils,b=l.getFormatting(),e=new core.EventNotifier([gui.HyperlinkController.enabledChanged]),k=!1;this.isEnabled=function(){return k};
this.subscribe=function(b,a){e.subscribe(b,a)};this.unsubscribe=function(b,a){e.unsubscribe(b,a)};this.insertImage=function(e,d,f,h){if(k){runtime.assert(0<f&&0<h,"Both width and height of the image should be greater than 0px.");h={width:f,height:h};if(f=r.getParagraphElement(l.getCursor(a).getNode()).getAttributeNS(p,"style-name")){f=b.getContentSize(f,"paragraph");var g=1,B=1;h.width>f.width&&(g=f.width/h.width);h.height>f.height&&(B=f.height/h.height);f=Math.min(g,B);h={width:h.width*f,height:h.height*
f}}f=h.width+"px";h=h.height+"px";var u=l.getOdfCanvas().odfContainer().rootElement.styles,g=e.toLowerCase(),B=n.hasOwnProperty(g)?n[g]:null,w,g=[];runtime.assert(null!==B,"Image type is not supported: "+e);B="Pictures/"+c.generateImageName()+B;w=new ops.OpSetBlob;w.init({memberid:a,filename:B,mimetype:e,content:d});g.push(w);b.getStyleElement("Graphics","graphic",[u])||(e=new ops.OpAddStyle,e.init({memberid:a,styleName:"Graphics",styleFamily:"graphic",isAutomaticStyle:!1,setProperties:{"style:graphic-properties":{"text:anchor-type":"paragraph",
"svg:x":"0cm","svg:y":"0cm","style:wrap":"dynamic","style:number-wrapped-paragraphs":"no-limit","style:wrap-contour":"false","style:vertical-pos":"top","style:vertical-rel":"paragraph","style:horizontal-pos":"center","style:horizontal-rel":"paragraph"}}}),g.push(e));e=c.generateStyleName();d=new ops.OpAddStyle;d.init({memberid:a,styleName:e,styleFamily:"graphic",isAutomaticStyle:!0,setProperties:{"style:parent-style-name":"Graphics","style:graphic-properties":{"style:vertical-pos":"top","style:vertical-rel":"baseline",
"style:horizontal-pos":"center","style:horizontal-rel":"paragraph","fo:background-color":"transparent","style:background-transparency":"100%","style:shadow":"none","style:mirror":"none","fo:clip":"rect(0cm, 0cm, 0cm, 0cm)","draw:luminance":"0%","draw:contrast":"0%","draw:red":"0%","draw:green":"0%","draw:blue":"0%","draw:gamma":"100%","draw:color-inversion":"false","draw:image-opacity":"100%","draw:color-mode":"standard"}}});g.push(d);w=new ops.OpInsertImage;w.init({memberid:a,position:l.getCursorPosition(a),
filename:B,frameWidth:f,frameHeight:h,frameStyleName:e,frameName:c.generateFrameName()});g.push(w);m.enqueue(g)}};this.destroy=function(b){l.unsubscribe(ops.Document.signalCursorMoved,f);d.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,h);b()};l.subscribe(ops.Document.signalCursorMoved,f);d.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,h);h()};gui.ImageController.enabledChanged="enabled/changed";
gui.ImageSelector=function(m){function d(){var d=m.getSizer(),h=c.createElement("div");h.id="imageSelector";h.style.borderWidth="1px";d.appendChild(h);a.forEach(function(a){var d=c.createElement("div");d.className=a;h.appendChild(d)});return h}var g=odf.Namespaces.svgns,a="topLeft topRight bottomRight bottomLeft topMiddle rightMiddle bottomMiddle leftMiddle".split(" "),c=m.getElement().ownerDocument,h=!1;this.select=function(a){var n,p,l=c.getElementById("imageSelector");l||(l=d());h=!0;n=l.parentNode;
p=a.getBoundingClientRect();var r=n.getBoundingClientRect(),b=m.getZoomLevel();n=(p.left-r.left)/b-1;p=(p.top-r.top)/b-1;l.style.display="block";l.style.left=n+"px";l.style.top=p+"px";l.style.width=a.getAttributeNS(g,"width");l.style.height=a.getAttributeNS(g,"height")};this.clearSelection=function(){var a;h&&(a=c.getElementById("imageSelector"))&&(a.style.display="none");h=!1};this.isSelectorElement=function(a){var d=c.getElementById("imageSelector");return d?a===d||a.parentNode===d:!1}};
(function(){function m(d){function g(a){f=a.which&&String.fromCharCode(a.which)===h;h=void 0;return!1===f}function a(){f=!1}function c(a){h=a.data;f=!1}var h,f=!1;this.destroy=function(f){d.unsubscribe("textInput",a);d.unsubscribe("compositionend",c);d.removeFilter("keypress",g);f()};d.subscribe("textInput",a);d.subscribe("compositionend",c);d.addFilter("keypress",g)}gui.InputMethodEditor=function(d,g){function a(a){b&&(a?b.getNode().setAttributeNS("urn:webodf:names:cursor","composing","true"):(b.getNode().removeAttributeNS("urn:webodf:names:cursor",
"composing"),q.textContent=""))}function c(){A&&(A=!1,a(!1),t.emit(gui.InputMethodEditor.signalCompositionEnd,{data:v}),v="")}function h(){F||(F=!0,c(),b&&b.getSelectedRange().collapsed?e.value="":e.value=u.writeToString(b.getSelectedRange().cloneContents()),e.setSelectionRange(0,e.value.length),F=!1)}function f(){g.hasFocus()&&x.trigger()}function n(){B=void 0;x.cancel();a(!0);A||t.emit(gui.InputMethodEditor.signalCompositionStart,{data:""})}function p(b){b=B=b.data;A=!0;v+=b;x.trigger()}function l(b){b.data!==
B&&(b=b.data,A=!0,v+=b,x.trigger());B=void 0}function r(){q.textContent=e.value}var b=null,e=g.getEventTrap(),k=e.ownerDocument,q,x,A=!1,v="",t=new core.EventNotifier([gui.InputMethodEditor.signalCompositionStart,gui.InputMethodEditor.signalCompositionEnd]),B,u,w=[],D,F=!1;this.subscribe=t.subscribe;this.unsubscribe=t.unsubscribe;this.registerCursor=function(a){a.getMemberId()===d&&(b=a,b.getNode().appendChild(q),a.subscribe(ops.OdtCursor.signalCursorUpdated,f),g.subscribe("input",r),g.subscribe("compositionupdate",
r))};this.removeCursor=function(a){b&&a===d&&(b.getNode().removeChild(q),b.unsubscribe(ops.OdtCursor.signalCursorUpdated,f),g.unsubscribe("input",r),g.unsubscribe("compositionupdate",r),b=null)};this.destroy=function(b){g.unsubscribe("compositionstart",n);g.unsubscribe("compositionend",p);g.unsubscribe("textInput",l);g.unsubscribe("keypress",c);g.unsubscribe("focus",h);core.Async.destroyAll(D,b)};(function(){u=new odf.TextSerializer;u.filter=new odf.OdfNodeFilter;g.subscribe("compositionstart",n);
g.subscribe("compositionend",p);g.subscribe("textInput",l);g.subscribe("keypress",c);g.subscribe("focus",h);w.push(new m(g));D=w.map(function(b){return b.destroy});q=k.createElement("span");q.setAttribute("id","composer");x=core.Task.createTimeoutTask(h,1);D.push(x.destroy)})()};gui.InputMethodEditor.signalCompositionStart="input/compositionstart";gui.InputMethodEditor.signalCompositionEnd="input/compositionend"})();
gui.MetadataController=function(m,d){function g(a){h.emit(gui.MetadataController.signalMetadataChanged,a)}function a(a){var c=-1===f.indexOf(a);c||runtime.log("Setting "+a+" is restricted.");return c}var c=m.getOdtDocument(),h=new core.EventNotifier([gui.MetadataController.signalMetadataChanged]),f=["dc:creator","dc:date","meta:editing-cycles","meta:editing-duration","meta:document-statistic"];this.setMetadata=function(c,f){var h={},g="",b;c&&Object.keys(c).filter(a).forEach(function(b){h[b]=c[b]});
f&&(g=f.filter(a).join(","));if(0<g.length||0<Object.keys(h).length)b=new ops.OpUpdateMetadata,b.init({memberid:d,setProperties:h,removedProperties:0<g.length?{attributes:g}:null}),m.enqueue([b])};this.getMetadata=function(a){var d;runtime.assert("string"===typeof a,"Property must be a string");d=a.split(":");runtime.assert(2===d.length,"Property must be a namespace-prefixed string");a=odf.Namespaces.lookupNamespaceURI(d[0]);runtime.assert(Boolean(a),"Prefix must be for an ODF namespace.");return c.getOdfCanvas().odfContainer().getMetadata(a,
d[1])};this.subscribe=function(a,c){h.subscribe(a,c)};this.unsubscribe=function(a,c){h.unsubscribe(a,c)};this.destroy=function(a){c.unsubscribe(ops.OdtDocument.signalMetadataUpdated,g);a()};c.subscribe(ops.OdtDocument.signalMetadataUpdated,g)};gui.MetadataController.signalMetadataChanged="metadata/changed";
gui.PasteController=function(m,d,g,a){function c(){n=!0===d.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)?g.isLocalCursorWithinOwnAnnotation():!0}function h(b){b.getMemberId()===a&&c()}var f=m.getOdtDocument(),n=!1,p=odf.Namespaces.textns,l=core.StepDirection.NEXT,r=odf.OdfUtils;this.isEnabled=function(){return n};this.paste=function(b){if(n){var e=f.getCursorPosition(a),c=f.getCursor(a).getNode(),c=r.getParagraphElement(c),d=c.getAttributeNS(p,"style-name")||"",h=e,g=[],v=f.convertDomPointToCursorStep(c,
0,l);b.replace(/\r/g,"").split("\n").forEach(function(b){var e=new ops.OpInsertText,c=new ops.OpSplitParagraph;e.init({memberid:a,position:h,text:b,moveCursor:!0});g.push(e);h+=b.length;c.init({memberid:a,position:h,paragraphStyleName:d,sourceParagraphPosition:v,moveCursor:!0});g.push(c);v=h+=1});g.pop();m.enqueue(g)}};this.destroy=function(b){f.unsubscribe(ops.Document.signalCursorMoved,h);d.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);b()};f.subscribe(ops.Document.signalCursorMoved,h);
d.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,c);c()};gui.ClosestXOffsetScanner=function(m){function d(a){return null!==a&&void 0!==c?Math.abs(a-m)>c:!1}function g(a){null!==a&&!1===d(a)&&(c=Math.abs(a-m))}var a=this,c,h=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT;this.token=void 0;this.process=function(c,m,p){var l,r;c.visualDirection===h?(l=m&&m.right,r=p&&p.left):(l=m&&m.left,r=p&&p.right);if(d(l)||d(r))return!0;if(m||p)g(l),g(r),a.token=c.token;return!1}};
gui.LineBoundaryScanner=function(){var m=this,d=null;this.token=void 0;this.process=function(g,a,c){var h;if(h=c)if(d){var f=d;h=Math.min(f.bottom-f.top,c.bottom-c.top);var n=Math.max(f.top,c.top),f=Math.min(f.bottom,c.bottom)-n;h=.4>=(0<h?f/h:0)}else h=!1;!a||c&&!h||(m.token=g.token);if(h)return!0;d=(g=d)&&a?{left:Math.min(g.left,a.left),right:Math.max(g.right,a.right),top:Math.min(g.top,a.top),bottom:Math.min(g.bottom,a.bottom)}:g||a;return!1}};
gui.ParagraphBoundaryScanner=function(){var m=this,d=!1,g,a=odf.OdfUtils;this.token=void 0;this.process=function(c){var h=a.getParagraphElement(c.container());d||(g=h,d=!0);if(g!==h)return!0;m.token=c.token;return!1}};
odf.WordBoundaryFilter=function(m,d){function g(b,a,e){for(var c=null,d=m.getRootNode(),f;b!==d&&null!==b&&null===c;)f=0>a?b.previousSibling:b.nextSibling,e(f)===NodeFilter.FILTER_ACCEPT&&(c=f),b=b.parentNode;return c}function a(b,a){var e;return null===b?k.NO_NEIGHBOUR:f.isCharacterElement(b)?k.SPACE_CHAR:b.nodeType===c||f.isTextSpan(b)||f.isHyperlink(b)?(e=b.textContent.charAt(a()),p.test(e)?k.SPACE_CHAR:n.test(e)?k.PUNCTUATION_CHAR:k.WORD_CHAR):k.OTHER}var c=Node.TEXT_NODE,h=Node.ELEMENT_NODE,
f=odf.OdfUtils,n=/[!-#%-*,-\/:-;?-@\[-\]_{}\u00a1\u00ab\u00b7\u00bb\u00bf;\u00b7\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0700-\u070d\u07f7-\u07f9\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u169b-\u169c\u16eb-\u16ed\u1735-\u1736\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u1944-\u1945\u19de-\u19df\u1a1e-\u1a1f\u1b5a-\u1b60\u1c3b-\u1c3f\u1c7e-\u1c7f\u2000-\u206e\u207d-\u207e\u208d-\u208e\u3008-\u3009\u2768-\u2775\u27c5-\u27c6\u27e6-\u27ef\u2983-\u2998\u29d8-\u29db\u29fc-\u29fd\u2cf9-\u2cfc\u2cfe-\u2cff\u2e00-\u2e7e\u3000-\u303f\u30a0\u30fb\ua60d-\ua60f\ua673\ua67e\ua874-\ua877\ua8ce-\ua8cf\ua92e-\ua92f\ua95f\uaa5c-\uaa5f\ufd3e-\ufd3f\ufe10-\ufe19\ufe30-\ufe52\ufe54-\ufe61\ufe63\ufe68\ufe6a-\ufe6b\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|\ud800[\udd00-\udd01\udf9f\udfd0]|\ud802[\udd1f\udd3f\ude50-\ude58]|\ud809[\udc00-\udc7e]/,
p=/\s/,l=core.PositionFilter.FilterResult.FILTER_ACCEPT,r=core.PositionFilter.FilterResult.FILTER_REJECT,b=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,e=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,k={NO_NEIGHBOUR:0,SPACE_CHAR:1,PUNCTUATION_CHAR:2,WORD_CHAR:3,OTHER:4};this.acceptPosition=function(c){var f=c.container(),m=c.leftNode(),n=c.rightNode(),p=c.unfilteredDomOffset,B=function(){return c.unfilteredDomOffset()-1};f.nodeType===h&&(null===n&&(n=g(f,1,c.getNodeFilter())),null===m&&(m=
g(f,-1,c.getNodeFilter())));f!==n&&(p=function(){return 0});f!==m&&null!==m&&(B=function(){return m.textContent.length-1});f=a(m,B);n=a(n,p);return f===k.WORD_CHAR&&n===k.WORD_CHAR||f===k.PUNCTUATION_CHAR&&n===k.PUNCTUATION_CHAR||d===b&&f!==k.NO_NEIGHBOUR&&n===k.SPACE_CHAR||d===e&&f===k.SPACE_CHAR&&n!==k.NO_NEIGHBOUR?r:l}};odf.WordBoundaryFilter.IncludeWhitespace={None:0,TRAILING:1,LEADING:2};
gui.SelectionController=function(m,d){function g(b){var a=b.spec();if(b.isEdit||a.memberid===d)F=void 0,C.cancel()}function a(){var b=A.getCursor(d).getNode();return A.createStepIterator(b,0,[B,w],A.getRootElement(b))}function c(b,a,e){e=new odf.WordBoundaryFilter(A,e);var c=A.getRootElement(b)||A.getRootNode(),d=A.createRootFilter(c);return A.createStepIterator(b,a,[B,d,e],c)}function h(b,a){return a?{anchorNode:b.startContainer,anchorOffset:b.startOffset,focusNode:b.endContainer,focusOffset:b.endOffset}:
{anchorNode:b.endContainer,anchorOffset:b.endOffset,focusNode:b.startContainer,focusOffset:b.startOffset}}function f(b,a,e){var c=new ops.OpMoveCursor;c.init({memberid:d,position:b,length:a||0,selectionType:e});return c}function n(b,a,e){var c;c=A.getCursor(d);c=h(c.getSelectedRange(),c.hasForwardSelection());c.focusNode=b;c.focusOffset=a;e||(c.anchorNode=c.focusNode,c.anchorOffset=c.focusOffset);b=A.convertDomToCursorRange(c);m.enqueue([f(b.position,b.length)])}function p(b){var a;a=c(b.startContainer,
b.startOffset,H);a.roundToPreviousStep()&&b.setStart(a.container(),a.offset());a=c(b.endContainer,b.endOffset,s);a.roundToNextStep()&&b.setEnd(a.container(),a.offset())}function l(b){var a=t.getParagraphElements(b),e=a[0],a=a[a.length-1];e&&b.setStart(e,0);a&&(t.isParagraph(b.endContainer)&&0===b.endOffset?b.setEndBefore(a):b.setEnd(a,a.childNodes.length))}function r(b,a,e,c){var d,f;c?(d=e.startContainer,f=e.startOffset):(d=e.endContainer,f=e.endOffset);v.containsNode(b,d)||(f=0>v.comparePoints(b,
0,d,f)?0:b.childNodes.length,d=b);b=A.createStepIterator(d,f,a,t.getParagraphElement(d)||b);b.roundToClosestStep()||runtime.assert(!1,"No step found in requested range");c?e.setStart(b.container(),b.offset()):e.setEnd(b.container(),b.offset())}function b(b,e){var c=a();c.advanceStep(b)&&n(c.container(),c.offset(),e)}function e(b,e){var c,d=F,f=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];void 0===d&&D&&(d=D());isNaN(d)||(c=a(),u.moveToFilteredStep(c,b,f)&&c.advanceStep(b)&&(f=[new gui.ClosestXOffsetScanner(d),
new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner],u.moveToFilteredStep(c,b,f)&&(n(c.container(),c.offset(),e),F=d,C.restart())))}function k(b,e){var c=a(),d=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];u.moveToFilteredStep(c,b,d)&&n(c.container(),c.offset(),e)}function q(b,a){var e=A.getCursor(d),e=h(e.getSelectedRange(),e.hasForwardSelection()),e=c(e.focusNode,e.focusOffset,H);e.advanceStep(b)&&n(e.container(),e.offset(),a)}function x(b,a,e){var c=!1,f=A.getCursor(d),
f=h(f.getSelectedRange(),f.hasForwardSelection()),c=A.getRootElement(f.focusNode);runtime.assert(Boolean(c),"SelectionController: Cursor outside root");f=A.createStepIterator(f.focusNode,f.focusOffset,[B,w],c);f.roundToClosestStep();f.advanceStep(b)&&(e=e(f.container()))&&(b===z?(f.setPosition(e,0),c=f.roundToNextStep()):(f.setPosition(e,e.childNodes.length),c=f.roundToPreviousStep()),c&&n(f.container(),f.offset(),a))}var A=m.getOdtDocument(),v=core.DomUtils,t=odf.OdfUtils,B=A.getPositionFilter(),
u=new gui.GuiStepUtils,w=A.createRootFilter(d),D=null,F,C,H=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,s=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,z=core.StepDirection.PREVIOUS,y=core.StepDirection.NEXT;this.selectionToRange=function(b){var a=0<=v.comparePoints(b.anchorNode,b.anchorOffset,b.focusNode,b.focusOffset),e=b.focusNode.ownerDocument.createRange();a?(e.setStart(b.anchorNode,b.anchorOffset),e.setEnd(b.focusNode,b.focusOffset)):(e.setStart(b.focusNode,b.focusOffset),e.setEnd(b.anchorNode,
b.anchorOffset));return{range:e,hasForwardSelection:a}};this.rangeToSelection=h;this.selectImage=function(b){var a=A.getRootElement(b),e=A.createRootFilter(a),a=A.createStepIterator(b,0,[e,A.getPositionFilter()],a),c;a.roundToPreviousStep()||runtime.assert(!1,"No walkable position before frame");e=a.container();c=a.offset();a.setPosition(b,b.childNodes.length);a.roundToNextStep()||runtime.assert(!1,"No walkable position after frame");b=A.convertDomToCursorRange({anchorNode:e,anchorOffset:c,focusNode:a.container(),
focusOffset:a.offset()});b=f(b.position,b.length,ops.OdtCursor.RegionSelection);m.enqueue([b])};this.expandToWordBoundaries=p;this.expandToParagraphBoundaries=l;this.selectRange=function(b,a,e){var c=A.getOdfCanvas().getElement(),k,g=[B];k=v.containsNode(c,b.startContainer);c=v.containsNode(c,b.endContainer);if(k||c)if(k&&c&&(2===e?p(b):3<=e&&l(b)),(e=a?A.getRootElement(b.startContainer):A.getRootElement(b.endContainer))||(e=A.getRootNode()),g.push(A.createRootFilter(e)),r(e,g,b,!0),r(e,g,b,!1),b=
h(b,a),a=A.convertDomToCursorRange(b),b=A.getCursorSelection(d),a.position!==b.position||a.length!==b.length)b=f(a.position,a.length,ops.OdtCursor.RangeSelection),m.enqueue([b])};this.moveCursorToLeft=function(){b(z,!1);return!0};this.moveCursorToRight=function(){b(y,!1);return!0};this.extendSelectionToLeft=function(){b(z,!0);return!0};this.extendSelectionToRight=function(){b(y,!0);return!0};this.setCaretXPositionLocator=function(b){D=b};this.moveCursorUp=function(){e(z,!1);return!0};this.moveCursorDown=
function(){e(y,!1);return!0};this.extendSelectionUp=function(){e(z,!0);return!0};this.extendSelectionDown=function(){e(y,!0);return!0};this.moveCursorBeforeWord=function(){q(z,!1);return!0};this.moveCursorPastWord=function(){q(y,!1);return!0};this.extendSelectionBeforeWord=function(){q(z,!0);return!0};this.extendSelectionPastWord=function(){q(y,!0);return!0};this.moveCursorToLineStart=function(){k(z,!1);return!0};this.moveCursorToLineEnd=function(){k(y,!1);return!0};this.extendSelectionToLineStart=
function(){k(z,!0);return!0};this.extendSelectionToLineEnd=function(){k(y,!0);return!0};this.extendSelectionToParagraphStart=function(){x(z,!0,t.getParagraphElement);return!0};this.extendSelectionToParagraphEnd=function(){x(y,!0,t.getParagraphElement);return!0};this.moveCursorToParagraphStart=function(){x(z,!1,t.getParagraphElement);return!0};this.moveCursorToParagraphEnd=function(){x(y,!1,t.getParagraphElement);return!0};this.moveCursorToDocumentStart=function(){x(z,!1,A.getRootElement);return!0};
this.moveCursorToDocumentEnd=function(){x(y,!1,A.getRootElement);return!0};this.extendSelectionToDocumentStart=function(){x(z,!0,A.getRootElement);return!0};this.extendSelectionToDocumentEnd=function(){x(y,!0,A.getRootElement);return!0};this.extendSelectionToEntireDocument=function(){var b=A.getCursor(d),b=A.getRootElement(b.getNode()),a,e,c;runtime.assert(Boolean(b),"SelectionController: Cursor outside root");c=A.createStepIterator(b,0,[B,w],b);c.roundToClosestStep();a=c.container();e=c.offset();
c.setPosition(b,b.childNodes.length);c.roundToClosestStep();b=A.convertDomToCursorRange({anchorNode:a,anchorOffset:e,focusNode:c.container(),focusOffset:c.offset()});m.enqueue([f(b.position,b.length)]);return!0};this.destroy=function(b){A.unsubscribe(ops.OdtDocument.signalOperationStart,g);core.Async.destroyAll([C.destroy],b)};(function(){C=core.Task.createTimeoutTask(function(){F=void 0},2E3);A.subscribe(ops.OdtDocument.signalOperationStart,g)})()};
gui.TextController=function(m,d,g,a,c,h){function f(){x=!0===d.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)?g.isLocalCursorWithinOwnAnnotation():!0}function n(b){b.getMemberId()===a&&f()}function p(b,a,c){var d=[e.getPositionFilter()];c&&d.push(e.createRootFilter(b.startContainer));c=e.createStepIterator(b.startContainer,b.startOffset,d,a);c.roundToClosestStep()||runtime.assert(!1,"No walkable step found in paragraph element at range start");a=e.convertDomPointToCursorStep(c.container(),c.offset());
b.collapsed?b=a:(c.setPosition(b.endContainer,b.endOffset),c.roundToClosestStep()||runtime.assert(!1,"No walkable step found in paragraph element at range end"),b=e.convertDomPointToCursorStep(c.container(),c.offset()));return{position:a,length:b-a}}function l(b){var e,c,d,f=k.getParagraphElements(b),h=b.cloneRange(),g=[];e=f[0];1<f.length&&(k.hasNoODFContent(e)&&(e=f[f.length-1]),c=e.getAttributeNS(odf.Namespaces.textns,"style-name")||"");f.forEach(function(e,f){var k,l;h.setStart(e,0);h.collapse(!0);
k=p(h,e,!1).position;0<f&&(l=new ops.OpMergeParagraph,l.init({memberid:a,paragraphStyleName:c,destinationStartPosition:d,sourceStartPosition:k,moveCursor:1===f}),g.unshift(l));d=k;h.selectNodeContents(e);if(k=q.rangeIntersection(h,b))k=p(k,e,!0),0<k.length&&(l=new ops.OpRemoveText,l.init({memberid:a,position:k.position,length:k.length}),g.unshift(l))});return g}function r(b){0>b.length&&(b.position+=b.length,b.length=-b.length);return b}function b(b){if(!x)return!1;var c,d=e.getCursor(a).getSelectedRange().cloneRange(),
f=r(e.getCursorSelection(a)),k;if(0===f.length){f=void 0;c=e.getCursor(a).getNode();k=e.getRootElement(c);var h=[e.getPositionFilter(),e.createRootFilter(k)];k=e.createStepIterator(c,0,h,k);k.roundToClosestStep()&&(b?k.nextStep():k.previousStep())&&(f=r(e.convertDomToCursorRange({anchorNode:c,anchorOffset:0,focusNode:k.container(),focusOffset:k.offset()})),b?(d.setStart(c,0),d.setEnd(k.container(),k.offset())):(d.setStart(k.container(),k.offset()),d.setEnd(c,0)))}f&&m.enqueue(l(d));return void 0!==
f}var e=m.getOdtDocument(),k=odf.OdfUtils,q=core.DomUtils,x=!1,A=odf.Namespaces.textns,v=core.StepDirection.NEXT;this.isEnabled=function(){return x};this.enqueueParagraphSplittingOps=function(){if(!x)return!1;var b=e.getCursor(a),c=b.getSelectedRange(),d=r(e.getCursorSelection(a)),f=[],b=k.getParagraphElement(b.getNode()),g=b.getAttributeNS(A,"style-name")||"";0<d.length&&(f=f.concat(l(c)));c=new ops.OpSplitParagraph;c.init({memberid:a,position:d.position,paragraphStyleName:g,sourceParagraphPosition:e.convertDomPointToCursorStep(b,
0,v),moveCursor:!0});f.push(c);h&&(d=h(d.position+1),f=f.concat(d));m.enqueue(f);return!0};this.removeTextByBackspaceKey=function(){return b(!1)};this.removeTextByDeleteKey=function(){return b(!0)};this.removeCurrentSelection=function(){if(!x)return!1;var b=e.getCursor(a).getSelectedRange();m.enqueue(l(b));return!0};this.insertText=function(b){if(x){var d=e.getCursor(a).getSelectedRange(),f=r(e.getCursorSelection(a)),k=[],h=!1;0<f.length&&(k=k.concat(l(d)),h=!0);d=new ops.OpInsertText;d.init({memberid:a,
position:f.position,text:b,moveCursor:!0});k.push(d);c&&(b=c(f.position,b.length,h))&&k.push(b);m.enqueue(k)}};this.destroy=function(b){e.unsubscribe(ops.Document.signalCursorMoved,n);d.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,f);b()};e.subscribe(ops.Document.signalCursorMoved,n);d.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,f);f()};gui.UndoManager=function(){};gui.UndoManager.prototype.subscribe=function(m,d){};gui.UndoManager.prototype.unsubscribe=function(m,d){};
gui.UndoManager.prototype.setDocument=function(m){};gui.UndoManager.prototype.setInitialState=function(){};gui.UndoManager.prototype.initialize=function(){};gui.UndoManager.prototype.purgeInitialState=function(){};gui.UndoManager.prototype.setPlaybackFunction=function(m){};gui.UndoManager.prototype.hasUndoStates=function(){};gui.UndoManager.prototype.hasRedoStates=function(){};gui.UndoManager.prototype.moveForward=function(m){};gui.UndoManager.prototype.moveBackward=function(m){};
gui.UndoManager.prototype.onOperationExecuted=function(m){};gui.UndoManager.signalUndoStackChanged="undoStackChanged";gui.UndoManager.signalUndoStateCreated="undoStateCreated";gui.UndoManager.signalUndoStateModified="undoStateModified";gui.SessionControllerOptions=function(){this.annotationsEnabled=this.directParagraphStylingEnabled=this.directTextStylingEnabled=!1};
(function(){var m=core.PositionFilter.FilterResult.FILTER_ACCEPT;gui.SessionController=function(d,g,a,c){function h(b){return b.target||b.srcElement||null}function f(b,a){var e=K.getDOMDocument(),c=null;e.caretRangeFromPoint?(e=e.caretRangeFromPoint(b,a),c={container:e.startContainer,offset:e.startOffset}):e.caretPositionFromPoint&&(e=e.caretPositionFromPoint(b,a))&&e.offsetNode&&(c={container:e.offsetNode,offset:e.offset});return c}function n(b){var a=K.getCursor(g).getSelectedRange();a.collapsed?
b.preventDefault():ca.setDataFromRange(b,a)?fa.removeCurrentSelection():runtime.log("Cut operation failed")}function p(){return!1!==K.getCursor(g).getSelectedRange().collapsed}function l(b){var a=K.getCursor(g).getSelectedRange();a.collapsed?b.preventDefault():ca.setDataFromRange(b,a)||runtime.log("Copy operation failed")}function r(b){var a;J.clipboardData&&J.clipboardData.getData?a=J.clipboardData.getData("Text"):b.clipboardData&&b.clipboardData.getData&&(a=b.clipboardData.getData("text/plain"));
a&&(fa.removeCurrentSelection(),ga.paste(a));b.preventDefault?b.preventDefault():b.returnValue=!1}function b(){return!1}function e(b){if(T)T.onOperationExecuted(b)}function k(b){K.emit(ops.OdtDocument.signalUndoStackChanged,b)}function q(){var b;return T?(b=Q.hasFocus(),T.moveBackward(1),b&&Q.focus(),!0):!1}function x(){var b;return T?(b=Q.hasFocus(),T.moveForward(1),b&&Q.focus(),!0):!1}function A(b){var e=K.getCursor(g).getSelectedRange(),c=h(b).getAttribute("end");e&&c&&(b=f(b.clientX,b.clientY))&&
(ia.setUnfilteredPosition(b.container,b.offset),S.acceptPosition(ia)===m&&(e=e.cloneRange(),"left"===c?e.setStart(ia.container(),ia.unfilteredDomOffset()):e.setEnd(ia.container(),ia.unfilteredDomOffset()),a.setSelectedRange(e,"right"===c),K.emit(ops.Document.signalCursorMoved,a)))}function v(){V.selectRange(a.getSelectedRange(),a.hasForwardSelection(),1)}function t(){var b=J.getSelection(),e=0<b.rangeCount&&V.selectionToRange(b);X&&e&&($=!0,ka.clearSelection(),ia.setUnfilteredPosition(b.focusNode,
b.focusOffset),S.acceptPosition(ia)===m&&(2===na?V.expandToWordBoundaries(e.range):3<=na&&V.expandToParagraphBoundaries(e.range),a.setSelectedRange(e.range,e.hasForwardSelection),K.emit(ops.Document.signalCursorMoved,a)))}function B(b){var a=h(b),e=K.getCursor(g);if(X=null!==a&&P.containsNode(K.getOdfCanvas().getElement(),a))$=!1,a=K.getRootElement(a)||K.getRootNode(),S=K.createRootFilter(a),na=0===b.button?b.detail:0,e&&b.shiftKey?J.getSelection().collapse(e.getAnchorNode(),0):(b=J.getSelection(),
a=e.getSelectedRange(),b.extend?e.hasForwardSelection()?(b.collapse(a.startContainer,a.startOffset),b.extend(a.endContainer,a.endOffset)):(b.collapse(a.endContainer,a.endOffset),b.extend(a.startContainer,a.startOffset)):(b.removeAllRanges(),b.addRange(a.cloneRange()))),1<na&&t()}function u(b){var a=K.getRootElement(b),e=K.createRootFilter(a),a=K.createStepIterator(b,0,[e,K.getPositionFilter()],a);a.setPosition(b,b.childNodes.length);return a.roundToNextStep()?{container:a.container(),offset:a.offset()}:
null}function w(b){var a;a=(a=J.getSelection())?{anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}:null;var e=J.getSelection().isCollapsed,c,d;a.anchorNode||a.focusNode||!(c=f(b.clientX,b.clientY))||(a.anchorNode=c.container,a.anchorOffset=c.offset,a.focusNode=a.anchorNode,a.focusOffset=a.anchorOffset);if(R.isImage(a.focusNode)&&0===a.focusOffset&&R.isCharacterFrame(a.focusNode.parentNode)){if(d=a.focusNode.parentNode,c=d.getBoundingClientRect(),
b.clientX>c.left&&(c=u(d)))a.focusNode=c.container,a.focusOffset=c.offset,e&&(a.anchorNode=a.focusNode,a.anchorOffset=a.focusOffset)}else R.isImage(a.focusNode.firstChild)&&1===a.focusOffset&&R.isCharacterFrame(a.focusNode)&&(c=u(a.focusNode))&&(a.anchorNode=a.focusNode=c.container,a.anchorOffset=a.focusOffset=c.offset);a.anchorNode&&a.focusNode&&(a=V.selectionToRange(a),V.selectRange(a.range,a.hasForwardSelection,0===b.button?b.detail:0));Q.focus()}function D(b){var a;if(a=f(b.clientX,b.clientY))b=
a.container,a=a.offset,b={anchorNode:b,anchorOffset:a,focusNode:b,focusOffset:a},b=V.selectionToRange(b),V.selectRange(b.range,b.hasForwardSelection,2),Q.focus()}function F(b){var e=h(b),c,d,f;la.processRequests();X&&(R.isImage(e)&&R.isCharacterFrame(e.parentNode)&&J.getSelection().isCollapsed?(V.selectImage(e.parentNode),Q.focus()):ka.isSelectorElement(e)?Q.focus():$?(e=a.getSelectedRange(),d=e.collapsed,R.isImage(e.endContainer)&&0===e.endOffset&&R.isCharacterFrame(e.endContainer.parentNode)&&(f=
e.endContainer.parentNode,f=u(f))&&(e.setEnd(f.container,f.offset),d&&e.collapse(!1)),V.selectRange(e,a.hasForwardSelection(),0===b.button?b.detail:0),Q.focus()):ua?w(b):(c=P.cloneEvent(b),da=runtime.setTimeout(function(){w(c)},0)),na=0,$=X=!1)}function C(b){var a=K.getCursor(g).getSelectedRange();a.collapsed||ba.exportRangeToDataTransfer(b.dataTransfer,a)}function H(){X&&Q.focus();na=0;$=X=!1}function s(b){F(b)}function z(b){var a=h(b),e=null;"annotationRemoveButton"===a.className?(runtime.assert(ha,
"Remove buttons are displayed on annotations while annotation editing is disabled in the controller."),e=a.parentNode.getElementsByTagNameNS(odf.Namespaces.officens,"annotation").item(0),Z.removeAnnotation(e),Q.focus()):"webodf-draggable"!==a.getAttribute("class")&&F(b)}function y(b){(b=b.data)&&(-1===b.indexOf("\n")?fa.insertText(b):ga.paste(b))}function M(b){return function(){b();return!0}}function E(b){return function(a){return K.getCursor(g).getSelectionType()===ops.OdtCursor.RangeSelection?b(a):
!0}}function I(b){Q.unsubscribe("keydown",L.handleEvent);Q.unsubscribe("keypress",Y.handleEvent);Q.unsubscribe("keyup",ea.handleEvent);Q.unsubscribe("copy",l);Q.unsubscribe("mousedown",B);Q.unsubscribe("mousemove",la.trigger);Q.unsubscribe("mouseup",z);Q.unsubscribe("contextmenu",s);Q.unsubscribe("dragstart",C);Q.unsubscribe("dragend",H);Q.unsubscribe("click",oa.handleClick);Q.unsubscribe("longpress",D);Q.unsubscribe("drag",A);Q.unsubscribe("dragstop",v);K.unsubscribe(ops.OdtDocument.signalOperationEnd,
ma.trigger);K.unsubscribe(ops.Document.signalCursorAdded,ja.registerCursor);K.unsubscribe(ops.Document.signalCursorRemoved,ja.removeCursor);K.unsubscribe(ops.OdtDocument.signalOperationEnd,e);b()}var J=runtime.getWindow(),K=d.getOdtDocument(),G=new gui.SessionConstraints,W=new gui.SessionContext(d,g),P=core.DomUtils,R=odf.OdfUtils,ba=new gui.MimeDataExporter,ca=new gui.Clipboard(ba),L=new gui.KeyboardHandler,Y=new gui.KeyboardHandler,ea=new gui.KeyboardHandler,X=!1,U=new odf.ObjectNameGenerator(K.getOdfCanvas().odfContainer(),
g),$=!1,S=null,da,T=null,Q=new gui.EventManager(K),ha=c.annotationsEnabled,Z=new gui.AnnotationController(d,G,g),aa=new gui.DirectFormattingController(d,G,W,g,U,c.directTextStylingEnabled,c.directParagraphStylingEnabled),fa=new gui.TextController(d,G,W,g,aa.createCursorStyleOp,aa.createParagraphStyleOps),pa=new gui.ImageController(d,G,W,g,U),ka=new gui.ImageSelector(K.getOdfCanvas()),ia=K.createPositionIterator(K.getRootNode()),la,ma,ga=new gui.PasteController(d,G,W,g),ja=new gui.InputMethodEditor(g,
Q),na=0,oa=new gui.HyperlinkClickHandler(K.getOdfCanvas().getElement,L,ea),sa=new gui.HyperlinkController(d,G,W,g),V=new gui.SelectionController(d,g),ta=new gui.MetadataController(d,g),N=gui.KeyboardHandler.Modifier,O=gui.KeyboardHandler.KeyCode,qa=-1!==J.navigator.appVersion.toLowerCase().indexOf("mac"),ua=-1!==["iPad","iPod","iPhone"].indexOf(J.navigator.platform),ra;runtime.assert(null!==J,"Expected to be run in an environment which has a global window, like a browser.");this.undo=q;this.redo=
x;this.insertLocalCursor=function(){runtime.assert(void 0===d.getOdtDocument().getCursor(g),"Inserting local cursor a second time.");var b=new ops.OpAddCursor;b.init({memberid:g});d.enqueue([b]);Q.focus()};this.removeLocalCursor=function(){runtime.assert(void 0!==d.getOdtDocument().getCursor(g),"Removing local cursor without inserting before.");var b=new ops.OpRemoveCursor;b.init({memberid:g});d.enqueue([b])};this.startEditing=function(){ja.subscribe(gui.InputMethodEditor.signalCompositionStart,fa.removeCurrentSelection);
ja.subscribe(gui.InputMethodEditor.signalCompositionEnd,y);Q.subscribe("beforecut",p);Q.subscribe("cut",n);Q.subscribe("beforepaste",b);Q.subscribe("paste",r);T&&T.initialize();Q.setEditing(!0);oa.setModifier(qa?N.Meta:N.Ctrl);L.bind(O.Backspace,N.None,M(fa.removeTextByBackspaceKey),!0);L.bind(O.Delete,N.None,fa.removeTextByDeleteKey);L.bind(O.Tab,N.None,E(function(){fa.insertText("\t");return!0}));qa?(L.bind(O.Clear,N.None,fa.removeCurrentSelection),L.bind(O.B,N.Meta,E(aa.toggleBold)),L.bind(O.I,
N.Meta,E(aa.toggleItalic)),L.bind(O.U,N.Meta,E(aa.toggleUnderline)),L.bind(O.L,N.MetaShift,E(aa.alignParagraphLeft)),L.bind(O.E,N.MetaShift,E(aa.alignParagraphCenter)),L.bind(O.R,N.MetaShift,E(aa.alignParagraphRight)),L.bind(O.J,N.MetaShift,E(aa.alignParagraphJustified)),ha&&L.bind(O.C,N.MetaShift,Z.addAnnotation),L.bind(O.Z,N.Meta,q),L.bind(O.Z,N.MetaShift,x)):(L.bind(O.B,N.Ctrl,E(aa.toggleBold)),L.bind(O.I,N.Ctrl,E(aa.toggleItalic)),L.bind(O.U,N.Ctrl,E(aa.toggleUnderline)),L.bind(O.L,N.CtrlShift,
E(aa.alignParagraphLeft)),L.bind(O.E,N.CtrlShift,E(aa.alignParagraphCenter)),L.bind(O.R,N.CtrlShift,E(aa.alignParagraphRight)),L.bind(O.J,N.CtrlShift,E(aa.alignParagraphJustified)),ha&&L.bind(O.C,N.CtrlAlt,Z.addAnnotation),L.bind(O.Z,N.Ctrl,q),L.bind(O.Z,N.CtrlShift,x));Y.setDefault(E(function(b){var a;a=null===b.which||void 0===b.which?String.fromCharCode(b.keyCode):0!==b.which&&0!==b.charCode?String.fromCharCode(b.which):null;return!a||b.altKey||b.ctrlKey||b.metaKey?!1:(fa.insertText(a),!0)}));
Y.bind(O.Enter,N.None,E(fa.enqueueParagraphSplittingOps))};this.endEditing=function(){ja.unsubscribe(gui.InputMethodEditor.signalCompositionStart,fa.removeCurrentSelection);ja.unsubscribe(gui.InputMethodEditor.signalCompositionEnd,y);Q.unsubscribe("cut",n);Q.unsubscribe("beforecut",p);Q.unsubscribe("paste",r);Q.unsubscribe("beforepaste",b);Q.setEditing(!1);oa.setModifier(N.None);L.bind(O.Backspace,N.None,function(){return!0},!0);L.unbind(O.Delete,N.None);L.unbind(O.Tab,N.None);qa?(L.unbind(O.Clear,
N.None),L.unbind(O.B,N.Meta),L.unbind(O.I,N.Meta),L.unbind(O.U,N.Meta),L.unbind(O.L,N.MetaShift),L.unbind(O.E,N.MetaShift),L.unbind(O.R,N.MetaShift),L.unbind(O.J,N.MetaShift),ha&&L.unbind(O.C,N.MetaShift),L.unbind(O.Z,N.Meta),L.unbind(O.Z,N.MetaShift)):(L.unbind(O.B,N.Ctrl),L.unbind(O.I,N.Ctrl),L.unbind(O.U,N.Ctrl),L.unbind(O.L,N.CtrlShift),L.unbind(O.E,N.CtrlShift),L.unbind(O.R,N.CtrlShift),L.unbind(O.J,N.CtrlShift),ha&&L.unbind(O.C,N.CtrlAlt),L.unbind(O.Z,N.Ctrl),L.unbind(O.Z,N.CtrlShift));Y.setDefault(null);
Y.unbind(O.Enter,N.None)};this.getInputMemberId=function(){return g};this.getSession=function(){return d};this.getSessionConstraints=function(){return G};this.setUndoManager=function(b){T&&T.unsubscribe(gui.UndoManager.signalUndoStackChanged,k);if(T=b)T.setDocument(K),T.setPlaybackFunction(d.enqueue),T.subscribe(gui.UndoManager.signalUndoStackChanged,k)};this.getUndoManager=function(){return T};this.getMetadataController=function(){return ta};this.getAnnotationController=function(){return Z};this.getDirectFormattingController=
function(){return aa};this.getHyperlinkClickHandler=function(){return oa};this.getHyperlinkController=function(){return sa};this.getImageController=function(){return pa};this.getSelectionController=function(){return V};this.getTextController=function(){return fa};this.getEventManager=function(){return Q};this.getKeyboardHandlers=function(){return{keydown:L,keypress:Y}};this.destroy=function(b){var a=[la.destroy,ma.destroy,aa.destroy,ja.destroy,Q.destroy,oa.destroy,sa.destroy,ta.destroy,V.destroy,
fa.destroy,I];ra&&a.unshift(ra.destroy);runtime.clearTimeout(da);core.Async.destroyAll(a,b)};la=core.Task.createRedrawTask(t);ma=core.Task.createRedrawTask(function(){var b=K.getCursor(g);if(b&&b.getSelectionType()===ops.OdtCursor.RegionSelection&&(b=R.getImageElements(b.getSelectedRange())[0])){ka.select(b.parentNode);return}ka.clearSelection()});L.bind(O.Left,N.None,E(V.moveCursorToLeft));L.bind(O.Right,N.None,E(V.moveCursorToRight));L.bind(O.Up,N.None,E(V.moveCursorUp));L.bind(O.Down,N.None,E(V.moveCursorDown));
L.bind(O.Left,N.Shift,E(V.extendSelectionToLeft));L.bind(O.Right,N.Shift,E(V.extendSelectionToRight));L.bind(O.Up,N.Shift,E(V.extendSelectionUp));L.bind(O.Down,N.Shift,E(V.extendSelectionDown));L.bind(O.Home,N.None,E(V.moveCursorToLineStart));L.bind(O.End,N.None,E(V.moveCursorToLineEnd));L.bind(O.Home,N.Ctrl,E(V.moveCursorToDocumentStart));L.bind(O.End,N.Ctrl,E(V.moveCursorToDocumentEnd));L.bind(O.Home,N.Shift,E(V.extendSelectionToLineStart));L.bind(O.End,N.Shift,E(V.extendSelectionToLineEnd));L.bind(O.Up,
N.CtrlShift,E(V.extendSelectionToParagraphStart));L.bind(O.Down,N.CtrlShift,E(V.extendSelectionToParagraphEnd));L.bind(O.Home,N.CtrlShift,E(V.extendSelectionToDocumentStart));L.bind(O.End,N.CtrlShift,E(V.extendSelectionToDocumentEnd));qa?(L.bind(O.Left,N.Alt,E(V.moveCursorBeforeWord)),L.bind(O.Right,N.Alt,E(V.moveCursorPastWord)),L.bind(O.Left,N.Meta,E(V.moveCursorToLineStart)),L.bind(O.Right,N.Meta,E(V.moveCursorToLineEnd)),L.bind(O.Home,N.Meta,E(V.moveCursorToDocumentStart)),L.bind(O.End,N.Meta,
E(V.moveCursorToDocumentEnd)),L.bind(O.Left,N.AltShift,E(V.extendSelectionBeforeWord)),L.bind(O.Right,N.AltShift,E(V.extendSelectionPastWord)),L.bind(O.Left,N.MetaShift,E(V.extendSelectionToLineStart)),L.bind(O.Right,N.MetaShift,E(V.extendSelectionToLineEnd)),L.bind(O.Up,N.AltShift,E(V.extendSelectionToParagraphStart)),L.bind(O.Down,N.AltShift,E(V.extendSelectionToParagraphEnd)),L.bind(O.Up,N.MetaShift,E(V.extendSelectionToDocumentStart)),L.bind(O.Down,N.MetaShift,E(V.extendSelectionToDocumentEnd)),
L.bind(O.A,N.Meta,E(V.extendSelectionToEntireDocument))):(L.bind(O.Left,N.Ctrl,E(V.moveCursorBeforeWord)),L.bind(O.Right,N.Ctrl,E(V.moveCursorPastWord)),L.bind(O.Left,N.CtrlShift,E(V.extendSelectionBeforeWord)),L.bind(O.Right,N.CtrlShift,E(V.extendSelectionPastWord)),L.bind(O.A,N.Ctrl,E(V.extendSelectionToEntireDocument)));ua&&(ra=new gui.IOSSafariSupport(Q));Q.subscribe("keydown",L.handleEvent);Q.subscribe("keypress",Y.handleEvent);Q.subscribe("keyup",ea.handleEvent);Q.subscribe("copy",l);Q.subscribe("mousedown",
B);Q.subscribe("mousemove",la.trigger);Q.subscribe("mouseup",z);Q.subscribe("contextmenu",s);Q.subscribe("dragstart",C);Q.subscribe("dragend",H);Q.subscribe("click",oa.handleClick);Q.subscribe("longpress",D);Q.subscribe("drag",A);Q.subscribe("dragstop",v);K.subscribe(ops.OdtDocument.signalOperationEnd,ma.trigger);K.subscribe(ops.Document.signalCursorAdded,ja.registerCursor);K.subscribe(ops.Document.signalCursorRemoved,ja.removeCursor);K.subscribe(ops.OdtDocument.signalOperationEnd,e)}})();
gui.CaretManager=function(m,d){function g(a){return h.hasOwnProperty(a)?h[a]:null}function a(){return Object.keys(h).map(function(a){return h[a]})}function c(a){var c=h[a];c&&(delete h[a],a===m.getInputMemberId()?(n.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,c.ensureVisible),n.unsubscribe(ops.Document.signalCursorMoved,c.refreshCursorBlinking),p.unsubscribe("compositionupdate",c.handleUpdate),p.unsubscribe("compositionend",c.handleUpdate),p.unsubscribe("focus",c.setFocus),p.unsubscribe("blur",
c.removeFocus),f.removeEventListener("focus",c.show,!1),f.removeEventListener("blur",c.hide,!1)):n.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,c.handleUpdate),c.destroy(function(){}))}var h={},f=runtime.getWindow(),n=m.getSession().getOdtDocument(),p=m.getEventManager();this.registerCursor=function(a,c,b){var e=a.getMemberId();a=new gui.Caret(a,d,c,b);h[e]=a;e===m.getInputMemberId()?(runtime.log("Starting to track input on new cursor of "+e),n.subscribe(ops.OdtDocument.signalProcessingBatchEnd,
a.ensureVisible),n.subscribe(ops.Document.signalCursorMoved,a.refreshCursorBlinking),p.subscribe("compositionupdate",a.handleUpdate),p.subscribe("compositionend",a.handleUpdate),p.subscribe("focus",a.setFocus),p.subscribe("blur",a.removeFocus),f.addEventListener("focus",a.show,!1),f.addEventListener("blur",a.hide,!1),a.setOverlayElement(p.getEventTrap())):n.subscribe(ops.OdtDocument.signalProcessingBatchEnd,a.handleUpdate);return a};this.getCaret=g;this.getCarets=a;this.destroy=function(d){var f=
a().map(function(b){return b.destroy});m.getSelectionController().setCaretXPositionLocator(null);n.unsubscribe(ops.Document.signalCursorRemoved,c);h={};core.Async.destroyAll(f,d)};m.getSelectionController().setCaretXPositionLocator(function(){var a=g(m.getInputMemberId()),c;a&&(c=a.getBoundingClientRect());return c?c.right:void 0});n.subscribe(ops.Document.signalCursorRemoved,c)};
gui.EditInfoHandle=function(m){var d=[],g,a=m.ownerDocument,c=a.documentElement.namespaceURI;this.setEdits=function(h){d=h;var f,m,p,l;g.innerHTML="";for(h=0;h<d.length;h+=1)f=a.createElementNS(c,"div"),f.className="editInfo",m=a.createElementNS(c,"span"),m.className="editInfoColor",m.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",d[h].memberid),p=a.createElementNS(c,"span"),p.className="editInfoAuthor",p.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",d[h].memberid),
l=a.createElementNS(c,"span"),l.className="editInfoTime",l.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",d[h].memberid),l.innerHTML=d[h].time,f.appendChild(m),f.appendChild(p),f.appendChild(l),g.appendChild(f)};this.show=function(){g.style.display="block"};this.hide=function(){g.style.display="none"};this.destroy=function(a){m.removeChild(g);a()};g=a.createElementNS(c,"div");g.setAttribute("class","editInfoHandle");g.style.display="none";m.appendChild(g)};
ops.EditInfo=function(m,d){function g(){var a=[],d;for(d in c)c.hasOwnProperty(d)&&a.push({memberid:d,time:c[d].time});a.sort(function(a,c){return a.time-c.time});return a}var a,c={};this.getNode=function(){return a};this.getOdtDocument=function(){return d};this.getEdits=function(){return c};this.getSortedEdits=function(){return g()};this.addEdit=function(a,d){c[a]={time:d}};this.clearEdits=function(){c={}};this.destroy=function(c){m.parentNode&&m.removeChild(a);c()};a=d.getDOMDocument().createElementNS("urn:webodf:names:editinfo",
"editinfo");m.insertBefore(a,m.firstChild)};
gui.EditInfoMarker=function(m,d){function g(a,b){return runtime.setTimeout(function(){f.style.opacity=a},b)}var a=this,c,h,f,n,p,l;this.addEdit=function(a,b){var e=Date.now()-b;m.addEdit(a,b);h.setEdits(m.getSortedEdits());f.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",a);runtime.clearTimeout(p);runtime.clearTimeout(l);1E4>e?(n=g(1,0),p=g(.5,1E4-e),l=g(.2,2E4-e)):1E4<=e&&2E4>e?(n=g(.5,0),l=g(.2,2E4-e)):n=g(.2,0)};this.getEdits=function(){return m.getEdits()};this.clearEdits=function(){m.clearEdits();
h.setEdits([]);f.hasAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")&&f.removeAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")};this.getEditInfo=function(){return m};this.show=function(){f.style.display="block"};this.hide=function(){a.hideHandle();f.style.display="none"};this.showHandle=function(){h.show()};this.hideHandle=function(){h.hide()};this.destroy=function(a){runtime.clearTimeout(n);runtime.clearTimeout(p);runtime.clearTimeout(l);c.removeChild(f);h.destroy(function(b){b?
a(b):m.destroy(a)})};(function(){var g=m.getOdtDocument().getDOMDocument();f=g.createElementNS(g.documentElement.namespaceURI,"div");f.setAttribute("class","editInfoMarker");f.onmouseover=function(){a.showHandle()};f.onmouseout=function(){a.hideHandle()};c=m.getNode();c.appendChild(f);h=new gui.EditInfoHandle(c);d||a.hide()})()};
gui.HyperlinkTooltipView=function(m,d){var g=core.DomUtils,a=odf.OdfUtils,c=runtime.getWindow(),h,f,n;runtime.assert(null!==c,"Expected to be run in an environment which has a global window, like a browser.");this.showTooltip=function(p){var l=p.target||p.srcElement,r=m.getSizer(),b=m.getZoomLevel(),e;a:{for(;l;){if(a.isHyperlink(l))break a;if(a.isParagraph(l)||a.isInlineRoot(l))break;l=l.parentNode}l=null}if(l){g.containsNode(r,n)||r.appendChild(n);e=f;var k;if(d)switch(d()){case gui.KeyboardHandler.Modifier.Ctrl:k=
runtime.tr("Ctrl-click to follow link");break;case gui.KeyboardHandler.Modifier.Meta:k=runtime.tr("\u2318-click to follow link");break;default:k=""}else k="";e.textContent=k;h.textContent=a.getHyperlinkTarget(l);n.style.display="block";e=c.innerWidth-n.offsetWidth-15;l=p.clientX>e?e:p.clientX+15;e=c.innerHeight-n.offsetHeight-10;p=p.clientY>e?e:p.clientY+10;r=r.getBoundingClientRect();l=(l-r.left)/b;p=(p-r.top)/b;n.style.left=l+"px";n.style.top=p+"px"}};this.hideTooltip=function(){n.style.display=
"none"};this.destroy=function(a){n.parentNode&&n.parentNode.removeChild(n);a()};(function(){var a=m.getElement().ownerDocument;h=a.createElement("span");f=a.createElement("span");h.className="webodf-hyperlinkTooltipLink";f.className="webodf-hyperlinkTooltipText";n=a.createElement("div");n.className="webodf-hyperlinkTooltip";n.appendChild(h);n.appendChild(f);m.getElement().appendChild(n)})()};
gui.OdfFieldView=function(m){function d(){var a=odf.OdfSchema.getFields().map(function(a){return a.replace(":","|")}),d=a.join(",\n")+"\n{ background-color: #D0D0D0; }\n",a=a.map(function(a){return a+":empty::after"}).join(",\n")+"\n{ content:' '; white-space: pre; }\n";return d+"\n"+a}var g,a=m.getElement().ownerDocument;this.showFieldHighlight=function(){g.appendChild(a.createTextNode(d()))};this.hideFieldHighlight=function(){for(var a=g.sheet,d=a.cssRules;d.length;)a.deleteRule(d.length-1)};this.destroy=
function(a){g.parentNode&&g.parentNode.removeChild(g);a()};g=function(){var c=a.getElementsByTagName("head").item(0),d=a.createElement("style"),f="";d.type="text/css";d.media="screen, print, handheld, projection";odf.Namespaces.forEachPrefix(function(a,c){f+="@namespace "+a+" url("+c+");\n"});d.appendChild(a.createTextNode(f));c.appendChild(d);return d}()};
gui.ShadowCursor=function(m){var d=m.getDOMDocument().createRange(),g=!0;this.removeFromDocument=function(){};this.getMemberId=function(){return gui.ShadowCursor.ShadowCursorMemberId};this.getSelectedRange=function(){return d};this.setSelectedRange=function(a,c){d=a;g=!1!==c};this.hasForwardSelection=function(){return g};this.getDocument=function(){return m};this.getSelectionType=function(){return ops.OdtCursor.RangeSelection};d.setStart(m.getRootNode(),0)};gui.ShadowCursor.ShadowCursorMemberId="";
gui.SelectionView=function(m){};gui.SelectionView.prototype.rerender=function(){};gui.SelectionView.prototype.show=function(){};gui.SelectionView.prototype.hide=function(){};gui.SelectionView.prototype.destroy=function(m){};
gui.SelectionViewManager=function(m){function d(){return Object.keys(g).map(function(a){return g[a]})}var g={};this.getSelectionView=function(a){return g.hasOwnProperty(a)?g[a]:null};this.getSelectionViews=d;this.removeSelectionView=function(a){g.hasOwnProperty(a)&&(g[a].destroy(function(){}),delete g[a])};this.hideSelectionView=function(a){g.hasOwnProperty(a)&&g[a].hide()};this.showSelectionView=function(a){g.hasOwnProperty(a)&&g[a].show()};this.rerenderSelectionViews=function(){Object.keys(g).forEach(function(a){g[a].rerender()})};
this.registerCursor=function(a,c){var d=a.getMemberId(),f=new m(a);c?f.show():f.hide();return g[d]=f};this.destroy=function(a){function c(d,g){g?a(g):d<h.length?h[d].destroy(function(a){c(d+1,a)}):a()}var h=d();c(0,void 0)}};gui.SessionViewOptions=function(){this.caretBlinksOnRangeSelect=this.caretAvatarsInitiallyVisible=this.editInfoMarkersInitiallyVisible=!0};
(function(){function m(d,g){return void 0!==d?Boolean(d):g}gui.SessionView=function(d,g,a,c,h,f){function n(b){b.memberId===g&&F.getViewport().scrollIntoView(b.annotation.getBoundingClientRect())}function p(){var b=document.getElementsByTagName("head").item(0),a=document.createElement("style");a.type="text/css";a.media="screen, print, handheld, projection";b.appendChild(a);return a}function l(b,a,e){function c(a,e,d){e=a+'[editinfo|memberid="'+b+'"]'+d+e;a:{var f=B.firstChild;for(a=a+'[editinfo|memberid="'+
b+'"]'+d+"{";f;){if(f.nodeType===Node.TEXT_NODE&&0===f.data.indexOf(a)){a=f;break a}f=f.nextSibling}a=null}a?a.data=e:B.appendChild(document.createTextNode(e))}c("div.editInfoMarker","{ background-color: "+e+"; }","");c("span.editInfoColor","{ background-color: "+e+"; }","");c("span.editInfoAuthor",'{ content: "'+a+'"; }',":before");c("dc|creator","{ background-color: "+e+"; }","");c(".webodf-selectionOverlay","{ fill: "+e+"; stroke: "+e+";}","");b===g&&(c(".webodf-touchEnabled .webodf-selectionOverlay",
"{ display: block; }"," > .webodf-draggable"),b=gui.ShadowCursor.ShadowCursorMemberId,c(".webodf-selectionOverlay","{ fill: "+e+"; stroke: "+e+";}",""),c(".webodf-touchEnabled .webodf-selectionOverlay","{ display: block; }"," > .webodf-draggable"))}function r(b){var a,e;for(e in w)w.hasOwnProperty(e)&&(a=w[e],b?a.show():a.hide())}function b(b){h.getCarets().forEach(function(a){b?a.showHandle():a.hideHandle()})}function e(b){var a=b.getMemberId();b=b.getProperties();l(a,b.fullName,b.color)}function k(b){var e=
b.getMemberId(),c=a.getOdtDocument().getMember(e).getProperties();h.registerCursor(b,s,z);f.registerCursor(b,!0);if(b=h.getCaret(e))b.setAvatarImageUrl(c.imageUrl),b.setColor(c.color);runtime.log("+++ View here +++ eagerly created an Caret for '"+e+"'! +++")}function q(b){b=b.getMemberId();var a=f.getSelectionView(g),e=f.getSelectionView(gui.ShadowCursor.ShadowCursorMemberId),c=h.getCaret(g);b===g?(e.hide(),a&&a.show(),c&&c.show()):b===gui.ShadowCursor.ShadowCursorMemberId&&(e.show(),a&&a.hide(),
c&&c.hide())}function x(b){f.removeSelectionView(b)}function A(b){var e=b.paragraphElement,c=b.memberId;b=b.timeStamp;var d,f="",k=e.getElementsByTagNameNS("urn:webodf:names:editinfo","editinfo").item(0);k?(f=k.getAttributeNS("urn:webodf:names:editinfo","id"),d=w[f]):(f=Math.random().toString(),d=new ops.EditInfo(e,a.getOdtDocument()),d=new gui.EditInfoMarker(d,H),k=e.getElementsByTagNameNS("urn:webodf:names:editinfo","editinfo").item(0),k.setAttributeNS("urn:webodf:names:editinfo","id",f),w[f]=d);
d.addEdit(c,new Date(b));C.trigger()}function v(){var b;""!==u.innerHTML&&(u.innerHTML="");!0===c.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)&&(b=a.getOdtDocument().getMember(g))&&(b=b.getProperties().fullName,u.appendChild(document.createTextNode(".annotationWrapper:not([creator = '"+b+"']) .annotationRemoveButton { display: none; }")))}function t(b){var a=Object.keys(w).map(function(b){return w[b]});D.unsubscribe(ops.Document.signalMemberAdded,e);D.unsubscribe(ops.Document.signalMemberUpdated,
e);D.unsubscribe(ops.Document.signalCursorAdded,k);D.unsubscribe(ops.Document.signalCursorRemoved,x);D.unsubscribe(ops.OdtDocument.signalParagraphChanged,A);D.unsubscribe(ops.Document.signalCursorMoved,q);D.unsubscribe(ops.OdtDocument.signalParagraphChanged,f.rerenderSelectionViews);D.unsubscribe(ops.OdtDocument.signalTableAdded,f.rerenderSelectionViews);D.unsubscribe(ops.OdtDocument.signalParagraphStyleModified,f.rerenderSelectionViews);c.unsubscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,
v);D.unsubscribe(ops.Document.signalMemberAdded,v);D.unsubscribe(ops.Document.signalMemberUpdated,v);B.parentNode.removeChild(B);u.parentNode.removeChild(u);(function I(e,c){c?b(c):e<a.length?a[e].destroy(function(b){I(e+1,b)}):b()})(0,void 0)}var B,u,w={},D,F,C,H=m(d.editInfoMarkersInitiallyVisible,!0),s=m(d.caretAvatarsInitiallyVisible,!0),z=m(d.caretBlinksOnRangeSelect,!0);this.showEditInfoMarkers=function(){H||(H=!0,r(H))};this.hideEditInfoMarkers=function(){H&&(H=!1,r(H))};this.showCaretAvatars=
function(){s||(s=!0,b(s))};this.hideCaretAvatars=function(){s&&(s=!1,b(s))};this.getSession=function(){return a};this.getCaret=function(b){return h.getCaret(b)};this.destroy=function(b){var a=[C.destroy,t];D.unsubscribe(ops.OdtDocument.signalAnnotationAdded,n);core.Async.destroyAll(a,b)};D=a.getOdtDocument();F=D.getOdfCanvas();D.subscribe(ops.OdtDocument.signalAnnotationAdded,n);D.subscribe(ops.Document.signalMemberAdded,e);D.subscribe(ops.Document.signalMemberUpdated,e);D.subscribe(ops.Document.signalCursorAdded,
k);D.subscribe(ops.Document.signalCursorRemoved,x);D.subscribe(ops.OdtDocument.signalParagraphChanged,A);D.subscribe(ops.Document.signalCursorMoved,q);D.subscribe(ops.OdtDocument.signalParagraphChanged,f.rerenderSelectionViews);D.subscribe(ops.OdtDocument.signalTableAdded,f.rerenderSelectionViews);D.subscribe(ops.OdtDocument.signalParagraphStyleModified,f.rerenderSelectionViews);c.subscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,v);D.subscribe(ops.Document.signalMemberAdded,v);D.subscribe(ops.Document.signalMemberUpdated,
v);B=p();B.appendChild(document.createTextNode("@namespace editinfo url(urn:webodf:names:editinfo);"));B.appendChild(document.createTextNode("@namespace dc url(http://purl.org/dc/elements/1.1/);"));u=p();v();C=core.Task.createRedrawTask(function(){var b=F.getAnnotationViewManager();b&&(b.rehighlightAnnotations(),D.fixCursorPositions())})}})();
gui.SvgSelectionView=function(m){function d(){var b=e.getRootNode();k!==b&&(k=b,q=e.getCanvas().getSizer(),q.appendChild(A),A.setAttribute("class","webodf-selectionOverlay"),t.setAttribute("class","webodf-draggable"),B.setAttribute("class","webodf-draggable"),t.setAttribute("end","left"),B.setAttribute("end","right"),t.setAttribute("r",8),B.setAttribute("r",8),A.appendChild(v),A.appendChild(t),A.appendChild(B))}function g(b){b=b.getBoundingClientRect();return Boolean(b&&0!==b.height)}function a(b){var a=
u.getTextElements(b,!0,!1),e=b.cloneRange(),c=b.cloneRange();b=b.cloneRange();if(!a.length)return null;var d;a:{d=0;var f=a[d],k=e.startContainer===f?e.startOffset:0,h=k;e.setStart(f,k);for(e.setEnd(f,h);!g(e);){if(f.nodeType===Node.ELEMENT_NODE&&h<f.childNodes.length)h=f.childNodes.length;else if(f.nodeType===Node.TEXT_NODE&&h<f.length)h+=1;else if(a[d])f=a[d],d+=1,k=h=0;else{d=!1;break a}e.setStart(f,k);e.setEnd(f,h)}d=!0}if(!d)return null;a:{d=a.length-1;f=a[d];h=k=c.endContainer===f?c.endOffset:
f.nodeType===Node.TEXT_NODE?f.length:f.childNodes.length;c.setStart(f,k);for(c.setEnd(f,h);!g(c);){if(f.nodeType===Node.ELEMENT_NODE&&0<k)k=0;else if(f.nodeType===Node.TEXT_NODE&&0<k)k-=1;else if(a[d])f=a[d],d-=1,k=h=f.length||f.childNodes.length;else{a=!1;break a}c.setStart(f,k);c.setEnd(f,h)}a=!0}if(!a)return null;b.setStart(e.startContainer,e.startOffset);b.setEnd(c.endContainer,c.endOffset);return{firstRange:e,lastRange:c,fillerRange:b}}function c(b,a){var e={};e.top=Math.min(b.top,a.top);e.left=
Math.min(b.left,a.left);e.right=Math.max(b.right,a.right);e.bottom=Math.max(b.bottom,a.bottom);e.width=e.right-e.left;e.height=e.bottom-e.top;return e}function h(b,a){a&&0<a.width&&0<a.height&&(b=b?c(b,a):a);return b}function f(b){function a(b){C.setUnfilteredPosition(b,0);return t.acceptNode(b)===H&&z.acceptPosition(C)===H?H:s}function c(b){var e=null;a(b)===H&&(e=w.getBoundingClientRect(b));return e}var d=b.commonAncestorContainer,f=b.startContainer,k=b.endContainer,g=b.startOffset,l=b.endOffset,
m,q,n=null,p,r=x.createRange(),z,t=new odf.OdfNodeFilter,v;if(f===d||k===d)return r=b.cloneRange(),n=r.getBoundingClientRect(),r.detach(),n;for(b=f;b.parentNode!==d;)b=b.parentNode;for(q=k;q.parentNode!==d;)q=q.parentNode;z=e.createRootFilter(f);for(d=b.nextSibling;d&&d!==q;)p=c(d),n=h(n,p),d=d.nextSibling;if(u.isParagraph(b))n=h(n,w.getBoundingClientRect(b));else if(b.nodeType===Node.TEXT_NODE)d=b,r.setStart(d,g),r.setEnd(d,d===q?l:d.length),p=r.getBoundingClientRect(),n=h(n,p);else for(v=x.createTreeWalker(b,
NodeFilter.SHOW_TEXT,a,!1),d=v.currentNode=f;d&&d!==k;)r.setStart(d,g),r.setEnd(d,d.length),p=r.getBoundingClientRect(),n=h(n,p),m=d,g=0,d=v.nextNode();m||(m=f);if(u.isParagraph(q))n=h(n,w.getBoundingClientRect(q));else if(q.nodeType===Node.TEXT_NODE)d=q,r.setStart(d,d===b?g:0),r.setEnd(d,l),p=r.getBoundingClientRect(),n=h(n,p);else for(v=x.createTreeWalker(q,NodeFilter.SHOW_TEXT,a,!1),d=v.currentNode=k;d&&d!==m;)if(r.setStart(d,0),r.setEnd(d,l),p=r.getBoundingClientRect(),n=h(n,p),d=v.previousNode())l=
d.length;return n}function n(b,a){var e=b.getBoundingClientRect(),c={width:0};c.top=e.top;c.bottom=e.bottom;c.height=e.height;c.left=c.right=a?e.right:e.left;return c}function p(){var b=m.getSelectedRange(),e;if(e=F&&m.getSelectionType()===ops.OdtCursor.RangeSelection&&!b.collapsed){d();var k=w.getBoundingClientRect(q),h=D.getZoomLevel(),b=a(b),g,l,s,u,p,r;if(b){e=b.firstRange;g=b.lastRange;l=b.fillerRange;s=w.translateRect(n(e,!1),k,h);p=w.translateRect(n(g,!0),k,h);u=(u=f(l))?w.translateRect(u,
k,h):c(s,p);r=u.left;u=s.left+Math.max(0,u.width-(s.left-u.left));k=Math.min(s.top,p.top);h=p.top+p.height;r=[{x:s.left,y:k+s.height},{x:s.left,y:k},{x:u,y:k},{x:u,y:h-p.height},{x:p.right,y:h-p.height},{x:p.right,y:h},{x:r,y:h},{x:r,y:k+s.height},{x:s.left,y:k+s.height}];u="";var z;for(z=0;z<r.length;z+=1)u+=r[z].x+","+r[z].y+" ";v.setAttribute("points",u);t.setAttribute("cx",s.left);t.setAttribute("cy",k+s.height/2);B.setAttribute("cx",p.right);B.setAttribute("cy",h-p.height/2);e.detach();g.detach();
l.detach()}e=Boolean(b)}A.style.display=e?"block":"none"}function l(b){F&&b===m&&z.trigger()}function r(b){b=8/b;t.setAttribute("r",b);B.setAttribute("r",b)}function b(b){q.removeChild(A);q.classList.remove("webodf-virtualSelections");m.getDocument().unsubscribe(ops.Document.signalCursorMoved,l);D.unsubscribe(gui.ZoomHelper.signalZoomChanged,r);b()}var e=m.getDocument(),k,q,x=e.getDOMDocument(),A=x.createElementNS("http://www.w3.org/2000/svg","svg"),v=x.createElementNS("http://www.w3.org/2000/svg",
"polygon"),t=x.createElementNS("http://www.w3.org/2000/svg","circle"),B=x.createElementNS("http://www.w3.org/2000/svg","circle"),u=odf.OdfUtils,w=core.DomUtils,D=e.getCanvas().getZoomHelper(),F=!0,C=m.getDocument().createPositionIterator(e.getRootNode()),H=NodeFilter.FILTER_ACCEPT,s=NodeFilter.FILTER_REJECT,z;this.rerender=function(){F&&z.trigger()};this.show=function(){F=!0;z.trigger()};this.hide=function(){F=!1;z.trigger()};this.destroy=function(a){core.Async.destroyAll([z.destroy,b],a)};(function(){var b=
m.getMemberId();z=core.Task.createRedrawTask(p);d();A.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",b);q.classList.add("webodf-virtualSelections");m.getDocument().subscribe(ops.Document.signalCursorMoved,l);D.subscribe(gui.ZoomHelper.signalZoomChanged,r);r(D.getZoomLevel())})()};
gui.UndoStateRules=function(){function m(a,d){var f=a.length;this.previous=function(){for(f-=1;0<=f;f-=1)if(d(a[f]))return a[f];return null}}function d(a){a=a.spec();var d;a.hasOwnProperty("position")&&(d=a.position);return d}function g(a){return a.isEdit}function a(a,h,f){if(!f)return f=d(a)-d(h),0===f||1===Math.abs(f);a=d(a);h=d(h);f=d(f);return a-h===h-f}this.isEditOperation=g;this.isPartOfOperationSet=function(c,d){var f=void 0!==c.group,n;if(!c.isEdit||0===d.length)return!0;n=d[d.length-1];if(f&&
c.group===n.group)return!0;a:switch(c.spec().optype){case "RemoveText":case "InsertText":n=!0;break a;default:n=!1}if(n&&d.some(g)){if(f){var p;f=c.spec().optype;n=new m(d,g);var l=n.previous(),r=null,b,e;runtime.assert(Boolean(l),"No edit operations found in state");e=l.group;runtime.assert(void 0!==e,"Operation has no group");for(b=1;l&&l.group===e;){if(f===l.spec().optype){p=l;break}l=n.previous()}if(p){for(l=n.previous();l;){if(l.group!==e){if(2===b)break;e=l.group;b+=1}if(f===l.spec().optype){r=
l;break}l=n.previous()}p=a(c,p,r)}else p=!1;return p}p=c.spec().optype;f=new m(d,g);n=f.previous();runtime.assert(Boolean(n),"No edit operations found in state");p=p===n.spec().optype?a(c,n,f.previous()):!1;return p}return!1}};
gui.TrivialUndoManager=function(m){function d(b){0<b.length&&(B=!0,e(b),B=!1)}function g(){v.emit(gui.UndoManager.signalUndoStackChanged,{undoAvailable:p.hasUndoStates(),redoAvailable:p.hasRedoStates()})}function a(){q!==b&&q!==x[x.length-1]&&x.push(q)}function c(b){var a=b.previousSibling||b.nextSibling;b.parentNode.removeChild(b);l.normalizeTextNodes(a)}function h(b){return Object.keys(b).map(function(a){return b[a]})}function f(b){function a(b){var k=b.spec();if(d[k.memberid])switch(k.optype){case "AddCursor":e[k.memberid]||
(e[k.memberid]=b,delete d[k.memberid],f-=1);break;case "MoveCursor":c[k.memberid]||(c[k.memberid]=b)}}var e={},c={},d={},f,g=b.pop();k.getMemberIds().forEach(function(b){d[b]=!0});for(f=Object.keys(d).length;g&&0<f;)g.reverse(),g.forEach(a),g=b.pop();return h(e).concat(h(c))}function n(){var e=r=k.cloneDocumentElement();l.getElementsByTagNameNS(e,"urn:webodf:names:cursor","cursor").forEach(c);l.getElementsByTagNameNS(e,"urn:webodf:names:cursor","anchor").forEach(c);a();q=b=f([b].concat(x));x.length=
0;A.length=0;g()}var p=this,l=core.DomUtils,r,b=[],e,k,q=[],x=[],A=[],v=new core.EventNotifier([gui.UndoManager.signalUndoStackChanged,gui.UndoManager.signalUndoStateCreated,gui.UndoManager.signalUndoStateModified,gui.TrivialUndoManager.signalDocumentRootReplaced]),t=m||new gui.UndoStateRules,B=!1;this.subscribe=function(b,a){v.subscribe(b,a)};this.unsubscribe=function(b,a){v.unsubscribe(b,a)};this.hasUndoStates=function(){return 0<x.length};this.hasRedoStates=function(){return 0<A.length};this.setDocument=
function(b){k=b};this.purgeInitialState=function(){x.length=0;A.length=0;b.length=0;q.length=0;r=null;g()};this.setInitialState=n;this.initialize=function(){r||n()};this.setPlaybackFunction=function(b){e=b};this.onOperationExecuted=function(e){B||(t.isEditOperation(e)&&(q===b||0<A.length)||!t.isPartOfOperationSet(e,q)?(A.length=0,a(),q=[e],x.push(q),v.emit(gui.UndoManager.signalUndoStateCreated,{operations:q}),g()):(q.push(e),v.emit(gui.UndoManager.signalUndoStateModified,{operations:q})))};this.moveForward=
function(b){for(var a=0,e;b&&A.length;)e=A.pop(),x.push(e),d(e),b-=1,a+=1;a&&(q=x[x.length-1],g());return a};this.moveBackward=function(a){for(var e=0;a&&x.length;)A.push(x.pop()),a-=1,e+=1;e&&(k.getMemberIds().forEach(function(b){k.removeCursor(b)}),k.setDocumentElement(r.cloneNode(!0)),v.emit(gui.TrivialUndoManager.signalDocumentRootReplaced,{}),d(b),x.forEach(d),q=x[x.length-1]||b,g());return e}};gui.TrivialUndoManager.signalDocumentRootReplaced="documentRootReplaced";
odf.GraphicProperties=function(m,d,g){var a=this,c=odf.Namespaces.stylens,h=odf.Namespaces.svgns;this.verticalPos=function(){return a.data.value("verticalPos")};this.verticalRel=function(){return a.data.value("verticalRel")};this.horizontalPos=function(){return a.data.value("horizontalPos")};this.horizontalRel=function(){return a.data.value("horizontalRel")};this.strokeWidth=function(){return a.data.value("strokeWidth")};this.data;a.data=new odf.LazyStyleProperties(void 0===g?void 0:g.data,{verticalPos:function(){var a=
m.getAttributeNS(c,"vertical-pos");return""===a?void 0:a},verticalRel:function(){var a=m.getAttributeNS(c,"vertical-rel");return""===a?void 0:a},horizontalPos:function(){var a=m.getAttributeNS(c,"horizontal-pos");return""===a?void 0:a},horizontalRel:function(){var a=m.getAttributeNS(c,"horizontal-rel");return""===a?void 0:a},strokeWidth:function(){var a=m.getAttributeNS(h,"stroke-width");return d.parseLength(a)}})};
odf.ComputedGraphicProperties=function(){var m;this.setGraphicProperties=function(d){m=d};this.verticalPos=function(){return m&&m.verticalPos()||"from-top"};this.verticalRel=function(){return m&&m.verticalRel()||"page"};this.horizontalPos=function(){return m&&m.horizontalPos()||"from-left"};this.horizontalRel=function(){return m&&m.horizontalRel()||"page"}};
odf.PageLayoutProperties=function(m,d,g){var a=this,c=odf.Namespaces.fons;this.pageHeight=function(){return a.data.value("pageHeight")||1123};this.pageWidth=function(){return a.data.value("pageWidth")||794};this.data;a.data=new odf.LazyStyleProperties(void 0===g?void 0:g.data,{pageHeight:function(){var a;m&&(a=m.getAttributeNS(c,"page-height"),a=d.parseLength(a));return a},pageWidth:function(){var a;m&&(a=m.getAttributeNS(c,"page-width"),a=d.parseLength(a));return a}})};
odf.PageLayout=function(m,d,g){this.pageLayout;var a=null;m&&(a=d.getPropertiesElement("page-layout-properties",m));this.pageLayout=new odf.PageLayoutProperties(a,d,g&&g.pageLayout)};odf.PageLayoutCache=function(){};odf.PageLayoutCache.prototype.getPageLayout=function(m){};odf.PageLayoutCache.prototype.getDefaultPageLayout=function(){};
odf.ParagraphProperties=function(m,d,g){var a=this,c=odf.Namespaces.fons;this.marginTop=function(){return a.data.value("marginTop")};this.data;a.data=new odf.LazyStyleProperties(void 0===g?void 0:g.data,{marginTop:function(){var a=m.getAttributeNS(c,"margin-top");return d.parsePositiveLengthOrPercent(a,"marginTop",g&&g.data)}})};
odf.ComputedParagraphProperties=function(){var m={},d=[];this.setStyleChain=function(g){d=g;m={}};this.marginTop=function(){var g,a;if(m.hasOwnProperty("marginTop"))g=m.marginTop;else{for(a=0;void 0===g&&a<d.length;a+=1)g=d[a].marginTop();m.marginTop=g}return g||0}};
odf.TextProperties=function(m,d,g){var a=this,c=odf.Namespaces.fons;this.fontSize=function(){return a.data.value("fontSize")};this.data;a.data=new odf.LazyStyleProperties(void 0===g?void 0:g.data,{fontSize:function(){var a=m.getAttributeNS(c,"font-size");return d.parsePositiveLengthOrPercent(a,"fontSize",g&&g.data)}})};
odf.ComputedTextProperties=function(){var m={},d=[];this.setStyleChain=function(g){d=g;m={}};this.fontSize=function(){var g,a;if(m.hasOwnProperty("fontSize"))g=m.fontSize;else{for(a=0;void 0===g&&a<d.length;a+=1)g=d[a].fontSize();m.fontSize=g}return g||12}};odf.MasterPage=function(m,d){this.pageLayout;var g;m?(g=m.getAttributeNS(odf.Namespaces.stylens,"page-layout-name"),this.pageLayout=d.getPageLayout(g)):this.pageLayout=d.getDefaultPageLayout()};odf.MasterPageCache=function(){};
odf.MasterPageCache.prototype.getMasterPage=function(m){};
odf.StylePileEntry=function(m,d,g,a){this.text;this.paragraph;this.graphic;this.masterPage=function(){var a=m.getAttributeNS(odf.Namespaces.stylens,"master-page-name"),d=null;a&&(d=g.getMasterPage(a));return d};(function(c){var h=m.getAttributeNS(odf.Namespaces.stylens,"family"),f=null;if("graphic"===h||"chart"===h)c.graphic=void 0===a?void 0:a.graphic,f=d.getPropertiesElement("graphic-properties",m,f),null!==f&&(c.graphic=new odf.GraphicProperties(f,d,c.graphic));if("paragraph"===h||"table-cell"===
h||"graphic"===h||"presentation"===h||"chart"===h)c.paragraph=void 0===a?void 0:a.paragraph,f=d.getPropertiesElement("paragraph-properties",m,f),null!==f&&(c.paragraph=new odf.ParagraphProperties(f,d,c.paragraph));if("text"===h||"paragraph"===h||"table-cell"===h||"graphic"===h||"presentation"===h||"chart"===h)c.text=void 0===a?void 0:a.text,f=d.getPropertiesElement("text-properties",m,f),null!==f&&(c.text=new odf.TextProperties(f,d,c.text))})(this)};
odf.StylePile=function(m,d){function g(c,b){var e,f;c.hasAttributeNS(a,"parent-style-name")&&(f=c.getAttributeNS(a,"parent-style-name"),-1===b.indexOf(f)&&(e=l(f,b)));return new odf.StylePileEntry(c,m,d,e)}var a=odf.Namespaces.stylens,c={},h={},f,n={},p={},l;l=function(a,b){var e=n[a],d;!e&&(d=c[a])&&(b.push(a),e=g(d,b),n[a]=e);return e};this.getStyle=function(a){var b=p[a]||n[a],e,d=[];b||(e=h[a],e||(e=c[a])&&d.push(a),e&&(b=g(e,d)));return b};this.addCommonStyle=function(d){var b;d.hasAttributeNS(a,
"name")&&(b=d.getAttributeNS(a,"name"),c.hasOwnProperty(b)||(c[b]=d))};this.addAutomaticStyle=function(c){var b;c.hasAttributeNS(a,"name")&&(b=c.getAttributeNS(a,"name"),h.hasOwnProperty(b)||(h[b]=c))};this.setDefaultStyle=function(a){void 0===f&&(f=g(a,[]))};this.getDefaultStyle=function(){return f}};odf.ComputedGraphicStyle=function(){this.text=new odf.ComputedTextProperties;this.paragraph=new odf.ComputedParagraphProperties;this.graphic=new odf.ComputedGraphicProperties};
odf.ComputedParagraphStyle=function(){this.text=new odf.ComputedTextProperties;this.paragraph=new odf.ComputedParagraphProperties};odf.ComputedTextStyle=function(){this.text=new odf.ComputedTextProperties};
odf.StyleCache=function(m){function d(b,a,e,c){a=e.getAttributeNS(a,"class-names");var d;if(a)for(a=a.split(" "),d=0;d<a.length;d+=1)if(e=a[d])c.push(b),c.push(e)}function g(b,a){var e=A.getStyleName("paragraph",b);void 0!==e&&(a.push("paragraph"),a.push(e));b.namespaceURI!==q||"h"!==b.localName&&"p"!==b.localName||d("paragraph",q,b,a);return a}function a(b,a,e){var c=[],d,f,k,h;for(d=0;d<b.length;d+=2)k=b[d],h=b[d+1],k=n[k],h=k.getStyle(h),void 0!==h&&(h=h[a],void 0!==h&&h!==f&&(c.push(h),f=h));
k=n[e];if(h=k.getDefaultStyle())h=h[a],void 0!==h&&h!==f&&c.push(h);return c}function c(b,a){var e=A.getStyleName("text",b),f=b.parentNode;void 0!==e&&(a.push("text"),a.push(e));"span"===b.localName&&b.namespaceURI===q&&d("text",q,b,a);if(!f||f===m)return a;f.namespaceURI!==q||"p"!==f.localName&&"h"!==f.localName?c(f,a):g(f,a);return a}function h(b){b=b.getAttributeNS(x,"family");return n[b]}var f=this,n,p,l,r,b,e,k,q=odf.Namespaces.textns,x=odf.Namespaces.stylens,A=new odf.StyleInfo,v=new odf.StyleParseUtils,
t,B,u,w,D,F;this.getComputedGraphicStyle=function(b){var e=[];b=A.getStyleName("graphic",b);void 0!==b&&(e.push("graphic"),e.push(b));b=e.join("/");var c=r[b];runtime.assert(0===e.length%2,"Invalid style chain.");void 0===c&&(c=new odf.ComputedGraphicStyle,c.graphic.setGraphicProperties(a(e,"graphic","graphic")[0]),c.text.setStyleChain(a(e,"text","graphic")),c.paragraph.setStyleChain(a(e,"paragraph","graphic")),r[b]=c);return c};this.getComputedParagraphStyle=function(b){b=g(b,[]);var e=b.join("/"),
c=l[e];runtime.assert(0===b.length%2,"Invalid style chain.");void 0===c&&(c=new odf.ComputedParagraphStyle,c.text.setStyleChain(a(b,"text","paragraph")),c.paragraph.setStyleChain(a(b,"paragraph","paragraph")),l[e]=c);return c};this.getComputedTextStyle=function(b){b=c(b,[]);var e=b.join("/"),d=p[e];runtime.assert(0===b.length%2,"Invalid style chain.");void 0===d&&(d=new odf.ComputedTextStyle,d.text.setStyleChain(a(b,"text","text")),p[e]=d);return d};this.getPageLayout=function(b){var a=F[b];a||((a=
D[b])?(a=new odf.PageLayout(a,v,w),F[b]=a):a=w);return a};this.getDefaultPageLayout=function(){return w};this.getMasterPage=function(b){var a=B[b];void 0===a&&((a=t[b])?(a=new odf.MasterPage(a,f),B[b]=a):a=null);return a};this.getDefaultMasterPage=function(){return u};this.update=function(){var a,c,d=null,g=null;p={};l={};r={};t={};B={};F={};D={};b=new odf.StylePile(v,f);e=new odf.StylePile(v,f);k=new odf.StylePile(v,f);n={text:b,paragraph:e,graphic:k};for(a=m.styles.firstElementChild;a;)a.namespaceURI===
x&&((c=h(a))?"style"===a.localName?c.addCommonStyle(a):"default-style"===a.localName&&c.setDefaultStyle(a):"default-page-layout"===a.localName&&(d=a)),a=a.nextElementSibling;w=new odf.PageLayout(d,v);for(a=m.automaticStyles.firstElementChild;a;)a.namespaceURI===x&&((c=h(a))&&"style"===a.localName?c.addAutomaticStyle(a):"page-layout"===a.localName&&(D[a.getAttributeNS(x,"name")]=a)),a=a.nextElementSibling;for(a=m.masterStyles.firstElementChild;a;)a.namespaceURI===x&&"master-page"===a.localName&&(g=
g||a,c=a,d=c.getAttributeNS(x,"name"),0<d.length&&!t.hasOwnProperty(d)&&(t[d]=c)),a=a.nextElementSibling;u=new odf.MasterPage(g,f)}};
ops.OperationTransformMatrix=function(){function m(b){b.position+=b.length;b.length*=-1}function d(b){var a=0>b.length;a&&m(b);return a}function g(b,a){function c(f){b[f]===a&&d.push(f)}var d=[];b&&["style:parent-style-name","style:next-style-name"].forEach(c);return d}function a(b,a){function c(d){b[d]===a&&delete b[d]}b&&["style:parent-style-name","style:next-style-name"].forEach(c)}function c(b){var a={};Object.keys(b).forEach(function(d){a[d]="object"===typeof b[d]?c(b[d]):b[d]});return a}function h(b,
a,c,d){var f,h=!1,g=!1,l,m=[];d&&d.attributes&&(m=d.attributes.split(","));b&&(c||0<m.length)&&Object.keys(b).forEach(function(a){var e=b[a],d;"object"!==typeof e&&(c&&(d=c[a]),void 0!==d?(delete b[a],g=!0,d===e&&(delete c[a],h=!0)):-1!==m.indexOf(a)&&(delete b[a],g=!0))});if(a&&a.attributes&&(c||0<m.length)){l=a.attributes.split(",");for(d=0;d<l.length;d+=1)if(f=l[d],c&&void 0!==c[f]||m&&-1!==m.indexOf(f))l.splice(d,1),d-=1,g=!0;0<l.length?a.attributes=l.join(","):delete a.attributes}return{majorChanged:h,
minorChanged:g}}function f(b){for(var a in b)if(b.hasOwnProperty(a))return!0;return!1}function n(b){for(var a in b)if(b.hasOwnProperty(a)&&("attributes"!==a||0<b.attributes.length))return!0;return!1}function p(b,a,c,d,g){var l=b?b[g]:null,m=a?a[g]:null,p=c?c[g]:null,r=d?d[g]:null,u;u=h(l,m,p,r);l&&!f(l)&&delete b[g];m&&!n(m)&&delete a[g];p&&!f(p)&&delete c[g];r&&!n(r)&&delete d[g];return u}function l(b,a){return{opSpecsA:[b],opSpecsB:[a]}}var r;r={AddCursor:{AddCursor:l,AddMember:l,AddStyle:l,ApplyDirectStyling:l,
InsertText:l,MergeParagraph:l,MoveCursor:l,RemoveCursor:l,RemoveMember:l,RemoveStyle:l,RemoveText:l,SetParagraphStyle:l,SplitParagraph:l,UpdateMember:l,UpdateMetadata:l,UpdateParagraphStyle:l},AddMember:{AddStyle:l,ApplyDirectStyling:l,InsertText:l,MergeParagraph:l,MoveCursor:l,RemoveCursor:l,RemoveStyle:l,RemoveText:l,SetParagraphStyle:l,SplitParagraph:l,UpdateMetadata:l,UpdateParagraphStyle:l},AddStyle:{AddStyle:l,ApplyDirectStyling:l,InsertText:l,MergeParagraph:l,MoveCursor:l,RemoveCursor:l,RemoveMember:l,
RemoveStyle:function(b,e){var c,d=[b],f=[e];b.styleFamily===e.styleFamily&&(c=g(b.setProperties,e.styleName),0<c.length&&(c={optype:"UpdateParagraphStyle",memberid:e.memberid,timestamp:e.timestamp,styleName:b.styleName,removedProperties:{attributes:c.join(",")}},f.unshift(c)),a(b.setProperties,e.styleName));return{opSpecsA:d,opSpecsB:f}},RemoveText:l,SetParagraphStyle:l,SplitParagraph:l,UpdateMember:l,UpdateMetadata:l,UpdateParagraphStyle:l},ApplyDirectStyling:{ApplyDirectStyling:function(b,a,d){var h,
g,l,m,n,r,u,w;m=[b];l=[a];if(!(b.position+b.length<=a.position||b.position>=a.position+a.length)){h=d?b:a;g=d?a:b;if(b.position!==a.position||b.length!==a.length)r=c(h),u=c(g);a=p(g.setProperties,null,h.setProperties,null,"style:text-properties");if(a.majorChanged||a.minorChanged)l=[],b=[],m=h.position+h.length,n=g.position+g.length,g.position<h.position?a.minorChanged&&(w=c(u),w.length=h.position-g.position,b.push(w),g.position=h.position,g.length=n-g.position):h.position<g.position&&a.majorChanged&&
(w=c(r),w.length=g.position-h.position,l.push(w),h.position=g.position,h.length=m-h.position),n>m?a.minorChanged&&(r=u,r.position=m,r.length=n-m,b.push(r),g.length=m-g.position):m>n&&a.majorChanged&&(r.position=n,r.length=m-n,l.push(r),h.length=n-h.position),h.setProperties&&f(h.setProperties)&&l.push(h),g.setProperties&&f(g.setProperties)&&b.push(g),d?(m=l,l=b):m=b}return{opSpecsA:m,opSpecsB:l}},InsertText:function(b,a){a.position<=b.position?b.position+=a.text.length:a.position<=b.position+b.length&&
(b.length+=a.text.length);return{opSpecsA:[b],opSpecsB:[a]}},MergeParagraph:function(b,a){var c=b.position,d=b.position+b.length;c>=a.sourceStartPosition&&(c-=1);d>=a.sourceStartPosition&&(d-=1);b.position=c;b.length=d-c;return{opSpecsA:[b],opSpecsB:[a]}},MoveCursor:l,RemoveCursor:l,RemoveMember:l,RemoveStyle:l,RemoveText:function(b,a){var c=b.position+b.length,d=a.position+a.length,f=[b],h=[a];d<=b.position?b.position-=a.length:a.position<c&&(b.position<a.position?b.length=d<c?b.length-a.length:
a.position-b.position:(b.position=a.position,d<c?b.length=c-d:f=[]));return{opSpecsA:f,opSpecsB:h}},SetParagraphStyle:l,SplitParagraph:function(b,a){a.position<b.position?b.position+=1:a.position<b.position+b.length&&(b.length+=1);return{opSpecsA:[b],opSpecsB:[a]}},UpdateMember:l,UpdateMetadata:l,UpdateParagraphStyle:l},InsertText:{InsertText:function(b,a,c){b.position<a.position?a.position+=b.text.length:b.position>a.position?b.position+=a.text.length:c?a.position+=b.text.length:b.position+=a.text.length;
return{opSpecsA:[b],opSpecsB:[a]}},MergeParagraph:function(b,a){b.position>=a.sourceStartPosition?b.position-=1:(b.position<a.sourceStartPosition&&(a.sourceStartPosition+=b.text.length),b.position<a.destinationStartPosition&&(a.destinationStartPosition+=b.text.length));return{opSpecsA:[b],opSpecsB:[a]}},MoveCursor:function(b,a){var c=d(a);b.position<a.position?a.position+=b.text.length:b.position<a.position+a.length&&(a.length+=b.text.length);c&&m(a);return{opSpecsA:[b],opSpecsB:[a]}},RemoveCursor:l,
RemoveMember:l,RemoveStyle:l,RemoveText:function(b,a){var c;c=a.position+a.length;var d=[b],f=[a];c<=b.position?b.position-=a.length:b.position<=a.position?a.position+=b.text.length:(a.length=b.position-a.position,c={optype:"RemoveText",memberid:a.memberid,timestamp:a.timestamp,position:b.position+b.text.length,length:c-b.position},f.unshift(c),b.position=a.position);return{opSpecsA:d,opSpecsB:f}},SetParagraphStyle:function(b,a){a.position>b.position&&(a.position+=b.text.length);return{opSpecsA:[b],
opSpecsB:[a]}},SplitParagraph:function(b,a){b.position<a.sourceParagraphPosition&&(a.sourceParagraphPosition+=b.text.length);b.position<=a.position?a.position+=b.text.length:b.position+=1;return{opSpecsA:[b],opSpecsB:[a]}},UpdateMember:l,UpdateMetadata:l,UpdateParagraphStyle:l},MergeParagraph:{MergeParagraph:function(b,a,c){var d=[b],f=[a],h;b.destinationStartPosition===a.destinationStartPosition?(d=[],f=[],b.moveCursor&&(h={optype:"MoveCursor",memberid:b.memberid,timestamp:b.timestamp,position:b.sourceStartPosition-
1},d.push(h)),a.moveCursor&&(h={optype:"MoveCursor",memberid:a.memberid,timestamp:a.timestamp,position:a.sourceStartPosition-1},f.push(h)),b=c?b:a,b={optype:"SetParagraphStyle",memberid:b.memberid,timestamp:b.timestamp,position:b.destinationStartPosition,styleName:b.paragraphStyleName},c?d.push(b):f.push(b)):a.sourceStartPosition===b.destinationStartPosition?(b.destinationStartPosition=a.destinationStartPosition,b.sourceStartPosition-=1,b.paragraphStyleName=a.paragraphStyleName):b.sourceStartPosition===
a.destinationStartPosition?(a.destinationStartPosition=b.destinationStartPosition,a.sourceStartPosition-=1,a.paragraphStyleName=b.paragraphStyleName):b.destinationStartPosition<a.destinationStartPosition?(a.destinationStartPosition-=1,a.sourceStartPosition-=1):(b.destinationStartPosition-=1,b.sourceStartPosition-=1);return{opSpecsA:d,opSpecsB:f}},MoveCursor:function(b,a){var c=a.position,d=a.position+a.length,f=Math.min(c,d),c=Math.max(c,d);f>=b.sourceStartPosition&&(f-=1);c>=b.sourceStartPosition&&
(c-=1);0<=a.length?(a.position=f,a.length=c-f):(a.position=c,a.length=f-c);return{opSpecsA:[b],opSpecsB:[a]}},RemoveCursor:l,RemoveMember:l,RemoveStyle:l,RemoveText:function(b,a){a.position>=b.sourceStartPosition?a.position-=1:(a.position<b.destinationStartPosition&&(b.destinationStartPosition-=a.length),a.position<b.sourceStartPosition&&(b.sourceStartPosition-=a.length));return{opSpecsA:[b],opSpecsB:[a]}},SetParagraphStyle:function(b,a){var c=[b],d=[a];if(a.position>b.sourceStartPosition)a.position-=
1;else if(a.position===b.destinationStartPosition||a.position===b.sourceStartPosition)a.position=b.destinationStartPosition,b.paragraphStyleName=a.styleName;return{opSpecsA:c,opSpecsB:d}},SplitParagraph:function(b,a){var c,d=[b],f=[a];a.position<b.destinationStartPosition?(b.destinationStartPosition+=1,b.sourceStartPosition+=1):a.position>=b.destinationStartPosition&&a.position<b.sourceStartPosition?(a.paragraphStyleName=b.paragraphStyleName,c={optype:"SetParagraphStyle",memberid:b.memberid,timestamp:b.timestamp,
position:b.destinationStartPosition,styleName:b.paragraphStyleName},d.push(c),a.position===b.sourceStartPosition-1&&b.moveCursor&&(c={optype:"MoveCursor",memberid:b.memberid,timestamp:b.timestamp,position:a.position,length:0},d.push(c)),b.destinationStartPosition=a.position+1,b.sourceStartPosition+=1):a.position>=b.sourceStartPosition&&(a.position-=1,a.sourceParagraphPosition-=1);return{opSpecsA:d,opSpecsB:f}},UpdateMember:l,UpdateMetadata:l,UpdateParagraphStyle:l},MoveCursor:{MoveCursor:l,RemoveCursor:function(b,
a){return{opSpecsA:b.memberid===a.memberid?[]:[b],opSpecsB:[a]}},RemoveMember:l,RemoveStyle:l,RemoveText:function(b,a){var c=d(b),f=b.position+b.length,h=a.position+a.length;h<=b.position?b.position-=a.length:a.position<f&&(b.position<a.position?b.length=h<f?b.length-a.length:a.position-b.position:(b.position=a.position,b.length=h<f?f-h:0));c&&m(b);return{opSpecsA:[b],opSpecsB:[a]}},SetParagraphStyle:l,SplitParagraph:function(b,a){var c=d(b);a.position<b.position?b.position+=1:a.position<b.position+
b.length&&(b.length+=1);c&&m(b);return{opSpecsA:[b],opSpecsB:[a]}},UpdateMember:l,UpdateMetadata:l,UpdateParagraphStyle:l},RemoveCursor:{RemoveCursor:function(b,a){var c=b.memberid===a.memberid;return{opSpecsA:c?[]:[b],opSpecsB:c?[]:[a]}},RemoveMember:l,RemoveStyle:l,RemoveText:l,SetParagraphStyle:l,SplitParagraph:l,UpdateMember:l,UpdateMetadata:l,UpdateParagraphStyle:l},RemoveMember:{RemoveStyle:l,RemoveText:l,SetParagraphStyle:l,SplitParagraph:l,UpdateMetadata:l,UpdateParagraphStyle:l},RemoveStyle:{RemoveStyle:function(b,
a){var c=b.styleName===a.styleName&&b.styleFamily===a.styleFamily;return{opSpecsA:c?[]:[b],opSpecsB:c?[]:[a]}},RemoveText:l,SetParagraphStyle:function(b,a){var c,d=[b],f=[a];"paragraph"===b.styleFamily&&b.styleName===a.styleName&&(c={optype:"SetParagraphStyle",memberid:b.memberid,timestamp:b.timestamp,position:a.position,styleName:""},d.unshift(c),a.styleName="");return{opSpecsA:d,opSpecsB:f}},SplitParagraph:l,UpdateMember:l,UpdateMetadata:l,UpdateParagraphStyle:function(b,e){var c,d=[b],f=[e];"paragraph"===
b.styleFamily&&(c=g(e.setProperties,b.styleName),0<c.length&&(c={optype:"UpdateParagraphStyle",memberid:b.memberid,timestamp:b.timestamp,styleName:e.styleName,removedProperties:{attributes:c.join(",")}},d.unshift(c)),b.styleName===e.styleName?f=[]:a(e.setProperties,b.styleName));return{opSpecsA:d,opSpecsB:f}}},RemoveText:{RemoveText:function(b,a){var c=b.position+b.length,d=a.position+a.length,f=[b],h=[a];d<=b.position?b.position-=a.length:c<=a.position?a.position-=b.length:a.position<c&&(b.position<
a.position?(b.length=d<c?b.length-a.length:a.position-b.position,c<d?(a.position=b.position,a.length=d-c):h=[]):(c<d?a.length-=b.length:a.position<b.position?a.length=b.position-a.position:h=[],d<c?(b.position=a.position,b.length=c-d):f=[]));return{opSpecsA:f,opSpecsB:h}},SetParagraphStyle:function(b,a){b.position<a.position&&(a.position-=b.length);return{opSpecsA:[b],opSpecsB:[a]}},SplitParagraph:function(b,a){var c=b.position+b.length,d=[b],f=[a];a.position<=b.position?b.position+=1:a.position<
c&&(b.length=a.position-b.position,c={optype:"RemoveText",memberid:b.memberid,timestamp:b.timestamp,position:a.position+1,length:c-a.position},d.unshift(c));b.position+b.length<=a.position?a.position-=b.length:b.position<a.position&&(a.position=b.position);b.position+b.length<a.sourceParagraphPosition&&(a.sourceParagraphPosition-=b.length);return{opSpecsA:d,opSpecsB:f}},UpdateMember:l,UpdateMetadata:l,UpdateParagraphStyle:l},SetParagraphStyle:{SetParagraphStyle:function(b,a,c){b.position===a.position&&
(c?a.styleName=b.styleName:b.styleName=a.styleName);return{opSpecsA:[b],opSpecsB:[a]}},SplitParagraph:function(b,a){var d=[b],f=[a],h;b.position>a.position?b.position+=1:b.position===a.sourceParagraphPosition&&(a.paragraphStyleName=b.styleName,h=c(b),h.position=a.position+1,d.push(h));return{opSpecsA:d,opSpecsB:f}},UpdateMember:l,UpdateMetadata:l,UpdateParagraphStyle:l},SplitParagraph:{SplitParagraph:function(b,a,c){var d,f;b.position<a.position?d=!0:a.position<b.position?f=!0:b.position===a.position&&
(c?d=!0:f=!0);d?(a.position+=1,a.sourceParagraphPosition=b.position<a.sourceParagraphPosition?a.sourceParagraphPosition+1:b.position+1):f&&(b.position+=1,b.sourceParagraphPosition=a.position<a.sourceParagraphPosition?b.sourceParagraphPosition+1:a.position+1);return{opSpecsA:[b],opSpecsB:[a]}},UpdateMember:l,UpdateMetadata:l,UpdateParagraphStyle:l},UpdateMember:{UpdateMetadata:l,UpdateParagraphStyle:l},UpdateMetadata:{UpdateMetadata:function(b,a,c){var d,g=[b],l=[a];d=c?b:a;b=c?a:b;h(b.setProperties||
null,b.removedProperties||null,d.setProperties||null,d.removedProperties||null);d.setProperties&&f(d.setProperties)||d.removedProperties&&n(d.removedProperties)||(c?g=[]:l=[]);b.setProperties&&f(b.setProperties)||b.removedProperties&&n(b.removedProperties)||(c?l=[]:g=[]);return{opSpecsA:g,opSpecsB:l}},UpdateParagraphStyle:l},UpdateParagraphStyle:{UpdateParagraphStyle:function(b,a,c){var d,g=[b],l=[a];b.styleName===a.styleName&&(d=c?b:a,b=c?a:b,p(b.setProperties,b.removedProperties,d.setProperties,
d.removedProperties,"style:paragraph-properties"),p(b.setProperties,b.removedProperties,d.setProperties,d.removedProperties,"style:text-properties"),h(b.setProperties||null,b.removedProperties||null,d.setProperties||null,d.removedProperties||null),d.setProperties&&f(d.setProperties)||d.removedProperties&&n(d.removedProperties)||(c?g=[]:l=[]),b.setProperties&&f(b.setProperties)||b.removedProperties&&n(b.removedProperties)||(c?l=[]:g=[]));return{opSpecsA:g,opSpecsB:l}}}};this.passUnchanged=l;this.extendTransformations=
function(b){Object.keys(b).forEach(function(a){var c=b[a],d,f=r.hasOwnProperty(a);runtime.log((f?"Extending":"Adding")+" map for optypeA: "+a);f||(r[a]={});d=r[a];Object.keys(c).forEach(function(b){var f=d.hasOwnProperty(b);runtime.assert(a<=b,"Wrong order:"+a+", "+b);runtime.log("  "+(f?"Overwriting":"Adding")+" entry for optypeB: "+b);d[b]=c[b]})})};this.transformOpspecVsOpspec=function(b,a){var c=b.optype<=a.optype,d;runtime.log("Crosstransforming:");runtime.log(runtime.toJson(b));runtime.log(runtime.toJson(a));
c||(d=b,b=a,a=d);(d=(d=r[b.optype])&&d[a.optype])?(d=d(b,a,!c),c||null===d||(d={opSpecsA:d.opSpecsB,opSpecsB:d.opSpecsA})):d=null;runtime.log("result:");d?(runtime.log(runtime.toJson(d.opSpecsA)),runtime.log(runtime.toJson(d.opSpecsB))):runtime.log("null");return d}};
ops.OperationTransformer=function(){function m(g,a){for(var c,h,f=[],n=[];0<g.length&&a;){c=g.shift();c=d.transformOpspecVsOpspec(c,a);if(!c)return null;f=f.concat(c.opSpecsA);if(0===c.opSpecsB.length){f=f.concat(g);a=null;break}for(;1<c.opSpecsB.length;){h=m(g,c.opSpecsB.shift());if(!h)return null;n=n.concat(h.opSpecsB);g=h.opSpecsA}a=c.opSpecsB.pop()}a&&n.push(a);return{opSpecsA:f,opSpecsB:n}}var d=new ops.OperationTransformMatrix;this.getOperationTransformMatrix=function(){return d};this.transform=
function(d,a){for(var c,h=[];0<a.length;){c=m(d,a.shift());if(!c)return null;d=c.opSpecsA;h=h.concat(c.opSpecsB)}return{opSpecsA:d,opSpecsB:h}}};var webodf_css='@namespace draw url(urn:oasis:names:tc:opendocument:xmlns:drawing:1.0);@namespace fo url(urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0);@namespace office url(urn:oasis:names:tc:opendocument:xmlns:office:1.0);@namespace presentation url(urn:oasis:names:tc:opendocument:xmlns:presentation:1.0);@namespace style url(urn:oasis:names:tc:opendocument:xmlns:style:1.0);@namespace svg url(urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0);@namespace table url(urn:oasis:names:tc:opendocument:xmlns:table:1.0);@namespace text url(urn:oasis:names:tc:opendocument:xmlns:text:1.0);@namespace webodfhelper url(urn:webodf:names:helper);@namespace cursor url(urn:webodf:names:cursor);@namespace editinfo url(urn:webodf:names:editinfo);@namespace annotation url(urn:webodf:names:annotation);@namespace dc url(http://purl.org/dc/elements/1.1/);@namespace svgns url(http://www.w3.org/2000/svg);office|document > *, office|document-content > * {display: none;}office|body, office|document {display: inline-block;position: relative;}text|p, text|h {display: block;padding: 0;margin: 0;line-height: normal;position: relative;}text|p::after, text|h::after {content: "\\200B";white-space: pre;}*[webodfhelper|containsparagraphanchor] {position: relative;}text|s {white-space: pre;}text|tab {display: inline;white-space: pre;}text|tracked-changes {display: none;}office|binary-data {display: none;}office|text {display: block;text-align: left;overflow: visible;word-wrap: break-word;}office|text::selection {background: transparent;}.webodf-virtualSelections *::selection {background: transparent;}.webodf-virtualSelections *::-moz-selection {background: transparent;}office|text * draw|text-box {display: block;border: 1px solid #d3d3d3;}office|text draw|frame {z-index: 1;}office|spreadsheet {display: block;border-collapse: collapse;empty-cells: show;font-family: sans-serif;font-size: 10pt;text-align: left;page-break-inside: avoid;overflow: hidden;}office|presentation {display: inline-block;text-align: left;}#shadowContent {display: inline-block;text-align: left;}draw|page {display: block;position: relative;overflow: hidden;}presentation|notes, presentation|footer-decl, presentation|date-time-decl {display: none;}@media print {draw|page {border: 1pt solid black;page-break-inside: avoid;}presentation|notes {}}office|spreadsheet text|p {border: 0px;padding: 1px;margin: 0px;}office|spreadsheet table|table {margin: 3px;}office|spreadsheet table|table:after {}office|spreadsheet table|table-row {counter-increment: row;}office|spreadsheet table|table-row:before {width: 3em;background: #cccccc;border: 1px solid black;text-align: center;content: counter(row);display: table-cell;}office|spreadsheet table|table-cell {border: 1px solid #cccccc;}table|table {display: table;}draw|frame table|table {width: 100%;height: 100%;background: white;}table|table-header-rows {display: table-header-group;}table|table-row {display: table-row;}table|table-column {display: table-column;}table|table-cell {width: 0.889in;display: table-cell;word-break: break-all;}draw|frame {display: block;}draw|image {display: block;width: 100%;height: 100%;top: 0px;left: 0px;background-repeat: no-repeat;background-size: 100% 100%;-moz-background-size: 100% 100%;}draw|frame > draw|image:nth-of-type(n+2) {display: none;}text|list:before {display: none;content:"";}text|list {display: block;}text|list-item {display: block;}text|number {display:none;}text|a {color: blue;text-decoration: underline;cursor: pointer;}.webodf-inactiveLinks text|a {cursor: text;}text|note-citation {vertical-align: super;font-size: smaller;}text|note-body {display: none;}text|note:hover text|note-citation {background: #dddddd;}text|note:hover text|note-body {display: block;left:1em;max-width: 80%;position: absolute;background: #ffffaa;}text|bibliography-source {display: none;}svg|title, svg|desc {display: none;}video {width: 100%;height: 100%}cursor|anchor {display: none;}cursor|cursor {display: none;}.webodf-caretOverlay {position: absolute;top: 5%;height: 1em;z-index: 10;padding-left: 1px;pointer-events: none;}.webodf-caretOverlay .caret {position: absolute;border-left: 2px solid black;top: 0;bottom: 0;right: 0;}.webodf-caretOverlay .handle {position: absolute;margin-top: 5px;padding-top: 3px;margin-left: auto;margin-right: auto;width: 64px;height: 68px;border-radius: 5px;opacity: 0.3;text-align: center;background-color: black;box-shadow: 0px 0px 5px rgb(90, 90, 90);border: 1px solid black;top: -85px;right: -32px;}.webodf-caretOverlay .handle > img {box-shadow: 0px 0px 5px rgb(90, 90, 90) inset;background-color: rgb(200, 200, 200);border-radius: 5px;border: 2px solid;height: 60px;width: 60px;display: block;margin: auto;}.webodf-caretOverlay .handle.active {opacity: 0.8;}.webodf-caretOverlay .handle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 43%;}.webodf-caretSizer {display: inline-block;width: 0;visibility: hidden;}#eventTrap {display: block;position: absolute;bottom: 0;left: 0;outline: none;opacity: 0;color: rgba(255, 255, 255, 0);pointer-events: none;white-space: pre;overflow: hidden;}cursor|cursor > #composer {text-decoration: underline;}cursor|cursor[cursor|caret-sizer-active="true"],cursor|cursor[cursor|composing="true"] {display: inline;}editinfo|editinfo {display: inline-block;}.editInfoMarker {position: absolute;width: 10px;height: 100%;left: -20px;opacity: 0.8;top: 0;border-radius: 5px;background-color: transparent;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);}.editInfoMarker:hover {box-shadow: 0px 0px 8px rgba(0, 0, 0, 1);}.editInfoHandle {position: absolute;background-color: black;padding: 5px;border-radius: 5px;opacity: 0.8;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);bottom: 100%;margin-bottom: 10px;z-index: 3;left: -25px;}.editInfoHandle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 5px;}.editInfo {font-family: sans-serif;font-weight: normal;font-style: normal;text-decoration: none;color: white;width: 100%;height: 12pt;}.editInfoColor {float: left;width: 10pt;height: 10pt;border: 1px solid white;}.editInfoAuthor {float: left;margin-left: 5pt;font-size: 10pt;text-align: left;height: 12pt;line-height: 12pt;}.editInfoTime {float: right;margin-left: 30pt;font-size: 8pt;font-style: italic;color: yellow;height: 12pt;line-height: 12pt;}.annotationWrapper {display: inline;position: relative;}.annotationRemoveButton:before {content: "\u00d7";color: white;padding: 5px;line-height: 1em;}.annotationRemoveButton {width: 20px;height: 20px;border-radius: 10px;background-color: black;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);position: absolute;top: -10px;left: -10px;z-index: 3;text-align: center;font-family: sans-serif;font-style: normal;font-weight: normal;text-decoration: none;font-size: 15px;}.annotationRemoveButton:hover {cursor: pointer;box-shadow: 0px 0px 5px rgba(0, 0, 0, 1);}.annotationNote {width: 4cm;position: absolute;display: inline;z-index: 10;top: 0;}.annotationNote > office|annotation {display: block;text-align: left;}.annotationConnector {position: absolute;display: inline;top: 0;z-index: 2;border-top: 1px dashed brown;}.annotationConnector.angular {-moz-transform-origin: left top;-webkit-transform-origin: left top;-ms-transform-origin: left top;transform-origin: left top;}.annotationConnector.horizontal {left: 0;}.annotationConnector.horizontal:before {content: "";display: inline;position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: brown transparent transparent transparent;top: -1px;left: -5px;}office|annotation {width: 100%;height: 100%;display: none;background: rgb(198, 238, 184);background: -moz-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -webkit-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -o-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -ms-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: linear-gradient(180deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);box-shadow: 0 3px 4px -3px #ccc;}office|annotation > dc|creator {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;color: white;background-color: brown;padding: 4px;}office|annotation > dc|date {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;border: 4px solid transparent;color: black;}office|annotation > text|list {display: block;padding: 5px;}office|annotation text|p {font-size: 10pt;color: black;font-weight: normal;font-style: normal;text-decoration: none;font-family: sans-serif;}#annotationsPane {background-color: #EAEAEA;width: 4cm;height: 100%;display: none;position: absolute;outline: 1px solid #ccc;}.webodf-annotationHighlight {background-color: yellow;position: relative;}.webodf-selectionOverlay {position: absolute;pointer-events: none;top: 0;left: 0;top: 0;left: 0;width: 100%;height: 100%;z-index: 15;}.webodf-selectionOverlay > polygon {fill-opacity: 0.3;stroke-opacity: 0.8;stroke-width: 1;fill-rule: evenodd;}.webodf-selectionOverlay > .webodf-draggable {fill-opacity: 0.8;stroke-opacity: 0;stroke-width: 8;pointer-events: all;display: none;-moz-transform-origin: center center;-webkit-transform-origin: center center;-ms-transform-origin: center center;transform-origin: center center;}#imageSelector {display: none;position: absolute;border-style: solid;border-color: black;}#imageSelector > div {width: 5px;height: 5px;display: block;position: absolute;border: 1px solid black;background-color: #ffffff;}#imageSelector > .topLeft {top: -4px;left: -4px;}#imageSelector > .topRight {top: -4px;right: -4px;}#imageSelector > .bottomRight {right: -4px;bottom: -4px;}#imageSelector > .bottomLeft {bottom: -4px;left: -4px;}#imageSelector > .topMiddle {top: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .rightMiddle {top: 50%;right: -4px;margin-top: -2.5px;}#imageSelector > .bottomMiddle {bottom: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .leftMiddle {top: 50%;left: -4px;margin-top: -2.5px;}div.webodf-customScrollbars::-webkit-scrollbar{width: 8px;height: 8px;background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-track{background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-thumb{background-color: #444;border-radius: 4px;}.webodf-hyperlinkTooltip {display: none;color: white;background-color: black;border-radius: 5px;box-shadow: 2px 2px 5px gray;padding: 3px;position: absolute;max-width: 210px;text-align: left;word-break: break-all;z-index: 16;}.webodf-hyperlinkTooltipText {display: block;font-weight: bold;}';
!function(m){var d="undefined"!==typeof window?window:"undefined"!==typeof global?global:{};(d.externs||(d.externs={})).JSZip=m()}(function(){return function d(g,a,c){function h(n,l){if(!a[n]){if(!g[n]){var r="function"==typeof require&&require;if(!l&&r)return r(n,!0);if(f)return f(n,!0);throw Error("Cannot find module '"+n+"'");}r=a[n]={exports:{}};g[n][0].call(r.exports,function(b){var a=g[n][1][b];return h(a?a:b)},r,r.exports,d,g,a,c)}return a[n].exports}for(var f="function"==typeof require&&require,
n=0;n<c.length;n++)h(c[n]);return h}({1:[function(d,g,a){a.encode=function(a,d){for(var f="",g,p,l,r,b,e,k=0;k<a.length;)g=a.charCodeAt(k++),p=a.charCodeAt(k++),l=a.charCodeAt(k++),r=g>>2,g=(g&3)<<4|p>>4,b=(p&15)<<2|l>>6,e=l&63,isNaN(p)?b=e=64:isNaN(l)&&(e=64),f=f+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(r)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e);
return f};a.decode=function(a,d){var f="",g,p,l,r,b,e=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");e<a.length;)g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(e++)),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(e++)),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(e++)),b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(e++)),g=g<<2|p>>4,p=(p&15)<<
4|r>>2,l=(r&3)<<6|b,f+=String.fromCharCode(g),64!=r&&(f+=String.fromCharCode(p)),64!=b&&(f+=String.fromCharCode(l));return f}},{}],2:[function(d,g,a){function c(){this.crc32=this.uncompressedSize=this.compressedSize=0;this.compressedContent=this.compressionMethod=null}c.prototype={getContent:function(){return null},getCompressedContent:function(){return null}};g.exports=c},{}],3:[function(d,g,a){a.STORE={magic:"\x00\x00",compress:function(a){return a},uncompress:function(a){return a},compressInputType:null,
uncompressInputType:null};a.DEFLATE=d("./flate")},{"./flate":8}],4:[function(d,g,a){var c=d("./utils"),h=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,
3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,
453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,
3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,
1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,
1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];g.exports=function(a,d){if("undefined"===typeof a||!a.length)return 0;var g="string"!==c.getTypeOf(a);"undefined"==typeof d&&(d=0);var l=0,l=l=0;d^=-1;for(var r=0,b=a.length;r<b;r++)l=
g?a[r]:a.charCodeAt(r),l=(d^l)&255,l=h[l],d=d>>>8^l;return d^-1}},{"./utils":21}],5:[function(d,g,a){function c(a){this.data=null;this.index=this.length=0}var h=d("./utils");c.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<a||0>a)throw Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?");},setIndex:function(a){this.checkIndex(a);this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(a){},
readInt:function(a){var c=0,d;this.checkOffset(a);for(d=this.index+a-1;d>=this.index;d--)c=(c<<8)+this.byteAt(d);this.index+=a;return c},readString:function(a){return h.transformTo("string",this.readData(a))},readData:function(a){},lastIndexOfSignature:function(a){},readDate:function(){var a=this.readInt(4);return new Date((a>>25&127)+1980,(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(a&31)<<1)}};g.exports=c},{"./utils":21}],6:[function(d,g,a){a.base64=!1;a.binary=!1;a.dir=!1;a.createFolders=!1;a.date=
null;a.compression=null;a.comment=null},{}],7:[function(d,g,a){var c=d("./utils");a.string2binary=function(a){return c.string2binary(a)};a.string2Uint8Array=function(a){return c.transformTo("uint8array",a)};a.uint8Array2String=function(a){return c.transformTo("string",a)};a.string2Blob=function(a){a=c.transformTo("arraybuffer",a);return c.arrayBuffer2Blob(a)};a.arrayBuffer2Blob=function(a){return c.arrayBuffer2Blob(a)};a.transformTo=function(a,d){return c.transformTo(a,d)};a.getTypeOf=function(a){return c.getTypeOf(a)};
a.checkSupport=function(a){return c.checkSupport(a)};a.MAX_VALUE_16BITS=c.MAX_VALUE_16BITS;a.MAX_VALUE_32BITS=c.MAX_VALUE_32BITS;a.pretty=function(a){return c.pretty(a)};a.findCompression=function(a){return c.findCompression(a)};a.isRegExp=function(a){return c.isRegExp(a)}},{"./utils":21}],8:[function(d,g,a){g="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array;var c=d("pako");a.uncompressInputType=g?"uint8array":"array";a.compressInputType=g?"uint8array":
"array";a.magic="\b\x00";a.compress=function(a){return c.deflateRaw(a)};a.uncompress=function(a){return c.inflateRaw(a)}},{pako:24}],9:[function(d,g,a){function c(a,d){if(!(this instanceof c))return new c(a,d);this.files={};this.comment=null;this.root="";a&&this.load(a,d);this.clone=function(){var a=new c,d;for(d in this)"function"!==typeof this[d]&&(a[d]=this[d]);return a}}var h=d("./base64");c.prototype=d("./object");c.prototype.load=d("./load");c.support=d("./support");c.defaults=d("./defaults");
c.utils=d("./deprecatedPublicUtils");c.base64={encode:function(a){return h.encode(a)},decode:function(a){return h.decode(a)}};c.compressions=d("./compressions");g.exports=c},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(d,g,a){var c=d("./base64"),h=d("./zipEntries");g.exports=function(a,d){var g,l,r,b;d=d||{};d.base64&&(a=c.decode(a));l=new h(a,d);g=l.files;for(r=0;r<g.length;r++)b=g[r],this.file(b.fileName,b.decompressed,
{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileComment.length?b.fileComment:null,createFolders:d.createFolders});l.zipComment.length&&(this.comment=l.zipComment);return this}},{"./base64":1,"./zipEntries":22}],11:[function(d,g,a){(function(a){g.exports=function(d,f){return new a(d,f)};g.exports.test=function(d){return a.isBuffer(d)}}).call(this,"undefined"!==typeof Buffer?Buffer:void 0)},{}],12:[function(d,g,a){function c(a){this.data=a;this.length=this.data.length;this.index=
0}d=d("./uint8ArrayReader");c.prototype=new d;c.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.index,this.index+a);this.index+=a;return c};g.exports=c},{"./uint8ArrayReader":18}],13:[function(d,g,a){var c=d("./support"),h=d("./utils"),f=d("./crc32"),n=d("./signature"),p=d("./defaults"),l=d("./base64"),r=d("./compressions"),b=d("./compressedObject"),e=d("./nodeBuffer"),k=d("./utf8"),q=d("./stringWriter"),x=d("./uint8ArrayWriter"),A=function(a){if(a._data instanceof b&&
(a._data=a._data.getContent(),a.options.binary=!0,a.options.base64=!1,"uint8array"===h.getTypeOf(a._data))){var c=a._data;a._data=new Uint8Array(c.length);0!==c.length&&a._data.set(c,0)}return a._data},v=function(b){var a=A(b);return"string"===h.getTypeOf(a)?!b.options.binary&&c.nodebuffer?e(a,"utf-8"):b.asBinary():a},t=function(b){var a=A(this);if(null===a||"undefined"===typeof a)return"";this.options.base64&&(a=l.decode(a));a=b&&this.options.binary?C.utf8decode(a):h.transformTo("string",a);b||this.options.binary||
(a=h.transformTo("string",C.utf8encode(a)));return a},B=function(b,a,c){this.name=b;this.dir=c.dir;this.date=c.date;this.comment=c.comment;this._data=a;this.options=c;this._initialMetadata={dir:c.dir,date:c.date}};B.prototype={asText:function(){return t.call(this,!0)},asBinary:function(){return t.call(this,!1)},asNodeBuffer:function(){var b=v(this);return h.transformTo("nodebuffer",b)},asUint8Array:function(){var b=v(this);return h.transformTo("uint8array",b)},asArrayBuffer:function(){return this.asUint8Array().buffer}};
var u=function(b,a){var c="",e;for(e=0;e<a;e++)c+=String.fromCharCode(b&255),b>>>=8;return c},w=function(){var b={},a,c;for(a=0;a<arguments.length;a++)for(c in arguments[a])arguments[a].hasOwnProperty(c)&&"undefined"===typeof b[c]&&(b[c]=arguments[a][c]);return b},D=function(a,c,e){var d=h.getTypeOf(c),f;e=e||{};!0!==e.base64||null!==e.binary&&void 0!==e.binary||(e.binary=!0);e=w(e,p);e.date=e.date||new Date;null!==e.compression&&(e.compression=e.compression.toUpperCase());var k;if(k=e.createFolders)f=
a,"/"==f.slice(-1)&&(f=f.substring(0,f.length-1)),k=f.lastIndexOf("/"),k=f=0<k?f.substring(0,k):"";k&&F.call(this,f,!0);if(e.dir||null===c||"undefined"===typeof c)e.base64=!1,e.binary=!1,c=null;else if("string"===d)e.binary&&!e.base64&&!0!==e.optimizedBinaryString&&(c=h.string2binary(c));else{e.base64=!1;e.binary=!0;if(!(d||c instanceof b))throw Error("The data of '"+a+"' is in an unsupported format !");"arraybuffer"===d&&(c=h.transformTo("uint8array",c))}c=new B(a,c,e);return this.files[a]=c},F=
function(b,a){"/"!=b.slice(-1)&&(b+="/");this.files[b]||D.call(this,b,null,{dir:!0,createFolders:"undefined"!==typeof a?a:!1});return this.files[b]},C={load:function(b,a){throw Error("Load method is not defined. Is the file jszip-load.js included ?");},filter:function(b){var a=[],c,e,d;for(c in this.files)this.files.hasOwnProperty(c)&&(e=this.files[c],d=new B(e.name,e._data,w(e.options)),e=c.slice(this.root.length,c.length),c.slice(0,this.root.length)===this.root&&b(e,d)&&a.push(d));return a},file:function(b,
a,c){if(1===arguments.length){if(h.isRegExp(b)){var e=b;return this.filter(function(b,a){return!a.dir&&e.test(b)})}return this.filter(function(a,c){return!c.dir&&a===b})[0]||null}b=this.root+b;D.call(this,b,a,c);return this},folder:function(b){if(!b)return this;if(h.isRegExp(b))return this.filter(function(a,c){return c.dir&&b.test(a)});var a=F.call(this,this.root+b),c=this.clone();c.root=a.name;return c},remove:function(b){b=this.root+b;var a=this.files[b];a||("/"!=b.slice(-1)&&(b+="/"),a=this.files[b]);
if(a&&!a.dir)delete this.files[b];else for(var a=this.filter(function(a,c){return c.name.slice(0,b.length)===b}),c=0;c<a.length;c++)delete this.files[a[c].name];return this},generate:function(a){a=w(a||{},{base64:!0,compression:"STORE",type:"base64",comment:null});h.checkSupport(a.type);var c=[],e=0,d=0,g=h.transformTo("string",this.utf8encode(a.comment||this.comment||"")),p;for(p in this.files)if(this.files.hasOwnProperty(p)){var t=this.files[p],B=t.options.compression||a.compression.toUpperCase(),
A=r[B];if(!A)throw Error(B+" is not a valid compression method !");var B=t,G=new b,C=void 0;if(B._data instanceof b)G.uncompressedSize=B._data.uncompressedSize,G.crc32=B._data.crc32,0===G.uncompressedSize||B.dir?(A=r.STORE,G.compressedContent="",G.crc32=0):B._data.compressionMethod===A.magic?G.compressedContent=B._data.getCompressedContent():(C=B._data.getContent(),G.compressedContent=A.compress(h.transformTo(A.compressInputType,C)));else{C=v(B);if(!C||0===C.length||B.dir)A=r.STORE,C="";G.uncompressedSize=
C.length;G.crc32=f(C);G.compressedContent=A.compress(h.transformTo(A.compressInputType,C))}G.compressedSize=G.compressedContent.length;G.compressionMethod=A.magic;var B=G,F=t,t=B,A=e,G=h.transformTo("string",k.utf8encode(F.name)),R=F.comment||"",C=h.transformTo("string",k.utf8encode(R)),D=G.length!==F.name.length,ca=C.length!==R.length,L=F.options,Y=void 0,ea=void 0,X=R="",X="",U=void 0,X=void 0,U=F._initialMetadata.dir!==F.dir?F.dir:L.dir,X=F._initialMetadata.date!==F.date?F.date:L.date,Y=X.getHours(),
Y=Y<<6,Y=Y|X.getMinutes(),Y=Y<<5,Y=Y|X.getSeconds()/2,ea=X.getFullYear()-1980,ea=ea<<4,ea=ea|X.getMonth()+1,ea=ea<<5,ea=ea|X.getDate();D&&(X=u(1,1)+u(f(G),4)+G,R+="up"+u(X.length,2)+X);ca&&(X=u(1,1)+u(this.crc32(C),4)+C,R+="uc"+u(X.length,2)+X);F="";F+="\n\x00";F+=D||ca?"\x00\b":"\x00\x00";F+=t.compressionMethod;F+=u(Y,2);F+=u(ea,2);F+=u(t.crc32,4);F+=u(t.compressedSize,4);F+=u(t.uncompressedSize,4);F+=u(G.length,2);F+=u(R.length,2);D=n.LOCAL_FILE_HEADER+F+G+R;A=n.CENTRAL_FILE_HEADER+"\u0014\x00"+
F+u(C.length,2)+"\x00\x00\x00\x00"+(!0===U?"\u0010\x00\x00\x00":"\x00\x00\x00\x00")+u(A,4)+G+R+C;t={fileRecord:D,dirRecord:A,compressedObject:t};e+=t.fileRecord.length+B.compressedSize;d+=t.dirRecord.length;c.push(t)}p="";p=n.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+u(c.length,2)+u(c.length,2)+u(d,4)+u(e,4)+u(g.length,2)+g;g=a.type.toLowerCase();e="uint8array"===g||"arraybuffer"===g||"blob"===g||"nodebuffer"===g?new x(e+d+p.length):new q(e+d+p.length);for(d=0;d<c.length;d++)e.append(c[d].fileRecord),
e.append(c[d].compressedObject.compressedContent);for(d=0;d<c.length;d++)e.append(c[d].dirRecord);e.append(p);c=e.finalize();switch(a.type.toLowerCase()){case "uint8array":case "arraybuffer":case "nodebuffer":return h.transformTo(a.type.toLowerCase(),c);case "blob":return h.arrayBuffer2Blob(h.transformTo("arraybuffer",c));case "base64":return a.base64?l.encode(c):c;default:return c}},crc32:function(b,a){return f(b,a)},utf8encode:function(b){return h.transformTo("string",k.utf8encode(b))},utf8decode:function(b){return k.utf8decode(b)}};
g.exports=C},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(d,g,a){a.LOCAL_FILE_HEADER="PK\u0003\u0004";a.CENTRAL_FILE_HEADER="PK\u0001\u0002";a.CENTRAL_DIRECTORY_END="PK\u0005\u0006";a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\u0006\u0007";a.ZIP64_CENTRAL_DIRECTORY_END="PK\u0006\u0006";a.DATA_DESCRIPTOR="PK\u0007\b"},{}],15:[function(d,
g,a){function c(a,c){this.data=a;c||(this.data=h.string2binary(this.data));this.length=this.data.length;this.index=0}a=d("./dataReader");var h=d("./utils");c.prototype=new a;c.prototype.byteAt=function(a){return this.data.charCodeAt(a)};c.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)};c.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.index,this.index+a);this.index+=a;return c};g.exports=c},{"./dataReader":5,"./utils":21}],16:[function(d,g,
a){var c=d("./utils");d=function(){this.data=[]};d.prototype={append:function(a){a=c.transformTo("string",a);this.data.push(a)},finalize:function(){return this.data.join("")}};g.exports=d},{"./utils":21}],17:[function(d,g,a){d="undefined"!==typeof Buffer?Buffer:void 0;a.base64=!0;a.array=!0;a.string=!0;a.arraybuffer="undefined"!==typeof ArrayBuffer&&"undefined"!==typeof Uint8Array;a.nodebuffer="undefined"!==typeof d;a.uint8array="undefined"!==typeof Uint8Array;if("undefined"===typeof ArrayBuffer)a.blob=
!1;else{d=new ArrayBuffer(0);try{a.blob=0===(new Blob([d],{type:"application/zip"})).size}catch(c){try{var h=new (window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);h.append(d);a.blob=0===h.getBlob("application/zip").size}catch(f){a.blob=!1}}}},{}],18:[function(d,g,a){function c(a){a&&(this.data=a,this.length=this.data.length,this.index=0)}d=d("./dataReader");c.prototype=new d;c.prototype.byteAt=function(a){return this.data[a]};c.prototype.lastIndexOfSignature=
function(a){var c=a.charCodeAt(0),d=a.charCodeAt(1),g=a.charCodeAt(2);a=a.charCodeAt(3);for(var l=this.length-4;0<=l;--l)if(this.data[l]===c&&this.data[l+1]===d&&this.data[l+2]===g&&this.data[l+3]===a)return l;return-1};c.prototype.readData=function(a){this.checkOffset(a);if(0===a)return new Uint8Array(0);var c=this.data.subarray(this.index,this.index+a);this.index+=a;return c};g.exports=c},{"./dataReader":5}],19:[function(d,g,a){var c=d("./utils");d=function(a){this.data=new Uint8Array(a);this.index=
0};d.prototype={append:function(a){0!==a.length&&(a=c.transformTo("uint8array",a),this.data.set(a,this.index),this.index+=a.length)},finalize:function(){return this.data}};g.exports=d},{"./utils":21}],20:[function(d,g,a){var c=d("./utils"),h=d("./support"),f=d("./nodeBuffer"),n=Array(256);for(d=0;256>d;d++)n[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;n[254]=n[254]=1;var p=function(a){var d,b,e,f,g=a.length,h=Array(2*g);for(d=b=0;d<g;)if(e=a[d++],128>e)h[b++]=e;else if(f=n[e],4<f)h[b++]=65533,
d+=f-1;else{for(e&=2===f?31:3===f?15:7;1<f&&d<g;)e=e<<6|a[d++]&63,f--;1<f?h[b++]=65533:65536>e?h[b++]=e:(e-=65536,h[b++]=55296|e>>10&1023,h[b++]=56320|e&1023)}h.length!==b&&(h.subarray?h=h.subarray(0,b):h.length=b);return c.applyFromCharCode(h)};a.utf8encode=function(a){if(h.nodebuffer)return f(a,"utf-8");var c,b,e,d,g,n=a.length,p=0;for(d=0;d<n;d++)b=a.charCodeAt(d),55296===(b&64512)&&d+1<n&&(e=a.charCodeAt(d+1),56320===(e&64512)&&(b=65536+(b-55296<<10)+(e-56320),d++)),p+=128>b?1:2048>b?2:65536>
b?3:4;c=h.uint8array?new Uint8Array(p):Array(p);for(d=g=0;g<p;d++)b=a.charCodeAt(d),55296===(b&64512)&&d+1<n&&(e=a.charCodeAt(d+1),56320===(e&64512)&&(b=65536+(b-55296<<10)+(e-56320),d++)),128>b?c[g++]=b:(2048>b?c[g++]=192|b>>>6:(65536>b?c[g++]=224|b>>>12:(c[g++]=240|b>>>18,c[g++]=128|b>>>12&63),c[g++]=128|b>>>6&63),c[g++]=128|b&63);return c};a.utf8decode=function(a){if(h.nodebuffer)return c.transformTo("nodebuffer",a).toString("utf-8");a=c.transformTo(h.uint8array?"uint8array":"array",a);for(var d=
[],b=0,e=a.length;b<e;){var f;f=Math.min(b+65536,e);var g=void 0;f=f||a.length;f>a.length&&(f=a.length);for(g=f-1;0<=g&&128===(a[g]&192);)g--;f=0>g?f:0===g?f:g+n[a[g]]>f?g:f;h.uint8array?d.push(p(a.subarray(b,f))):d.push(p(a.slice(b,f)));b=f}return d.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(d,g,a){function c(b){return b}function h(b,a){for(var c=0;c<b.length;++c)a[c]=b.charCodeAt(c)&255;return a}function f(b){var c=65536,d=[],f=b.length,g=a.getTypeOf(b),h=0,l=!0;try{switch(g){case "uint8array":String.fromCharCode.apply(null,
new Uint8Array(0));break;case "nodebuffer":String.fromCharCode.apply(null,r(0))}}catch(n){l=!1}if(!l){c="";for(d=0;d<b.length;d++)c+=String.fromCharCode(b[d]);return c}for(;h<f&&1<c;)try{"array"===g||"nodebuffer"===g?d.push(String.fromCharCode.apply(null,b.slice(h,Math.min(h+c,f)))):d.push(String.fromCharCode.apply(null,b.subarray(h,Math.min(h+c,f)))),h+=c}catch(p){c=Math.floor(c/2)}return d.join("")}function n(b,a){for(var c=0;c<b.length;c++)a[c]=b[c];return a}var p=d("./support"),l=d("./compressions"),
r=d("./nodeBuffer");a.string2binary=function(b){for(var a="",c=0;c<b.length;c++)a+=String.fromCharCode(b.charCodeAt(c)&255);return a};a.arrayBuffer2Blob=function(b){a.checkSupport("blob");try{return new Blob([b],{type:"application/zip"})}catch(c){try{var d=new (window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);d.append(b);return d.getBlob("application/zip")}catch(f){throw Error("Bug : can't construct the Blob.");}}};a.applyFromCharCode=f;var b={};b.string=
{string:c,array:function(b){return h(b,Array(b.length))},arraybuffer:function(a){return b.string.uint8array(a).buffer},uint8array:function(b){return h(b,new Uint8Array(b.length))},nodebuffer:function(b){return h(b,r(b.length))}};b.array={string:f,array:c,arraybuffer:function(b){return(new Uint8Array(b)).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return r(b)}};b.arraybuffer={string:function(b){return f(new Uint8Array(b))},array:function(b){return n(new Uint8Array(b),
Array(b.byteLength))},arraybuffer:c,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return r(new Uint8Array(b))}};b.uint8array={string:f,array:function(b){return n(b,Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:c,nodebuffer:function(b){return r(b)}};b.nodebuffer={string:f,array:function(b){return n(b,Array(b.length))},arraybuffer:function(a){return b.nodebuffer.uint8array(a).buffer},uint8array:function(b){return n(b,new Uint8Array(b.length))},nodebuffer:c};
a.transformTo=function(c,d){d||(d="");if(!c)return d;a.checkSupport(c);var f=a.getTypeOf(d);return b[f][c](d)};a.getTypeOf=function(b){if("string"===typeof b)return"string";if("[object Array]"===Object.prototype.toString.call(b))return"array";if(p.nodebuffer&&r.test(b))return"nodebuffer";if(p.uint8array&&b instanceof Uint8Array)return"uint8array";if(p.arraybuffer&&b instanceof ArrayBuffer)return"arraybuffer"};a.checkSupport=function(b){if(!p[b.toLowerCase()])throw Error(b+" is not supported by this browser");
};a.MAX_VALUE_16BITS=65535;a.MAX_VALUE_32BITS=-1;a.pretty=function(b){var a="",c,d;for(d=0;d<(b||"").length;d++)c=b.charCodeAt(d),a+="\\x"+(16>c?"0":"")+c.toString(16).toUpperCase();return a};a.findCompression=function(b){for(var a in l)if(l.hasOwnProperty(a)&&l[a].magic===b)return l[a];return null};a.isRegExp=function(b){return"[object RegExp]"===Object.prototype.toString.call(b)}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(d,g,a){function c(b,a){this.files=[];this.loadOptions=
a;b&&this.load(b)}var h=d("./stringReader"),f=d("./nodeBufferReader"),n=d("./uint8ArrayReader"),p=d("./utils"),l=d("./signature"),r=d("./zipEntry"),b=d("./support"),e=d("./object");c.prototype={checkSignature:function(b){var a=this.reader.readString(4);if(a!==b)throw Error("Corrupted zip or bug : unexpected signature ("+p.pretty(a)+", expected "+p.pretty(b)+")");},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=
this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);this.zipComment=this.reader.readString(this.zipCommentLength);this.zipComment=e.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.versionMadeBy=this.reader.readString(2);this.versionNeeded=this.reader.readInt(2);this.diskNumber=
this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData={};for(var b=this.zip64EndOfCentralSize-44,a,c,d;0<b;)a=this.reader.readInt(2),c=this.reader.readInt(4),d=this.reader.readString(c),this.zip64ExtensibleData[a]={id:a,length:c,value:d}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=
this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);this.disksCount=this.reader.readInt(4);if(1<this.disksCount)throw Error("Multi-volumes zip are not supported");},readLocalFiles:function(){var b,a;for(b=0;b<this.files.length;b++)a=this.files[b],this.reader.setIndex(a.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),a.readLocalPart(this.reader),a.handleUTF8()},readCentralDir:function(){var b;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===
l.CENTRAL_FILE_HEADER;)b=new r({zip64:this.zip64},this.loadOptions),b.readCentralPart(this.reader),this.files.push(b)},readEndOfCentral:function(){var b=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(-1===b)throw Error("Corrupted zip : can't find end of central directory");this.reader.setIndex(b);this.checkSignature(l.CENTRAL_DIRECTORY_END);this.readBlockEndOfCentral();if(this.diskNumber===p.MAX_VALUE_16BITS||this.diskWithCentralDirStart===p.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===
p.MAX_VALUE_16BITS||this.centralDirRecords===p.MAX_VALUE_16BITS||this.centralDirSize===p.MAX_VALUE_32BITS||this.centralDirOffset===p.MAX_VALUE_32BITS){this.zip64=!0;b=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(-1===b)throw Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(b);this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR);this.readBlockZip64EndOfCentralLocator();this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);
this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END);this.readBlockZip64EndOfCentral()}},prepareReader:function(a){var c=p.getTypeOf(a);this.reader="string"!==c||b.uint8array?"nodebuffer"===c?new f(a):new n(p.transformTo("uint8array",a)):new h(a,this.loadOptions.optimizedBinaryString)},load:function(b){this.prepareReader(b);this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};g.exports=c},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,
"./utils":21,"./zipEntry":23}],23:[function(d,g,a){function c(a,c){this.options=a;this.loadOptions=c}var h=d("./stringReader"),f=d("./utils"),n=d("./compressedObject"),p=d("./object");c.prototype={isEncrypted:function(){return 1===(this.bitFlag&1)},useUTF8:function(){return 2048===(this.bitFlag&2048)},prepareCompressedContent:function(a,c,b){return function(){var d=a.index;a.setIndex(c);var f=a.readData(b);a.setIndex(d);return f}},prepareContent:function(a,c,b,d,g){return function(){var b=f.transformTo(d.uncompressInputType,
this.getCompressedContent()),b=d.uncompress(b);if(b.length!==g)throw Error("Bug : uncompressed data size mismatch");return b}},readLocalPart:function(a){var c;a.skip(22);this.fileNameLength=a.readInt(2);c=a.readInt(2);this.fileName=a.readString(this.fileNameLength);a.skip(c);if(-1==this.compressedSize||-1==this.uncompressedSize)throw Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");c=f.findCompression(this.compressionMethod);
if(null===c)throw Error("Corrupted zip : compression "+f.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");this.decompressed=new n;this.decompressed.compressedSize=this.compressedSize;this.decompressed.uncompressedSize=this.uncompressedSize;this.decompressed.crc32=this.crc32;this.decompressed.compressionMethod=this.compressionMethod;this.decompressed.getCompressedContent=this.prepareCompressedContent(a,a.index,this.compressedSize,c);this.decompressed.getContent=this.prepareContent(a,
a.index,this.compressedSize,c,this.uncompressedSize);if(this.loadOptions.checkCRC32&&(this.decompressed=f.transformTo("string",this.decompressed.getContent()),p.crc32(this.decompressed)!==this.crc32))throw Error("Corrupted zip : CRC32 mismatch");},readCentralPart:function(a){this.versionMadeBy=a.readString(2);this.versionNeeded=a.readInt(2);this.bitFlag=a.readInt(2);this.compressionMethod=a.readString(2);this.date=a.readDate();this.crc32=a.readInt(4);this.compressedSize=a.readInt(4);this.uncompressedSize=
a.readInt(4);this.fileNameLength=a.readInt(2);this.extraFieldsLength=a.readInt(2);this.fileCommentLength=a.readInt(2);this.diskNumberStart=a.readInt(2);this.internalFileAttributes=a.readInt(2);this.externalFileAttributes=a.readInt(4);this.localHeaderOffset=a.readInt(4);if(this.isEncrypted())throw Error("Encrypted zip are not supported");this.fileName=a.readString(this.fileNameLength);this.readExtraFields(a);this.parseZIP64ExtraField(a);this.fileComment=a.readString(this.fileCommentLength);this.dir=
this.externalFileAttributes&16?!0:!1},parseZIP64ExtraField:function(a){this.extraFields[1]&&(a=new h(this.extraFields[1].value),this.uncompressedSize===f.MAX_VALUE_32BITS&&(this.uncompressedSize=a.readInt(8)),this.compressedSize===f.MAX_VALUE_32BITS&&(this.compressedSize=a.readInt(8)),this.localHeaderOffset===f.MAX_VALUE_32BITS&&(this.localHeaderOffset=a.readInt(8)),this.diskNumberStart===f.MAX_VALUE_32BITS&&(this.diskNumberStart=a.readInt(4)))},readExtraFields:function(a){var c=a.index,b,d,f;for(this.extraFields=
this.extraFields||{};a.index<c+this.extraFieldsLength;)b=a.readInt(2),d=a.readInt(2),f=a.readString(d),this.extraFields[b]={id:b,length:d,value:f}},handleUTF8:function(){if(this.useUTF8())this.fileName=p.utf8decode(this.fileName),this.fileComment=p.utf8decode(this.fileComment);else{var a=this.findExtraFieldUnicodePath();null!==a&&(this.fileName=a);a=this.findExtraFieldUnicodeComment();null!==a&&(this.fileComment=a)}},findExtraFieldUnicodePath:function(){var a=this.extraFields[28789];if(a){var c=new h(a.value);
return 1!==c.readInt(1)||p.crc32(this.fileName)!==c.readInt(4)?null:p.utf8decode(c.readString(a.length-5))}return null},findExtraFieldUnicodeComment:function(){var a=this.extraFields[25461];if(a){var c=new h(a.value);return 1!==c.readInt(1)||p.crc32(this.fileComment)!==c.readInt(4)?null:p.utf8decode(c.readString(a.length-5))}return null}};g.exports=c},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(d,g,a){a=d("./lib/utils/common").assign;var c=d("./lib/deflate"),
h=d("./lib/inflate");d=d("./lib/zlib/constants");var f={};a(f,c,h,d);g.exports=f},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(d,g,a){function c(b,a){var c=new r(a);c.push(b,!0);if(c.err)throw c.msg;return c.result}var h=d("./zlib/deflate.js"),f=d("./utils/common"),n=d("./utils/strings"),p=d("./zlib/messages"),l=d("./zlib/zstream"),r=function(b){b=this.options=f.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,
to:""},b||{});b.raw&&0<b.windowBits?b.windowBits=-b.windowBits:b.gzip&&0<b.windowBits&&16>b.windowBits&&(b.windowBits+=16);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new l;this.strm.avail_out=0;var a=h.deflateInit2(this.strm,b.level,b.method,b.windowBits,b.memLevel,b.strategy);if(0!==a)throw Error(p[a]);b.header&&h.deflateSetHeader(this.strm,b.header)};r.prototype.push=function(b,a){var c=this.strm,d=this.options.chunkSize,g,l;if(this.ended)return!1;l=a===~~a?a:!0===a?4:0;c.input=
"string"===typeof b?n.string2buf(b):b;c.next_in=0;c.avail_in=c.input.length;do{0===c.avail_out&&(c.output=new f.Buf8(d),c.next_out=0,c.avail_out=d);g=h.deflate(c,l);if(1!==g&&0!==g)return this.onEnd(g),this.ended=!0,!1;if(0===c.avail_out||0===c.avail_in&&4===l)if("string"===this.options.to)this.onData(n.buf2binstring(f.shrinkBuf(c.output,c.next_out)));else this.onData(f.shrinkBuf(c.output,c.next_out))}while((0<c.avail_in||0===c.avail_out)&&1!==g);return 4===l?(g=h.deflateEnd(this.strm),this.onEnd(g),
this.ended=!0,0===g):!0};r.prototype.onData=function(b){this.chunks.push(b)};r.prototype.onEnd=function(b){0===b&&(this.result="string"===this.options.to?this.chunks.join(""):f.flattenChunks(this.chunks));this.chunks=[];this.err=b;this.msg=this.strm.msg};a.Deflate=r;a.deflate=c;a.deflateRaw=function(b,a){a=a||{};a.raw=!0;return c(b,a)};a.gzip=function(b,a){a=a||{};a.gzip=!0;return c(b,a)}},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],
26:[function(d,g,a){function c(b,a){var c=new e(a);c.push(b,!0);if(c.err)throw c.msg;return c.result}var h=d("./zlib/inflate.js"),f=d("./utils/common"),n=d("./utils/strings"),p=d("./zlib/constants"),l=d("./zlib/messages"),r=d("./zlib/zstream"),b=d("./zlib/gzheader"),e=function(a){var c=this.options=f.assign({chunkSize:16384,windowBits:0,to:""},a||{});c.raw&&0<=c.windowBits&&16>c.windowBits&&(c.windowBits=-c.windowBits,0===c.windowBits&&(c.windowBits=-15));!(0<=c.windowBits&&16>c.windowBits)||a&&a.windowBits||
(c.windowBits+=32);15<c.windowBits&&48>c.windowBits&&0===(c.windowBits&15)&&(c.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new r;this.strm.avail_out=0;a=h.inflateInit2(this.strm,c.windowBits);if(a!==p.Z_OK)throw Error(l[a]);this.header=new b;h.inflateGetHeader(this.strm,this.header)};e.prototype.push=function(b,a){var c=this.strm,d=this.options.chunkSize,e,g,l,u,r;if(this.ended)return!1;g=a===~~a?a:!0===a?p.Z_FINISH:p.Z_NO_FLUSH;c.input="string"===typeof b?n.binstring2buf(b):
b;c.next_in=0;c.avail_in=c.input.length;do{0===c.avail_out&&(c.output=new f.Buf8(d),c.next_out=0,c.avail_out=d);e=h.inflate(c,p.Z_NO_FLUSH);if(e!==p.Z_STREAM_END&&e!==p.Z_OK)return this.onEnd(e),this.ended=!0,!1;if(c.next_out&&(0===c.avail_out||e===p.Z_STREAM_END||0===c.avail_in&&g===p.Z_FINISH))if("string"===this.options.to)l=n.utf8border(c.output,c.next_out),u=c.next_out-l,r=n.buf2string(c.output,l),c.next_out=u,c.avail_out=d-u,u&&f.arraySet(c.output,c.output,l,u,0),this.onData(r);else this.onData(f.shrinkBuf(c.output,
c.next_out))}while(0<c.avail_in&&e!==p.Z_STREAM_END);e===p.Z_STREAM_END&&(g=p.Z_FINISH);return g===p.Z_FINISH?(e=h.inflateEnd(this.strm),this.onEnd(e),this.ended=!0,e===p.Z_OK):!0};e.prototype.onData=function(b){this.chunks.push(b)};e.prototype.onEnd=function(b){b===p.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):f.flattenChunks(this.chunks));this.chunks=[];this.err=b;this.msg=this.strm.msg};a.Inflate=e;a.inflate=c;a.inflateRaw=function(b,a){a=a||{};a.raw=!0;return c(b,a)};a.ungzip=
c},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(d,g,a){d="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;a.assign=function(a){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var d=c.shift();if(d){if("object"!==typeof d)throw new TypeError(d+"must be non-object");for(var g in d)d.hasOwnProperty(g)&&(a[g]=d[g])}}return a};
a.shrinkBuf=function(a,c){if(a.length===c)return a;if(a.subarray)return a.subarray(0,c);a.length=c;return a};var c={arraySet:function(a,c,d,g,h){if(c.subarray&&a.subarray)a.set(c.subarray(d,d+g),h);else for(var b=0;b<g;b++)a[h+b]=c[d+b]},flattenChunks:function(a){var c,d,g,h,b;c=g=0;for(d=a.length;c<d;c++)g+=a[c].length;b=new Uint8Array(g);c=g=0;for(d=a.length;c<d;c++)h=a[c],b.set(h,g),g+=h.length;return b}},h={arraySet:function(a,c,d,g,h){for(var b=0;b<g;b++)a[h+b]=c[d+b]},flattenChunks:function(a){return[].concat.apply([],
a)}};a.setTyped=function(d){d?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,c)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,h))};a.setTyped(d)},{}],28:[function(d,g,a){function c(a,c){if(65537>c&&(a.subarray&&n||!a.subarray&&f))return String.fromCharCode.apply(null,h.shrinkBuf(a,c));for(var d="",g=0;g<c;g++)d+=String.fromCharCode(a[g]);return d}var h=d("./common"),f=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch(p){f=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(l){n=
!1}var r=new h.Buf8(256);for(d=0;256>d;d++)r[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;r[254]=r[254]=1;a.string2buf=function(a){var c,d,f,g,l,n=a.length,p=0;for(g=0;g<n;g++)d=a.charCodeAt(g),55296===(d&64512)&&g+1<n&&(f=a.charCodeAt(g+1),56320===(f&64512)&&(d=65536+(d-55296<<10)+(f-56320),g++)),p+=128>d?1:2048>d?2:65536>d?3:4;c=new h.Buf8(p);for(g=l=0;l<p;g++)d=a.charCodeAt(g),55296===(d&64512)&&g+1<n&&(f=a.charCodeAt(g+1),56320===(f&64512)&&(d=65536+(d-55296<<10)+(f-56320),g++)),128>d?c[l++]=
d:(2048>d?c[l++]=192|d>>>6:(65536>d?c[l++]=224|d>>>12:(c[l++]=240|d>>>18,c[l++]=128|d>>>12&63),c[l++]=128|d>>>6&63),c[l++]=128|d&63);return c};a.buf2binstring=function(a){return c(a,a.length)};a.binstring2buf=function(a){for(var c=new h.Buf8(a.length),d=0,f=c.length;d<f;d++)c[d]=a.charCodeAt(d);return c};a.buf2string=function(a,d){var f,g,h,l,n=d||a.length,p=Array(2*n);for(f=g=0;f<n;)if(h=a[f++],128>h)p[g++]=h;else if(l=r[h],4<l)p[g++]=65533,f+=l-1;else{for(h&=2===l?31:3===l?15:7;1<l&&f<n;)h=h<<6|
a[f++]&63,l--;1<l?p[g++]=65533:65536>h?p[g++]=h:(h-=65536,p[g++]=55296|h>>10&1023,p[g++]=56320|h&1023)}return c(p,g)};a.utf8border=function(a,c){var d;c=c||a.length;c>a.length&&(c=a.length);for(d=c-1;0<=d&&128===(a[d]&192);)d--;return 0>d||0===d?c:d+r[a[d]]>c?d:c}},{"./common":27}],29:[function(d,g,a){g.exports=function(a,d,f,g){var p=a&65535|0;a=a>>>16&65535|0;for(var l=0;0!==f;){l=2E3<f?2E3:f;f-=l;do p=p+d[g++]|0,a=a+p|0;while(--l);p%=65521;a%=65521}return p|a<<16|0}},{}],30:[function(d,g,a){g.exports=
{Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(d,g,a){var c=function(){for(var a,c=[],d=0;256>d;d++){a=d;for(var g=0;8>g;g++)a=a&1?3988292384^a>>>
1:a>>>1;c[d]=a}return c}();g.exports=function(a,d,g,p){g=p+g;for(a^=-1;p<g;p++)a=a>>>8^c[(a^d[p])&255];return a^-1}},{}],32:[function(d,g,a){function c(a,b){a.msg=C[b];return b}function h(a){for(var b=a.length;0<=--b;)a[b]=0}function f(a){var b=a.state,c=b.pending;c>a.avail_out&&(c=a.avail_out);0!==c&&(u.arraySet(a.output,b.pending_buf,b.pending_out,c,a.next_out),a.next_out+=c,b.pending_out+=c,a.total_out+=c,a.avail_out-=c,b.pending-=c,0===b.pending&&(b.pending_out=0))}function n(a,b){w._tr_flush_block(a,
0<=a.block_start?a.block_start:-1,a.strstart-a.block_start,b);a.block_start=a.strstart;f(a.strm)}function p(a,b){a.pending_buf[a.pending++]=b}function l(a,b){a.pending_buf[a.pending++]=b>>>8&255;a.pending_buf[a.pending++]=b&255}function r(a,b){var c=a.max_chain_length,d=a.strstart,e,f=a.prev_length,g=a.nice_match,h=a.strstart>a.w_size-262?a.strstart-(a.w_size-262):0,k=a.window,l=a.w_mask,n=a.prev,u=a.strstart+258,p=k[d+f-1],q=k[d+f];a.prev_length>=a.good_match&&(c>>=2);g>a.lookahead&&(g=a.lookahead);
do if(e=b,k[e+f]===q&&k[e+f-1]===p&&k[e]===k[d]&&k[++e]===k[d+1]){d+=2;for(e++;k[++d]===k[++e]&&k[++d]===k[++e]&&k[++d]===k[++e]&&k[++d]===k[++e]&&k[++d]===k[++e]&&k[++d]===k[++e]&&k[++d]===k[++e]&&k[++d]===k[++e]&&d<u;);e=258-(u-d);d=u-258;if(e>f){a.match_start=b;f=e;if(e>=g)break;p=k[d+f-1];q=k[d+f]}}while((b=n[b&l])>h&&0!==--c);return f<=a.lookahead?f:a.lookahead}function b(a){var b=a.w_size,c,d,e,f;do{f=a.window_size-a.lookahead-a.strstart;if(a.strstart>=b+(b-262)){u.arraySet(a.window,a.window,
b,b,0);a.match_start-=b;a.strstart-=b;a.block_start-=b;c=d=a.hash_size;do e=a.head[--c],a.head[c]=e>=b?e-b:0;while(--d);c=d=b;do e=a.prev[--c],a.prev[c]=e>=b?e-b:0;while(--d);f+=b}if(0===a.strm.avail_in)break;c=a.strm;d=a.window;e=a.strstart+a.lookahead;var g=c.avail_in;g>f&&(g=f);0===g?d=0:(c.avail_in-=g,u.arraySet(d,c.input,c.next_in,g,e),1===c.state.wrap?c.adler=D(c.adler,d,g,e):2===c.state.wrap&&(c.adler=F(c.adler,d,g,e)),c.next_in+=g,c.total_in+=g,d=g);a.lookahead+=d;if(3<=a.lookahead+a.insert)for(f=
a.strstart-a.insert,a.ins_h=a.window[f],a.ins_h=(a.ins_h<<a.hash_shift^a.window[f+1])&a.hash_mask;a.insert&&!(a.ins_h=(a.ins_h<<a.hash_shift^a.window[f+3-1])&a.hash_mask,a.prev[f&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=f,f++,a.insert--,3>a.lookahead+a.insert););}while(262>a.lookahead&&0!==a.strm.avail_in)}function e(a,c){for(var d;;){if(262>a.lookahead){b(a);if(262>a.lookahead&&0===c)return 1;if(0===a.lookahead)break}d=0;3<=a.lookahead&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&
a.hash_mask,d=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);0!==d&&a.strstart-d<=a.w_size-262&&(a.match_length=r(a,d));if(3<=a.match_length)if(d=w._tr_tally(a,a.strstart-a.match_start,a.match_length-3),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&3<=a.lookahead){a.match_length--;do a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart;while(0!==--a.match_length);
a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else d=w._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(d&&(n(a,!1),0===a.strm.avail_out))return 1}a.insert=2>a.strstart?a.strstart:2;return 4===c?(n(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(n(a,!1),0===a.strm.avail_out)?1:2}function k(a,c){for(var d,e;;){if(262>a.lookahead){b(a);if(262>a.lookahead&&0===c)return 1;if(0===
a.lookahead)break}d=0;3<=a.lookahead&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,d=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);a.prev_length=a.match_length;a.prev_match=a.match_start;a.match_length=2;0!==d&&a.prev_length<a.max_lazy_match&&a.strstart-d<=a.w_size-262&&(a.match_length=r(a,d),5>=a.match_length&&(1===a.strategy||3===a.match_length&&4096<a.strstart-a.match_start)&&(a.match_length=2));if(3<=a.prev_length&&a.match_length<=a.prev_length){e=
a.strstart+a.lookahead-3;d=w._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-3);a.lookahead-=a.prev_length-1;a.prev_length-=2;do++a.strstart<=e&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);while(0!==--a.prev_length);a.match_available=0;a.match_length=2;a.strstart++;if(d&&(n(a,!1),0===a.strm.avail_out))return 1}else if(a.match_available){if((d=w._tr_tally(a,0,a.window[a.strstart-1]))&&n(a,!1),a.strstart++,
a.lookahead--,0===a.strm.avail_out)return 1}else a.match_available=1,a.strstart++,a.lookahead--}a.match_available&&(w._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0);a.insert=2>a.strstart?a.strstart:2;return 4===c?(n(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(n(a,!1),0===a.strm.avail_out)?1:2}function q(a,c){for(var d,e,f,g=a.window;;){if(258>=a.lookahead){b(a);if(258>=a.lookahead&&0===c)return 1;if(0===a.lookahead)break}a.match_length=0;if(3<=a.lookahead&&0<a.strstart&&(e=a.strstart-
1,d=g[e],d===g[++e]&&d===g[++e]&&d===g[++e])){for(f=a.strstart+258;d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&e<f;);a.match_length=258-(f-e);a.match_length>a.lookahead&&(a.match_length=a.lookahead)}3<=a.match_length?(d=w._tr_tally(a,1,a.match_length-3),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(d=w._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++);if(d&&(n(a,!1),0===a.strm.avail_out))return 1}a.insert=
0;return 4===c?(n(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(n(a,!1),0===a.strm.avail_out)?1:2}function x(a,c){for(var d;;){if(0===a.lookahead&&(b(a),0===a.lookahead)){if(0===c)return 1;break}a.match_length=0;d=w._tr_tally(a,0,a.window[a.strstart]);a.lookahead--;a.strstart++;if(d&&(n(a,!1),0===a.strm.avail_out))return 1}a.insert=0;return 4===c?(n(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(n(a,!1),0===a.strm.avail_out)?1:2}function A(){this.strm=null;this.status=0;this.pending_buf=null;this.wrap=
this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=8;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=
this.ins_h=0;this.dyn_ltree=new u.Buf16(1146);this.dyn_dtree=new u.Buf16(122);this.bl_tree=new u.Buf16(78);h(this.dyn_ltree);h(this.dyn_dtree);h(this.bl_tree);this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new u.Buf16(16);this.heap=new u.Buf16(573);h(this.heap);this.heap_max=this.heap_len=0;this.depth=new u.Buf16(573);h(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function v(a){var b;if(!a||
!a.state)return c(a,-2);a.total_in=a.total_out=0;a.data_type=2;b=a.state;b.pending=0;b.pending_out=0;0>b.wrap&&(b.wrap=-b.wrap);b.status=b.wrap?42:113;a.adler=2===b.wrap?0:1;b.last_flush=0;w._tr_init(b);return 0}function t(a){var b=v(a);0===b&&(a=a.state,a.window_size=2*a.w_size,h(a.head),a.max_lazy_match=H[a.level].max_lazy,a.good_match=H[a.level].good_length,a.nice_match=H[a.level].nice_length,a.max_chain_length=H[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=
a.prev_length=2,a.match_available=0,a.ins_h=0);return b}function B(a,b,d,e,f,g){if(!a)return-2;var h=1;-1===b&&(b=6);0>e?(h=0,e=-e):15<e&&(h=2,e-=16);if(1>f||9<f||8!==d||8>e||15<e||0>b||9<b||0>g||4<g)return c(a,-2);8===e&&(e=9);var k=new A;a.state=k;k.strm=a;k.wrap=h;k.gzhead=null;k.w_bits=e;k.w_size=1<<k.w_bits;k.w_mask=k.w_size-1;k.hash_bits=f+7;k.hash_size=1<<k.hash_bits;k.hash_mask=k.hash_size-1;k.hash_shift=~~((k.hash_bits+3-1)/3);k.window=new u.Buf8(2*k.w_size);k.head=new u.Buf16(k.hash_size);
k.prev=new u.Buf16(k.w_size);k.lit_bufsize=1<<f+6;k.pending_buf_size=4*k.lit_bufsize;k.pending_buf=new u.Buf8(k.pending_buf_size);k.d_buf=k.lit_bufsize>>1;k.l_buf=3*k.lit_bufsize;k.level=b;k.strategy=g;k.method=d;return t(a)}var u=d("../utils/common"),w=d("./trees"),D=d("./adler32"),F=d("./crc32"),C=d("./messages");d=function(a,b,c,d,e){this.good_length=a;this.max_lazy=b;this.nice_length=c;this.max_chain=d;this.func=e};var H;H=[new d(0,0,0,0,function(a,c){var d=65535;for(d>a.pending_buf_size-5&&(d=
a.pending_buf_size-5);;){if(1>=a.lookahead){b(a);if(0===a.lookahead&&0===c)return 1;if(0===a.lookahead)break}a.strstart+=a.lookahead;a.lookahead=0;var e=a.block_start+d;if(0===a.strstart||a.strstart>=e)if(a.lookahead=a.strstart-e,a.strstart=e,n(a,!1),0===a.strm.avail_out)return 1;if(a.strstart-a.block_start>=a.w_size-262&&(n(a,!1),0===a.strm.avail_out))return 1}a.insert=0;if(4===c)return n(a,!0),0===a.strm.avail_out?3:4;a.strstart>a.block_start&&n(a,!1);return 1}),new d(4,4,8,4,e),new d(4,5,16,8,
e),new d(4,6,32,32,e),new d(4,4,16,16,k),new d(8,16,32,32,k),new d(8,16,128,128,k),new d(8,32,128,256,k),new d(32,128,258,1024,k),new d(32,258,258,4096,k)];a.deflateInit=function(a,b){return B(a,b,8,15,8,0)};a.deflateInit2=B;a.deflateReset=t;a.deflateResetKeep=v;a.deflateSetHeader=function(a,b){if(!a||!a.state||2!==a.state.wrap)return-2;a.state.gzhead=b;return 0};a.deflate=function(a,b){var d,e,g,k;if(!a||!a.state||5<b||0>b)return a?c(a,-2):-2;e=a.state;if(!a.output||!a.input&&0!==a.avail_in||666===
e.status&&4!==b)return c(a,0===a.avail_out?-5:-2);e.strm=a;d=e.last_flush;e.last_flush=b;42===e.status&&(2===e.wrap?(a.adler=0,p(e,31),p(e,139),p(e,8),e.gzhead?(p(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),p(e,e.gzhead.time&255),p(e,e.gzhead.time>>8&255),p(e,e.gzhead.time>>16&255),p(e,e.gzhead.time>>24&255),p(e,9===e.level?2:2<=e.strategy||2>e.level?4:0),p(e,e.gzhead.os&255),e.gzhead.extra&&e.gzhead.extra.length&&(p(e,e.gzhead.extra.length&
255),p(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(a.adler=F(a.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=69):(p(e,0),p(e,0),p(e,0),p(e,0),p(e,0),p(e,9===e.level?2:2<=e.strategy||2>e.level?4:0),p(e,3),e.status=113)):(g=8+(e.w_bits-8<<4)<<8,k=-1,k=2<=e.strategy||2>e.level?0:6>e.level?1:6===e.level?2:3,g|=k<<6,0!==e.strstart&&(g|=32),e.status=113,l(e,g+(31-g%31)),0!==e.strstart&&(l(e,a.adler>>>16),l(e,a.adler&65535)),a.adler=1));if(69===e.status)if(e.gzhead.extra){for(g=e.pending;e.gzindex<
(e.gzhead.extra.length&65535)&&(e.pending!==e.pending_buf_size||(e.gzhead.hcrc&&e.pending>g&&(a.adler=F(a.adler,e.pending_buf,e.pending-g,g)),f(a),g=e.pending,e.pending!==e.pending_buf_size));)p(e,e.gzhead.extra[e.gzindex]&255),e.gzindex++;e.gzhead.hcrc&&e.pending>g&&(a.adler=F(a.adler,e.pending_buf,e.pending-g,g));e.gzindex===e.gzhead.extra.length&&(e.gzindex=0,e.status=73)}else e.status=73;if(73===e.status)if(e.gzhead.name){g=e.pending;do{if(e.pending===e.pending_buf_size&&(e.gzhead.hcrc&&e.pending>
g&&(a.adler=F(a.adler,e.pending_buf,e.pending-g,g)),f(a),g=e.pending,e.pending===e.pending_buf_size)){k=1;break}k=e.gzindex<e.gzhead.name.length?e.gzhead.name.charCodeAt(e.gzindex++)&255:0;p(e,k)}while(0!==k);e.gzhead.hcrc&&e.pending>g&&(a.adler=F(a.adler,e.pending_buf,e.pending-g,g));0===k&&(e.gzindex=0,e.status=91)}else e.status=91;if(91===e.status)if(e.gzhead.comment){g=e.pending;do{if(e.pending===e.pending_buf_size&&(e.gzhead.hcrc&&e.pending>g&&(a.adler=F(a.adler,e.pending_buf,e.pending-g,g)),
f(a),g=e.pending,e.pending===e.pending_buf_size)){k=1;break}k=e.gzindex<e.gzhead.comment.length?e.gzhead.comment.charCodeAt(e.gzindex++)&255:0;p(e,k)}while(0!==k);e.gzhead.hcrc&&e.pending>g&&(a.adler=F(a.adler,e.pending_buf,e.pending-g,g));0===k&&(e.status=103)}else e.status=103;103===e.status&&(e.gzhead.hcrc?(e.pending+2>e.pending_buf_size&&f(a),e.pending+2<=e.pending_buf_size&&(p(e,a.adler&255),p(e,a.adler>>8&255),a.adler=0,e.status=113)):e.status=113);if(0!==e.pending){if(f(a),0===a.avail_out)return e.last_flush=
-1,0}else if(0===a.avail_in&&(b<<1)-(4<b?9:0)<=(d<<1)-(4<d?9:0)&&4!==b)return c(a,-5);if(666===e.status&&0!==a.avail_in)return c(a,-5);if(0!==a.avail_in||0!==e.lookahead||0!==b&&666!==e.status){d=2===e.strategy?x(e,b):3===e.strategy?q(e,b):H[e.level].func(e,b);if(3===d||4===d)e.status=666;if(1===d||3===d)return 0===a.avail_out&&(e.last_flush=-1),0;if(2===d&&(1===b?w._tr_align(e):5!==b&&(w._tr_stored_block(e,0,0,!1),3===b&&(h(e.head),0===e.lookahead&&(e.strstart=0,e.block_start=0,e.insert=0))),f(a),
0===a.avail_out))return e.last_flush=-1,0}if(4!==b)return 0;if(0>=e.wrap)return 1;2===e.wrap?(p(e,a.adler&255),p(e,a.adler>>8&255),p(e,a.adler>>16&255),p(e,a.adler>>24&255),p(e,a.total_in&255),p(e,a.total_in>>8&255),p(e,a.total_in>>16&255),p(e,a.total_in>>24&255)):(l(e,a.adler>>>16),l(e,a.adler&65535));f(a);0<e.wrap&&(e.wrap=-e.wrap);return 0!==e.pending?0:1};a.deflateEnd=function(a){var b;if(!a||!a.state)return-2;b=a.state.status;if(42!==b&&69!==b&&73!==b&&91!==b&&103!==b&&113!==b&&666!==b)return c(a,
-2);a.state=null;return 113===b?c(a,-3):0};a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(d,g,a){g.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],34:[function(d,g,a){g.exports=function(a,d){var f,g,p,l,r,b,e,k,q,x,A,v,t,B,u,w,D,F,C,H,s,z,y,M;f=a.state;g=a.next_in;y=a.input;p=g+(a.avail_in-5);l=a.next_out;
M=a.output;r=l-(d-a.avail_out);b=l+(a.avail_out-257);e=f.dmax;k=f.wsize;q=f.whave;x=f.wnext;A=f.window;v=f.hold;t=f.bits;B=f.lencode;u=f.distcode;w=(1<<f.lenbits)-1;D=(1<<f.distbits)-1;a:do b:for(15>t&&(v+=y[g++]<<t,t+=8,v+=y[g++]<<t,t+=8),F=B[v&w];;){C=F>>>24;v>>>=C;t-=C;C=F>>>16&255;if(0===C)M[l++]=F&65535;else if(C&16){H=F&65535;if(C&=15)t<C&&(v+=y[g++]<<t,t+=8),H+=v&(1<<C)-1,v>>>=C,t-=C;15>t&&(v+=y[g++]<<t,t+=8,v+=y[g++]<<t,t+=8);F=u[v&D];c:for(;;){C=F>>>24;v>>>=C;t-=C;C=F>>>16&255;if(C&16){F&=
65535;C&=15;t<C&&(v+=y[g++]<<t,t+=8,t<C&&(v+=y[g++]<<t,t+=8));F+=v&(1<<C)-1;if(F>e){a.msg="invalid distance too far back";f.mode=30;break a}v>>>=C;t-=C;C=l-r;if(F>C){C=F-C;if(C>q&&f.sane){a.msg="invalid distance too far back";f.mode=30;break a}s=0;z=A;if(0===x){if(s+=k-C,C<H){H-=C;do M[l++]=A[s++];while(--C);s=l-F;z=M}}else if(x<C){if(s+=k+x-C,C-=x,C<H){H-=C;do M[l++]=A[s++];while(--C);s=0;if(x<H){C=x;H-=C;do M[l++]=A[s++];while(--C);s=l-F;z=M}}}else if(s+=x-C,C<H){H-=C;do M[l++]=A[s++];while(--C);
s=l-F;z=M}for(;2<H;)M[l++]=z[s++],M[l++]=z[s++],M[l++]=z[s++],H-=3;H&&(M[l++]=z[s++],1<H&&(M[l++]=z[s++]))}else{s=l-F;do M[l++]=M[s++],M[l++]=M[s++],M[l++]=M[s++],H-=3;while(2<H);H&&(M[l++]=M[s++],1<H&&(M[l++]=M[s++]))}}else if(0===(C&64)){F=u[(F&65535)+(v&(1<<C)-1)];continue c}else{a.msg="invalid distance code";f.mode=30;break a}break}}else if(0===(C&64)){F=B[(F&65535)+(v&(1<<C)-1)];continue b}else{C&32?f.mode=12:(a.msg="invalid literal/length code",f.mode=30);break a}break}while(g<p&&l<b);H=t>>
3;g-=H;t-=H<<3;a.next_in=g;a.next_out=l;a.avail_in=g<p?5+(p-g):5-(g-p);a.avail_out=l<b?257+(b-l):257-(l-b);f.hold=v&(1<<t)-1;f.bits=t}},{}],35:[function(d,g,a){function c(a){return(a>>>24&255)+(a>>>8&65280)+((a&65280)<<8)+((a&255)<<24)}function h(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=
null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new r.Buf16(320);this.work=new r.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function f(a){var b;if(!a||!a.state)return-2;b=a.state;a.total_in=a.total_out=b.total=0;a.msg="";b.wrap&&(a.adler=b.wrap&1);b.mode=1;b.last=0;b.havedict=0;b.dmax=32768;b.head=null;b.hold=0;b.bits=0;b.lencode=b.lendyn=new r.Buf32(852);b.distcode=b.distdyn=new r.Buf32(592);b.sane=1;b.back=-1;return 0}
function n(a){var b;if(!a||!a.state)return-2;b=a.state;b.wsize=0;b.whave=0;b.wnext=0;return f(a)}function p(a,b){var c,e;if(!a||!a.state)return-2;e=a.state;0>b?(c=0,b=-b):(c=(b>>4)+1,48>b&&(b&=15));if(b&&(8>b||15<b))return-2;null!==e.window&&e.wbits!==b&&(e.window=null);e.wrap=c;e.wbits=b;return n(a)}function l(a,b){var c;if(!a)return-2;c=new h;a.state=c;c.window=null;c=p(a,b);0!==c&&(a.state=null);return c}var r=d("../utils/common"),b=d("./adler32"),e=d("./crc32"),k=d("./inffast"),q=d("./inftrees"),
x=!0,A,v;a.inflateReset=n;a.inflateReset2=p;a.inflateResetKeep=f;a.inflateInit=function(a){return l(a,15)};a.inflateInit2=l;a.inflate=function(a,d){var f,g,h,l,p,n,s,z,y,M,E,I,J,K,G=0,W,P,R,ba=new r.Buf8(4),ca=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!a||!a.state||!a.output||!a.input&&0!==a.avail_in)return-2;f=a.state;12===f.mode&&(f.mode=13);p=a.next_out;h=a.output;s=a.avail_out;l=a.next_in;g=a.input;n=a.avail_in;z=f.hold;y=f.bits;M=n;E=s;R=0;a:for(;;)switch(f.mode){case 1:if(0===f.wrap){f.mode=
13;break}for(;16>y;){if(0===n)break a;n--;z+=g[l++]<<y;y+=8}if(f.wrap&2&&35615===z){f.check=0;ba[0]=z&255;ba[1]=z>>>8&255;f.check=e(f.check,ba,2,0);y=z=0;f.mode=2;break}f.flags=0;f.head&&(f.head.done=!1);if(!(f.wrap&1)||(((z&255)<<8)+(z>>8))%31){a.msg="incorrect header check";f.mode=30;break}if(8!==(z&15)){a.msg="unknown compression method";f.mode=30;break}z>>>=4;y-=4;J=(z&15)+8;if(0===f.wbits)f.wbits=J;else if(J>f.wbits){a.msg="invalid window size";f.mode=30;break}f.dmax=1<<J;a.adler=f.check=1;f.mode=
z&512?10:12;y=z=0;break;case 2:for(;16>y;){if(0===n)break a;n--;z+=g[l++]<<y;y+=8}f.flags=z;if(8!==(f.flags&255)){a.msg="unknown compression method";f.mode=30;break}if(f.flags&57344){a.msg="unknown header flags set";f.mode=30;break}f.head&&(f.head.text=z>>8&1);f.flags&512&&(ba[0]=z&255,ba[1]=z>>>8&255,f.check=e(f.check,ba,2,0));y=z=0;f.mode=3;case 3:for(;32>y;){if(0===n)break a;n--;z+=g[l++]<<y;y+=8}f.head&&(f.head.time=z);f.flags&512&&(ba[0]=z&255,ba[1]=z>>>8&255,ba[2]=z>>>16&255,ba[3]=z>>>24&255,
f.check=e(f.check,ba,4,0));y=z=0;f.mode=4;case 4:for(;16>y;){if(0===n)break a;n--;z+=g[l++]<<y;y+=8}f.head&&(f.head.xflags=z&255,f.head.os=z>>8);f.flags&512&&(ba[0]=z&255,ba[1]=z>>>8&255,f.check=e(f.check,ba,2,0));y=z=0;f.mode=5;case 5:if(f.flags&1024){for(;16>y;){if(0===n)break a;n--;z+=g[l++]<<y;y+=8}f.length=z;f.head&&(f.head.extra_len=z);f.flags&512&&(ba[0]=z&255,ba[1]=z>>>8&255,f.check=e(f.check,ba,2,0));y=z=0}else f.head&&(f.head.extra=null);f.mode=6;case 6:if(f.flags&1024&&(I=f.length,I>n&&
(I=n),I&&(f.head&&(J=f.head.extra_len-f.length,f.head.extra||(f.head.extra=Array(f.head.extra_len)),r.arraySet(f.head.extra,g,l,I,J)),f.flags&512&&(f.check=e(f.check,g,I,l)),n-=I,l+=I,f.length-=I),f.length))break a;f.length=0;f.mode=7;case 7:if(f.flags&2048){if(0===n)break a;I=0;do J=g[l+I++],f.head&&J&&65536>f.length&&(f.head.name+=String.fromCharCode(J));while(J&&I<n);f.flags&512&&(f.check=e(f.check,g,I,l));n-=I;l+=I;if(J)break a}else f.head&&(f.head.name=null);f.length=0;f.mode=8;case 8:if(f.flags&
4096){if(0===n)break a;I=0;do J=g[l+I++],f.head&&J&&65536>f.length&&(f.head.comment+=String.fromCharCode(J));while(J&&I<n);f.flags&512&&(f.check=e(f.check,g,I,l));n-=I;l+=I;if(J)break a}else f.head&&(f.head.comment=null);f.mode=9;case 9:if(f.flags&512){for(;16>y;){if(0===n)break a;n--;z+=g[l++]<<y;y+=8}if(z!==(f.check&65535)){a.msg="header crc mismatch";f.mode=30;break}y=z=0}f.head&&(f.head.hcrc=f.flags>>9&1,f.head.done=!0);a.adler=f.check=0;f.mode=12;break;case 10:for(;32>y;){if(0===n)break a;n--;
z+=g[l++]<<y;y+=8}a.adler=f.check=c(z);y=z=0;f.mode=11;case 11:if(0===f.havedict)return a.next_out=p,a.avail_out=s,a.next_in=l,a.avail_in=n,f.hold=z,f.bits=y,2;a.adler=f.check=1;f.mode=12;case 12:if(5===d||6===d)break a;case 13:if(f.last){z>>>=y&7;y-=y&7;f.mode=27;break}for(;3>y;){if(0===n)break a;n--;z+=g[l++]<<y;y+=8}f.last=z&1;z>>>=1;y-=1;switch(z&3){case 0:f.mode=14;break;case 1:I=f;if(x){J=void 0;A=new r.Buf32(512);v=new r.Buf32(32);for(J=0;144>J;)I.lens[J++]=8;for(;256>J;)I.lens[J++]=9;for(;280>
J;)I.lens[J++]=7;for(;288>J;)I.lens[J++]=8;q(1,I.lens,0,288,A,0,I.work,{bits:9});for(J=0;32>J;)I.lens[J++]=5;q(2,I.lens,0,32,v,0,I.work,{bits:5});x=!1}I.lencode=A;I.lenbits=9;I.distcode=v;I.distbits=5;f.mode=20;if(6===d){z>>>=2;y-=2;break a}break;case 2:f.mode=17;break;case 3:a.msg="invalid block type",f.mode=30}z>>>=2;y-=2;break;case 14:z>>>=y&7;for(y-=y&7;32>y;){if(0===n)break a;n--;z+=g[l++]<<y;y+=8}if((z&65535)!==(z>>>16^65535)){a.msg="invalid stored block lengths";f.mode=30;break}f.length=z&
65535;y=z=0;f.mode=15;if(6===d)break a;case 15:f.mode=16;case 16:if(I=f.length){I>n&&(I=n);I>s&&(I=s);if(0===I)break a;r.arraySet(h,g,l,I,p);n-=I;l+=I;s-=I;p+=I;f.length-=I;break}f.mode=12;break;case 17:for(;14>y;){if(0===n)break a;n--;z+=g[l++]<<y;y+=8}f.nlen=(z&31)+257;z>>>=5;y-=5;f.ndist=(z&31)+1;z>>>=5;y-=5;f.ncode=(z&15)+4;z>>>=4;y-=4;if(286<f.nlen||30<f.ndist){a.msg="too many length or distance symbols";f.mode=30;break}f.have=0;f.mode=18;case 18:for(;f.have<f.ncode;){for(;3>y;){if(0===n)break a;
n--;z+=g[l++]<<y;y+=8}f.lens[ca[f.have++]]=z&7;z>>>=3;y-=3}for(;19>f.have;)f.lens[ca[f.have++]]=0;f.lencode=f.lendyn;f.lenbits=7;I={bits:f.lenbits};R=q(0,f.lens,0,19,f.lencode,0,f.work,I);f.lenbits=I.bits;if(R){a.msg="invalid code lengths set";f.mode=30;break}f.have=0;f.mode=19;case 19:for(;f.have<f.nlen+f.ndist;){for(;;){G=f.lencode[z&(1<<f.lenbits)-1];I=G>>>24;G&=65535;if(I<=y)break;if(0===n)break a;n--;z+=g[l++]<<y;y+=8}if(16>G)z>>>=I,y-=I,f.lens[f.have++]=G;else{if(16===G){for(J=I+2;y<J;){if(0===
n)break a;n--;z+=g[l++]<<y;y+=8}z>>>=I;y-=I;if(0===f.have){a.msg="invalid bit length repeat";f.mode=30;break}J=f.lens[f.have-1];I=3+(z&3);z>>>=2;y-=2}else if(17===G){for(J=I+3;y<J;){if(0===n)break a;n--;z+=g[l++]<<y;y+=8}z>>>=I;y-=I;J=0;I=3+(z&7);z>>>=3;y-=3}else{for(J=I+7;y<J;){if(0===n)break a;n--;z+=g[l++]<<y;y+=8}z>>>=I;y-=I;J=0;I=11+(z&127);z>>>=7;y-=7}if(f.have+I>f.nlen+f.ndist){a.msg="invalid bit length repeat";f.mode=30;break}for(;I--;)f.lens[f.have++]=J}}if(30===f.mode)break;if(0===f.lens[256]){a.msg=
"invalid code -- missing end-of-block";f.mode=30;break}f.lenbits=9;I={bits:f.lenbits};R=q(1,f.lens,0,f.nlen,f.lencode,0,f.work,I);f.lenbits=I.bits;if(R){a.msg="invalid literal/lengths set";f.mode=30;break}f.distbits=6;f.distcode=f.distdyn;I={bits:f.distbits};R=q(2,f.lens,f.nlen,f.ndist,f.distcode,0,f.work,I);f.distbits=I.bits;if(R){a.msg="invalid distances set";f.mode=30;break}f.mode=20;if(6===d)break a;case 20:f.mode=21;case 21:if(6<=n&&258<=s){a.next_out=p;a.avail_out=s;a.next_in=l;a.avail_in=n;
f.hold=z;f.bits=y;k(a,E);p=a.next_out;h=a.output;s=a.avail_out;l=a.next_in;g=a.input;n=a.avail_in;z=f.hold;y=f.bits;12===f.mode&&(f.back=-1);break}for(f.back=0;;){G=f.lencode[z&(1<<f.lenbits)-1];I=G>>>24;J=G>>>16&255;G&=65535;if(I<=y)break;if(0===n)break a;n--;z+=g[l++]<<y;y+=8}if(J&&0===(J&240)){K=I;W=J;for(P=G;;){G=f.lencode[P+((z&(1<<K+W)-1)>>K)];I=G>>>24;J=G>>>16&255;G&=65535;if(K+I<=y)break;if(0===n)break a;n--;z+=g[l++]<<y;y+=8}z>>>=K;y-=K;f.back+=K}z>>>=I;y-=I;f.back+=I;f.length=G;if(0===J){f.mode=
26;break}if(J&32){f.back=-1;f.mode=12;break}if(J&64){a.msg="invalid literal/length code";f.mode=30;break}f.extra=J&15;f.mode=22;case 22:if(f.extra){for(J=f.extra;y<J;){if(0===n)break a;n--;z+=g[l++]<<y;y+=8}f.length+=z&(1<<f.extra)-1;z>>>=f.extra;y-=f.extra;f.back+=f.extra}f.was=f.length;f.mode=23;case 23:for(;;){G=f.distcode[z&(1<<f.distbits)-1];I=G>>>24;J=G>>>16&255;G&=65535;if(I<=y)break;if(0===n)break a;n--;z+=g[l++]<<y;y+=8}if(0===(J&240)){K=I;W=J;for(P=G;;){G=f.distcode[P+((z&(1<<K+W)-1)>>K)];
I=G>>>24;J=G>>>16&255;G&=65535;if(K+I<=y)break;if(0===n)break a;n--;z+=g[l++]<<y;y+=8}z>>>=K;y-=K;f.back+=K}z>>>=I;y-=I;f.back+=I;if(J&64){a.msg="invalid distance code";f.mode=30;break}f.offset=G;f.extra=J&15;f.mode=24;case 24:if(f.extra){for(J=f.extra;y<J;){if(0===n)break a;n--;z+=g[l++]<<y;y+=8}f.offset+=z&(1<<f.extra)-1;z>>>=f.extra;y-=f.extra;f.back+=f.extra}if(f.offset>f.dmax){a.msg="invalid distance too far back";f.mode=30;break}f.mode=25;case 25:if(0===s)break a;I=E-s;if(f.offset>I){I=f.offset-
I;if(I>f.whave&&f.sane){a.msg="invalid distance too far back";f.mode=30;break}I>f.wnext?(I-=f.wnext,J=f.wsize-I):J=f.wnext-I;I>f.length&&(I=f.length);K=f.window}else K=h,J=p-f.offset,I=f.length;I>s&&(I=s);s-=I;f.length-=I;do h[p++]=K[J++];while(--I);0===f.length&&(f.mode=21);break;case 26:if(0===s)break a;h[p++]=f.length;s--;f.mode=21;break;case 27:if(f.wrap){for(;32>y;){if(0===n)break a;n--;z|=g[l++]<<y;y+=8}E-=s;a.total_out+=E;f.total+=E;E&&(a.adler=f.check=f.flags?e(f.check,h,E,p-E):b(f.check,
h,E,p-E));E=s;if((f.flags?z:c(z))!==f.check){a.msg="incorrect data check";f.mode=30;break}y=z=0}f.mode=28;case 28:if(f.wrap&&f.flags){for(;32>y;){if(0===n)break a;n--;z+=g[l++]<<y;y+=8}if(z!==(f.total&4294967295)){a.msg="incorrect length check";f.mode=30;break}y=z=0}f.mode=29;case 29:R=1;break a;case 30:R=-3;break a;case 31:return-4;default:return-2}a.next_out=p;a.avail_out=s;a.next_in=l;a.avail_in=n;f.hold=z;f.bits=y;if(f.wsize||E!==a.avail_out&&30>f.mode&&(27>f.mode||4!==d))g=a.output,l=a.next_out,
p=E-a.avail_out,s=a.state,null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new r.Buf8(s.wsize)),p>=s.wsize?(r.arraySet(s.window,g,l-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>p&&(n=p),r.arraySet(s.window,g,l-p,n,s.wnext),(p-=n)?(r.arraySet(s.window,g,l-p,p,0),s.wnext=p,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n)));M-=a.avail_in;E-=a.avail_out;a.total_in+=M;a.total_out+=E;f.total+=E;f.wrap&&E&&(a.adler=f.check=f.flags?
e(f.check,h,E,a.next_out-E):b(f.check,h,E,a.next_out-E));a.data_type=f.bits+(f.last?64:0)+(12===f.mode?128:0)+(20===f.mode||15===f.mode?256:0);(0===M&&0===E||4===d)&&0===R&&(R=-5);return R};a.inflateEnd=function(a){if(!a||!a.state)return-2;var b=a.state;b.window&&(b.window=null);a.state=null;return 0};a.inflateGetHeader=function(a,b){var c;if(!a||!a.state)return-2;c=a.state;if(0===(c.wrap&2))return-2;c.head=b;b.done=!1;return 0};a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,
"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(d,g,a){var c=d("../utils/common"),h=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],f=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],n=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],p=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,
28,29,29,64,64];g.exports=function(a,d,b,e,g,q,x,A){for(var v=A.bits,t=0,B=0,u=0,w=0,D=0,F=0,C=0,H=0,s=0,z=0,y,M,E=null,I=0,J,K=new c.Buf16(16),F=new c.Buf16(16),G=null,W=0,P,R,ba,t=0;15>=t;t++)K[t]=0;for(B=0;B<e;B++)K[d[b+B]]++;D=v;for(w=15;1<=w&&0===K[w];w--);D>w&&(D=w);if(0===w)return g[q++]=20971520,g[q++]=20971520,A.bits=1,0;for(u=1;u<w&&0===K[u];u++);D<u&&(D=u);for(t=H=1;15>=t;t++)if(H<<=1,H-=K[t],0>H)return-1;if(0<H&&(0===a||1!==w))return-1;F[1]=0;for(t=1;15>t;t++)F[t+1]=F[t]+K[t];for(B=0;B<
e;B++)0!==d[b+B]&&(x[F[d[b+B]]++]=B);0===a?(E=G=x,J=19):1===a?(E=h,I-=257,G=f,W-=257,J=256):(E=n,G=p,J=-1);B=z=0;t=u;v=q;F=D;C=0;M=-1;s=1<<D;e=s-1;if(1===a&&852<s||2===a&&592<s)return 1;for(var ca=0;;){ca++;P=t-C;x[B]<J?(R=0,ba=x[B]):x[B]>J?(R=G[W+x[B]],ba=E[I+x[B]]):(R=96,ba=0);H=1<<t-C;u=y=1<<F;do y-=H,g[v+(z>>C)+y]=P<<24|R<<16|ba|0;while(0!==y);for(H=1<<t-1;z&H;)H>>=1;0!==H?(z&=H-1,z+=H):z=0;B++;if(0===--K[t]){if(t===w)break;t=d[b+x[B]]}if(t>D&&(z&e)!==M){0===C&&(C=D);v+=u;F=t-C;for(H=1<<F;F+C<
w;){H-=K[F+C];if(0>=H)break;F++;H<<=1}s+=1<<F;if(1===a&&852<s||2===a&&592<s)return 1;M=z&e;g[M]=D<<24|F<<16|v-q|0}}0!==z&&(g[v+z]=t-C<<24|4194304);A.bits=D;return 0}},{"../utils/common":27}],37:[function(d,g,a){g.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(d,g,a){function c(a){for(var b=a.length;0<=--b;)a[b]=0}function h(a,b){a.pending_buf[a.pending++]=
b&255;a.pending_buf[a.pending++]=b>>>8&255}function f(a,b,c){a.bi_valid>16-c?(a.bi_buf|=b<<a.bi_valid&65535,h(a,a.bi_buf),a.bi_buf=b>>16-a.bi_valid,a.bi_valid+=c-16):(a.bi_buf|=b<<a.bi_valid&65535,a.bi_valid+=c)}function n(a,b,c){f(a,c[2*b],c[2*b+1])}function p(a,b){var c=0;do c|=a&1,a>>>=1,c<<=1;while(0<--b);return c>>>1}function l(a,b,c){var e=Array(16),d=0,f;for(f=1;15>=f;f++)e[f]=d=d+c[f-1]<<1;for(c=0;c<=b;c++)d=a[2*c+1],0!==d&&(a[2*c]=p(e[d]++,d))}function r(a){var b;for(b=0;286>b;b++)a.dyn_ltree[2*
b]=0;for(b=0;30>b;b++)a.dyn_dtree[2*b]=0;for(b=0;19>b;b++)a.bl_tree[2*b]=0;a.dyn_ltree[512]=1;a.opt_len=a.static_len=0;a.last_lit=a.matches=0}function b(a){8<a.bi_valid?h(a,a.bi_buf):0<a.bi_valid&&(a.pending_buf[a.pending++]=a.bi_buf);a.bi_buf=0;a.bi_valid=0}function e(a,b,c,d){var e=2*b,f=2*c;return a[e]<a[f]||a[e]===a[f]&&d[b]<=d[c]}function k(a,b,c){for(var d=a.heap[c],f=c<<1;f<=a.heap_len;){f<a.heap_len&&e(b,a.heap[f+1],a.heap[f],a.depth)&&f++;if(e(b,d,a.heap[f],a.depth))break;a.heap[c]=a.heap[f];
c=f;f<<=1}a.heap[c]=d}function q(a,b,c){var d,e,g=0,h,k;if(0!==a.last_lit){do d=a.pending_buf[a.d_buf+2*g]<<8|a.pending_buf[a.d_buf+2*g+1],e=a.pending_buf[a.l_buf+g],g++,0===d?n(a,e,b):(h=y[e],n(a,h+256+1,b),k=w[h],0!==k&&(e-=M[h],f(a,e,k)),d--,h=256>d?z[d]:z[256+(d>>>7)],n(a,h,c),k=D[h],0!==k&&(d-=E[h],f(a,d,k)));while(g<a.last_lit)}n(a,256,b)}function x(a,b){var c=b.dyn_tree,d=b.stat_desc.static_tree,e=b.stat_desc.has_stree,f=b.stat_desc.elems,g,h=-1,n;a.heap_len=0;a.heap_max=573;for(g=0;g<f;g++)0!==
c[2*g]?(a.heap[++a.heap_len]=h=g,a.depth[g]=0):c[2*g+1]=0;for(;2>a.heap_len;)n=a.heap[++a.heap_len]=2>h?++h:0,c[2*n]=1,a.depth[n]=0,a.opt_len--,e&&(a.static_len-=d[2*n+1]);b.max_code=h;for(g=a.heap_len>>1;1<=g;g--)k(a,c,g);n=f;do g=a.heap[1],a.heap[1]=a.heap[a.heap_len--],k(a,c,1),d=a.heap[1],a.heap[--a.heap_max]=g,a.heap[--a.heap_max]=d,c[2*n]=c[2*g]+c[2*d],a.depth[n]=(a.depth[g]>=a.depth[d]?a.depth[g]:a.depth[d])+1,c[2*g+1]=c[2*d+1]=n,a.heap[1]=n++,k(a,c,1);while(2<=a.heap_len);a.heap[--a.heap_max]=
a.heap[1];g=b.dyn_tree;n=b.max_code;for(var p=b.stat_desc.static_tree,q=b.stat_desc.has_stree,r=b.stat_desc.extra_bits,s=b.stat_desc.extra_base,t=b.stat_desc.max_length,u,v,w=0,f=0;15>=f;f++)a.bl_count[f]=0;g[2*a.heap[a.heap_max]+1]=0;for(d=a.heap_max+1;573>d;d++)e=a.heap[d],f=g[2*g[2*e+1]+1]+1,f>t&&(f=t,w++),g[2*e+1]=f,e>n||(a.bl_count[f]++,u=0,e>=s&&(u=r[e-s]),v=g[2*e],a.opt_len+=v*(f+u),q&&(a.static_len+=v*(p[2*e+1]+u)));if(0!==w){do{for(f=t-1;0===a.bl_count[f];)f--;a.bl_count[f]--;a.bl_count[f+
1]+=2;a.bl_count[t]--;w-=2}while(0<w);for(f=t;0!==f;f--)for(e=a.bl_count[f];0!==e;)p=a.heap[--d],p>n||(g[2*p+1]!==f&&(a.opt_len+=(f-g[2*p+1])*g[2*p],g[2*p+1]=f),e--)}l(c,h,a.bl_count)}function A(a,b,c){var d,e=-1,f,g=b[1],h=0,k=7,l=4;0===g&&(k=138,l=3);b[2*(c+1)+1]=65535;for(d=0;d<=c;d++)f=g,g=b[2*(d+1)+1],++h<k&&f===g||(h<l?a.bl_tree[2*f]+=h:0!==f?(f!==e&&a.bl_tree[2*f]++,a.bl_tree[32]++):10>=h?a.bl_tree[34]++:a.bl_tree[36]++,h=0,e=f,0===g?(k=138,l=3):f===g?(k=6,l=3):(k=7,l=4))}function v(a,b,c){var d,
e=-1,g,h=b[1],k=0,l=7,p=4;0===h&&(l=138,p=3);for(d=0;d<=c;d++)if(g=h,h=b[2*(d+1)+1],!(++k<l&&g===h)){if(k<p){do n(a,g,a.bl_tree);while(0!==--k)}else 0!==g?(g!==e&&(n(a,g,a.bl_tree),k--),n(a,16,a.bl_tree),f(a,k-3,2)):10>=k?(n(a,17,a.bl_tree),f(a,k-3,3)):(n(a,18,a.bl_tree),f(a,k-11,7));k=0;e=g;0===h?(l=138,p=3):g===h?(l=6,p=3):(l=7,p=4)}}function t(a){var b=4093624447,c;for(c=0;31>=c;c++,b>>>=1)if(b&1&&0!==a.dyn_ltree[2*c])return 0;if(0!==a.dyn_ltree[18]||0!==a.dyn_ltree[20]||0!==a.dyn_ltree[26])return 1;
for(c=32;256>c;c++)if(0!==a.dyn_ltree[2*c])return 1;return 0}function B(a,c,d,e){f(a,0+(e?1:0),3);b(a);h(a,d);h(a,~d);u.arraySet(a.pending_buf,a.window,c,d,a.pending);a.pending+=d}var u=d("../utils/common"),w=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],D=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],F=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=Array(576);c(H);var s=Array(60);c(s);var z=Array(512);c(z);var y=
Array(256);c(y);var M=Array(29);c(M);var E=Array(30);c(E);var I=function(a,b,c,d,e){this.static_tree=a;this.extra_bits=b;this.extra_base=c;this.elems=d;this.max_length=e;this.has_stree=a&&a.length},J,K,G,W=function(a,b){this.dyn_tree=a;this.max_code=0;this.stat_desc=b},P=!1;a._tr_init=function(a){if(!P){var b,c,d,e=Array(16);for(d=c=0;28>d;d++)for(M[d]=c,b=0;b<1<<w[d];b++)y[c++]=d;y[c-1]=d;for(d=c=0;16>d;d++)for(E[d]=c,b=0;b<1<<D[d];b++)z[c++]=d;for(c>>=7;30>d;d++)for(E[d]=c<<7,b=0;b<1<<D[d]-7;b++)z[256+
c++]=d;for(b=0;15>=b;b++)e[b]=0;for(b=0;143>=b;)H[2*b+1]=8,b++,e[8]++;for(;255>=b;)H[2*b+1]=9,b++,e[9]++;for(;279>=b;)H[2*b+1]=7,b++,e[7]++;for(;287>=b;)H[2*b+1]=8,b++,e[8]++;l(H,287,e);for(b=0;30>b;b++)s[2*b+1]=5,s[2*b]=p(b,5);J=new I(H,w,257,286,15);K=new I(s,D,0,30,15);G=new I([],F,0,19,7);P=!0}a.l_desc=new W(a.dyn_ltree,J);a.d_desc=new W(a.dyn_dtree,K);a.bl_desc=new W(a.bl_tree,G);a.bi_buf=0;a.bi_valid=0;r(a)};a._tr_stored_block=B;a._tr_flush_block=function(a,c,d,e){var g,h,k=0;if(0<a.level){2===
a.strm.data_type&&(a.strm.data_type=t(a));x(a,a.l_desc);x(a,a.d_desc);A(a,a.dyn_ltree,a.l_desc.max_code);A(a,a.dyn_dtree,a.d_desc.max_code);x(a,a.bl_desc);for(k=18;3<=k&&0===a.bl_tree[2*C[k]+1];k--);a.opt_len+=3*(k+1)+14;g=a.opt_len+3+7>>>3;h=a.static_len+3+7>>>3;h<=g&&(g=h)}else g=h=d+5;if(d+4<=g&&-1!==c)B(a,c,d,e);else if(4===a.strategy||h===g)f(a,2+(e?1:0),3),q(a,H,s);else{f(a,4+(e?1:0),3);c=a.l_desc.max_code+1;d=a.d_desc.max_code+1;k+=1;f(a,c-257,5);f(a,d-1,5);f(a,k-4,4);for(g=0;g<k;g++)f(a,a.bl_tree[2*
C[g]+1],3);v(a,a.dyn_ltree,c-1);v(a,a.dyn_dtree,d-1);q(a,a.dyn_ltree,a.dyn_dtree)}r(a);e&&b(a)};a._tr_tally=function(a,b,c){a.pending_buf[a.d_buf+2*a.last_lit]=b>>>8&255;a.pending_buf[a.d_buf+2*a.last_lit+1]=b&255;a.pending_buf[a.l_buf+a.last_lit]=c&255;a.last_lit++;0===b?a.dyn_ltree[2*c]++:(a.matches++,b--,a.dyn_ltree[2*(y[c]+256+1)]++,a.dyn_dtree[2*(256>b?z[b]:z[256+(b>>>7)])]++);return a.last_lit===a.lit_bufsize-1};a._tr_align=function(a){f(a,2,3);n(a,256,H);16===a.bi_valid?(h(a,a.bi_buf),a.bi_buf=
0,a.bi_valid=0):8<=a.bi_valid&&(a.pending_buf[a.pending++]=a.bi_buf&255,a.bi_buf>>=8,a.bi_valid-=8)}},{"../utils/common":27}],39:[function(d,g,a){g.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}},{}]},{},[9])(9)});
function number_format(m,d,g,a){m=(m+"").replace(/[^0-9+\-Ee.]/g,"");m=isFinite(+m)?+m:0;d=isFinite(+d)?Math.abs(d):0;a="undefined"===typeof a?",":a;g="undefined"===typeof g?".":g;var c="",c=function(a,c){var d=Math.pow(10,c);return""+Math.round(a*d)/d},c=(d?c(m,d):""+Math.round(m)).split(".");3<c[0].length&&(c[0]=c[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,a));(c[1]||"").length<d&&(c[1]=c[1]||"",c[1]+=Array(d-c[1].length+1).join("0"));return c.join(g)}
function findChildNode(m,d,g){var a=[];for(m=m?m.firstElementChild:null;m;)m.localName===g&&m.namespaceURI===d&&a.push(m),m=m.nextElementSibling;return a}function getWindowWidth(){var m=0;if("number"==typeof window.innerWidth)m=window.innerWidth;else var m=document.documentElement.clientWidth,d=document.body.clientWidth,m=0<m?m:d;m||(m=0);return m}
function getWindowHeight(){var m=0;if("number"==typeof window.innerHeight)m=window.innerHeight;else var m=document.documentElement.clientHeight,d=document.body.clientHeight,m=0<m?m:d;m||(m=0);return m}function getScrollLeft(){var m;document.body&&document.body.scrollLeft?m=document.body.scrollLeft:document.documentElement&&document.documentElement.scrollLeft&&(m=document.documentElement.scrollLeft);m||(m=0);return m}
function getScrollTop(){var m;document.body&&document.body.scrollTop?m=document.body.scrollTop:document.documentElement&&document.documentElement.scrollTop&&(m=document.documentElement.scrollTop);m||(m=0);return m}var messagetimer=null;
function show_message(m,d,g,a,c){d||(d=10);g||(g=10);a||(a=5);c||(c=2E3);for(var h=1,f=1;4>=f;f++){var n="layer_message";1<f&&(n="layer_message"+f);if(n=document.getElementById(n)){h=f;break}}n.style.left="1px";n.style.top="1px";n.innerHTML=m;n.style.display="";1==h?(d=getScrollLeft()+d,g=getScrollTop()+g):2==h?(d=getScrollLeft()+(getWindowWidth()-n.clientWidth)/2,g=getScrollTop()+(getWindowHeight()-n.clientHeight)/2):(d=3==h?document.body.offsetWidth-n.clientWidth-5:getScrollLeft()+(getWindowWidth()-
n.clientWidth)/2,g=getScrollTop()+g);d=parseInt(d);g=parseInt(g);n.style.border="1px solid #000000";n.style.padding=a+"px";n.style.left=d+"px";n.style.top=g+"px";messagetimer&&clearTimeout(messagetimer);messagetimer=setTimeout(hide_message,c)}function hide_message(){for(var m=1;4>=m;m++){var d="layer_message";1<m&&(d="layer_message"+m);if(d=document.getElementById(d))d.style.display="none"}}
var gformats2=[["svg","image/svg+xml"],["pdf","application/pdf"],["gif","image/gif"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["png","image/png"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["htm","text/html"],["html","text/html"],["txt","text/plain"],["text","text/plain"],["odt","application/vnd.oasis.opendocument.text"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],
["odp","application/vnd.oasis.opendocument.presentation"],["xls","application/vnd.ms-excel"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["csv","text/csv"],["tsv","text/tab-separated-values"]];function getmimetype2(m){m=(m||"").split(".");m=m[m.length-1].toLowerCase();for(var d=0;d<=gformats2.length-1;d++)if(gformats2[d][0]==m)return gformats2[d][1]};
