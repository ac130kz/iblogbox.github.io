var gdocumentType,ghyperlinkTooltipView,clicktimer,gstyleParseUtils,godfcontainer,historylist=[];window.addEventListener&&window.addEventListener("hashchange",function(){var l=window.location.hash;if(l)for(var c=0;c<=historylist.length-1;c++)if(historylist[c].url==l){clearTimeout(clicktimer);clicktimer=setTimeout(function(){try{historylist[c].node.scrollIntoView(!0)}catch(g){}},100);break}});var g_errmsg=function(l){proc_g_errmsg&&proc_g_errmsg(l)},webodf_version="0.5.4";function Runtime(){}
Runtime.prototype.getVariable=function(l){};Runtime.prototype.toJson=function(l){};Runtime.prototype.fromJson=function(l){};Runtime.prototype.byteArrayFromString=function(l,c){};Runtime.prototype.byteArrayToString=function(l,c){};Runtime.prototype.read=function(l,c,g,a){};Runtime.prototype.readFile=function(l,c,g){};Runtime.prototype.readFileSync=function(l,c){};Runtime.prototype.loadXML=function(l,c){};Runtime.prototype.writeFile=function(l,c,g){};Runtime.prototype.deleteFile=function(l,c){};
Runtime.prototype.log=function(l,c){};Runtime.prototype.setTimeout=function(l,c){};Runtime.prototype.clearTimeout=function(l){};Runtime.prototype.libraryPaths=function(){};Runtime.prototype.currentDirectory=function(){};Runtime.prototype.setCurrentDirectory=function(l){};Runtime.prototype.type=function(){};Runtime.prototype.getDOMImplementation=function(){};Runtime.prototype.parseXML=function(l){};Runtime.prototype.exit=function(l){};Runtime.prototype.getWindow=function(){};
Runtime.prototype.requestAnimationFrame=function(l){};Runtime.prototype.cancelAnimationFrame=function(l){};Runtime.prototype.assert=function(l,c){};var IS_COMPILED_CODE=!0;
Runtime.byteArrayToString=function(l,c){function g(a){var e="",f,c=a.length;for(f=0;f<c;f+=1)e+=String.fromCharCode(a[f]&255);return e}function a(a){var e="",f,c=a.length,h=[],q,b,d,m;for(f=0;f<c;f+=1)q=a[f],128>q?h.push(q):(f+=1,b=a[f],194<=q&&224>q?h.push((q&31)<<6|b&63):(f+=1,d=a[f],224<=q&&240>q?h.push((q&15)<<12|(b&63)<<6|d&63):(f+=1,m=a[f],240<=q&&245>q&&(q=(q&7)<<18|(b&63)<<12|(d&63)<<6|m&63,q-=65536,h.push((q>>10)+55296,(q&1023)+56320))))),1E3<=h.length&&(e+=String.fromCharCode.apply(null,
h),h.length=0);return e+String.fromCharCode.apply(null,h)}var f;"utf8"===c?f=a(l):("binary"!==c&&this.log("Unsupported encoding: "+c),f=g(l));return f};Runtime.getVariable=function(l){try{return eval(l)}catch(c){}};Runtime.toJson=function(l){return JSON.stringify(l)};Runtime.fromJson=function(l){return JSON.parse(l)};Runtime.getFunctionName=function(l){return void 0===l.name?(l=/function\s+(\w+)/.exec(l))&&l[1]:l.name};
Runtime.assert=function(l,c){if(!l)throw this.log("alert","ASSERTION FAILED:\n"+c),Error(c);};
function BrowserRuntime(l){function c(h){var a=h.length,b,d,m=0;for(b=0;b<a;b+=1)d=h.charCodeAt(b),m+=1+(128<d)+(2048<d),55040<d&&57344>d&&(m+=1,b+=1);return m}function g(h,a,b){var d=h.length,m,r;a=new Uint8Array(new ArrayBuffer(a));b?(a[0]=239,a[1]=187,a[2]=191,r=3):r=0;for(b=0;b<d;b+=1)m=h.charCodeAt(b),128>m?(a[r]=m,r+=1):2048>m?(a[r]=192|m>>>6,a[r+1]=128|m&63,r+=2):55040>=m||57344<=m?(a[r]=224|m>>>12&15,a[r+1]=128|m>>>6&63,a[r+2]=128|m&63,r+=3):(b+=1,m=(m-55296<<10|h.charCodeAt(b)-56320)+65536,
a[r]=240|m>>>18&7,a[r+1]=128|m>>>12&63,a[r+2]=128|m>>>6&63,a[r+3]=128|m&63,r+=4);return a}function a(h){var a=h.length,b=new Uint8Array(new ArrayBuffer(a)),d;for(d=0;d<a;d+=1)b[d]=h.charCodeAt(d)&255;return b}function f(h,a){var b,d,m;void 0!==a?m=h:a=h;l?(d=l.ownerDocument,m&&(b=d.createElement("span"),b.className=m,b.appendChild(d.createTextNode(m)),l.appendChild(b),l.appendChild(d.createTextNode(" "))),b=d.createElement("span"),0<a.length&&"<"===a[0]?b.innerHTML=a:b.appendChild(d.createTextNode(a)),
l.appendChild(b),l.appendChild(d.createElement("br"))):console&&console.log(a);n.enableAlerts&&"alert"===m&&alert(a)}function k(h,e,b){if(0!==b.status||b.responseText)if(200===b.status||0===b.status){if(b.response&&"string"!==typeof b.response)"binary"===e?(b=b.response,b=new Uint8Array(b)):b=String(b.response);else if("binary"===e)if(null!==b.responseBody&&"undefined"!==String(typeof VBArray)){b=(new VBArray(b.responseBody)).toArray();var d=b.length;e=new Uint8Array(new ArrayBuffer(d));for(h=0;h<
d;h+=1)e[h]=b[h];b=e}else{(h=b.getResponseHeader("Content-Length"))&&(h=parseInt(h,10));if(h&&h!==b.responseText.length)a:{d=b.responseText;e=!1;var m=c(d);if("number"===typeof h){if(h!==m&&h!==m+3){d=void 0;break a}e=m+3===h;m=h}d=g(d,m,e)}void 0===d&&(d=a(b.responseText));b=d}else b=b.responseText;b={err:null,data:b}}else b={err:b.responseText||b.statusText,data:null};else b={err:"File "+h+" is empty.",data:null};return b}function e(a,e,b){var d=new XMLHttpRequest;d.open("GET",a,b);d.overrideMimeType&&
("binary"!==e?d.overrideMimeType("text/plain; charset="+e):d.overrideMimeType("text/plain; charset=x-user-defined"));return d}function p(a,f,b){function d(m){var b=document.getElementById("canvas");b&&(b.innerHTML='<div style="font-size:14px;padding:5px">'+m+'<span id="inner_progress"></span></div>')}var m=e(a,f,!0);m.onreadystatechange=function(){var r;4===m.readyState&&(d("Loading the file... Please wait..."),setTimeout(function(){r=k(a,f,m);b(r.err,r.data)},10))};if(a)if(0==a.toLowerCase().indexOf("blob"))d("Loading the file... Please wait...");
else{d("Downloading the file... Please wait...");var r=(new Date).getTime();m.onprogress=function(m){if(r){var b=new Date;if(300>b.getTime()-r)return;r=b.getTime()}b=m.totalSize||m.total||0;0==b&&"undefined"!==typeof g_docsize&&(b=g_docsize||0);1.8446744073709552E19<=b&&(b=0);m=m.position||m.loaded||0;var d=document.getElementById("inner_progress");d&&(d.innerHTML=" ("+number_format(m)+"/"+number_format(b)+")")}}try{m.send(null)}catch(c){d("Loading..."),b(c.message,null)}}var n=this;this.byteArrayFromString=
function(h,e){var b;"utf8"===e?b=g(h,c(h),!1):("binary"!==e&&n.log("unknown encoding: "+e),b=a(h));return b};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.readFile=p;this.read=function(a,e,b,d){p(a,"binary",function(m,r){var a=null;if(r){if("string"===typeof r)throw"This should not happen.";a=r.subarray(e,e+b)}d(m,a)})};this.readFileSync=function(a,f){var b=e(a,f,!1),d;try{b.send(null);d=k(a,f,b);
if(d.err)throw d.err;if(null===d.data)throw"No data read from "+a+".";}catch(m){throw m;}return d.data};this.writeFile=function(a,e,b){var d=new XMLHttpRequest,m;d.open("PUT",a,!0);d.onreadystatechange=function(){4===d.readyState&&(0!==d.status||d.responseText?200<=d.status&&300>d.status||0===d.status?b(null):b("Status "+String(d.status)+": "+d.responseText||d.statusText):b("File "+a+" is empty."))};m=e.buffer&&!d.sendAsBinary?e.buffer:n.byteArrayToString(e,"binary");try{d.sendAsBinary?d.sendAsBinary(m):
d.send(m)}catch(r){n.log("HUH? "+r+" "+e),b(r.message)}};this.deleteFile=function(a,e){var b=new XMLHttpRequest;b.open("DELETE",a,!0);b.onreadystatechange=function(){4===b.readyState&&(200>b.status&&300<=b.status?e(b.responseText):e(null))};b.send(null)};this.loadXML=function(a,e){var b=new XMLHttpRequest;b.open("GET",a,!0);b.overrideMimeType&&b.overrideMimeType("text/xml");b.onreadystatechange=function(){4===b.readyState&&(0!==b.status||b.responseText?200===b.status||0===b.status?e(null,b.responseXML):
e(b.responseText,null):e("File "+a+" is empty.",null))};try{b.send(null)}catch(d){e(d.message,null)}};this.log=f;this.enableAlerts=!0;this.assert=Runtime.assert;this.setTimeout=function(a,e){return setTimeout(function(){a()},e)};this.clearTimeout=function(a){clearTimeout(a)};this.libraryPaths=function(){return["lib"]};this.setCurrentDirectory=function(){};this.currentDirectory=function(){return""};this.type=function(){return"BrowserRuntime"};this.getDOMImplementation=function(){return window.document.implementation};
this.parseXML=function(a){var e=new DOMParser;a&&(a=a.trim());return e.parseFromString(a,"text/xml")};this.exit=function(a){f("Calling exit with code "+String(a)+", but exit() is not implemented.")};this.getWindow=function(){return window};this.requestAnimationFrame=function(a){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,b=0;if(e)e.bind(window),b=e(a);else return setTimeout(a,15);return b};this.cancelAnimationFrame=
function(a){var e=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame;e?(e.bind(window),e(a)):clearTimeout(a)}}
function NodeJSRuntime(){function l(a){var e=a.length,f,b=new Uint8Array(new ArrayBuffer(e));for(f=0;f<e;f+=1)b[f]=a[f];return b}function c(e,h,c){function b(b,m){if(b)return c(b,null);if(!m)return c("No data for "+e+".",null);if("string"===typeof m)return c(b,m);c(b,l(m))}e=f.resolve(k,e);"binary"!==h?a.readFile(e,h,b):a.readFile(e,null,b)}var g=this,a=require("fs"),f=require("path"),k="",e,p;this.byteArrayFromString=function(a,e){var f=new Buffer(a,e),b,d=f.length,m=new Uint8Array(new ArrayBuffer(d));
for(b=0;b<d;b+=1)m[b]=f[b];return m};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.readFile=c;this.loadXML=function(a,e){c(a,"utf-8",function(f,b){if(f)return e(f,null);if(!b)return e("No data for "+a+".",null);e(null,g.parseXML(b))})};this.writeFile=function(e,h,c){h=new Buffer(h);e=f.resolve(k,e);a.writeFile(e,h,"binary",function(b){c(b||null)})};this.deleteFile=function(e,h){e=f.resolve(k,e);
a.unlink(e,h)};this.read=function(e,h,c,b){e=f.resolve(k,e);a.open(e,"r+",666,function(d,m){if(d)b(d,null);else{var r=new Buffer(c);a.read(m,r,0,c,h,function(d){a.close(m);b(d,l(r))})}})};this.readFileSync=function(e,h){var f;f=a.readFileSync(e,"binary"===h?null:h);if(null===f)throw"File "+e+" could not be read.";"binary"===h&&(f=l(f));return f};this.log=function(a,e){var f;void 0!==e?f=a:e=a;"alert"===f&&process.stderr.write("\n!!!!! ALERT !!!!!\n");process.stderr.write(e+"\n");"alert"===f&&process.stderr.write("!!!!! ALERT !!!!!\n")};
this.assert=Runtime.assert;this.setTimeout=function(a,e){return setTimeout(function(){a()},e)};this.clearTimeout=function(a){clearTimeout(a)};this.libraryPaths=function(){return[__dirname]};this.setCurrentDirectory=function(a){k=a};this.currentDirectory=function(){return k};this.type=function(){return"NodeJSRuntime"};this.getDOMImplementation=function(){return p};this.parseXML=function(a){a&&(a=a.trim());return e.parseFromString(a,"text/xml")};this.exit=process.exit;this.getWindow=function(){return null};
this.requestAnimationFrame=function(a){return setTimeout(a,15)};this.cancelAnimationFrame=function(a){clearTimeout(a)};e=new (require("xmldom").DOMParser);p=g.parseXML("<a/>").implementation}
function RhinoRuntime(){var l=this,c={},g=c.javax.xml.parsers.DocumentBuilderFactory.newInstance(),a,f,k="";g.setValidating(!1);g.setNamespaceAware(!0);g.setExpandEntityReferences(!1);g.setSchema(null);f=c.org.xml.sax.EntityResolver({resolveEntity:function(a,f){var k=new c.java.io.FileReader(f);return new c.org.xml.sax.InputSource(k)}});a=g.newDocumentBuilder();a.setEntityResolver(f);this.byteArrayFromString=function(a,f){var c,h=a.length,k=new Uint8Array(new ArrayBuffer(h));for(c=0;c<h;c+=1)k[c]=
a.charCodeAt(c)&255;return k};this.byteArrayToString=Runtime.byteArrayToString;this.getVariable=Runtime.getVariable;this.fromJson=Runtime.fromJson;this.toJson=Runtime.toJson;this.loadXML=function(e,f){var k=new c.java.io.File(e),h=null;try{h=a.parse(k)}catch(g){return print(g),f(g,null)}f(null,h)};this.readFile=function(a,f,g){k&&(a=k+"/"+a);var h=new c.java.io.File(a),q="binary"===f?"latin1":f;h.isFile()?((a=readFile(a,q))&&"binary"===f&&(a=l.byteArrayFromString(a,"binary")),g(null,a)):g(a+" is not a file.",
null)};this.writeFile=function(a,f,g){k&&(a=k+"/"+a);a=new c.java.io.FileOutputStream(a);var h,q=f.length;for(h=0;h<q;h+=1)a.write(f[h]);a.close();g(null)};this.deleteFile=function(a,f){k&&(a=k+"/"+a);var g=new c.java.io.File(a),h=a+Math.random(),h=new c.java.io.File(h);g.rename(h)?(h.deleteOnExit(),f(null)):f("Could not delete "+a)};this.read=function(a,f,g,h){k&&(a=k+"/"+a);var q;q=a;var b="binary";(new c.java.io.File(q)).isFile()?("binary"===b&&(b="latin1"),q=readFile(q,b)):q=null;q?h(null,this.byteArrayFromString(q.substring(f,
f+g),"binary")):h("Cannot read "+a,null)};this.readFileSync=function(a,f){if(!f)return"";var c=readFile(a,f);if(null===c)throw"File could not be read.";return c};this.log=function(a,f){var c;void 0!==f?c=a:f=a;"alert"===c&&print("\n!!!!! ALERT !!!!!");print(f);"alert"===c&&print("!!!!! ALERT !!!!!")};this.assert=Runtime.assert;this.setTimeout=function(a){a();return 0};this.clearTimeout=function(){};this.libraryPaths=function(){return["lib"]};this.setCurrentDirectory=function(a){k=a};this.currentDirectory=
function(){return k};this.type=function(){return"RhinoRuntime"};this.getDOMImplementation=function(){return a.getDOMImplementation()};this.parseXML=function(e){e=new c.java.io.StringReader(e);e=new c.org.xml.sax.InputSource(e);return a.parse(e)};this.exit=quit;this.getWindow=function(){return null};this.requestAnimationFrame=function(a){a();return 0};this.cancelAnimationFrame=function(){}}
Runtime.create=function(){return"undefined"!==String(typeof window)?new BrowserRuntime(window.document.getElementById("logoutput")):"undefined"!==String(typeof require)?new NodeJSRuntime:new RhinoRuntime};var runtime=Runtime.create(),core={},gui={},xmldom={},odf={},ops={},webodf={};(function(){webodf.Version="undefined"!==String(typeof webodf_version)?webodf_version:"From Source"})();
(function(){function l(a,e,f){var c=a+"/manifest.json",b,d;runtime.log("Loading manifest: "+c);try{b=runtime.readFileSync(c,"utf-8")}catch(m){if(f)runtime.log("No loadable manifest found.");else throw console.log(String(m)),m;return}f=JSON.parse(b);for(d in f)f.hasOwnProperty(d)&&(e[d]={dir:a,deps:f[d]})}function c(a,e,f){function c(r){if(!m[r]&&!f(r)){if(d[r])throw"Circular dependency detected for "+r+".";d[r]=!0;if(!e[r])throw"Missing dependency information for class "+r+".";var a=e[r],k=a.deps,
g,p=k.length;for(g=0;g<p;g+=1)c(k[g]);d[r]=!1;m[r]=!0;b.push(a.dir+"/"+r.replace(".","/")+".js")}}var b=[],d={},m={};a.forEach(c);return b}function g(a,e){return e+("\n//# sourceURL="+a)}function a(a){var e,f;for(e=0;e<a.length;e+=1)f=runtime.readFileSync(a[e],"utf-8"),f=g(a[e],f),eval(f)}function f(a){a=a.split(".");var f,c=e,k=a.length;for(f=0;f<k;f+=1){if(!c.hasOwnProperty(a[f]))return!1;c=c[a[f]]}return!0}var k,e={core:core,gui:gui,xmldom:xmldom,odf:odf,ops:ops};runtime.loadClasses=function(e,
g){if(IS_COMPILED_CODE||0===e.length)return g&&g();var h;if(!(h=k)){h=[];var q=runtime.libraryPaths(),b;runtime.currentDirectory()&&-1===q.indexOf(runtime.currentDirectory())&&l(runtime.currentDirectory(),h,!0);for(b=0;b<q.length;b+=1)l(q[b],h)}k=h;e=c(e,k,f);if(0===e.length)return g&&g();if("BrowserRuntime"===runtime.type()&&g){h=e;q=document.currentScript||document.documentElement.lastChild;b=document.createDocumentFragment();var d,m;for(m=0;m<h.length;m+=1)d=document.createElement("script"),d.type=
"text/javascript",d.charset="utf-8",d.async=!1,d.setAttribute("src",h[m]),b.appendChild(d);g&&(d.onload=g);q.parentNode.insertBefore(b,q)}else a(e),g&&g()};runtime.loadClass=function(a,e){runtime.loadClasses([a],e)}})();(function(){var l=function(c){return c};runtime.getTranslator=function(){return l};runtime.setTranslator=function(c){l=c};runtime.tr=function(c){var g=l(c);return g&&"string"===String(typeof g)?g:c}})();
(function(l){function c(c){if(c.length){var a=c[0];runtime.readFile(a,"utf8",function(f,k){function e(){var a;(a=eval(l))&&runtime.exit(a)}var p="",p=a.lastIndexOf("/"),l=k,p=-1!==p?a.substring(0,p):".";runtime.setCurrentDirectory(p);f?(runtime.log(f),runtime.exit(1)):null===l?(runtime.log("No code found for "+a),runtime.exit(1)):e.apply(null,c)})}}l=l?Array.prototype.slice.call(l):[];"NodeJSRuntime"===runtime.type()?c(process.argv.slice(2)):"RhinoRuntime"===runtime.type()?c(l):c(l.slice(1))})("undefined"!==
String(typeof arguments)&&arguments);(function(){core.Async=function(){return{forEach:function(l,c,g){function a(a){e!==k&&(a?(e=k,g(a)):(e+=1,e===k&&g(null)))}var f,k=l.length,e=0;for(f=0;f<k;f+=1)c(l[f],a)},destroyAll:function(l,c){function g(a,f){if(f)c(f);else if(a<l.length)l[a](function(f){g(a+1,f)});else c()}g(0,void 0)}}}()})();
function makeBase64(){function l(b){var m,d=b.length,r=new Uint8Array(new ArrayBuffer(d));for(m=0;m<d;m+=1)r[m]=b.charCodeAt(m)&255;return r}function c(b){var m,d="",r,a=b.length-2;for(r=0;r<a;r+=3)m=b[r]<<16|b[r+1]<<8|b[r+2],d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m>>>18],d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m>>>12&63],d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m>>>6&63],d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m&
63];r===a+1?(m=b[r]<<4,d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m>>>6],d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m&63],d+="=="):r===a&&(m=b[r]<<10|b[r+1]<<2,d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m>>>12],d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m>>>6&63],d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m&63],d+="=");return d}function g(m){m=m.replace(/[^A-Za-z0-9+\/]+/g,
"");var b=m.length,d=new Uint8Array(new ArrayBuffer(3*b)),a=m.length%4,e=0,f,t;for(f=0;f<b;f+=4)t=(r[m.charAt(f)]||0)<<18|(r[m.charAt(f+1)]||0)<<12|(r[m.charAt(f+2)]||0)<<6|(r[m.charAt(f+3)]||0),d[e]=t>>16,d[e+1]=t>>8&255,d[e+2]=t&255,e+=3;b=3*b-[0,0,2,1][a];return d.subarray(0,b)}function a(m){var b,d,r=m.length,a=0,e=new Uint8Array(new ArrayBuffer(3*r));for(b=0;b<r;b+=1)d=m[b],128>d?e[a++]=d:(2048>d?e[a++]=192|d>>>6:(e[a++]=224|d>>>12&15,e[a++]=128|d>>>6&63),e[a++]=128|d&63);return e.subarray(0,
a)}function f(m){var b,d,r,a,e=m.length,t=new Uint8Array(new ArrayBuffer(e)),f=0;for(b=0;b<e;b+=1)d=m[b],128>d?t[f++]=d:(b+=1,r=m[b],224>d?t[f++]=(d&31)<<6|r&63:(b+=1,a=m[b],t[f++]=(d&15)<<12|(r&63)<<6|a&63));return t.subarray(0,f)}function k(b){return c(l(b))}function e(b){return String.fromCharCode.apply(String,g(b))}function p(b){return f(l(b))}function n(b){b=f(b);for(var m="",d=0;d<b.length;)m+=String.fromCharCode.apply(String,b.subarray(d,d+45E3)),d+=45E3;return m}function h(b,m,d){var r,a,
e,t="";for(e=m;e<d;e+=1)m=b.charCodeAt(e)&255,128>m?t+=String.fromCharCode(m):(e+=1,r=b.charCodeAt(e)&255,224>m?t+=String.fromCharCode((m&31)<<6|r&63):(e+=1,a=b.charCodeAt(e)&255,t+=String.fromCharCode((m&15)<<12|(r&63)<<6|a&63)));return t}function q(b,m){function d(){var e=a+1E5;e>b.length&&(e=b.length);r+=h(b,a,e);a=e;e=a===b.length;m(r,e)&&!e&&runtime.setTimeout(d,0)}var r="",a=0;1E5>b.length?m(h(b,0,b.length),!0):("string"!==typeof b&&(b=b.slice()),d())}function b(b){return a(l(b))}function d(b){return String.fromCharCode.apply(String,
a(b))}function m(b){return String.fromCharCode.apply(String,a(l(b)))}var r=function(b){var m={},d,r;d=0;for(r=b.length;d<r;d+=1)m[b.charAt(d)]=d;return m}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),A,y,v=runtime.getWindow(),s,B;v&&v.btoa?(s=v.btoa,A=function(b){return s(m(b))}):(s=k,A=function(m){return c(b(m))});v&&v.atob?(B=v.atob,y=function(b){b=B(b);return h(b,0,b.length)}):(B=e,y=function(b){return n(g(b))});core.Base64=function(){this.convertByteArrayToBase64=this.convertUTF8ArrayToBase64=
c;this.convertBase64ToByteArray=this.convertBase64ToUTF8Array=g;this.convertUTF16ArrayToByteArray=this.convertUTF16ArrayToUTF8Array=a;this.convertByteArrayToUTF16Array=this.convertUTF8ArrayToUTF16Array=f;this.convertUTF8StringToBase64=k;this.convertBase64ToUTF8String=e;this.convertUTF8StringToUTF16Array=p;this.convertByteArrayToUTF16String=this.convertUTF8ArrayToUTF16String=n;this.convertUTF8StringToUTF16String=q;this.convertUTF16StringToByteArray=this.convertUTF16StringToUTF8Array=b;this.convertUTF16ArrayToUTF8String=
d;this.convertUTF16StringToUTF8String=m;this.convertUTF16StringToBase64=A;this.convertBase64ToUTF16String=y;this.fromBase64=e;this.toBase64=k;this.atob=B;this.btoa=s;this.utob=m;this.btou=q;this.encode=A;this.encodeURI=function(b){return A(b).replace(/[+\/]/g,function(b){return"+"===b?"-":"_"}).replace(/\\=+$/,"")};this.decode=function(b){return y(b.replace(/[\-_]/g,function(b){return"-"===b?"+":"/"}))};return this};return core.Base64}core.Base64=makeBase64();
core.ByteArray=function(l){this.pos=0;this.data=l;this.readUInt32LE=function(){this.pos+=4;var c=this.data,g=this.pos;return c[--g]<<24|c[--g]<<16|c[--g]<<8|c[--g]};this.readUInt16LE=function(){this.pos+=2;var c=this.data,g=this.pos;return c[--g]<<8|c[--g]}};
core.ByteArrayWriter=function(l){function c(e){e>f-a&&(f=Math.max(2*f,a+e),e=new Uint8Array(new ArrayBuffer(f)),e.set(k),k=e)}var g=this,a=0,f=1024,k=new Uint8Array(new ArrayBuffer(f));this.appendByteArrayWriter=function(a){g.appendByteArray(a.getByteArray())};this.appendByteArray=function(e){var f=e.length;c(f);k.set(e,a);a+=f};this.appendArray=function(e){var f=e.length;c(f);k.set(e,a);a+=f};this.appendUInt16LE=function(a){g.appendArray([a&255,a>>8&255])};this.appendUInt32LE=function(a){g.appendArray([a&
255,a>>8&255,a>>16&255,a>>24&255])};this.appendString=function(a){g.appendByteArray(runtime.byteArrayFromString(a,l))};this.getLength=function(){return a};this.getByteArray=function(){var e=new Uint8Array(new ArrayBuffer(a));e.set(k.subarray(0,a));return e}};
core.CSSUnits=function(){var l=this,c={"in":1,cm:2.54,mm:25.4,pt:72,pc:12,px:96};this.convert=function(g,a,f){return g*c[f]/c[a]};this.convertMeasure=function(c,a){var f,k;c&&a&&(f=parseFloat(c),k=c.replace(f.toString(),""),f=l.convert(f,k,a));return f};this.getUnits=function(c){return c.substr(c.length-2,c.length)}};
(function(){function l(){var a,f,c,e,p,l,h,q,b;void 0===g&&(f=(a=runtime.getWindow())&&a.document,l=f.documentElement,h=f.body,g={rangeBCRIgnoresElementBCR:!1,unscaledRangeClientRects:!1,elementBCRIgnoresBodyScroll:!1},f&&(e=f.createElement("div"),e.style.position="absolute",e.style.left="-99999px",e.style.transform="scale(2)",e.style["-webkit-transform"]="scale(2)",p=f.createElement("div"),e.appendChild(p),h.appendChild(e),a=f.createRange(),a.selectNode(p),g.rangeBCRIgnoresElementBCR=0===a.getClientRects().length,
p.appendChild(f.createTextNode("Rect transform test")),f=p.getBoundingClientRect(),c=a.getBoundingClientRect(),g.unscaledRangeClientRects=2<Math.abs(f.height-c.height),e.style.transform="",e.style["-webkit-transform"]="",f=l.style.overflow,c=h.style.overflow,q=h.style.height,b=h.scrollTop,l.style.overflow="visible",h.style.overflow="visible",h.style.height="200%",h.scrollTop=h.scrollHeight,g.elementBCRIgnoresBodyScroll=a.getBoundingClientRect().top!==p.getBoundingClientRect().top,h.scrollTop=b,h.style.height=
q,h.style.overflow=c,l.style.overflow=f,a.detach(),h.removeChild(e),a=Object.keys(g).map(function(b){return b+":"+String(g[b])}).join(", "),runtime.log("Detected browser quirks - "+a)));return g}function c(a,f,c){for(a=a?a.firstElementChild:null;a;){if(a.localName===c&&a.namespaceURI===f)return a;a=a.nextElementSibling}return null}var g;core.DomUtilsImpl=function(){function a(b,d){for(var a=0,e;b.parentNode!==d;)runtime.assert(null!==b.parentNode,"parent is null"),b=b.parentNode;for(e=d.firstChild;e!==
b;)a+=1,e=e.nextSibling;return a}function f(b,d){return 0>=b.compareBoundaryPoints(Range.START_TO_START,d)&&0<=b.compareBoundaryPoints(Range.END_TO_END,d)}function k(b,d){return 0>=b.compareBoundaryPoints(Range.END_TO_START,d)&&0<=b.compareBoundaryPoints(Range.START_TO_END,d)}function e(b,d){var a=null;b.nodeType===Node.TEXT_NODE&&(0===b.length?(b.parentNode.removeChild(b),d.nodeType===Node.TEXT_NODE&&(a=d)):(d.nodeType===Node.TEXT_NODE&&(b.appendData(d.data),d.parentNode.removeChild(d)),a=b));return a}
function g(b){for(var d=b.parentNode;b.firstChild;)d.insertBefore(b.firstChild,b);d.removeChild(b);return d}function n(b,d){for(var a=b.parentNode,e=b.firstChild,f;e;)f=e.nextSibling,n(e,d),e=f;a&&d(b)&&g(b);return a}function h(b,d){return b===d||Boolean(b.compareDocumentPosition(d)&Node.DOCUMENT_POSITION_CONTAINED_BY)}function q(b,d){return l().unscaledRangeClientRects?b:b/d}function b(d,a,e){Object.keys(a).forEach(function(f){var c=f.split(":"),h=c[1],k=e(c[0]),c=a[f],g=typeof c;"object"===g?Object.keys(c).length&&
(f=k?d.getElementsByTagNameNS(k,h)[0]||d.ownerDocument.createElementNS(k,f):d.getElementsByTagName(h)[0]||d.ownerDocument.createElement(f),d.appendChild(f),b(f,c,e)):k&&(runtime.assert("number"===g||"string"===g,"attempting to map unsupported type '"+g+"' (key: "+f+")"),d.setAttributeNS(k,f,String(c)))})}var d=null;this.splitBoundaries=function(b){var d,e=[],f,c,h;if(b.startContainer.nodeType===Node.TEXT_NODE||b.endContainer.nodeType===Node.TEXT_NODE){f=b.endContainer;c=b.endContainer.nodeType!==
Node.TEXT_NODE?b.endOffset===b.endContainer.childNodes.length:!1;h=b.endOffset;d=b.endContainer;if(h<d.childNodes.length)for(d=d.childNodes.item(h),h=0;d.firstChild;)d=d.firstChild;else for(;d.lastChild;)d=d.lastChild,h=d.nodeType===Node.TEXT_NODE?d.textContent.length:d.childNodes.length;d===f&&(f=null);b.setEnd(d,h);h=b.endContainer;0!==b.endOffset&&h.nodeType===Node.TEXT_NODE&&(d=h,b.endOffset!==d.length&&(e.push(d.splitText(b.endOffset)),e.push(d)));h=b.startContainer;0!==b.startOffset&&h.nodeType===
Node.TEXT_NODE&&(d=h,b.startOffset!==d.length&&(h=d.splitText(b.startOffset),e.push(d),e.push(h),b.setStart(h,0)));if(null!==f){for(h=b.endContainer;h.parentNode&&h.parentNode!==f;)h=h.parentNode;c=c?f.childNodes.length:a(h,f);b.setEnd(f,c)}}return e};this.containsRange=f;this.rangesIntersect=k;this.rangeIntersection=function(b,d){var a;k(b,d)&&(a=b.cloneRange(),-1===b.compareBoundaryPoints(Range.START_TO_START,d)&&a.setStart(d.startContainer,d.startOffset),1===b.compareBoundaryPoints(Range.END_TO_END,
d)&&a.setEnd(d.endContainer,d.endOffset));return a};this.getNodesInRange=function(b,d,a){var e=[],f=b.commonAncestorContainer,f=f.nodeType===Node.TEXT_NODE?f.parentNode:f;a=b.startContainer.ownerDocument.createTreeWalker(f,a,d,!1);var c,h;b.endContainer.childNodes[b.endOffset-1]?(c=b.endContainer.childNodes[b.endOffset-1],h=Node.DOCUMENT_POSITION_PRECEDING|Node.DOCUMENT_POSITION_CONTAINED_BY):(c=b.endContainer,h=Node.DOCUMENT_POSITION_PRECEDING);if(b.startContainer.childNodes[b.startOffset])b=b.startContainer.childNodes[b.startOffset],
a.currentNode=b;else{var k=b.startContainer;b.startOffset===(k.nodeType===Node.TEXT_NODE?k.length:k.childNodes.length)?(b=b.startContainer,a.currentNode=b,a.lastChild(),b=a.nextNode()):(b=b.startContainer,a.currentNode=b)}if(b){b=a.currentNode;if(b!==f)for(b=b.parentNode;b&&b!==f;)d(b)===NodeFilter.FILTER_REJECT&&(a.currentNode=b),b=b.parentNode;b=a.currentNode;switch(d(b)){case NodeFilter.FILTER_REJECT:for(b=a.nextSibling();!b&&a.parentNode();)b=a.nextSibling();break;case NodeFilter.FILTER_SKIP:b=
a.nextNode()}for(;b;){d=c.compareDocumentPosition(b);if(0!==d&&0===(d&h))break;e.push(b);b=a.nextNode()}}return e};this.normalizeTextNodes=function(b){b&&b.nextSibling&&(b=e(b,b.nextSibling));b&&b.previousSibling&&e(b.previousSibling,b)};this.rangeContainsNode=function(b,d){var a=d.ownerDocument.createRange(),e=d.ownerDocument.createRange(),c;a.setStart(b.startContainer,b.startOffset);a.setEnd(b.endContainer,b.endOffset);e.selectNodeContents(d);c=f(a,e);a.detach();e.detach();return c};this.mergeIntoParent=
g;this.removeUnwantedNodes=n;this.getElementsByTagNameNS=function(b,d,a){var e=[];b=b.getElementsByTagNameNS(d,a);e.length=a=b.length;for(d=0;d<a;d+=1)e[d]=b.item(d);return e};this.getElementsByTagName=function(b,d){var a=[],e,f,c;e=b.getElementsByTagName(d);a.length=c=e.length;for(f=0;f<c;f+=1)a[f]=e.item(f);return a};this.containsNode=function(b,d){return b===d||b.contains(d)};this.comparePoints=function(b,d,e,f){if(b===e)return f-d;var c=b.compareDocumentPosition(e);2===c?c=-1:4===c?c=1:10===c?
(d=a(b,e),c=d<f?1:-1):(f=a(e,b),c=f<d?-1:1);return c};this.adaptRangeDifferenceToZoomLevel=q;this.translateRect=function(b,d,a){return{top:q(b.top-d.top,a),left:q(b.left-d.left,a),bottom:q(b.bottom-d.top,a),right:q(b.right-d.left,a),width:q(b.width,a),height:q(b.height,a)}};this.getBoundingClientRect=function(b){var a=b.ownerDocument,e=l(),f=a.body;if((!1===e.unscaledRangeClientRects||e.rangeBCRIgnoresElementBCR)&&b.nodeType===Node.ELEMENT_NODE)return b=b.getBoundingClientRect(),e.elementBCRIgnoresBodyScroll?
{left:b.left+f.scrollLeft,right:b.right+f.scrollLeft,top:b.top+f.scrollTop,bottom:b.bottom+f.scrollTop,width:b.width,height:b.height}:b;var c;d?c=d:d=c=a.createRange();e=c;e.selectNode(b);return e.getBoundingClientRect()};this.mapKeyValObjOntoNode=function(b,d,a){Object.keys(d).forEach(function(e){var f=e.split(":"),c=f[1],f=a(f[0]),h=d[e];f?(c=b.getElementsByTagNameNS(f,c)[0],c||(c=b.ownerDocument.createElementNS(f,e),b.appendChild(c)),c.textContent=h):runtime.log("Key ignored: "+e)})};this.removeKeyElementsFromNode=
function(b,d,a){d.forEach(function(d){var e=d.split(":"),r=e[1];(e=a(e[0]))?(r=b.getElementsByTagNameNS(e,r)[0])?r.parentNode.removeChild(r):runtime.log("Element for "+d+" not found."):runtime.log("Property Name ignored: "+d)})};this.getKeyValRepresentationOfNode=function(b,d){for(var a={},e=b.firstElementChild,f;e;){if(f=d(e.namespaceURI))a[f+":"+e.localName]=e.textContent;e=e.nextElementSibling}return a};this.mapObjOntoNode=b;this.cloneEvent=function(b){var d=Object.create(null);Object.keys(b.constructor.prototype).forEach(function(a){d[a]=
b[a]});null==d.clientX&&(d=Object.create(null),Object.keys(b).forEach(function(a){d[a]=b[a]}));d.prototype=b.constructor.prototype;return d};this.getDirectChild=c;(function(b){var d,a;a=runtime.getWindow();null!==a&&(d=a.navigator.appVersion.toLowerCase(),a=-1===d.indexOf("chrome")&&(-1!==d.indexOf("applewebkit")||-1!==d.indexOf("safari")),d=-1!==d.indexOf("msie")||-1!==d.indexOf("trident"),a||d)&&(b.containsNode=h)})(this)};core.DomUtils=new core.DomUtilsImpl})();
core.Cursor=function(l,c){function g(b){b.parentNode&&(p.push(b.previousSibling),p.push(b.nextSibling),b.parentNode.removeChild(b))}function a(b,d,a){if(d.nodeType===Node.TEXT_NODE){runtime.assert(Boolean(d),"putCursorIntoTextNode: invalid container");var e=d.parentNode;runtime.assert(Boolean(e),"putCursorIntoTextNode: container without parent");runtime.assert(0<=a&&a<=d.length,"putCursorIntoTextNode: offset is out of bounds");0===a?e.insertBefore(b,d):(a!==d.length&&d.splitText(a),e.insertBefore(b,
d.nextSibling))}else d.nodeType===Node.ELEMENT_NODE&&d.insertBefore(b,d.childNodes.item(a));p.push(b.previousSibling);p.push(b.nextSibling)}var f=l.createElementNS("urn:webodf:names:cursor","cursor"),k=l.createElementNS("urn:webodf:names:cursor","anchor"),e,p=[],n=l.createRange(),h,q=core.DomUtils;this.getNode=function(){return f};this.getAnchorNode=function(){return k.parentNode?k:f};this.getSelectedRange=function(){h?(n.setStartBefore(f),n.collapse(!0)):(n.setStartAfter(e?k:f),n.setEndBefore(e?
f:k));return n};this.setSelectedRange=function(b,d){n&&n!==b&&n.detach();n=b;e=!1!==d;(h=b.collapsed)?(g(k),g(f),a(f,b.startContainer,b.startOffset)):(g(k),g(f),a(e?f:k,b.endContainer,b.endOffset),a(e?k:f,b.startContainer,b.startOffset));p.forEach(q.normalizeTextNodes);p.length=0};this.hasForwardSelection=function(){return e};this.remove=function(){g(f);p.forEach(q.normalizeTextNodes);p.length=0};f.setAttributeNS("urn:webodf:names:cursor","memberId",c);k.setAttributeNS("urn:webodf:names:cursor","memberId",
c)};core.Destroyable=function(){};core.Destroyable.prototype.destroy=function(l){};core.EventSource=function(){};core.EventSource.prototype.subscribe=function(l,c){};core.EventSource.prototype.unsubscribe=function(l,c){};
core.EventNotifier=function(l){function c(a){runtime.assert(!g.hasOwnProperty(a),'Duplicated event ids: "'+a+'" registered more than once.');g[a]=[]}var g={};this.emit=function(a,f){var c,e;runtime.assert(g.hasOwnProperty(a),'unknown event fired "'+a+'"');e=g[a];for(c=0;c<e.length;c+=1)e[c](f)};this.subscribe=function(a,f){runtime.assert(g.hasOwnProperty(a),'tried to subscribe to unknown event "'+a+'"');g[a].push(f)};this.unsubscribe=function(a,f){var c;runtime.assert(g.hasOwnProperty(a),'tried to unsubscribe from unknown event "'+
a+'"');c=g[a].indexOf(f);runtime.assert(-1!==c,'tried to unsubscribe unknown callback from event "'+a+'"');-1!==c&&g[a].splice(c,1)};this.register=c;l&&l.forEach(c)};
core.ScheduledTask=function(l,c,g){function a(){e&&(g(k),e=!1)}function f(){a();l.apply(void 0,p);p=null}var k,e=!1,p=[],n=!1;this.trigger=function(){runtime.assert(!1===n,"Can't trigger destroyed ScheduledTask instance");p=Array.prototype.slice.call(arguments);e||(e=!0,k=c(f))};this.triggerImmediate=function(){runtime.assert(!1===n,"Can't trigger destroyed ScheduledTask instance");p=Array.prototype.slice.call(arguments);f()};this.processRequests=function(){e&&f()};this.cancel=a;this.restart=function(){runtime.assert(!1===
n,"Can't trigger destroyed ScheduledTask instance");a();e=!0;k=c(f)};this.destroy=function(e){a();n=!0;e()}};
(function(){var l;core.Task={};core.Task.SUPPRESS_MANUAL_PROCESSING=!1;core.Task.processTasks=function(){core.Task.SUPPRESS_MANUAL_PROCESSING||l.performRedraw()};core.Task.createRedrawTask=function(c){return new core.ScheduledTask(c,l.requestRedrawTask,l.cancelRedrawTask)};core.Task.createTimeoutTask=function(c,g){return new core.ScheduledTask(c,function(a){return runtime.setTimeout(a,g)},runtime.clearTimeout)};l=new function(){var c={};this.requestRedrawTask=function(g){var a=runtime.requestAnimationFrame(function(){g();
delete c[a]});c[a]=g;return a};this.performRedraw=function(){Object.keys(c).forEach(function(g){c[g]();runtime.cancelAnimationFrame(parseInt(g,10))});c={}};this.cancelRedrawTask=function(g){runtime.cancelAnimationFrame(g);delete c[g]}}})();
core.EventSubscriptions=function(){function l(a,f,c){a.subscribe(f,c);g.push({eventSource:a,eventid:f,callback:c})}function c(){var e=[];g.forEach(function(a){a.eventSource.unsubscribe(a.eventid,a.callback)});g.length=0;Object.keys(f).forEach(function(a){f[a].forEach(function(a){e.push(a.task.destroy)});delete f[a]});core.Async.destroyAll(e,function(){});a=new core.EventNotifier}var g=[],a=new core.EventNotifier,f={},k=0;this.addSubscription=l;this.addFrameSubscription=function(e,c,g){var h,q,b,d;
f.hasOwnProperty(c)||(f[c]=[]);b=f[c];for(d=0;d<b.length;d+=1)if(b[d].eventSource===e){h=b[d];break}h||(q="s"+k,k+=1,a.register(q),h={frameEventId:q,eventSource:e,task:core.Task.createRedrawTask(function(){a.emit(q,void 0)})},b.push(h),l(e,c,h.task.trigger));a.subscribe(h.frameEventId,g)};this.unsubscribeAll=c;this.destroy=function(a){c();a()}};core.LazyProperty=function(l){var c,g=!1;this.value=function(){g||(c=l(),g=!0);return c};this.reset=function(){g=!1}};
core.LoopWatchDog=function(l,c){var g=Date.now(),a=0;this.check=function(){var f;if(l&&(f=Date.now(),f-g>l))throw runtime.log("alert","watchdog timeout"),"timeout!";if(0<c&&(a+=1,a>c))throw runtime.log("alert","watchdog loop overflow"),"loop overflow";}};core.NodeFilterChain=function(l){var c=NodeFilter.FILTER_REJECT,g=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(a){var f;for(f=0;f<l.length;f+=1)if(l[f].acceptNode(a)===c)return c;return g}};
core.PositionIterator=function(l,c,g,a){function f(){this.acceptNode=function(b){return!b||b.nodeType===m&&0===b.length?y:A}}function k(b){this.acceptNode=function(d){return!d||d.nodeType===m&&0===d.length?y:b.acceptNode(d)}}function e(){var d=q.currentNode,a=d.nodeType;b=a===m?d.length-1:a===r?1:0}function p(){if(null===q.previousSibling()){if(!q.parentNode()||q.currentNode===l)return q.firstChild(),!1;b=0}else e();return!0}function n(){var a=q.currentNode,e;e=d(a);if(a!==l)for(a=a.parentNode;a&&
a!==l;)d(a)===y&&(q.currentNode=a,e=y),a=a.parentNode;e===y?(b=q.currentNode.nodeType===m?a.length:1,a=h.nextPosition()):a=e===A?!0:h.nextPosition();a&&runtime.assert(d(q.currentNode)===A,"moveToAcceptedNode did not result in walker being on an accepted node");return a}var h=this,q,b,d,m=Node.TEXT_NODE,r=Node.ELEMENT_NODE,A=NodeFilter.FILTER_ACCEPT,y=NodeFilter.FILTER_REJECT;this.nextPosition=function(){var d=q.currentNode,a=d.nodeType;if(d===l)return!1;if(0===b&&a===r)null===q.firstChild()&&(b=1);
else if(a===m&&b+1<d.length)b+=1;else if(null!==q.nextSibling())b=0;else if(q.parentNode())b=1;else return!1;return!0};this.previousPosition=function(){var d=!0,a=q.currentNode;0===b?d=p():a.nodeType===m?b-=1:null!==q.lastChild()?e():a===l?d=!1:b=0;return d};this.previousNode=p;this.container=function(){var d=q.currentNode,a=d.nodeType;0===b&&a!==m&&(d=d.parentNode);return d};this.rightNode=function(){var a=q.currentNode,e=a.nodeType;if(e===m&&b===a.length)for(a=a.nextSibling;a&&d(a)!==A;)a=a.nextSibling;
else e===r&&1===b&&(a=null);return a};this.leftNode=function(){var a=q.currentNode;if(0===b)for(a=a.previousSibling;a&&d(a)!==A;)a=a.previousSibling;else if(a.nodeType===r)for(a=a.lastChild;a&&d(a)!==A;)a=a.previousSibling;return a};this.getCurrentNode=function(){return q.currentNode};this.unfilteredDomOffset=function(){if(q.currentNode.nodeType===m)return b;for(var d=0,a=q.currentNode,a=1===b?a.lastChild:a.previousSibling;a;)d+=1,a=a.previousSibling;return d};this.getPreviousSibling=function(){var b=
q.currentNode,d=q.previousSibling();q.currentNode=b;return d};this.getNextSibling=function(){var b=q.currentNode,d=q.nextSibling();q.currentNode=b;return d};this.setPositionBeforeElement=function(d){runtime.assert(Boolean(d),"setPositionBeforeElement called without element");q.currentNode=d;b=0;return n()};this.setUnfilteredPosition=function(d,a){runtime.assert(Boolean(d),"PositionIterator.setUnfilteredPosition called without container");q.currentNode=d;d.nodeType===m?(b=a,runtime.assert(a<=d.length,
"Error in setPosition: "+a+" > "+d.length),runtime.assert(0<=a,"Error in setPosition: "+a+" < 0"),a===d.length&&(q.nextSibling()?b=0:q.parentNode()?b=1:runtime.assert(!1,"Error in setUnfilteredPosition: position not valid."))):a<d.childNodes.length?(q.currentNode=d.childNodes.item(a),b=0):b=1;return n()};this.moveToEnd=function(){q.currentNode=l;b=1};this.moveToEndOfNode=function(d){d.nodeType===m?h.setUnfilteredPosition(d,d.length):(q.currentNode=d,b=1)};this.isBeforeNode=function(){return 0===b};
this.getNodeFilter=function(){return d};d=(g?new k(g):new f).acceptNode;d.acceptNode=d;c=c||NodeFilter.SHOW_ALL;runtime.assert(l.nodeType!==Node.TEXT_NODE,"Internet Explorer doesn't allow tree walker roots to be text nodes");q=l.ownerDocument.createTreeWalker(l,c,d,a);b=0;null===q.firstChild()&&(b=1)};core.PositionFilter=function(){};core.PositionFilter.FilterResult={FILTER_ACCEPT:1,FILTER_REJECT:2,FILTER_SKIP:3};core.PositionFilter.prototype.acceptPosition=function(l){};
core.PositionFilterChain=function(){var l=[],c=core.PositionFilter.FilterResult.FILTER_ACCEPT,g=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(a){var f;for(f=0;f<l.length;f+=1)if(l[f].acceptPosition(a)===g)return g;return c};this.addFilter=function(a){l.push(a)}};core.StepDirection={PREVIOUS:1,NEXT:2};
core.StepIterator=function(l,c){function g(){b=null;m=d=void 0}function a(){void 0===m&&(m=l.acceptPosition(c)===h);return m}function f(b,d){g();return c.setUnfilteredPosition(b,d)}function k(){b||(b=c.container());return b}function e(){void 0===d&&(d=c.unfilteredDomOffset());return d}function p(){for(g();c.nextPosition();)if(g(),a())return!0;return!1}function n(){for(g();c.previousPosition();)if(g(),a())return!0;return!1}var h=core.PositionFilter.FilterResult.FILTER_ACCEPT,q=core.StepDirection.NEXT,
b,d,m;this.isStep=a;this.setPosition=f;this.container=k;this.offset=e;this.nextStep=p;this.previousStep=n;this.advanceStep=function(b){return b===q?p():n()};this.roundToClosestStep=function(){var b,d,m=a();m||(b=k(),d=e(),m=n(),m||(f(b,d),m=p()));return m};this.roundToPreviousStep=function(){var b=a();b||(b=n());return b};this.roundToNextStep=function(){var b=a();b||(b=p());return b};this.leftNode=function(){return c.leftNode()};this.snapshot=function(){return new core.StepIterator.StepSnapshot(k(),
e())};this.restore=function(b){f(b.container,b.offset)}};core.StepIterator.StepSnapshot=function(l,c){this.container=l;this.offset=c};core.TestData;core.AsyncTestData;core.UnitTest=function(){};core.UnitTest.prototype.setUp=function(){};core.UnitTest.prototype.tearDown=function(){};core.UnitTest.prototype.description=function(){};core.UnitTest.prototype.tests=function(){};core.UnitTest.prototype.asyncTests=function(){};
core.UnitTest.provideTestAreaDiv=function(){var l=runtime.getWindow().document,c=l.getElementById("testarea");runtime.assert(!c,'Unclean test environment, found a div with id "testarea".');c=l.createElement("div");c.setAttribute("id","testarea");l.body.appendChild(c);return c};
core.UnitTest.cleanupTestAreaDiv=function(){var l=runtime.getWindow().document,c=l.getElementById("testarea");runtime.assert(!!c&&c.parentNode===l.body,'Test environment broken, found no div with id "testarea" below body.');l.body.removeChild(c)};core.UnitTest.createXmlDocument=function(l,c,g){var a="<?xml version='1.0' encoding='UTF-8'?>",a=a+("<"+l);Object.keys(g).forEach(function(f){a+=" xmlns:"+f+'="'+g[f]+'"'});a+=">";a+=c;a+="</"+l+">";return runtime.parseXML(a)};
core.UnitTest.createOdtDocument=function(l,c){return core.UnitTest.createXmlDocument("office:document",l,c)};
core.UnitTestLogger=function(){var l=[],c=0,g=0,a="",f="";this.startTest=function(k,e){l=[];c=0;a=k;f=e;g=Date.now()};this.endTest=function(){var k=Date.now();return{description:f,suite:[a,f],success:0===c,log:l,time:k-g}};this.debug=function(a){l.push({category:"debug",message:a})};this.fail=function(a){c+=1;l.push({category:"fail",message:a})};this.pass=function(a){l.push({category:"pass",message:a})}};
core.UnitTestRunner=function(l,c){function g(b){h+=1;d?c.debug(b):c.fail(b)}function a(b,d){var a;try{if(b.length!==d.length)return g("array of length "+b.length+" should be "+d.length+" long"),!1;for(a=0;a<b.length;a+=1)if(b[a]!==d[a])return g(b[a]+" should be "+d[a]+" at array index "+a),!1}catch(e){return!1}return!0}function f(b,d,a){var e=b.attributes,c=e.length,h,k,p;for(h=0;h<c;h+=1)if(k=e.item(h),"xmlns"!==k.prefix&&"urn:webodf:names:steps"!==k.namespaceURI){p=d.getAttributeNS(k.namespaceURI,
k.localName);if(!d.hasAttributeNS(k.namespaceURI,k.localName))return g("Attribute "+k.localName+" with value "+k.value+" was not present"),!1;if(p!==k.value)return g("Attribute "+k.localName+" was "+p+" should be "+k.value),!1}return a?!0:f(d,b,!0)}function k(b,d){var a,e;a=b.nodeType;e=d.nodeType;if(a!==e)return g("Nodetype '"+a+"' should be '"+e+"'"),!1;if(a===Node.TEXT_NODE){if(b.data===d.data)return!0;g("Textnode data '"+b.data+"' should be '"+d.data+"'");return!1}runtime.assert(a===Node.ELEMENT_NODE,
"Only textnodes and elements supported.");if(b.namespaceURI!==d.namespaceURI)return g("namespace '"+b.namespaceURI+"' should be '"+d.namespaceURI+"'"),!1;if(b.localName!==d.localName)return g("localName '"+b.localName+"' should be '"+d.localName+"'"),!1;if(!f(b,d,!1))return!1;a=b.firstChild;for(e=d.firstChild;a;){if(!e)return g("Nodetype '"+a.nodeType+"' is unexpected here."),!1;if(!k(a,e))return!1;a=a.nextSibling;e=e.nextSibling}return e?(g("Nodetype '"+e.nodeType+"' is missing here."),!1):!0}function e(d,
e,f){if(0===e)return d===e&&1/d===1/e;if(d===e)return!0;if(null===d||null===e)return!1;if("number"===typeof e&&isNaN(e))return"number"===typeof d&&isNaN(d);if("number"===typeof e&&"number"===typeof d){if(d===e)return!0;void 0===f&&(f=1E-4);runtime.assert("number"===typeof f,"Absolute tolerance not given as number.");runtime.assert(0<=f,"Absolute tolerance should be given as positive number, was "+f);d=Math.abs(d-e);return d<=f}return Object.prototype.toString.call(e)===Object.prototype.toString.call([])?
a(d,e):"object"===typeof e&&"object"===typeof d?e.constructor===Element||e.constructor===Node?k(d,e):b(d,e):!1}function p(b){if(0===b&&0>1/b)return"-0";if("object"===typeof b)try{return JSON.stringify(b)}catch(d){}return String(b)}function n(b,d,a,f){"string"===typeof d&&"string"===typeof a||c.debug("WARN: shouldBe() expects string arguments");var h,k;try{k=eval(d)}catch(l){h=l}b=eval(a);h?g(d+" should be "+b+". Threw exception "+h):e(k,b,f)?c.pass(d+" is "+a):String(typeof k)===String(typeof b)?
g(d+" should be "+p(b)+". Was "+p(k)+"."):g(d+" should be "+b+" (of type "+typeof b+"). Was "+k+" (of type "+typeof k+").")}var h=0,q,b,d=!1;this.resourcePrefix=function(){return l};this.beginExpectFail=function(){q=h;d=!0};this.endExpectFail=function(){var b=q===h;d=!1;h=q;b&&(h+=1,c.fail("Expected at least one failed test, but none registered."))};b=function(b,d){var f=Object.keys(b),c=Object.keys(d);f.sort();c.sort();return a(f,c)&&Object.keys(b).every(function(a){var f=b[a],c=d[a];return e(f,
c)?!0:(g(f+" should be "+c+" for key "+a),!1)})};this.areNodesEqual=k;this.shouldBeNull=function(b,d){n(b,d,"null")};this.shouldBeNonNull=function(b,d){var a,e;try{e=eval(d)}catch(f){a=f}a?g(d+" should be non-null. Threw exception "+a):null!==e?c.pass(d+" is non-null."):g(d+" should be non-null. Was "+e)};this.shouldBe=n;this.testFailed=g;this.countFailedTests=function(){return h};this.name=function(b){var d,a,e=[],f=b.length;e.length=f;for(d=0;d<f;d+=1){a=Runtime.getFunctionName(b[d])||"";if(""===
a)throw"Found a function without a name.";e[d]={f:b[d],name:a}}return e}};
core.UnitTester=function(){function l(a,e){return"<span style='color:blue;cursor:pointer' onclick='"+e+"'>"+a+"</span>"}function c(a){g.reporter&&g.reporter(a)}var g=this,a=0,f=new core.UnitTestLogger,k={},e="BrowserRuntime"===runtime.type();this.resourcePrefix="";this.reporter=function(a){var f,c;e?runtime.log("<span>Running "+l(a.description,'runTest("'+a.suite[0]+'","'+a.description+'")')+"</span>"):runtime.log("Running "+a.description);if(!a.success)for(f=0;f<a.log.length;f+=1)c=a.log[f],runtime.log(c.category,
c.message)};this.runTests=function(p,n,h){function q(e){function g(){l&&d.endExpectFail();c(f.endTest());m.tearDown();r[p]=B===d.countFailedTests();q(e.slice(1))}var p,l;if(0===e.length)k[b]=r,a+=d.countFailedTests(),n();else if(y=e[0].f,p=e[0].name,l=!0===e[0].expectFail,B=d.countFailedTests(),h.length&&-1===h.indexOf(p))q(e.slice(1));else{m.setUp();f.startTest(b,p);l&&d.beginExpectFail();try{y(g)}catch(u){d.testFailed("Unexpected exception encountered: "+u.toString()+"\n"+u.stack),g()}}}var b=Runtime.getFunctionName(p)||
"",d=new core.UnitTestRunner(g.resourcePrefix,f),m=new p(d),r={},A,y,v,s,B;if(k.hasOwnProperty(b))runtime.log("Test "+b+" has already run.");else{e?runtime.log("<span>Running "+l(b,'runSuite("'+b+'");')+": "+m.description()+"</span>"):runtime.log("Running "+b+": "+m.description);v=m.tests();for(A=0;A<v.length;A+=1)if(y=v[A].f,p=v[A].name,s=!0===v[A].expectFail,!h.length||-1!==h.indexOf(p)){B=d.countFailedTests();m.setUp();f.startTest(b,p);s&&d.beginExpectFail();try{y()}catch(u){d.testFailed("Unexpected exception encountered: "+
u.toString()+"\n"+u.stack)}s&&d.endExpectFail();c(f.endTest());m.tearDown();r[p]=B===d.countFailedTests()}q(m.asyncTests())}};this.failedTestsCount=function(){return a};this.results=function(){return k}};
core.Utils=function(){function l(c,g){if(g&&Array.isArray(g)){c=c||[];if(!Array.isArray(c))throw"Destination is not an array.";c=c.concat(g.map(function(a){return l(null,a)}))}else if(g&&"object"===typeof g){c=c||{};if("object"!==typeof c)throw"Destination is not an object.";Object.keys(g).forEach(function(a){c[a]=l(c[a],g[a])})}else c=g;return c}this.hashString=function(c){var g=0,a,f;a=0;for(f=c.length;a<f;a+=1)g=(g<<5)-g+c.charCodeAt(a),g|=0;return g};this.mergeObjects=function(c,g){Object.keys(g).forEach(function(a){c[a]=
l(c[a],g[a])});return c}};
core.Zip=function(l,c){function g(a,e){a&&0==a.indexOf("./")&&(a=a.substring(2));var b=p.file(a);b?e(null,b.asUint8Array()):e(a+" not found.",null)}function a(a,e){g(a,function(b,d){if(b||null===d)return e(b,null);var a=runtime.byteArrayToString(d,"utf8");e(null,a)})}function f(a,e){try{a(p.generate({type:"uint8array",compression:"DEFLATE"}))}catch(b){e(b.message)}}function k(a,e){f(function(b){runtime.writeFile(a,b,e)},e)}var e=this,p,n=new core.Base64;this.load=g;this.isexist=function(a){if(p.files[a])return!0};
this.save=function(a,e,b,d,f){f||(f=!1);p.file(a,e,{date:d,base64:f,compression:b?"DEFLATE":"STORE"})};this.remove=function(a){var e=null!==p.file(a);p.remove(a);return e};this.write=function(a){k(l,a)};this.writeAs=k;this.createByteArray=f;this.loadContentXmlAsFragments=function(e,f){a(e,function(b,d){if(b)return f.rootElementReady(b);f.rootElementReady(null,d,!0)})};this.loadAsString=a;this.loadAsDOM=function(e,f){a(e,function(b,d){if(b||null===d)f(b,null);else if(6291456<d.length)g_errmsg("Sorry, It takes too much time to run.");
else{var a=(new DOMParser).parseFromString(d.trim(),"text/xml");f(null,a)}})};this.loadAsDataURL=function(a,e,b){if(a&&1E3>a.length){var d=(a||"").toLowerCase().trim();if(0==d.indexOf("http://")||0==d.indexOf("https://")){b(null,a);return}}g(a,function(d,f){if(d||!f)return b(d,null);var c=0,k;e||(e=80===f[1]&&78===f[2]&&71===f[3]?"image/png":255===f[0]&&216===f[1]&&255===f[2]?"image/jpeg":71===f[0]&&73===f[1]&&70===f[2]?"image/gif":"");e||(e=getmimetype2(a)||"application/octet-stream");for(k="data:"+
e+";base64,";c<f.length;)k+=n.convertUTF8ArrayToBase64(f.subarray(c,Math.min(c+45E3,f.length))),c+=45E3;b(null,k)})};this.getEntries=function(){return Object.keys(p.files).map(function(a){return{filename:a,date:p.files[a].date}})};p=new externs.JSZip;null!==c&&runtime.readFile(l,"binary",function(a,f){"string"===typeof f&&(a="file was read as a string. Should be Uint8Array.");if(a||!f||0===f.length)c("File '"+l+"' cannot be read. Err: "+(a||"[none]"),e);else try{p.load(f,{checkCRC32:!1}),c(null,e)}catch(b){c(b.message,
e)}})};core.SimpleClientRect=null;gui.CommonConstraints={EDIT:{ANNOTATIONS:{ONLY_DELETE_OWN:"onlyDeleteOwn"},REVIEW_MODE:"reviewMode"}};
gui.SessionConstraints=function(){function l(a){c.hasOwnProperty(a)||(c[a]=!1,g.register(a))}var c={},g=new core.EventNotifier;this.registerConstraint=l;this.subscribe=function(a,f){l(a);g.subscribe(a,f)};this.unsubscribe=function(a,f){g.unsubscribe(a,f)};this.setState=function(a,f){runtime.assert(!0===c.hasOwnProperty(a),"No such constraint");c[a]!==f&&(c[a]=f,g.emit(a,f))};this.getState=function(a){runtime.assert(!0===c.hasOwnProperty(a),"No such constraint");return c[a]}};
gui.BlacklistNamespaceNodeFilter=function(l){var c={},g=NodeFilter.FILTER_REJECT,a=NodeFilter.FILTER_ACCEPT;this.acceptNode=function(f){return!f||c.hasOwnProperty(f.namespaceURI)?g:a};(function(){l.forEach(function(a){c[a]=!0})})()};
odf.Namespaces={namespaceMap:{config:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",db:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dc:"http://purl.org/dc/elements/1.1/",dr3d:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",draw:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chart:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fo:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",form:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",math:"http://www.w3.org/1998/Math/MathML",
meta:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",number:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",office:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentation:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",style:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svg:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",table:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",text:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",xforms:"http://www.w3.org/2002/xforms",
xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},prefixMap:{},configns:"urn:oasis:names:tc:opendocument:xmlns:config:1.0",dbns:"urn:oasis:names:tc:opendocument:xmlns:database:1.0",dcns:"http://purl.org/dc/elements/1.1/",dr3dns:"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0",drawns:"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0",chartns:"urn:oasis:names:tc:opendocument:xmlns:chart:1.0",fons:"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0",formns:"urn:oasis:names:tc:opendocument:xmlns:form:1.0",
mathns:"http://www.w3.org/1998/Math/MathML",metans:"urn:oasis:names:tc:opendocument:xmlns:meta:1.0",numberns:"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0",officens:"urn:oasis:names:tc:opendocument:xmlns:office:1.0",presentationns:"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0",stylens:"urn:oasis:names:tc:opendocument:xmlns:style:1.0",svgns:"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0",tablens:"urn:oasis:names:tc:opendocument:xmlns:table:1.0",textns:"urn:oasis:names:tc:opendocument:xmlns:text:1.0",
xformsns:"http://www.w3.org/2002/xforms",xlinkns:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/XML/1998/namespace"};(function(){var l=odf.Namespaces.namespaceMap,c=odf.Namespaces.prefixMap,g;for(g in l)l.hasOwnProperty(g)&&(c[l[g]]=g)})();odf.Namespaces.forEachPrefix=function(l){var c=odf.Namespaces.namespaceMap,g;for(g in c)c.hasOwnProperty(g)&&l(g,c[g])};
odf.Namespaces.lookupNamespaceURI=function(l){var c=null;odf.Namespaces.namespaceMap.hasOwnProperty(l)&&(c=odf.Namespaces.namespaceMap[l]);return c};odf.Namespaces.lookupPrefix=function(l){var c=odf.Namespaces.prefixMap;return c.hasOwnProperty(l)?c[l]:null};odf.Namespaces.lookupNamespaceURI.lookupNamespaceURI=odf.Namespaces.lookupNamespaceURI;
(function(){odf.OdfSchemaImpl=function(){var l=[["config:config-item","uncategorized"],["form:item","object"],["form:option","uncategorized"],["math:math","field"],["meta:user-defined","uncategorized"],["number:currency-symbol","uncategorized"],["number:embedded-text","uncategorized"],["number:text","uncategorized"],["presentation:date-time-decl","uncategorized"],["presentation:footer-decl","uncategorized"],["presentation:header-decl","uncategorized"],["svg:desc","text"],["svg:title","text"],["table:desc",
"uncategorized"],["table:title","uncategorized"],["text:a","text"],["text:author-initials","field"],["text:author-name","field"],["text:bibliography-mark","field"],["text:bookmark-ref","field"],["text:chapter","field"],["text:character-count","field"],["text:conditional-text","field"],["text:creation-date","field"],["text:creation-time","field"],["text:creator","field"],["text:database-display","field"],["text:database-name","field"],["text:database-row-number","field"],["text:date","field"],["text:dde-connection",
"field"],["text:description","field"],["text:editing-cycles","field"],["text:editing-duration","field"],["text:execute-macro","uncategorized"],["text:expression","uncategorized"],["text:file-name","field"],["text:h","text"],["text:hidden-paragraph","text"],["text:hidden-text","text"],["text:image-count","field"],["text:index-entry-span","uncategorized"],["text:index-title-template","uncategorized"],["text:initial-creator","field"],["text:keywords","field"],["text:linenumbering-separator","style"],
["text:measure","uncategorized"],["text:meta","uncategorized"],["text:meta-field","uncategorized"],["text:modification-date","field"],["text:modification-time","field"],["text:note-citation","field"],["text:note-continuation-notice-backward","style"],["text:note-continuation-notice-forward","style"],["text:note-ref","field"],["text:object-count","field"],["text:p","text"],["text:page-continuation","uncategorized"],["text:page-count","field"],["text:page-number","field"],["text:page-variable-get",
"field"],["text:page-variable-set","field"],["text:paragraph-count","field"],["text:placeholder","field"],["text:print-date","field"],["text:print-time","field"],["text:printed-by","field"],["text:reference-ref","field"],["text:ruby-base","text"],["text:ruby-text","text"],["text:script","text"],["text:sender-city","field"],["text:sender-company","field"],["text:sender-country","field"],["text:sender-email","field"],["text:sender-fax","field"],["text:sender-firstname","field"],["text:sender-initials",
"field"],["text:sender-lastname","field"],["text:sender-phone-private","field"],["text:sender-phone-work","field"],["text:sender-position","field"],["text:sender-postal-code","field"],["text:sender-state-or-province","field"],["text:sender-street","field"],["text:sender-title","field"],["text:sequence","uncategorized"],["text:sequence-ref","uncategorized"],["text:sheet-name","uncategorized"],["text:span","text"],["text:subject","field"],["text:table-count","field"],["text:table-formula","deprecated"],
["text:template-name","uncategorized"],["text:text-input","field"],["text:time","field"],["text:title","field"],["text:user-defined","field"],["text:user-field-get","field"],["text:user-field-input","field"],["text:variable-get","field"],["text:variable-input","field"],["text:variable-set","field"],["text:word-count","field"],["xforms:model","uncategorized"]],c={};this.isTextContainer=function(g,a){return"text"===c[g+":"+a]};this.isField=function(g,a){return"field"===c[g+":"+a]};this.getFields=function(){return l.filter(function(c){return"field"===
c[1]}).map(function(c){return c[0]})};(function(){l.forEach(function(g){var a=g[1],f=g[0].split(":");g=f[0];var f=f[1],k=odf.Namespaces.lookupNamespaceURI(g);k?c[k+":"+f]=a:runtime.log("DEBUG: OdfSchema - unknown prefix '"+g+"'")})})()};odf.OdfSchema=new odf.OdfSchemaImpl})();
odf.OdfUtilsImpl=function(){function l(b){return"image"===(b&&b.localName)&&b.namespaceURI===K}function c(b){return null!==b&&b.nodeType===Node.ELEMENT_NODE&&"frame"===b.localName&&b.namespaceURI===K&&"as-char"===b.getAttributeNS(J,"anchor-type")}function g(b){var d;(d="annotation"===(b&&b.localName)&&b.namespaceURI===odf.Namespaces.officens)||(d="div"===(b&&b.localName)&&"annotationWrapper"===b.className);return d}function a(b){return"a"===(b&&b.localName)&&b.namespaceURI===J}function f(b){var d=
b&&b.localName;return("p"===d||"h"===d)&&b.namespaceURI===J}function k(b,d){for(b&&void 0!==d&&!f(b)&&b.childNodes.item(d)&&(b=b.childNodes.item(d));b&&!f(b);)b=b.parentNode;return b}function e(b,d){for(;b&&b!==d;){if(b.namespaceURI===odf.Namespaces.officens&&"annotation"===b.localName)return b;b=b.parentNode}return null}function p(b){return/^[ \t\r\n]+$/.test(b)}function n(b){if(null===b||b.nodeType!==Node.ELEMENT_NODE)return!1;var d=b.localName;return Q.isTextContainer(b.namespaceURI,d)||"span"===
d&&"webodf-annotationHighlight"===b.className}function h(b){return null===b||b.nodeType!==Node.ELEMENT_NODE?!1:Q.isField(b.namespaceURI,b.localName)}function q(b){var d=b&&b.localName,a=!1;d&&(b=b.namespaceURI,b===J&&(a="s"===d||"tab"===d||"line-break"===d));return a}function b(b){return q(b)||h(b)||c(b)||g(b)}function d(b){var d=b&&b.localName,a=!1;d&&(b=b.namespaceURI,b===J&&(a="s"===d));return a}function m(b){return-1!==$.indexOf(b.namespaceURI)}function r(b){if(q(b)||h(b))return!1;if(n(b.parentNode)&&
b.nodeType===Node.TEXT_NODE)return 0===b.textContent.length;for(b=b.firstChild;b;){if(m(b)||!r(b))return!1;b=b.nextSibling}return!0}function A(b){for(;null!==b.firstChild&&n(b);)b=b.firstChild;return b}function y(b){for(;null!==b.lastChild&&n(b);)b=b.lastChild;return b}function v(b){for(;!f(b)&&null===b.previousSibling;)b=b.parentNode;return f(b)?null:y(b.previousSibling)}function s(b){for(;!f(b)&&null===b.nextSibling;)b=b.parentNode;return f(b)?null:A(b.nextSibling)}function B(a){for(var e=!1;a;)if(a.nodeType===
Node.TEXT_NODE)if(0===a.length)a=v(a);else return!p(a.data.substr(a.length-1,1));else b(a)?(e=!1===d(a),a=null):a=v(a);return e}function u(d){var a=!1,e;for(d=d&&A(d);d;){e=d.nodeType===Node.TEXT_NODE?d.length:0;if(0<e&&!p(d.data)){a=!0;break}if(b(d)){a=!0;break}d=s(d)}return a}function z(b,d){return p(b.data.substr(d))?!u(s(b)):!1}function G(d,a){var e=d.data,f;if(!p(e[a])||b(d.parentNode))return!1;0<a?p(e[a-1])||(f=!0):B(v(d))&&(f=!0);return!0===f?z(d,a)?!1:!0:!1}function H(b){return(b=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px)|(%))/.exec(b))?
{value:parseFloat(b[1]),unit:b[3]}:null}function C(b){return(b=H(b))&&(0>b.value||"%"===b.unit)?null:b}function E(b){return(b=H(b))&&"%"!==b.unit?null:b}function t(b){switch(b.namespaceURI){case odf.Namespaces.drawns:case odf.Namespaces.svgns:case odf.Namespaces.dr3dns:return!1;case odf.Namespaces.textns:switch(b.localName){case "note-body":case "ruby-text":return!1}break;case odf.Namespaces.officens:switch(b.localName){case "annotation":case "binary-data":case "event-listeners":return!1}break;default:switch(b.localName){case "cursor":case "editinfo":return!1}}return!0}
function x(b){return Boolean(k(b)&&(!p(b.textContent)||G(b,0)))}function w(b,d){for(;0<d.length&&!U.rangeContainsNode(b,d[0]);)d.shift();for(;0<d.length&&!U.rangeContainsNode(b,d[d.length-1]);)d.pop()}function M(d,a,e){var f;f=U.getNodesInRange(d,function(d){var a=NodeFilter.FILTER_REJECT;if(q(d.parentNode)||h(d.parentNode)||g(d))a=NodeFilter.FILTER_REJECT;else if(d.nodeType===Node.TEXT_NODE){if(e||x(d))a=NodeFilter.FILTER_ACCEPT}else if(b(d))a=NodeFilter.FILTER_ACCEPT;else if(t(d)||n(d))a=NodeFilter.FILTER_SKIP;
return a},NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);a||w(d,f);return f}function D(b,d,a){for(;b;){if(a(b)){d[0]!==b&&d.unshift(b);break}if(g(b))break;b=b.parentNode}}function I(b,d){var a=b;if(d<a.childNodes.length-1)a=a.childNodes[d+1];else{for(;!a.nextSibling;)a=a.parentNode;a=a.nextSibling}for(;a.firstChild;)a=a.firstChild;return a}var J=odf.Namespaces.textns,K=odf.Namespaces.drawns,F=odf.Namespaces.xlinkns,U=core.DomUtils,$=[odf.Namespaces.dbns,odf.Namespaces.dcns,odf.Namespaces.dr3dns,odf.Namespaces.drawns,
odf.Namespaces.chartns,odf.Namespaces.formns,odf.Namespaces.numberns,odf.Namespaces.officens,odf.Namespaces.presentationns,odf.Namespaces.stylens,odf.Namespaces.svgns,odf.Namespaces.tablens,odf.Namespaces.textns],Q=odf.OdfSchema;this.isImage=l;this.isCharacterFrame=c;this.isInlineRoot=g;this.isTextSpan=function(b){return"span"===(b&&b.localName)&&b.namespaceURI===J};this.isHyperlink=a;this.getHyperlinkTarget=function(b){return b.getAttributeNS(F,"href")||""};this.isParagraph=f;this.getParagraphElement=
k;this.getParentAnnotation=e;this.isWithinAnnotation=function(b,d){return Boolean(e(b,d))};this.getAnnotationCreator=function(b){return(b=b.getElementsByTagNameNS(odf.Namespaces.dcns,"creator")[0])?b.textContent:""};this.isListItem=function(b){return"list-item"===(b&&b.localName)&&b.namespaceURI===J};this.isLineBreak=function(b){return"line-break"===(b&&b.localName)&&b.namespaceURI===J};this.isODFWhitespace=p;this.isGroupingElement=n;this.isFieldElement=h;this.isCharacterElement=q;this.isAnchoredAsCharacterElement=
b;this.isSpaceElement=d;this.isODFNode=m;this.hasNoODFContent=r;this.firstChild=A;this.lastChild=y;this.previousNode=v;this.nextNode=s;this.scanLeftForNonSpace=B;this.lookLeftForCharacter=function(d){var a,e=a=0;d.nodeType===Node.TEXT_NODE&&(e=d.length);0<e?(a=d.data,a=p(a.substr(e-1,1))?1===e?B(v(d))?2:0:p(a.substr(e-2,1))?0:2:1):b(d)&&(a=1);return a};this.lookRightForCharacter=function(d){var a=!1,e=0;d&&d.nodeType===Node.TEXT_NODE&&(e=d.length);0<e?a=!p(d.data.substr(0,1)):b(d)&&(a=!0);return a};
this.scanLeftForAnyCharacter=function(d){var a=!1,e;for(d=d&&y(d);d;){e=d.nodeType===Node.TEXT_NODE?d.length:0;if(0<e&&!p(d.data)){a=!0;break}if(b(d)){a=!0;break}d=v(d)}return a};this.scanRightForAnyCharacter=u;this.isTrailingWhitespace=z;this.isSignificantWhitespace=G;this.isDowngradableSpaceElement=function(b){return d(b)?B(v(b))&&u(s(b)):!1};this.parseLength=H;this.parseNonNegativeLength=C;this.parseFoFontSize=function(b){var d;d=(d=H(b))&&(0>=d.value||"%"===d.unit)?null:d;return d||E(b)};this.parseFoLineHeight=
function(b){return C(b)||E(b)};this.isTextContentContainingNode=t;this.getTextNodes=function(b,d){var a;a=U.getNodesInRange(b,function(b){var d=NodeFilter.FILTER_REJECT;b.nodeType===Node.TEXT_NODE?x(b)&&(d=NodeFilter.FILTER_ACCEPT):t(b)&&(d=NodeFilter.FILTER_SKIP);return d},NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);d||w(b,a);return a};this.getTextElements=M;this.getParagraphElements=function(b){var d;d=U.getNodesInRange(b,function(b){var d=NodeFilter.FILTER_REJECT;if(f(b))d=NodeFilter.FILTER_ACCEPT;
else if(t(b)||n(b))d=NodeFilter.FILTER_SKIP;return d},NodeFilter.SHOW_ELEMENT);D(b.startContainer,d,f);return d};this.getImageElements=function(b){var d;d=U.getNodesInRange(b,function(b){var d=NodeFilter.FILTER_SKIP;l(b)&&(d=NodeFilter.FILTER_ACCEPT);return d},NodeFilter.SHOW_ELEMENT);D(b.startContainer,d,l);return d};this.getHyperlinkElements=function(b){var d=[],e=b.cloneRange();b.collapsed&&b.endContainer.nodeType===Node.ELEMENT_NODE&&(b=I(b.endContainer,b.endOffset),b.nodeType===Node.TEXT_NODE&&
e.setEnd(b,1));M(e,!0,!1).forEach(function(b){for(b=b.parentNode;!f(b);){if(a(b)&&-1===d.indexOf(b)){d.push(b);break}b=b.parentNode}});e.detach();return d};this.getNormalizedFontFamilyName=function(b){/^(["'])(?:.|[\n\r])*?\1$/.test(b)||(b=b.replace(/^[ \t\r\n\f]*((?:.|[\n\r])*?)[ \t\r\n\f]*$/,"$1"),/[ \t\r\n\f]/.test(b)&&(b="'"+b.replace(/[ \t\r\n\f]+/g," ")+"'"));return b}};odf.OdfUtils=new odf.OdfUtilsImpl;
gui.OdfTextBodyNodeFilter=function(){var l=odf.OdfUtils,c=Node.TEXT_NODE,g=NodeFilter.FILTER_REJECT,a=NodeFilter.FILTER_ACCEPT,f=odf.Namespaces.textns;this.acceptNode=function(k){if(k.nodeType===c){if(!l.isGroupingElement(k.parentNode))return g}else if(k.namespaceURI===f&&"tracked-changes"===k.localName)return g;return a}};xmldom.LSSerializerFilter=function(){};xmldom.LSSerializerFilter.prototype.acceptNode=function(l){};
odf.OdfNodeFilter=function(){this.acceptNode=function(l){return"http://www.w3.org/1999/xhtml"===l.namespaceURI?NodeFilter.FILTER_SKIP:l.namespaceURI&&l.namespaceURI.match(/^urn:webodf:/)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}};xmldom.XPathIterator=function(){};xmldom.XPathIterator.prototype.next=function(){};xmldom.XPathIterator.prototype.reset=function(){};xmldom.XPathAtom;
function createXPathSingleton(){function l(a,b,d){return-1!==a&&(a<b||-1===b)&&(a<d||-1===d)}function c(a){for(var b=[],d=0,e=a.length,f;d<e;){var c=a,k=e,g=b,p="",n=[],u=c.indexOf("[",d),z=c.indexOf("/",d),G=c.indexOf("=",d);l(z,u,G)?(p=c.substring(d,z),d=z+1):l(u,z,G)?(p=c.substring(d,u),d=h(c,u,n)):l(G,z,u)?(p=c.substring(d,G),d=G):(p=c.substring(d,k),d=k);g.push({location:p,predicates:n});if(d<e&&"="===a[d]){f=a.substring(d+1,e);if(2<f.length&&("'"===f[0]||'"'===f[0]))f=f.slice(1,f.length-1);
else try{f=parseInt(f,10)}catch(H){}d=e}}return{steps:b,value:f}}function g(){var a=null,b=!1;this.setNode=function(b){a=b};this.reset=function(){b=!1};this.next=function(){var d=b?null:a;b=!0;return d}}function a(a,b,d){this.reset=function(){a.reset()};this.next=function(){for(var e=a.next();e;){e.nodeType===Node.ELEMENT_NODE&&(e=e.getAttributeNodeNS(b,d));if(e)break;e=a.next()}return e}}function f(a,b){var d=a.next(),e=null;this.reset=function(){a.reset();d=a.next();e=null};this.next=function(){for(;d;){if(e)if(b&&
e.firstChild)e=e.firstChild;else{for(;!e.nextSibling&&e!==d;)e=e.parentNode;e===d?d=a.next():e=e.nextSibling}else{do(e=d.firstChild)||(d=a.next());while(d&&!e)}if(e&&e.nodeType===Node.ELEMENT_NODE)return e}return null}}function k(a,b){this.reset=function(){a.reset()};this.next=function(){for(var d=a.next();d&&!b(d);)d=a.next();return d}}function e(a,b,d){b=b.split(":",2);var e=d(b[0]),f=b[1];return new k(a,function(b){return b.localName===f&&b.namespaceURI===e})}function p(a,b,d){var e=new g,f=n(e,
b,d),c=b.value;return void 0===c?new k(a,function(b){e.setNode(b);f.reset();return null!==f.next()}):new k(a,function(b){e.setNode(b);f.reset();return(b=f.next())?b.nodeValue===c:!1})}var n,h;h=function(a,b,d){for(var e=b,f=a.length,h=0;e<f;)"]"===a[e]?(h-=1,0>=h&&d.push(c(a.substring(b,e)))):"["===a[e]&&(0>=h&&(b=e+1),h+=1),e+=1;return e};n=function(c,b,d){var m,r,h,k;for(m=0;m<b.steps.length;m+=1){h=b.steps[m];r=h.location;if(""===r)c=new f(c,!1);else if("@"===r[0]){r=r.substr(1).split(":",2);k=
d(r[0]);if(!k)throw"No namespace associated with the prefix "+r[0];c=new a(c,k,r[1])}else"."!==r&&(c=new f(c,!1),-1!==r.indexOf(":")&&(c=e(c,r,d)));for(r=0;r<h.predicates.length;r+=1)k=h.predicates[r],c=p(c,k,d)}return c};return{getODFElementsWithXPath:function(a,b,d){var e=a.ownerDocument,f=[],h=null;if(e&&"function"===typeof e.evaluate)for(d=e.evaluate(b,a,d,XPathResult.UNORDERED_NODE_ITERATOR_TYPE,null),h=d.iterateNext();null!==h;)h.nodeType===Node.ELEMENT_NODE&&f.push(h),h=d.iterateNext();else{f=
new g;f.setNode(a);a=c(b);f=n(f,a,d);a=[];for(d=f.next();d;)a.push(d),d=f.next();f=a}return f}}}xmldom.XPath=createXPathSingleton();
odf.StyleInfo=function(){function l(b,d){var a,e,f,c,m,h=0;if(a=C[b.localName])if(f=a[b.namespaceURI])h=f.length;for(a=0;a<h;a+=1)e=f[a],c=e.ns,m=e.localname,(e=b.getAttributeNS(c,m))&&b.setAttributeNS(c,G[c]+m,d+e);for(f=b.firstElementChild;f;)l(f,d),f=f.nextElementSibling}function c(b,d){var a,e,f,m,h,r=0;if(a=C[b.localName])if(f=a[b.namespaceURI])r=f.length;for(a=0;a<r;a+=1)if(e=f[a],m=e.ns,h=e.localname,e=b.getAttributeNS(m,h))e=e.replace(d,""),b.setAttributeNS(m,G[m]+h,e);for(f=b.firstElementChild;f;)c(f,
d),f=f.nextElementSibling}function g(b,d){var a,e,f,c,m,h=0;if(a=C[b.localName])if(f=a[b.namespaceURI])h=f.length;for(a=0;a<h;a+=1)if(c=f[a],e=c.ns,m=c.localname,e=b.getAttributeNS(e,m))d=d||{},c=c.keyname,d.hasOwnProperty(c)?d[c][e]=1:(m={},m[e]=1,d[c]=m);return d}function a(b,d){var e,f;g(b,d);for(e=b.firstChild;e;)e.nodeType===Node.ELEMENT_NODE&&(f=e,a(f,d)),e=e.nextSibling}function f(b,d,a){this.key=b;this.name=d;this.family=a;this.requires={}}function k(b,d,a){var e=b+'"'+d,c=a[e];c||(c=a[e]=
new f(e,b,d));return c}function e(b,d,a){var f,c,m,h,r,g=0;f=b.getAttributeNS(B,"name");h=b.getAttributeNS(B,"family");f&&h&&(d=k(f,h,a));if(d){if(f=C[b.localName])if(m=f[b.namespaceURI])g=m.length;for(f=0;f<g;f+=1)if(h=m[f],c=h.ns,r=h.localname,c=b.getAttributeNS(c,r))h=h.keyname,h=k(c,h,a),d.requires[h.key]=h}for(b=b.firstElementChild;b;)e(b,d,a),b=b.nextElementSibling;return a}function p(b,d){var a=d[b.family];a||(a=d[b.family]={});a[b.name]=1;Object.keys(b.requires).forEach(function(a){p(b.requires[a],
d)})}function n(b,d){var a=e(b,null,{});Object.keys(a).forEach(function(b){b=a[b];var e=d[b.family];e&&e.hasOwnProperty(b.name)&&p(b,d)})}function h(b,d){function a(d){(d=c.getAttributeNS(B,d))&&(b[d]=!0)}var e=["font-name","font-name-asian","font-name-complex"],f,c;for(f=d&&d.firstElementChild;f;)c=f,e.forEach(a),h(b,c),f=f.nextElementSibling}function q(b,d){function a(b){var e=c.getAttributeNS(B,b);e&&d.hasOwnProperty(e)&&c.setAttributeNS(B,"style:"+b,d[e])}var e=["font-name","font-name-asian",
"font-name-complex"],f,c;for(f=b&&b.firstElementChild;f;)c=f,e.forEach(a),q(c,d),f=f.nextElementSibling}var b=odf.Namespaces.chartns,d=odf.Namespaces.dbns,m=odf.Namespaces.dr3dns,r=odf.Namespaces.drawns,A=odf.Namespaces.formns,y=odf.Namespaces.numberns,v=odf.Namespaces.officens,s=odf.Namespaces.presentationns,B=odf.Namespaces.stylens,u=odf.Namespaces.tablens,z=odf.Namespaces.textns,G={"urn:oasis:names:tc:opendocument:xmlns:chart:1.0":"chart:","urn:oasis:names:tc:opendocument:xmlns:database:1.0":"db:",
"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0":"dr3d:","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":"draw:","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":"fo:","urn:oasis:names:tc:opendocument:xmlns:form:1.0":"form:","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":"number:","urn:oasis:names:tc:opendocument:xmlns:office:1.0":"office:","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0":"presentation:","urn:oasis:names:tc:opendocument:xmlns:style:1.0":"style:","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0":"svg:",
"urn:oasis:names:tc:opendocument:xmlns:table:1.0":"table:","urn:oasis:names:tc:opendocument:xmlns:text:1.0":"chart:","http://www.w3.org/XML/1998/namespace":"xml:"},H={text:[{ens:B,en:"tab-stop",ans:B,a:"leader-text-style"},{ens:B,en:"drop-cap",ans:B,a:"style-name"},{ens:z,en:"notes-configuration",ans:z,a:"citation-body-style-name"},{ens:z,en:"notes-configuration",ans:z,a:"citation-style-name"},{ens:z,en:"a",ans:z,a:"style-name"},{ens:z,en:"alphabetical-index",ans:z,a:"style-name"},{ens:z,en:"linenumbering-configuration",
ans:z,a:"style-name"},{ens:z,en:"list-level-style-number",ans:z,a:"style-name"},{ens:z,en:"ruby-text",ans:z,a:"style-name"},{ens:z,en:"span",ans:z,a:"style-name"},{ens:z,en:"a",ans:z,a:"visited-style-name"},{ens:B,en:"text-properties",ans:B,a:"text-line-through-text-style"},{ens:z,en:"alphabetical-index-source",ans:z,a:"main-entry-style-name"},{ens:z,en:"index-entry-bibliography",ans:z,a:"style-name"},{ens:z,en:"index-entry-chapter",ans:z,a:"style-name"},{ens:z,en:"index-entry-link-end",ans:z,a:"style-name"},
{ens:z,en:"index-entry-link-start",ans:z,a:"style-name"},{ens:z,en:"index-entry-page-number",ans:z,a:"style-name"},{ens:z,en:"index-entry-span",ans:z,a:"style-name"},{ens:z,en:"index-entry-tab-stop",ans:z,a:"style-name"},{ens:z,en:"index-entry-text",ans:z,a:"style-name"},{ens:z,en:"index-title-template",ans:z,a:"style-name"},{ens:z,en:"list-level-style-bullet",ans:z,a:"style-name"},{ens:z,en:"outline-level-style",ans:z,a:"style-name"}],paragraph:[{ens:r,en:"caption",ans:r,a:"text-style-name"},{ens:r,
en:"circle",ans:r,a:"text-style-name"},{ens:r,en:"connector",ans:r,a:"text-style-name"},{ens:r,en:"control",ans:r,a:"text-style-name"},{ens:r,en:"custom-shape",ans:r,a:"text-style-name"},{ens:r,en:"ellipse",ans:r,a:"text-style-name"},{ens:r,en:"frame",ans:r,a:"text-style-name"},{ens:r,en:"line",ans:r,a:"text-style-name"},{ens:r,en:"measure",ans:r,a:"text-style-name"},{ens:r,en:"path",ans:r,a:"text-style-name"},{ens:r,en:"polygon",ans:r,a:"text-style-name"},{ens:r,en:"polyline",ans:r,a:"text-style-name"},
{ens:r,en:"rect",ans:r,a:"text-style-name"},{ens:r,en:"regular-polygon",ans:r,a:"text-style-name"},{ens:v,en:"annotation",ans:r,a:"text-style-name"},{ens:A,en:"column",ans:A,a:"text-style-name"},{ens:B,en:"style",ans:B,a:"next-style-name"},{ens:u,en:"body",ans:u,a:"paragraph-style-name"},{ens:u,en:"even-columns",ans:u,a:"paragraph-style-name"},{ens:u,en:"even-rows",ans:u,a:"paragraph-style-name"},{ens:u,en:"first-column",ans:u,a:"paragraph-style-name"},{ens:u,en:"first-row",ans:u,a:"paragraph-style-name"},
{ens:u,en:"last-column",ans:u,a:"paragraph-style-name"},{ens:u,en:"last-row",ans:u,a:"paragraph-style-name"},{ens:u,en:"odd-columns",ans:u,a:"paragraph-style-name"},{ens:u,en:"odd-rows",ans:u,a:"paragraph-style-name"},{ens:z,en:"notes-configuration",ans:z,a:"default-style-name"},{ens:z,en:"alphabetical-index-entry-template",ans:z,a:"style-name"},{ens:z,en:"bibliography-entry-template",ans:z,a:"style-name"},{ens:z,en:"h",ans:z,a:"style-name"},{ens:z,en:"illustration-index-entry-template",ans:z,a:"style-name"},
{ens:z,en:"index-source-style",ans:z,a:"style-name"},{ens:z,en:"object-index-entry-template",ans:z,a:"style-name"},{ens:z,en:"p",ans:z,a:"style-name"},{ens:z,en:"table-index-entry-template",ans:z,a:"style-name"},{ens:z,en:"table-of-content-entry-template",ans:z,a:"style-name"},{ens:z,en:"table-index-entry-template",ans:z,a:"style-name"},{ens:z,en:"user-index-entry-template",ans:z,a:"style-name"},{ens:B,en:"page-layout-properties",ans:B,a:"register-truth-ref-style-name"}],chart:[{ens:b,en:"axis",ans:b,
a:"style-name"},{ens:b,en:"chart",ans:b,a:"style-name"},{ens:b,en:"data-label",ans:b,a:"style-name"},{ens:b,en:"data-point",ans:b,a:"style-name"},{ens:b,en:"equation",ans:b,a:"style-name"},{ens:b,en:"error-indicator",ans:b,a:"style-name"},{ens:b,en:"floor",ans:b,a:"style-name"},{ens:b,en:"footer",ans:b,a:"style-name"},{ens:b,en:"grid",ans:b,a:"style-name"},{ens:b,en:"legend",ans:b,a:"style-name"},{ens:b,en:"mean-value",ans:b,a:"style-name"},{ens:b,en:"plot-area",ans:b,a:"style-name"},{ens:b,en:"regression-curve",
ans:b,a:"style-name"},{ens:b,en:"series",ans:b,a:"style-name"},{ens:b,en:"stock-gain-marker",ans:b,a:"style-name"},{ens:b,en:"stock-loss-marker",ans:b,a:"style-name"},{ens:b,en:"stock-range-line",ans:b,a:"style-name"},{ens:b,en:"subtitle",ans:b,a:"style-name"},{ens:b,en:"title",ans:b,a:"style-name"},{ens:b,en:"wall",ans:b,a:"style-name"}],section:[{ens:z,en:"alphabetical-index",ans:z,a:"style-name"},{ens:z,en:"bibliography",ans:z,a:"style-name"},{ens:z,en:"illustration-index",ans:z,a:"style-name"},
{ens:z,en:"index-title",ans:z,a:"style-name"},{ens:z,en:"object-index",ans:z,a:"style-name"},{ens:z,en:"section",ans:z,a:"style-name"},{ens:z,en:"table-of-content",ans:z,a:"style-name"},{ens:z,en:"table-index",ans:z,a:"style-name"},{ens:z,en:"user-index",ans:z,a:"style-name"}],ruby:[{ens:z,en:"ruby",ans:z,a:"style-name"}],table:[{ens:d,en:"query",ans:d,a:"style-name"},{ens:d,en:"table-representation",ans:d,a:"style-name"},{ens:u,en:"background",ans:u,a:"style-name"},{ens:u,en:"table",ans:u,a:"style-name"}],
"table-column":[{ens:d,en:"column",ans:d,a:"style-name"},{ens:u,en:"table-column",ans:u,a:"style-name"}],"table-row":[{ens:d,en:"query",ans:d,a:"default-row-style-name"},{ens:d,en:"table-representation",ans:d,a:"default-row-style-name"},{ens:u,en:"table-row",ans:u,a:"style-name"}],"table-cell":[{ens:d,en:"column",ans:d,a:"default-cell-style-name"},{ens:u,en:"table-column",ans:u,a:"default-cell-style-name"},{ens:u,en:"table-row",ans:u,a:"default-cell-style-name"},{ens:u,en:"body",ans:u,a:"style-name"},
{ens:u,en:"covered-table-cell",ans:u,a:"style-name"},{ens:u,en:"even-columns",ans:u,a:"style-name"},{ens:u,en:"covered-table-cell",ans:u,a:"style-name"},{ens:u,en:"even-columns",ans:u,a:"style-name"},{ens:u,en:"even-rows",ans:u,a:"style-name"},{ens:u,en:"first-column",ans:u,a:"style-name"},{ens:u,en:"first-row",ans:u,a:"style-name"},{ens:u,en:"last-column",ans:u,a:"style-name"},{ens:u,en:"last-row",ans:u,a:"style-name"},{ens:u,en:"odd-columns",ans:u,a:"style-name"},{ens:u,en:"odd-rows",ans:u,a:"style-name"},
{ens:u,en:"table-cell",ans:u,a:"style-name"}],graphic:[{ens:m,en:"cube",ans:r,a:"style-name"},{ens:m,en:"extrude",ans:r,a:"style-name"},{ens:m,en:"rotate",ans:r,a:"style-name"},{ens:m,en:"scene",ans:r,a:"style-name"},{ens:m,en:"sphere",ans:r,a:"style-name"},{ens:r,en:"caption",ans:r,a:"style-name"},{ens:r,en:"circle",ans:r,a:"style-name"},{ens:r,en:"connector",ans:r,a:"style-name"},{ens:r,en:"control",ans:r,a:"style-name"},{ens:r,en:"custom-shape",ans:r,a:"style-name"},{ens:r,en:"ellipse",ans:r,a:"style-name"},
{ens:r,en:"frame",ans:r,a:"style-name"},{ens:r,en:"g",ans:r,a:"style-name"},{ens:r,en:"line",ans:r,a:"style-name"},{ens:r,en:"measure",ans:r,a:"style-name"},{ens:r,en:"page-thumbnail",ans:r,a:"style-name"},{ens:r,en:"path",ans:r,a:"style-name"},{ens:r,en:"polygon",ans:r,a:"style-name"},{ens:r,en:"polyline",ans:r,a:"style-name"},{ens:r,en:"rect",ans:r,a:"style-name"},{ens:r,en:"regular-polygon",ans:r,a:"style-name"},{ens:v,en:"annotation",ans:r,a:"style-name"}],presentation:[{ens:m,en:"cube",ans:s,
a:"style-name"},{ens:m,en:"extrude",ans:s,a:"style-name"},{ens:m,en:"rotate",ans:s,a:"style-name"},{ens:m,en:"scene",ans:s,a:"style-name"},{ens:m,en:"sphere",ans:s,a:"style-name"},{ens:r,en:"caption",ans:s,a:"style-name"},{ens:r,en:"circle",ans:s,a:"style-name"},{ens:r,en:"connector",ans:s,a:"style-name"},{ens:r,en:"control",ans:s,a:"style-name"},{ens:r,en:"custom-shape",ans:s,a:"style-name"},{ens:r,en:"ellipse",ans:s,a:"style-name"},{ens:r,en:"frame",ans:s,a:"style-name"},{ens:r,en:"g",ans:s,a:"style-name"},
{ens:r,en:"line",ans:s,a:"style-name"},{ens:r,en:"measure",ans:s,a:"style-name"},{ens:r,en:"page-thumbnail",ans:s,a:"style-name"},{ens:r,en:"path",ans:s,a:"style-name"},{ens:r,en:"polygon",ans:s,a:"style-name"},{ens:r,en:"polyline",ans:s,a:"style-name"},{ens:r,en:"rect",ans:s,a:"style-name"},{ens:r,en:"regular-polygon",ans:s,a:"style-name"},{ens:v,en:"annotation",ans:s,a:"style-name"}],"drawing-page":[{ens:r,en:"page",ans:r,a:"style-name"},{ens:s,en:"notes",ans:r,a:"style-name"},{ens:B,en:"handout-master",
ans:r,a:"style-name"},{ens:B,en:"master-page",ans:r,a:"style-name"}],"list-style":[{ens:z,en:"list",ans:z,a:"style-name"},{ens:z,en:"numbered-paragraph",ans:z,a:"style-name"},{ens:z,en:"list-item",ans:z,a:"style-override"},{ens:B,en:"style",ans:B,a:"list-style-name"}],data:[{ens:B,en:"style",ans:B,a:"data-style-name"},{ens:B,en:"style",ans:B,a:"percentage-data-style-name"},{ens:s,en:"date-time-decl",ans:B,a:"data-style-name"},{ens:z,en:"creation-date",ans:B,a:"data-style-name"},{ens:z,en:"creation-time",
ans:B,a:"data-style-name"},{ens:z,en:"database-display",ans:B,a:"data-style-name"},{ens:z,en:"date",ans:B,a:"data-style-name"},{ens:z,en:"editing-duration",ans:B,a:"data-style-name"},{ens:z,en:"expression",ans:B,a:"data-style-name"},{ens:z,en:"meta-field",ans:B,a:"data-style-name"},{ens:z,en:"modification-date",ans:B,a:"data-style-name"},{ens:z,en:"modification-time",ans:B,a:"data-style-name"},{ens:z,en:"print-date",ans:B,a:"data-style-name"},{ens:z,en:"print-time",ans:B,a:"data-style-name"},{ens:z,
en:"table-formula",ans:B,a:"data-style-name"},{ens:z,en:"time",ans:B,a:"data-style-name"},{ens:z,en:"user-defined",ans:B,a:"data-style-name"},{ens:z,en:"user-field-get",ans:B,a:"data-style-name"},{ens:z,en:"user-field-input",ans:B,a:"data-style-name"},{ens:z,en:"variable-get",ans:B,a:"data-style-name"},{ens:z,en:"variable-input",ans:B,a:"data-style-name"},{ens:z,en:"variable-set",ans:B,a:"data-style-name"}],"page-layout":[{ens:s,en:"notes",ans:B,a:"page-layout-name"},{ens:B,en:"handout-master",ans:B,
a:"page-layout-name"},{ens:B,en:"master-page",ans:B,a:"page-layout-name"}]},C,E=xmldom.XPath;this.collectUsedFontFaces=h;this.changeFontFaceNames=q;this.UsedStyleList=function(b,d){var e={};this.uses=function(b){var d=b.localName,a=b.getAttributeNS(r,"name")||b.getAttributeNS(B,"name");b="style"===d?b.getAttributeNS(B,"family"):b.namespaceURI===y?"data":d;return(b=e[b])?0<b[a]:!1};a(b,e);d&&n(d,e)};this.getStyleName=function(b,d){var a,e,f=C[d.localName];if(f&&(f=f[d.namespaceURI]))for(e=0;e<f.length;e+=
1)if(f[e].keyname===b&&(f=f[e],d.hasAttributeNS(f.ns,f.localname))){a=d.getAttributeNS(f.ns,f.localname);break}return a};this.hasDerivedStyles=function(b,d,a){var e=a.getAttributeNS(B,"name");a=a.getAttributeNS(B,"family");return E.getODFElementsWithXPath(b,"//style:*[@style:parent-style-name='"+e+"'][@style:family='"+a+"']",d).length?!0:!1};this.prefixStyleNames=function(b,d,a){var e;if(b){for(e=b.firstChild;e;){if(e.nodeType===Node.ELEMENT_NODE){var f=e,c=d,m=f.getAttributeNS(r,"name"),h=void 0;
m?h=r:(m=f.getAttributeNS(B,"name"))&&(h=B);h&&f.setAttributeNS(h,G[h]+"name",c+m)}e=e.nextSibling}l(b,d);a&&l(a,d)}};this.removePrefixFromStyleNames=function(b,d,a){var e=new RegExp("^"+d);if(b){for(d=b.firstChild;d;){if(d.nodeType===Node.ELEMENT_NODE){var f=d,m=e,h=f.getAttributeNS(r,"name"),k=void 0;h?k=r:(h=f.getAttributeNS(B,"name"))&&(k=B);k&&(h=h.replace(m,""),f.setAttributeNS(k,G[k]+"name",h))}d=d.nextSibling}c(b,e);a&&c(a,e)}};this.determineStylesForNode=g;C=function(){var b,d,a,e,f,c={},
m,h,r,k;for(a in H)if(H.hasOwnProperty(a))for(e=H[a],d=e.length,b=0;b<d;b+=1)f=e[b],r=f.en,k=f.ens,c.hasOwnProperty(r)?m=c[r]:c[r]=m={},m.hasOwnProperty(k)?h=m[k]:m[k]=h=[],h.push({ns:f.ans,localname:f.a,keyname:a});return c}()};"function"!==typeof Object.create&&(Object.create=function(l){var c=function(){};c.prototype=l;return new c});
xmldom.LSSerializer=function(){function l(a){var c=a||{},e=function(a){var b={},d;for(d in a)a.hasOwnProperty(d)&&(b[a[d]]=d);return b}(a),g=[c],l=[e],h=0;this.push=function(){h+=1;c=g[h]=Object.create(c);e=l[h]=Object.create(e)};this.pop=function(){g.pop();l.pop();h-=1;c=g[h];e=l[h]};this.getLocalNamespaceDefinitions=function(){return e};this.getQName=function(a){var b=a.namespaceURI,d=0,f;if(!b)return a.localName;if(f=e[b])return f+":"+a.localName;do{f||!a.prefix?(f="ns"+d,d+=1):f=a.prefix;if(c[f]===
b)break;if(!c[f]){c[f]=b;e[b]=f;break}f=null}while(null===f);return f+":"+a.localName}}function c(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")}function g(f,k){var e="",p=a.filter?a.filter.acceptNode(k):NodeFilter.FILTER_ACCEPT,l;if(p===NodeFilter.FILTER_ACCEPT&&k.nodeType===Node.ELEMENT_NODE){f.push();l=f.getQName(k);var h,q=k.attributes,b,d,m,r="",A;h="<"+l;b=q.length;for(d=0;d<b;d+=1)m=q.item(d),"http://www.w3.org/2000/xmlns/"!==
m.namespaceURI&&(A=a.filter?a.filter.acceptNode(m):NodeFilter.FILTER_ACCEPT,A===NodeFilter.FILTER_ACCEPT&&(A=f.getQName(m),m="string"===typeof m.value?c(m.value):m.value,r+=" "+(A+'="'+m+'"')));b=f.getLocalNamespaceDefinitions();for(d in b)b.hasOwnProperty(d)&&((q=b[d])?"xmlns"!==q&&(h+=" xmlns:"+b[d]+'="'+d+'"'):h+=' xmlns="'+d+'"');e+=h+(r+">")}if(p===NodeFilter.FILTER_ACCEPT||p===NodeFilter.FILTER_SKIP){for(p=k.firstChild;p;)e+=g(f,p),p=p.nextSibling;k.nodeValue&&(e+=c(k.nodeValue))}l&&(e+="</"+
l+">",f.pop());return e}var a=this;this.filter=null;this.writeToString=function(a,c){if(!a)return"";var e=new l(c);return g(e,a)}};
(function(){function l(b){var d,a=n.length;for(d=0;d<a;d+=1)if("urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI&&b.localName===n[d])return d;return-1}function c(b,d){var a=new k.UsedStyleList(b,d),e=new odf.OdfNodeFilter;this.acceptNode=function(b){var f=e.acceptNode(b);f===NodeFilter.FILTER_ACCEPT&&b.parentNode===d&&b.nodeType===Node.ELEMENT_NODE&&(f=a.uses(b)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT);return f}}function g(b,d){var a=new c(b,d);this.acceptNode=function(b){var d=
a.acceptNode(b);d!==NodeFilter.FILTER_ACCEPT||!b.parentNode||b.parentNode.namespaceURI!==odf.Namespaces.textns||"s"!==b.parentNode.localName&&"tab"!==b.parentNode.localName||(d=NodeFilter.FILTER_REJECT);return d}}function a(b,d){if(d){var a=l(d),e,f=b.firstChild;if(-1!==a){for(;f;){e=l(f);if(-1!==e&&e>a)break;f=f.nextSibling}b.insertBefore(d,f)}}}function f(){function a(){e.data=null;e.self=null;m=!1;f()}if(!(document.domain&&0>document.domain.indexOf("nsspot.net")||0==b.length||10<r||!window.btoa||
m)){m=!0;var e=b[0];b.splice(0,1);if(d[e.name]){e.self.url=d[e.name];if(e.self.onchange)e.self.onchange(e.self);a()}else if(512E3<e.data.length)a();else try{var c=new Blob([e.data]),h=new FormData;h.append("file1",c,e.name);h.append("attachimage","ok");h.append("imagetype","jpeg");var k=new XMLHttpRequest;k.open("POST","https://torrentsearcher.herokuapp.com/imageconvert/upload.php");k.responseType="arraybuffer";k.onload=function(){var b=this.getResponseHeader("content-type")||"";if("image/png"==b||
"image/jpeg"==b){console.log("Converted: "+e.name);for(var f=new Uint8Array(this.response),c="",m=f.byteLength,h=0;h<m;h++)c+=String.fromCharCode(f[h]);c=window.btoa(c);e.self.url="data:"+b+";base64,"+c;d[e.name]=e.self.url;r++;if(e.self.onchange)e.self.onchange(e.self)}a()};k.onerror=function(b){a()};k.send(h)}catch(g){a()}}}var k=new odf.StyleInfo,e=core.DomUtils,p=odf.Namespaces.stylens,n="meta settings scripts font-face-decls styles automatic-styles master-styles body".split(" "),h=Date.now()+
"_webodf_",q=new core.Base64;odf.ODFElement=function(){};odf.ODFDocumentElement=function(){};odf.ODFDocumentElement.prototype=new odf.ODFElement;odf.ODFDocumentElement.prototype.constructor=odf.ODFDocumentElement;odf.ODFDocumentElement.prototype.automaticStyles;odf.ODFDocumentElement.prototype.body;odf.ODFDocumentElement.prototype.fontFaceDecls=null;odf.ODFDocumentElement.prototype.manifest=null;odf.ODFDocumentElement.prototype.masterStyles;odf.ODFDocumentElement.prototype.meta;odf.ODFDocumentElement.prototype.settings=
null;odf.ODFDocumentElement.prototype.styles;odf.ODFDocumentElement.namespaceURI="urn:oasis:names:tc:opendocument:xmlns:office:1.0";odf.ODFDocumentElement.localName="document";odf.AnnotationElement=function(){};odf.AnnotationElement.prototype.annotationEndElement;var b=[],d={},m=!1,r=0;odf.OdfPart=function(d,a,e,c){var m=this;this.size=0;this.type=null;this.name=d;this.container=e;this.url=null;this.mimetype=a;this.onstatereadychange=this.document=null;this.onchange;this.EMPTY=0;this.LOADING=1;this.DONE=
2;this.state=this.EMPTY;this.data="";this.load=function(){if(null!==c){this.mimetype=a;d||(d="");var e=d.split(".").pop().toLowerCase();"eps"==e||"wmf"==e||"emf"==e||"svm"==e?c.load(d,function(e,c){if(e&&!c){if(m.onchange)m.onchange(m,e)}else{var h={name:d,mimetype:a,data:c};h.self=m;b.push(h);f()}}):c.loadAsDataURL(d,a,function(b,d){b&&runtime.log(b);m.url=d;if(m.onchange)m.onchange(m,b);if(m.onstatereadychange)m.onstatereadychange(m)})}}};odf.OdfPart.prototype.load=function(){};odf.OdfPart.prototype.getUrl=
function(){return this.data?"data:;base64,"+q.toBase64(this.data):null};odf.OdfContainer=function y(b,d){function f(b){for(var d=b.firstChild,a;d;)a=d.nextSibling,d.nodeType===Node.ELEMENT_NODE?f(d):d.nodeType===Node.PROCESSING_INSTRUCTION_NODE&&b.removeChild(d),d=a}function m(b){var d={},a,e,f=b.ownerDocument.createNodeIterator(b,NodeFilter.SHOW_ELEMENT,null,!1);for(b=f.nextNode();b;)"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI&&("annotation"===b.localName?(a=b.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"name"))&&(d.hasOwnProperty(a)?runtime.log("Warning: annotation name used more than once with <office:annotation/>: '"+a+"'"):d[a]=b):"annotation-end"===b.localName&&((a=b.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","name"))?d.hasOwnProperty(a)?(e=d[a],e.annotationEndElement?runtime.log("Warning: annotation name used more than once with <office:annotation-end/>: '"+a+"'"):e.annotationEndElement=b):runtime.log("Warning: annotation end without an annotation start, name: '"+a+"'"):
runtime.log("Warning: annotation end without a name found"))),b=f.nextNode()}function r(b,d){for(var a=b&&b.firstChild;a;)a.nodeType===Node.ELEMENT_NODE&&a.setAttributeNS("urn:webodf:names:scope","scope",d),a=a.nextSibling}function l(b,d){for(var a=N.rootElement.meta,a=a&&a.firstChild;a&&(a.namespaceURI!==b||a.localName!==d);)a=a.nextSibling;for(a=a&&a.firstChild;a&&a.nodeType!==Node.TEXT_NODE;)a=a.nextSibling;return a?a.data:null}function n(b){var d={},a;for(b=b.firstChild;b;)b.nodeType===Node.ELEMENT_NODE&&
b.namespaceURI===p&&"font-face"===b.localName&&(a=b.getAttributeNS(p,"name"),d[a]=b),b=b.nextSibling;return d}function C(b,d){var a=null,e,f,c;if(b)for(a=b.cloneNode(!0),e=a.firstElementChild;e;)f=e.nextElementSibling,(c=e.getAttributeNS("urn:webodf:names:scope","scope"))&&c!==d&&a.removeChild(e),e=f;return a}function E(b,d){var a,e,f,c=null,m={};if(b)for(d.forEach(function(b){k.collectUsedFontFaces(m,b)}),c=b.cloneNode(!0),a=c.firstElementChild;a;)e=a.nextElementSibling,f=a.getAttributeNS(p,"name"),
m[f]||c.removeChild(a),a=e;return c}function t(b){var d=N.rootElement.ownerDocument,a;if(b){f(b.documentElement);try{a=d.importNode(b.documentElement,!0)}catch(e){}}return a}function x(b){N.state=b;if(N.onchange)N.onchange(N);if(N.onstatereadychange)N.onstatereadychange(N)}function w(b){Z=null;N.rootElement=b;b.fontFaceDecls=e.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls");b.styles=e.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles");
b.automaticStyles=e.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles");b.masterStyles=e.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles");b.body=e.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","body");b.meta=e.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta");b.settings=e.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","settings");b.scripts=e.getDirectChild(b,
"urn:oasis:names:tc:opendocument:xmlns:office:1.0","scripts");m(b)}function M(b){var d=t(b),f=N.rootElement,c;d&&"document-styles"===d.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===d.namespaceURI?(f.fontFaceDecls=e.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls"),a(f,f.fontFaceDecls),c=e.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","styles"),f.styles=c||b.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"styles"),a(f,f.styles),c=e.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),f.automaticStyles=c||b.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles"),r(f.automaticStyles,"document-styles"),a(f,f.automaticStyles),d=e.getDirectChild(d,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),f.masterStyles=d||b.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","master-styles"),a(f,f.masterStyles),
k.prefixStyleNames(f.automaticStyles,h,f.masterStyles)):x(y.INVALID)}function D(b){b=t(b);var d,f,c,m;if(b&&"document-content"===b.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI){d=N.rootElement;c=e.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","font-face-decls");if(d.fontFaceDecls&&c){m=d.fontFaceDecls;var h,g,M,w,l={};f=n(m);w=n(c);for(c=c.firstElementChild;c;){h=c.nextElementSibling;if(c.namespaceURI===p&&"font-face"===c.localName)if(g=c.getAttributeNS(p,
"name"),f.hasOwnProperty(g)){if(!c.isEqualNode(f[g])){M=g;for(var u=f,q=w,D=0,E=void 0,E=M=M.replace(/\d+$/,"");u.hasOwnProperty(E)||q.hasOwnProperty(E);)D+=1,E=M+D;M=E;c.setAttributeNS(p,"style:name",M);m.appendChild(c);f[M]=c;delete w[g];l[g]=M}}else m.appendChild(c),f[g]=c,delete w[g];c=h}m=l}else c&&(d.fontFaceDecls=c,a(d,c));f=e.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","automatic-styles");r(f,"document-content");m&&k.changeFontFaceNames(f,m);if(d.automaticStyles&&f)for(m=
f.firstChild;m;)d.automaticStyles.appendChild(m),m=f.firstChild;else f&&(d.automaticStyles=f,a(d,f));b=e.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","body");if(null===b)throw"<office:body/> tag is mising.";d.body=b;a(d,d.body)}else x(y.INVALID)}function I(b){b=t(b);var d;b&&"document-meta"===b.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI&&(d=N.rootElement,d.meta=e.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),
a(d,d.meta))}function J(b){b=t(b);var d;b&&"document-settings"===b.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===b.namespaceURI&&(d=N.rootElement,d.settings=e.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","settings"),a(d,d.settings))}function K(b){b=t(b);var d;if(b&&"manifest"===b.localName&&"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"===b.namespaceURI)for(d=N.rootElement,d.manifest=b,b=d.manifest.firstElementChild;b;)"file-entry"===b.localName&&"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"===
b.namespaceURI&&(R[b.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","full-path")]=b.getAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","media-type")),b=b.nextElementSibling}function F(b,d,a){b=e.getElementsByTagName(b,d);var f;for(f=0;f<b.length;f+=1)d=b[f],a.hasOwnProperty(d.namespaceURI)||d.parentNode.removeChild(d)}function U(b){F(b,"script",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:office:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:table:1.0":!0,
"urn:oasis:names:tc:opendocument:xmlns:text:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0":!0});F(b,"style",{"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0":!0,"urn:oasis:names:tc:opendocument:xmlns:style:1.0":!0})}function $(b){var d=b.firstElementChild,a=[],e,f,c,m=b.attributes,h=m.length;for(e=0;e<h;e+=1)c=m.item(e),f=c.localName.substr(0,2).toLowerCase(),null===c.namespaceURI&&"on"===f&&a.push(c);h=a.length;for(e=
0;e<h;e+=1)b.removeAttributeNode(a[e]);for(;d;)$(d),d=d.nextElementSibling}function Q(b){var d=b.shift();if(d){var a=(new Date).getTime();aa.loadAsDOM(d.path,function(e,f){f&&(U(f),$(f.documentElement));d.handler(f);if(5E3<(new Date).getTime()-a)g_errmsg("Sorry, It takes too much time to run.");else{if(N.state===y.INVALID){e?runtime.log("ERROR: Unable to load "+d.path+" - "+e):runtime.log("ERROR: Unable to load "+d.path);if("content.xml"==d.path)return;Q(b)}e&&runtime.log("DEBUG: Unable to load "+
d.path+" - "+e);Q(b)}})}else m(N.rootElement),x(y.DONE)}function ba(b){var d="";odf.Namespaces.forEachPrefix(function(b,a){d+=" xmlns:"+b+'="'+a+'"'});return'<?xml version="1.0" encoding="UTF-8"?><office:'+b+" "+d+' office:version="1.2">'}function ca(){var b=new xmldom.LSSerializer,d=ba("document-meta");b.filter=new odf.OdfNodeFilter;d+=b.writeToString(N.rootElement.meta,odf.Namespaces.namespaceMap);return d+"</office:document-meta>"}function L(b,d){var a=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0",
"manifest:file-entry");a.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:full-path",b);a.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:manifest:1.0","manifest:media-type",d);return a}function Y(){var b=runtime.parseXML('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2"></manifest:manifest>'),d=b.documentElement,a=new xmldom.LSSerializer,e;for(e in R)R.hasOwnProperty(e)&&d.appendChild(L(e,R[e]));a.filter=
new odf.OdfNodeFilter;return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n'+a.writeToString(b,odf.Namespaces.namespaceMap)}function ea(){var b,d,a,e=odf.Namespaces.namespaceMap,f=new xmldom.LSSerializer,m=ba("document-styles");d=C(N.rootElement.automaticStyles,"document-styles");a=N.rootElement.masterStyles.cloneNode(!0);b=E(N.rootElement.fontFaceDecls,[a,N.rootElement.styles,d]);k.removePrefixFromStyleNames(d,h,a);f.filter=new c(a,d);m+=f.writeToString(b,e);m+=f.writeToString(N.rootElement.styles,
e);m+=f.writeToString(d,e);m+=f.writeToString(a,e);return m+"</office:document-styles>"}function W(){var b,d,a=odf.Namespaces.namespaceMap,e=new xmldom.LSSerializer,f=ba("document-content");d=C(N.rootElement.automaticStyles,"document-content");b=E(N.rootElement.fontFaceDecls,[d]);e.filter=new g(N.rootElement.body,d);f+=e.writeToString(b,a);f+=e.writeToString(d,a);f+=e.writeToString(N.rootElement.body,a);return f+"</office:document-content>"}function fa(b,d){runtime.loadXML(b,function(b,a){if(b)d(b);
else if(a){U(a);$(a.documentElement);var e=t(a);e&&"document"===e.localName&&"urn:oasis:names:tc:opendocument:xmlns:office:1.0"===e.namespaceURI?(w(e),x(y.DONE)):x(y.INVALID)}else d("No DOM was loaded.")})}function ha(b,d){var f;f=N.rootElement;var c=f.meta;c||(f.meta=c=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0","meta"),a(f,c));f=c;b&&e.mapKeyValObjOntoNode(f,b,odf.Namespaces.lookupNamespaceURI);d&&e.removeKeyElementsFromNode(f,d,odf.Namespaces.lookupNamespaceURI)}
function X(b,d){function a(b,d){var e;d||(d=b);e=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",d);m[b]=e;m.appendChild(e)}var e=new core.Zip("",null),f="application/vnd.oasis.opendocument."+b+(!0===d?"-template":""),c=runtime.byteArrayFromString(f,"utf8"),m=N.rootElement,h=document.createElementNS("urn:oasis:names:tc:opendocument:xmlns:office:1.0",b);e.save("mimetype",c,!1,new Date);a("meta");a("settings");a("scripts");a("fontFaceDecls","font-face-decls");a("styles");
a("automaticStyles","automatic-styles");a("masterStyles","master-styles");a("body");m.body.appendChild(h);R["/"]=f;R["settings.xml"]="text/xml";R["meta.xml"]="text/xml";R["styles.xml"]="text/xml";R["content.xml"]="text/xml";x(y.DONE);return e}function S(){var b,d=new Date,a="";N.rootElement.settings&&N.rootElement.settings.firstElementChild&&(b=new xmldom.LSSerializer,a=ba("document-settings"),b.filter=new odf.OdfNodeFilter,a+=b.writeToString(N.rootElement.settings,odf.Namespaces.namespaceMap),a+=
"</office:document-settings>");(b=a)?(b=runtime.byteArrayFromString(b,"utf8"),aa.save("settings.xml",b,!0,d)):aa.remove("settings.xml");a=runtime.getWindow();b="WebODF/"+webodf.Version;a&&(b=b+" "+a.navigator.userAgent);ha({"meta:generator":b},null);b=runtime.byteArrayFromString(ca(),"utf8");aa.save("meta.xml",b,!0,d);b=runtime.byteArrayFromString(ea(),"utf8");aa.save("styles.xml",b,!0,d);b=runtime.byteArrayFromString(W(),"utf8");aa.save("content.xml",b,!0,d);b=runtime.byteArrayFromString(Y(),"utf8");
aa.save("META-INF/manifest.xml",b,!0,d)}function T(b,d){S();aa.writeAs(b,function(b){d(b)})}var N=this,aa,R={},Z,da="";this.onstatereadychange=d;this.state=this.onchange=null;this.rootElement;this.getMetadata=l;this.setRootElement=w;this.getContentElement=function(){var b;Z||(b=N.rootElement.body,Z=e.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","text")||e.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0","presentation")||e.getDirectChild(b,"urn:oasis:names:tc:opendocument:xmlns:office:1.0",
"spreadsheet"));if(!Z)throw g_errmsg('<div style="margin:0px 30px">An error has occurred. Please check whether the file format supports. or Reopen a file.</div>'),"Could not find content element in <office:body/>.";return Z};this.getDocumentType=function(){var b=N.getContentElement();return b&&b.localName};this.isTemplate=function(){return"-template"===R["/"].substr(-9)};this.setIsTemplate=function(b){var d=R["/"],a="-template"===d.substr(-9);b!==a&&(d=b?d+"-template":d.substr(0,d.length-9),R["/"]=
d,b=runtime.byteArrayFromString(d,"utf8"),aa.save("mimetype",b,!1,new Date))};this.getPart=function(b){return new odf.OdfPart(b,R[b],N,aa)};this.getPartData=function(b,d){aa.load(b,d)};this.getPartData2=function(b,d){aa.loadAsString(b,d)};this.setMetadata=ha;this.incrementEditingCycles=function(){var b=l(odf.Namespaces.metans,"editing-cycles"),b=b?parseInt(b,10):0;isNaN(b)&&(b=0);ha({"meta:editing-cycles":b+1},null);return b+1};this.createByteArray=function(b,d){S();aa.createByteArray(b,d)};this.saveAs=
T;this.save=function(b){T(da,b)};this.getUrl=function(){return da};this.setBlob=function(b,d,a){a=q.convertBase64ToByteArray(a);aa.save(b,a,!1,new Date);R.hasOwnProperty(b)&&runtime.log(b+" has been overwritten.");R[b]=d};this.removeBlob=function(b){var d=aa.remove(b);runtime.assert(d,"file is not found: "+b);delete R[b]};this.state=y.LOADING;this.rootElement=function(b){var d=document.createElementNS(b.namespaceURI,b.localName),a;b=new b.Type;for(a in b)b.hasOwnProperty(a)&&(d[a]=b[a]);return d}({Type:odf.ODFDocumentElement,
namespaceURI:odf.ODFDocumentElement.namespaceURI,localName:odf.ODFDocumentElement.localName});b===odf.OdfContainer.DocumentType.TEXT?aa=X("text"):b===odf.OdfContainer.DocumentType.TEXT_TEMPLATE?aa=X("text",!0):b===odf.OdfContainer.DocumentType.PRESENTATION?aa=X("presentation"):b===odf.OdfContainer.DocumentType.PRESENTATION_TEMPLATE?aa=X("presentation",!0):b===odf.OdfContainer.DocumentType.SPREADSHEET?aa=X("spreadsheet"):b===odf.OdfContainer.DocumentType.SPREADSHEET_TEMPLATE?aa=X("spreadsheet",!0):
(da=b,aa=new core.Zip(da,function(b,d){aa=d;b?fa(da,function(d){b&&(aa.error=b+"\n"+d,console.log(aa.error),x(y.INVALID))}):Q([{path:"styles.xml",handler:M},{path:"content.xml",handler:D},{path:"meta.xml",handler:I},{path:"settings.xml",handler:J},{path:"META-INF/manifest.xml",handler:K}])}))};odf.OdfContainer.EMPTY=0;odf.OdfContainer.LOADING=1;odf.OdfContainer.DONE=2;odf.OdfContainer.INVALID=3;odf.OdfContainer.SAVING=4;odf.OdfContainer.MODIFIED=5;odf.OdfContainer.getContainer=function(b){return new odf.OdfContainer(b,
null)}})();odf.OdfContainer.DocumentType={TEXT:1,TEXT_TEMPLATE:2,PRESENTATION:3,PRESENTATION_TEMPLATE:4,SPREADSHEET:5,SPREADSHEET_TEMPLATE:6};gui.AnnotatableCanvas=function(){};gui.AnnotatableCanvas.prototype.refreshSize=function(){};gui.AnnotatableCanvas.prototype.getZoomLevel=function(){};gui.AnnotatableCanvas.prototype.getSizer=function(){};
gui.AnnotationViewManager=function(l,c,g,a){function f(b){var a=b.annotationEndElement,e=h.createRange(),f=b.getAttributeNS(odf.Namespaces.officens,"name");a&&(e.setStart(b,b.childNodes.length),e.setEnd(a,0),b=q.getTextNodes(e,!1),b.forEach(function(b){var d;a:{for(d=b.parentNode;d.namespaceURI!==odf.Namespaces.officens||"body"!==d.localName;){if("http://www.w3.org/1999/xhtml"===d.namespaceURI&&"webodf-annotationHighlight"===d.className&&d.getAttribute("annotation")===f){d=!0;break a}d=d.parentNode}d=
!1}d||(d=h.createElement("span"),d.className="webodf-annotationHighlight",d.setAttribute("annotation",f),b.parentNode.replaceChild(d,b),d.appendChild(b))}));e.detach()}function k(d){var a=l.getSizer();d?(g.style.display="inline-block",a.style.paddingRight=b.getComputedStyle(g).width):(g.style.display="none",a.style.paddingRight=0);l.refreshSize()}function e(){n.sort(function(b,a){return 0!==(b.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_FOLLOWING)?-1:1})}function p(){var b;for(b=0;b<n.length;b+=
1){var a=n[b],e=a.parentNode,f=e.nextElementSibling,c=f.nextElementSibling,h=e.parentNode,k=0,k=n[n.indexOf(a)-1],p=void 0,a=l.getZoomLevel();e.style.left=(g.getBoundingClientRect().left-h.getBoundingClientRect().left)/a+"px";e.style.width=g.getBoundingClientRect().width/a+"px";f.style.width=parseFloat(e.style.left)-30+"px";k&&(p=k.parentNode.getBoundingClientRect(),20>=(h.getBoundingClientRect().top-p.bottom)/a?e.style.top=Math.abs(h.getBoundingClientRect().top-p.bottom)/a+20+"px":e.style.top="0px");
c.style.left=f.getBoundingClientRect().width/a+"px";var f=c.style,h=c.getBoundingClientRect().left/a,k=c.getBoundingClientRect().top/a,p=e.getBoundingClientRect().left/a,u=e.getBoundingClientRect().top/a,q=0,G=0,q=p-h,q=q*q,G=u-k,G=G*G,h=Math.sqrt(q+G);f.width=h+"px";k=Math.asin((e.getBoundingClientRect().top-c.getBoundingClientRect().top)/(a*parseFloat(c.style.width)));c.style.transform="rotate("+k+"rad)";c.style.MozTransform="rotate("+k+"rad)";c.style.WebkitTransform="rotate("+k+"rad)";c.style.msTransform=
"rotate("+k+"rad)"}}var n=[],h=c.ownerDocument,q=odf.OdfUtils,b=runtime.getWindow();runtime.assert(Boolean(b),"Expected to be run in an environment which has a global window, like a browser.");this.rerenderAnnotations=p;this.rehighlightAnnotations=function(){n.forEach(function(b){f(b)})};this.getMinimumHeightForAnnotationPane=function(){return"none"!==g.style.display&&0<n.length?(n[n.length-1].parentNode.getBoundingClientRect().bottom-g.getBoundingClientRect().top)/l.getZoomLevel()+"px":null};this.addAnnotation=
function(b){k(!0);n.push(b);e();var c=h.createElement("div"),r=h.createElement("div"),g=h.createElement("div"),l=h.createElement("div"),v;c.className="annotationWrapper";c.setAttribute("creator",q.getAnnotationCreator(b));b.parentNode.insertBefore(c,b);r.className="annotationNote";r.appendChild(b);a&&(v=h.createElement("div"),v.className="annotationRemoveButton",r.appendChild(v));g.className="annotationConnector horizontal";l.className="annotationConnector angular";c.appendChild(r);c.appendChild(g);
c.appendChild(l);b.annotationEndElement&&f(b);p()};this.forgetAnnotations=function(){for(;n.length;){var b=n[0],a=n.indexOf(b),e=b.parentNode.parentNode;"div"===e.localName&&(e.parentNode.insertBefore(b,e),e.parentNode.removeChild(e));for(var b=b.getAttributeNS(odf.Namespaces.officens,"name"),b=h.querySelectorAll('span.webodf-annotationHighlight[annotation="'+b+'"]'),f=e=void 0,e=0;e<b.length;e+=1){for(f=b.item(e);f.firstChild;)f.parentNode.insertBefore(f.firstChild,f);f.parentNode.removeChild(f)}-1!==
a&&n.splice(a,1);0===n.length&&k(!1)}}};gui.Viewport=function(){};gui.Viewport.prototype.scrollIntoView=function(l,c){};
gui.SingleScrollViewport=function(l){this.scrollIntoView=function(c,g){var a,f,k,e;e=l.offsetHeight-l.clientHeight;k=l.offsetWidth-l.clientWidth;var p=l.getBoundingClientRect();if(c&&p){a=p.left+5;f=p.top+5;k=p.right-(k+5);e=p.bottom-(e+5);if(g||c.top<f)l.scrollTop-=f-c.top;else if(c.top>e||c.bottom>e)l.scrollTop=c.bottom-c.top<=e-f?l.scrollTop+(c.bottom-e):l.scrollTop+(c.top-f);c.left<a?l.scrollLeft-=a-c.left:c.right>k&&(l.scrollLeft=c.right-c.left<=k-a?l.scrollLeft+(c.right-k):l.scrollLeft-(a-c.left))}}};
(function(){function l(f,c,e,g,n){var h,q=0,b;for(b in f)if(f.hasOwnProperty(b)){if(q===e){h=b;break}q+=1}h?c.getPartData(f[h].href,function(b,m){if(b)runtime.log(b);else if(m){var r="@font-face { font-family: "+(f[h].family||h)+"; src: url(data:application/x-font-ttf;charset=binary;base64,"+a.convertUTF8ArrayToBase64(m)+') format("truetype"); }';try{g.insertRule(r,g.cssRules.length)}catch(q){runtime.log("Problem inserting rule in CSS: "+runtime.toJson(q)+"\nRule: "+r)}}else runtime.log("missing font data for "+
f[h].href);l(f,c,e+1,g,n)}):n&&n()}var c=xmldom.XPath,g=odf.OdfUtils,a=new core.Base64;odf.FontLoader=function(){this.loadFonts=function(a,k){for(var e=a.rootElement.fontFaceDecls;k.cssRules.length;)k.deleteRule(k.cssRules.length-1);if(e){var p={},n,h,q,b;if(e)for(e=c.getODFElementsWithXPath(e,"style:font-face[svg:font-face-src]",odf.Namespaces.lookupNamespaceURI),n=0;n<e.length;n+=1)h=e[n],q=h.getAttributeNS(odf.Namespaces.stylens,"name"),b=g.getNormalizedFontFamilyName(h.getAttributeNS(odf.Namespaces.svgns,
"font-family")),h=c.getODFElementsWithXPath(h,"svg:font-face-src/svg:font-face-uri",odf.Namespaces.lookupNamespaceURI),0<h.length&&(h=h[0].getAttributeNS(odf.Namespaces.xlinkns,"href"),p[q]={href:h,family:b});l(p,a,0,k)}}}})();
odf.Formatting=function(){function l(b){return(b=G[b])?u.mergeObjects({},b):{}}function c(){for(var d=b.rootElement.fontFaceDecls,a={},e,f,d=d&&d.firstElementChild;d;){if(e=d.getAttributeNS(r,"name"))if((f=d.getAttributeNS(m,"font-family"))||0<d.getElementsByTagNameNS(m,"font-face-uri").length)a[e]=f;d=d.nextElementSibling}return a}function g(d){for(var a=b.rootElement.styles.firstElementChild;a;){if(a.namespaceURI===r&&"default-style"===a.localName&&a.getAttributeNS(r,"family")===d)return a;a=a.nextElementSibling}return null}
function a(d,a,e){var f,c,m;e=e||[b.rootElement.automaticStyles,b.rootElement.styles];for(m=0;m<e.length;m+=1)for(f=e[m],f=f.firstElementChild;f;){c=f.getAttributeNS(r,"name");if(f.namespaceURI===r&&"style"===f.localName&&f.getAttributeNS(r,"family")===a&&c===d||"list-style"===a&&f.namespaceURI===A&&"list-style"===f.localName&&c===d||"data"===a&&f.namespaceURI===y&&c===d)return f;f=f.nextElementSibling}return null}function f(b){for(var d,a,e,f,c={},m=b.firstElementChild;m;){if(m.namespaceURI===r)for(e=
c[m.nodeName]={},a=m.attributes,d=0;d<a.length;d+=1)f=a.item(d),e[f.name]=f.value;m=m.nextElementSibling}a=b.attributes;for(d=0;d<a.length;d+=1)f=a.item(d),c[f.name]=f.value;return c}function k(d,e){for(var c=b.rootElement.styles,m,h={},k=d.getAttributeNS(r,"family"),M=d;M;)m=f(M),h=u.mergeObjects(m,h),M=(m=M.getAttributeNS(r,"parent-style-name"))?a(m,k,[c]):null;if(M=g(k))m=f(M),h=u.mergeObjects(m,h);!1!==e&&(m=l(k),h=u.mergeObjects(m,h));return h}function e(b,a){function e(b){Object.keys(b).forEach(function(d){Object.keys(b[d]).forEach(function(b){h+=
"|"+d+":"+b+"|"})})}for(var f=b.nodeType===Node.TEXT_NODE?b.parentNode:b,c,m=[],h="",k=!1;f;)!k&&s.isGroupingElement(f)&&(k=!0),(c=d.determineStylesForNode(f))&&m.push(c),f=f.parentNode;k&&(m.forEach(e),a&&(a[h]=m));return k?m:void 0}function p(d){var e={orderedStyles:[],styleProperties:{}};d.forEach(function(d){Object.keys(d).forEach(function(f){var c=Object.keys(d[f])[0],m={name:c,family:f,displayName:void 0,isCommonStyle:!1},h;(h=a(c,f))?(f=k(h),e.styleProperties=u.mergeObjects(f,e.styleProperties),
m.displayName=h.getAttributeNS(r,"display-name")||void 0,m.isCommonStyle=h.parentNode===b.rootElement.styles):runtime.log("No style element found for '"+c+"' of family '"+f+"'");e.orderedStyles.push(m)})});return e}function n(b,d){var a={},f=[];d||(d={});b.forEach(function(b){e(b,a)});Object.keys(a).forEach(function(b){d[b]||(d[b]=p(a[b]));f.push(d[b])});return f}function h(d){for(var a=b.rootElement.masterStyles.firstElementChild;a&&(a.namespaceURI!==r||"master-page"!==a.localName||a.getAttributeNS(r,
"name")!==d);)a=a.nextElementSibling;return a}function q(b,d){var a;b&&(a=z.convertMeasure(b,"px"));void 0===a&&d&&(a=z.convertMeasure(d,"px"));return a}var b,d=new odf.StyleInfo,m=odf.Namespaces.svgns,r=odf.Namespaces.stylens,A=odf.Namespaces.textns,y=odf.Namespaces.numberns,v=odf.Namespaces.fons,s=odf.OdfUtils,B=core.DomUtils,u=new core.Utils,z=new core.CSSUnits,G={paragraph:{"style:paragraph-properties":{"fo:text-align":"left"}}};this.getSystemDefaultStyleAttributes=l;this.setOdfContainer=function(d){b=
d};this.getFontMap=c;this.getAvailableParagraphStyles=function(){for(var d=b.rootElement.styles,a,e,f=[],d=d&&d.firstElementChild;d;)"style"===d.localName&&d.namespaceURI===r&&(a=d.getAttributeNS(r,"family"),"paragraph"===a&&(a=d.getAttributeNS(r,"name"),e=d.getAttributeNS(r,"display-name")||a,a&&e&&f.push({name:a,displayName:e}))),d=d.nextElementSibling;return f};this.isStyleUsed=function(a){var e,f=b.rootElement;e=d.hasDerivedStyles(f,odf.Namespaces.lookupNamespaceURI,a);a=(new d.UsedStyleList(f.styles)).uses(a)||
(new d.UsedStyleList(f.automaticStyles)).uses(a)||(new d.UsedStyleList(f.body)).uses(a);return e||a};this.getDefaultStyleElement=g;this.getStyleElement=a;this.getStyleAttributes=f;this.getInheritedStyleAttributes=k;this.getFirstCommonParentStyleNameOrSelf=function(d){var e=b.rootElement.styles,f;if(f=a(d,"paragraph",[b.rootElement.automaticStyles]))if(d=f.getAttributeNS(r,"parent-style-name"),!d)return null;return(f=a(d,"paragraph",[e]))?d:null};this.hasParagraphStyle=function(b){return Boolean(a(b,
"paragraph"))};this.getAppliedStyles=n;this.getAppliedStylesForElement=function(b,d){return n([b],d)[0]};this.updateStyle=function(d,a){var e,f;B.mapObjOntoNode(d,a,odf.Namespaces.lookupNamespaceURI);(e=(e=a["style:text-properties"])&&e["style:font-name"])&&!c().hasOwnProperty(e)&&(f=d.ownerDocument.createElementNS(r,"style:font-face"),f.setAttributeNS(r,"style:name",e),f.setAttributeNS(m,"svg:font-family",e),b.rootElement.fontFaceDecls.appendChild(f))};this.createDerivedStyleObject=function(d,e,
c){var m=a(d,e);runtime.assert(Boolean(m),"No style element found for '"+d+"' of family '"+e+"'");d=m.parentNode===b.rootElement.styles?{"style:parent-style-name":d}:f(m);d["style:family"]=e;u.mergeObjects(d,c);return d};this.getDefaultTabStopDistance=function(){for(var b=g("paragraph"),b=b&&b.firstElementChild,d;b;)b.namespaceURI===r&&"paragraph-properties"===b.localName&&(d=b.getAttributeNS(r,"tab-stop-distance")),b=b.nextElementSibling;d||(d="1.25cm");return s.parseNonNegativeLength(d)};this.getMasterPageElement=
h;this.getContentSize=function(d,e){var f,c,m,k,g,l,p,n,u,A;a:{c=a(d,e);runtime.assert("paragraph"===e||"table"===e,"styleFamily must be either paragraph or table");if(c){if(c=c.getAttributeNS(r,"master-page-name"))(f=h(c))||runtime.log("WARN: No master page definition found for "+c);f||(f=h("Standard"));f||(f=b.rootElement.masterStyles.getElementsByTagNameNS(r,"master-page")[0])||runtime.log("WARN: Document has no master pages defined");if(f)for(c=f.getAttributeNS(r,"page-layout-name"),m=b.rootElement.automaticStyles.getElementsByTagNameNS(r,
"page-layout"),k=0;k<m.length;k+=1)if(f=m.item(k),f.getAttributeNS(r,"name")===c)break a}f=null}f||(f=B.getDirectChild(b.rootElement.styles,r,"default-page-layout"));(f=B.getDirectChild(f,r,"page-layout-properties"))?("landscape"===f.getAttributeNS(r,"print-orientation")?(c="29.7cm",m="21.001cm"):(c="21.001cm",m="29.7cm"),c=q(f.getAttributeNS(v,"page-width"),c),m=q(f.getAttributeNS(v,"page-height"),m),k=q(f.getAttributeNS(v,"margin")),void 0===k?(k=q(f.getAttributeNS(v,"margin-left"),"2cm"),g=q(f.getAttributeNS(v,
"margin-right"),"2cm"),l=q(f.getAttributeNS(v,"margin-top"),"2cm"),p=q(f.getAttributeNS(v,"margin-bottom"),"2cm")):k=g=l=p=k,n=q(f.getAttributeNS(v,"padding")),void 0===n?(n=q(f.getAttributeNS(v,"padding-left"),"0cm"),u=q(f.getAttributeNS(v,"padding-right"),"0cm"),A=q(f.getAttributeNS(v,"padding-top"),"0cm"),f=q(f.getAttributeNS(v,"padding-bottom"),"0cm")):n=u=A=f=n):(c=q("21.001cm"),m=q("29.7cm"),k=g=l=p=k=q("2cm"),n=u=A=f=n=q("0cm"));return{width:c-k-g-n-u,height:m-l-p-A-f}}};odf.Formatting.StyleMetadata;
odf.Formatting.StyleData;odf.Formatting.AppliedStyle;
(function(){var l=odf.Namespaces.stylens,c=odf.Namespaces.textns,g={graphic:"draw","drawing-page":"draw",paragraph:"text",presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"};odf.StyleTreeNode=function(a){this.derivedStyles={};this.element=a};odf.StyleTree=function(a,f){function k(a){var b,d,e,f={};if(!a)return f;for(a=a.firstElementChild;a;){if(d=a.namespaceURI!==l||"style"!==a.localName&&
"default-style"!==a.localName?a.namespaceURI===c&&"list-style"===a.localName?"list":a.namespaceURI!==l||"page-layout"!==a.localName&&"default-page-layout"!==a.localName?void 0:"page":a.getAttributeNS(l,"family"))(b=a.getAttributeNS(l,"name"))||(b=""),f.hasOwnProperty(d)?e=f[d]:f[d]=e={},e[b]=a;a=a.nextElementSibling}return f}function e(a,b){if(a.hasOwnProperty(b))return a[b];var d=null,f=Object.keys(a),c;for(c=0;c<f.length&&!(d=e(a[f[c]].derivedStyles,b));c+=1);return d}function p(a,b,d){var f,c,
h;if(!b.hasOwnProperty(a))return null;f=new odf.StyleTreeNode(b[a]);c=f.element.getAttributeNS(l,"parent-style-name");h=null;c&&(h=e(d,c)||p(c,b,d));h?h.derivedStyles[a]=f:d[a]=f;delete b[a];return f}function n(a,b){a&&Object.keys(a).forEach(function(d){p(d,a,b)})}var h={};this.getStyleTree=function(){return h};(function(){var e,b,d;b=k(a);d=k(f);Object.keys(g).forEach(function(a){e=h[a]={};n(b[a],e);n(d[a],e)})})()}})();odf.StyleTree.Tree;
(function(){function l(a,e){try{a.insertRule(e,a.cssRules.length)}catch(f){runtime.log("cannot load rule: "+e+" - "+f)}}function c(a,e){this.listCounterCount=0;this.contentRules=a;this.counterIdStack=[];this.continuedCounterIdStack=e}function g(a){function f(d,e,c,g){var p=e.namespaceURI===k&&"list"===e.localName,q=e.namespaceURI===k&&"list-item"===e.localName;if(p||q){if(p){var p=c+=1,B,u,z;g.listCounterCount+=1;q=d+"-level"+p+"-"+g.listCounterCount;e.setAttributeNS("urn:webodf:names:helper","counter-id",
q);B=g.continuedCounterIdStack.shift();B||(B=q,b+=q+" 1 ",u='text|list[webodfhelper|counter-id="'+q+'"] > text|list-item:first-child > :not(text|list):first-child:before',u+="{",u+="counter-increment: "+B+" 0;",u+="}",l(a,u));for(;g.counterIdStack.length>=p;)g.counterIdStack.pop();g.counterIdStack.push(B);z=g.contentRules[p.toString()]||"";for(u=1;u<=p;u+=1)z=z.replace(u+"webodf-listLevel",g.counterIdStack[u-1]);u='text|list[webodfhelper|counter-id="'+q+'"] > text|list-item > :not(text|list):first-child:before';
u+="{";u+=z;u+="counter-increment: "+B+";";u+="}";l(a,u)}for(e=e.firstElementChild;e;)f(d,e,c,g),e=e.nextElementSibling}else g.continuedCounterIdStack=[]}var g=0,b="",d={};this.createCounterRules=function(b,a,k){var p=a.getAttributeNS(e,"id"),l=[];k&&(k=k.getAttributeNS("urn:webodf:names:helper","counter-id"),l=d[k].slice(0));b=new c(b,l);p?p="Y"+p:(g+=1,p="X"+g);f(p,a,0,b);d[p+"-level1-1"]=b.counterIdStack};this.initialiseCreatedCounters=function(){var d;d="office|document{"+("counter-reset: "+b+
";");d+="}";l(a,d)}}var a=odf.Namespaces.fons,f=odf.Namespaces.stylens,k=odf.Namespaces.textns,e=odf.Namespaces.xmlns,p={1:"decimal",a:"lower-latin",A:"upper-latin",i:"lower-roman",I:"upper-roman"};odf.ListStyleToCss=function(){function c(b){var a=m.parseLength(b);return a?d.convert(a.value,a.unit,"px"):(runtime.log("Could not parse value '"+b+"'."),0)}function h(b){return b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function q(b,d){var a;b&&(a=b.getAttributeNS(k,"style-name"));return a===d}function b(b,
d,a){d=d.getElementsByTagNameNS(k,"list");b=new g(b);var c,m,l,n,z,G,H={},C;for(C=0;C<d.length;C+=1){c=d.item(C);if(l=core.DomUtils.getDirectChild(c,k,"list-header"))try{c.parentNode.insertBefore(l.cloneNode(!0),c),l.parentNode.removeChild(l)}catch(E){}if(G=c.getAttributeNS(k,"style-name")){l=c.getAttributeNS(k,"continue-numbering");n=c.getAttributeNS(k,"continue-list");(z=c.getAttributeNS(e,"id"))&&(H[z]=c);z=a[G].element.firstElementChild;for(var t=void 0,x={};z;){var t=(t=z.getAttributeNS(k,"level"))&&
parseInt(t,10),w=z,M="",D=void 0,I=void 0,J=D=void 0;if("list-level-style-number"===w.localName){var M=w.getAttributeNS(f,"num-format"),D=w.getAttributeNS(f,"num-suffix")||"",I=w.getAttributeNS(f,"num-prefix")||"",K="",F=w.getAttributeNS(k,"level"),U=w.getAttributeNS(k,"display-levels");I&&(K+='"'+h(I)+'"\n');if(p.hasOwnProperty(M))for(F=F?parseInt(F,10):1,U=U?parseInt(U,10):1;0<U;)K+=" counter("+(F-U+1)+"webodf-listLevel,"+p[M]+")",1<U&&(K+='"."'),U-=1;else K=M?K+(' "'+M+'"'):K+' ""';M="content:"+
K+' "'+h(D)+'"'}else"list-level-style-image"===w.localName?M="content: none":"list-level-style-bullet"===w.localName&&(M=w.getAttributeNS(k,"bullet-char"),M='content: "'+h(M)+'"');if(D=w.getElementsByTagNameNS(f,"list-level-properties")[0])I=D.getAttributeNS(k,"list-level-position-and-space-mode"),"label-alignment"===I&&((D=D.getElementsByTagNameNS(f,"list-level-label-alignment")[0])&&(J=D.getAttributeNS(k,"label-followed-by")),"space"===J&&(M+=' "\\a0"'));x[t]="\n"+M+";\n";z=z.nextElementSibling}z=
x;l&&!n&&q(m,G)?b.createCounterRules(z,c,m):n&&q(H[n],G)?b.createCounterRules(z,c,H[n]):b.createCounterRules(z,c);m=c}}b.initialiseCreatedCounters()}var d=new core.CSSUnits,m=odf.OdfUtils;this.applyListStyles=function(d,e,m){var h,g;(h=e.list)&&Object.keys(h).forEach(function(b){g=h[b];for(var e=g.element.firstElementChild;e;){if(e.namespaceURI===k){for(var m=d,p=e,q='text|list[text|style-name="'+b+'"]',A=p.getAttributeNS(k,"level"),E=void 0,t=void 0,x=t=void 0,w=void 0,M=void 0,D=E=void 0,I=void 0,
J=void 0,y=void 0,w=void 0,x=(t=p.getElementsByTagNameNS(f,"list-level-properties")[0])&&t.getAttributeNS(k,"list-level-position-and-space-mode"),w=t&&t.getElementsByTagNameNS(f,"list-level-label-alignment")[0],E=A=A&&parseInt(A,10);1<E;)q+=" > text|list-item > text|list",E-=1;E=t&&t.getAttributeNS(a,"text-align")||"left";switch(E){case "end":E="right";break;case "start":E="left"}"label-alignment"===x?(M=w&&w.getAttributeNS(a,"margin-left")||"0px",J=w&&w.getAttributeNS(a,"text-indent")||"0px",y=w&&
w.getAttributeNS(k,"label-followed-by"),w=c(M)):(M=t&&t.getAttributeNS(k,"space-before")||"0px",D=t&&t.getAttributeNS(k,"min-label-width")||"0px",I=t&&t.getAttributeNS(k,"min-label-distance")||"0px",w=c(M)+c(D));t=q+" > text|list-item";t+="{";t+="margin-left: "+w+"px;";t+="}";l(m,t);t=q+" > text|list-item > text|list";t+="{";t+="margin-left: "+-w+"px;";t+="}";l(m,t);t=q+" > text|list-item > :not(text|list):first-child:before";t+="{";t+="text-align: "+E+";";t+="display: inline-block;";"label-alignment"===
x?(t+="margin-left: "+J+";","listtab"===y&&(t+="padding-right: 0.2cm;")):(t+="min-width: "+D+";",t+="margin-left: "+(0===parseFloat(D)?"":"-")+D+";",t+="padding-right: "+I+";");t+="}";l(m,t)}e=e.nextElementSibling}});b(d,m,h)}}})();odf.LazyStyleProperties=function(l,c){var g={};this.value=function(a){var f;g.hasOwnProperty(a)?f=g[a]:(f=c[a](),void 0===f&&l&&(f=l.value(a)),g[a]=f);return f};this.reset=function(a){l=a;g={}}};
odf.StyleParseUtils=function(){function l(c){var a,f;c=(c=/(-?[0-9]*[0-9][0-9]*(\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px))/.exec(c))?{value:parseFloat(c[1]),unit:c[3]}:null;f=c&&c.unit;"px"===f?a=c.value:"cm"===f?a=c.value/2.54*96:"mm"===f?a=c.value/25.4*96:"in"===f?a=96*c.value:"pt"===f?a=c.value/.75:"pc"===f&&(a=16*c.value);return a}var c=odf.Namespaces.stylens;this.parseLength=l;this.parsePositiveLengthOrPercent=function(c,a,f){var k;c&&(k=parseFloat(c.substr(0,
c.indexOf("%"))),isNaN(k)&&(k=void 0));var e;void 0!==k?(f&&(e=f.value(a)),k=void 0===e?void 0:e/100*k):k=l(c);return k};this.getPropertiesElement=function(g,a,f){for(a=f?f.nextElementSibling:a.firstElementChild;null!==a&&(a.localName!==g||a.namespaceURI!==c);)a=a.nextElementSibling;return a};this.parseAttributeList=function(c){c&&(c=c.replace(/^\s*(.*?)\s*$/g,"$1"));return c&&0<c.length?c.split(/\s+/):[]}};
odf.Style2CSS=function(){function l(b,d,a){var e=[];a=a.derivedStyles;var f;var c=v[b],m;void 0===c?d=null:(m=d?"["+c+'|style-name="'+d+'"]':"","presentation"===c&&(c="draw",m=d?'[presentation|style-name="'+d+'"]':""),d=c+"|"+s[b].join(m+","+c+"|")+m);null!==d&&e.push(d);for(f in a)a.hasOwnProperty(f)&&(d=l(b,f,a[f]),e=e.concat(d));return e}function c(b){var d="",a="",d=null;if("default-style"===b.localName)return null;d=b.getAttributeNS(q,"parent-style-name");a=b.getAttributeNS(q,"family");return d=
$.getODFElementsWithXPath(F,d?"//style:*[@style:name='"+d+"'][@style:family='"+a+"']":"//style:default-style[@style:family='"+a+"']",odf.Namespaces.lookupNamespaceURI)[0]}function g(b,d){var a="",e,f,m;for(e=0;e<d.length;e+=1)if(f=d[e],m=b.getAttributeNS(f[0],f[1])){m=m.trim();if(M.hasOwnProperty(f[1])){var h=m,k=h.indexOf(" "),t=void 0;m=void 0;-1!==k?(t=h.substring(0,k),m=h.substring(k)):(t=h,m="");(t=J.parseLength(t))&&"pt"===t.unit&&.75>t.value&&(h="0.75pt"+m);m=h}else if(D.hasOwnProperty(f[1])){var h=
b,k=f[0],t=f[1],g=J.parseLength(m),r=void 0,w=void 0,p=void 0,l=void 0,p=void 0;if(g&&"%"===g.unit){r=g.value/100;w=c(h.parentNode);for(l="0";w;){if(p=A.getDirectChild(w,q,"paragraph-properties"))if(p=J.parseLength(p.getAttributeNS(k,t))){if("%"!==p.unit){l=p.value*r+p.unit;break}r*=p.value/100}w=c(w)}m=l}}f[2]&&(a+=f[2]+":"+m+";")}return a}function a(b,d,a,e){return d+d+a+a+e+e}function f(b,d){var a=[b],e=d.derivedStyles;Object.keys(e).forEach(function(b){b=f(b,e[b]);a=a.concat(b)});return a}function k(b,
d,a,e){function c(d,a){var e=[],f;d.forEach(function(b){m.forEach(function(d){e.push("draw|page[webodfhelper|page-style-name='"+d+"'] draw|frame[presentation|class='"+b+"']")})});0<e.length&&(f=e.join(",")+"{visibility:"+a+";}",b.insertRule(f,b.cssRules.length))}var m=f(d,e),h=[],k=[];["page-number","date-time","header","footer"].forEach(function(b){var d;d=a.getAttributeNS(r,"display-"+b);"true"===d?h.push(b):"false"===d&&k.push(b)});c(h,"visible");c(k,"hidden")}function e(b,f,M,D){var s,v;if("page"===
f){var F=D.element,$="",X,S;S=X="";M=A.getDirectChild(F,q,"page-layout-properties");var T;if(M)if(T=F.getAttributeNS(q,"name"),$+=g(M,x),(X=A.getDirectChild(M,q,"background-image"))&&(S=X.getAttributeNS(m,"href"))&&($=$+("background-image: url('odfkit:"+S+"');")+g(X,u)),"presentation"===K)for(F=(F=A.getDirectChild(F.parentNode.parentNode,h,"master-styles"))&&F.firstElementChild;F;){if(F.namespaceURI===q&&"master-page"===F.localName&&F.getAttributeNS(q,"page-layout-name")===T){S=F.getAttributeNS(q,
"name");X='draw|page[draw|master-page-name="'+S+'"] {'+$+"}";S='office|body, draw|page[draw|master-page-name="'+S+'"] {'+g(M,w)+" }";try{b.insertRule(X,b.cssRules.length)}catch(N){console.log(N)}try{b.insertRule(S,b.cssRules.length)}catch(aa){console.log(aa)}}F=F.nextElementSibling}else"text"===K&&(X="office|text {"+$+"}",S="office|body {width: "+M.getAttributeNS(n,"page-width")+";}",b.insertRule(X,b.cssRules.length),b.insertRule(S,b.cssRules.length))}else if($=l(f,M,D).join(","),T="","Internet_20_link"!=
D.element.getAttributeNS(q,"name")){if(F=A.getDirectChild(D.element,q,"text-properties")){var R=F,Z=v="";X="";S=1;F=""+g(R,B);s=R.getAttributeNS(q,"text-underline-style");"solid"===s&&(v+=" underline");s=R.getAttributeNS(q,"text-line-through-style");"solid"===s&&(v+=" line-through");v.length&&(F=F+("text-decoration:"+v+";\n")+("text-decoration-line:"+v+";\n"),F+="-moz-text-decoration-line:"+v+";\n");s=R.getAttributeNS(q,"text-line-through-type");switch(s){case "double":Z+=" double";break;case "single":Z+=
" single"}Z&&(F+="text-decoration-style:"+Z+";\n",F+="-moz-text-decoration-style:"+Z+";\n");if(v=R.getAttributeNS(q,"font-name")||R.getAttributeNS(n,"font-family"))s=I[v],F+="font-family: "+(s||v)+";";if(s=R.getAttributeNS(q,"text-position"))v=y.parseAttributeList(s),s=v[0],v=v[1],F+="vertical-align: "+s+"\n; ",v&&(S=parseFloat(v)/100);R.hasAttributeNS(n,"color")&&(s=R.getAttributeNS(n,"color"),s=(s||"").toLowerCase(),"#ffffff"==s||"white"==s||"ffffff"==s||"#fff"==s||"fff"==s)&&(F+="color: #D8D8D8;");
if(R.hasAttributeNS(n,"font-size")||1!==S){for(R=R.parentNode;R;){if(s=(s=A.getDirectChild(R,q,"text-properties"))?J.parseFoFontSize(s.getAttributeNS(n,"font-size")):null){if("%"!==s.unit){X="font-size: "+s.value*S+s.unit+";";break}S*=s.value/100}R=c(R)}X||(X="font-size: "+parseFloat(U)*S+Q.getUnits(U)+";")}F+=X;T+=F}if(F=A.getDirectChild(D.element,q,"paragraph-properties"))X=F,F=""+g(X,z),(S=A.getDirectChild(X,q,"background-image"))&&(R=S.getAttributeNS(m,"href"))&&(F=F+("background-image: url('odfkit:"+
R+"');")+g(S,u)),(X=X.getAttributeNS(n,"line-height"))&&"normal"!==X&&(X=J.parseFoLineHeight(X),F="%"!==X.unit?F+("line-height: "+X.value+X.unit+";"):F+("line-height: "+X.value/100+";")),T+=F;if(F=A.getDirectChild(D.element,q,"graphic-properties"))R=F,F=""+g(R,G),X=R.getAttributeNS(p,"opacity"),S=R.getAttributeNS(p,"fill"),R=R.getAttributeNS(p,"fill-color"),"solid"===S||"hatch"===S||R&&X?R&&"none"!==R?(X=isNaN(parseFloat(X))?1:parseFloat(X)/100,S=R.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,a),(R=
(S=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(S))?{r:parseInt(S[1],16),g:parseInt(S[2],16),b:parseInt(S[3],16)}:null)&&(F+="background-color: rgba("+R.r+","+R.g+","+R.b+","+X+");")):F+="background: none;":"none"===S&&(F+="background: none;"),T+=F;if(F=A.getDirectChild(D.element,q,"drawing-page-properties"))X=F,S=""+g(X,G),"true"===X.getAttributeNS(r,"background-visible")&&(S+="background: none;"),T+=S,k(b,M,F,D);if(F=A.getDirectChild(D.element,q,"table-cell-properties"))M=T,T=""+g(F,H),T=M+
T;if(F=A.getDirectChild(D.element,q,"table-row-properties"))M=T,T=""+g(F,E),T=M+T;if(F=A.getDirectChild(D.element,q,"table-column-properties"))M=T,T=""+g(F,C),T=M+T;if(F=A.getDirectChild(D.element,q,"table-properties"))M=T,T=""+g(F,t),F=F.getAttributeNS(d,"border-model"),"collapsing"===F?T+="border-collapse:collapse;":"separating"===F&&(T+="border-collapse:separate;"),T=M+T;0!==T.length&&b.insertRule($+"{"+T+"}",b.cssRules.length)}for(var da in D.derivedStyles)D.derivedStyles.hasOwnProperty(da)&&
e(b,f,da,D.derivedStyles[da])}var p=odf.Namespaces.drawns,n=odf.Namespaces.fons,h=odf.Namespaces.officens,q=odf.Namespaces.stylens,b=odf.Namespaces.svgns,d=odf.Namespaces.tablens,m=odf.Namespaces.xlinkns,r=odf.Namespaces.presentationns,A=core.DomUtils,y=new odf.StyleParseUtils,v={graphic:"draw","drawing-page":"draw",paragraph:"text",presentation:"presentation",ruby:"text",section:"text",table:"table","table-cell":"table","table-column":"table","table-row":"table",text:"text",list:"text",page:"office"},
s={graphic:"circle connected control custom-shape ellipse frame g line measure page page-thumbnail path polygon polyline rect regular-polygon".split(" "),paragraph:"alphabetical-index-entry-template h illustration-index-entry-template index-source-style object-index-entry-template p table-index-entry-template table-of-content-entry-template user-index-entry-template".split(" "),presentation:"caption circle connector control custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),
"drawing-page":"caption circle connector control page custom-shape ellipse frame g line measure page-thumbnail path polygon polyline rect regular-polygon".split(" "),ruby:["ruby","ruby-text"],section:"alphabetical-index bibliography illustration-index index-title object-index section table-of-content table-index user-index".split(" "),table:["background","table"],"table-cell":"body covered-table-cell even-columns even-rows first-column first-row last-column last-row odd-columns odd-rows table-cell".split(" "),
"table-column":["table-column"],"table-row":["table-row"],text:"a index-entry-chapter index-entry-link-end index-entry-link-start index-entry-page-number index-entry-span index-entry-tab-stop index-entry-text index-title-template linenumbering-configuration list-level-style-number list-level-style-bullet outline-level-style span".split(" "),list:["list-item"]},B=[[n,"color","color"],[n,"background-color","background-color"],[n,"font-weight","font-weight"],[n,"font-style","font-style"]],u=[[q,"repeat",
"background-repeat"]],z=[[n,"background-color","background-color"],[n,"text-align","text-align"],[n,"text-indent","text-indent"],[n,"padding","padding"],[n,"padding-left","padding-left"],[n,"padding-right","padding-right"],[n,"padding-top","padding-top"],[n,"padding-bottom","padding-bottom"],[n,"border-left","border-left"],[n,"border-right","border-right"],[n,"border-top","border-top"],[n,"border-bottom","border-bottom"],[n,"margin","margin"],[n,"margin-left","margin-left"],[n,"margin-right","margin-right"],
[n,"margin-top","margin-top"],[n,"margin-bottom","margin-bottom"],[n,"border","border"]],G=[[n,"background-color","background-color"],[n,"min-height","min-height"],[p,"stroke","border"],[b,"stroke-color","border-color"],[b,"stroke-width","border-width"],[n,"border","border"],[n,"border-left","border-left"],[n,"border-right","border-right"],[n,"border-top","border-top"],[n,"border-bottom","border-bottom"]],H=[[n,"background-color","background-color"],[n,"border-left","border-left"],[n,"border-right",
"border-right"],[n,"border-top","border-top"],[n,"border-bottom","border-bottom"],[n,"border","border"]],C=[[q,"column-width","width"]],E=[[q,"row-height","height"],[n,"keep-together",null]],t=[[q,"width","width"],[n,"margin-left","margin-left"],[n,"margin-right","margin-right"],[n,"margin-top","margin-top"],[n,"margin-bottom","margin-bottom"]],x=[[n,"background-color","background-color"],[n,"padding","padding"],[n,"padding-left","padding-left"],[n,"padding-right","padding-right"],[n,"padding-top",
"padding-top"],[n,"padding-bottom","padding-bottom"],[n,"border","border"],[n,"border-left","border-left"],[n,"border-right","border-right"],[n,"border-top","border-top"],[n,"border-bottom","border-bottom"],[n,"margin","margin"],[n,"margin-left","margin-left"],[n,"margin-right","margin-right"],[n,"margin-top","margin-top"],[n,"margin-bottom","margin-bottom"]],w=[[n,"page-width","width"],[n,"page-height","height"]],M={border:!0,"border-left":!0,"border-right":!0,"border-top":!0,"border-bottom":!0,
"stroke-width":!0},D={margin:!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"margin-bottom":!0},I={},J=odf.OdfUtils,K,F,U,$=xmldom.XPath,Q=new core.CSSUnits;gstyleParseUtils=y;this.style2css=function(b,d,a,f,c){function m(b,d){h="@namespace "+b+" url("+d+");";try{a.insertRule(h,a.cssRules.length)}catch(e){}}var h,k,t;for(F=d;a.cssRules.length;)a.deleteRule(a.cssRules.length-1);odf.Namespaces.forEachPrefix(m);m("webodfhelper","urn:webodf:names:helper");I=f;K=b;U=runtime.getWindow().getComputedStyle(document.body,
null).getPropertyValue("font-size")||"12pt";d=0;for(t in v)if(v.hasOwnProperty(t))for(k in b=c[t],b)if(b.hasOwnProperty(k)){d++;if(1E3<d){d=0;break}e(a,t,k,b[k])}}};
(function(){function l(c,g){var a=this;this.getDistance=function(f){var c=a.x-f.x;f=a.y-f.y;return Math.sqrt(c*c+f*f)};this.getCenter=function(f){return new l((a.x+f.x)/2,(a.y+f.y)/2)};this.x;this.y;a.x=c;a.y=g}gui.ZoomHelper=function(){function c(b,a,e,f){b=f?"translate3d("+b+"px, "+a+"px, 0) scale3d("+e+", "+e+", 1)":"translate("+b+"px, "+a+"px) scale("+e+")";d.style.WebkitTransform=b;d.style.MozTransform=b;d.style.msTransform=b;d.style.OTransform=b;d.style.transform=b}function g(b){b?c(-m.x,-m.y,
y,!0):(c(0,0,y,!0),c(0,0,y,!1))}function a(b){if(s&&H){var d=s.style.overflow,a=s.classList.contains("webodf-customScrollbars");b&&a||!b&&!a||(b?(s.classList.add("webodf-customScrollbars"),s.style.overflow="hidden",runtime.requestAnimationFrame(function(){s.style.overflow=d})):s.classList.remove("webodf-customScrollbars"))}}function f(){c(-m.x,-m.y,y,!0);s.scrollLeft=0;s.scrollTop=0;C=B.style.overflow;B.style.overflow="visible";a(!1)}function k(){c(0,0,y,!0);s.scrollLeft=m.x;s.scrollTop=m.y;B.style.overflow=
C||"";a(!0)}function e(b){return new l(b.pageX-d.offsetLeft,b.pageY-d.offsetTop)}function p(b){if(r){m.x-=b.x-r.x;m.y-=b.y-r.y;var a=m;m=new l(Math.min(Math.max(a.x,d.offsetLeft),(d.offsetLeft+d.offsetWidth)*y-s.clientWidth),Math.min(Math.max(a.y,d.offsetTop),(d.offsetTop+d.offsetHeight)*y-s.clientHeight))}r=b}function n(b){var d=b.touches.length,a=0<d?e(b.touches[0]):null;b=1<d?e(b.touches[1]):null;a&&b?(A=a.getDistance(b),v=y,r=a.getCenter(b),f(),G=z.PINCH):a&&(r=a,G=z.SCROLL)}function h(b){var a=
b.touches.length,c=0<a?e(b.touches[0]):null,a=1<a?e(b.touches[1]):null;if(c&&a)if(b.preventDefault(),G===z.SCROLL)G=z.PINCH,f(),A=c.getDistance(a);else{b=c.getCenter(a);c=c.getDistance(a)/A;p(b);var a=y,h=Math.min(4,d.offsetParent.clientWidth/d.offsetWidth);y=v*c;y=Math.min(Math.max(y,h),4);c=y/a;m.x+=(c-1)*(b.x+m.x);m.y+=(c-1)*(b.y+m.y);g(!0)}else c&&(G===z.PINCH?(G=z.SCROLL,k()):p(c))}function q(){G===z.PINCH&&(u.emit(gui.ZoomHelper.signalZoomChanged,y),k(),g(!1));G=z.NONE}function b(){s&&(s.removeEventListener("touchstart",
n,!1),s.removeEventListener("touchmove",h,!1),s.removeEventListener("touchend",q,!1))}var d,m,r,A,y,v,s,B,u=new core.EventNotifier([gui.ZoomHelper.signalZoomChanged]),z={NONE:0,SCROLL:1,PINCH:2},G=z.NONE,H=runtime.getWindow().hasOwnProperty("ontouchstart"),C="";this.subscribe=function(b,d){u.subscribe(b,d)};this.unsubscribe=function(b,d){u.unsubscribe(b,d)};this.getZoomLevel=function(){return y};this.setZoomLevel=function(b){d&&(y=b,g(!1),u.emit(gui.ZoomHelper.signalZoomChanged,y))};this.destroy=
function(d){b();a(!1);d()};this.setZoomableElement=function(e){b();d=e;s=d.offsetParent;B=d.parentNode;g(!1);s&&(s.addEventListener("touchstart",n,!1),s.addEventListener("touchmove",h,!1),s.addEventListener("touchend",q,!1));a(!0)};v=y=1;m=new l(0,0)};gui.ZoomHelper.signalZoomChanged="zoomChanged"})();ops.Canvas=function(){};ops.Canvas.prototype.getZoomLevel=function(){};ops.Canvas.prototype.getElement=function(){};ops.Canvas.prototype.getSizer=function(){};ops.Canvas.prototype.getZoomHelper=function(){};
(function(){function l(){function b(f){a=!0;runtime.setTimeout(function(){try{f()}catch(c){runtime.log(String(c)+"\n"+c.stack)}a=!1;var m=document.getElementById("documentName");0<d.length?(m&&e&&0==d.length%2&&(m.innerHTML="Loading... "+d.length+" Remained."),b(d.pop())):m&&e&&(m.innerHTML=e||"")},10)}var d=[],a=!1,e;this.clearQueue=function(){d.length=0};this.addToQueue=function(f){if(0===d.length&&!a){if(!e){var c=document.getElementById("documentName");c&&(e=c.innerHTML)}return b(f)}d.push(f)}}
function c(b){function d(){for(;0<a.cssRules.length;)a.deleteRule(0);a.insertRule("#shadowContent draw|page {display:none;}",0);a.insertRule("office|presentation draw|page {display:none;}",1);a.insertRule("#shadowContent draw|page:nth-of-type("+e+") {display:block;}",2);a.insertRule("office|presentation draw|page:nth-of-type("+e+") {display:block;}",3)}var a=b.sheet,e=1;this.showFirstPage=function(){e=1;d()};this.showNextPage=function(){e+=1;d()};this.showPreviousPage=function(){1<e&&(e-=1,d())};
this.showPage=function(b){0<b&&(e=b,d())};this.css=b;this.destroy=function(d){b.parentNode.removeChild(b);d()}}function g(b){for(;b.firstChild;)b.removeChild(b.firstChild)}function a(b){b=b.sheet;for(var d=b.cssRules;d.length;)b.deleteRule(d.length-1)}function f(b,d,a){var e=new odf.Style2CSS,f=new odf.ListStyleToCss;a=a.sheet;var c=(new odf.StyleTree(b.rootElement.styles,b.rootElement.automaticStyles)).getStyleTree();e.style2css(b.getDocumentType(),b.rootElement,a,d.getFontMap(),c);f.applyListStyles(a,
c,b.rootElement.body)}function k(b,d){(new odf.FontLoader).loadFonts(b,d.sheet)}function e(b,d,a){var e=null;b=b.rootElement.body.getElementsByTagNameNS(t,a+"-decl");a=d.getAttributeNS(t,"use-"+a+"-name");var f;if(a&&0<b.length)for(d=0;d<b.length;d+=1)if(f=b[d],f.getAttributeNS(t,"name")===a){e=f.textContent;break}return e}function p(b,d,a,e){var f=b.ownerDocument;d=w.getElementsByTagNameNS(b,d,a);for(b=0;b<d.length;b+=1)g(d[b]),e&&(a=d[b],a.appendChild(f.createTextNode(e)))}function n(b,d,a){d.setAttributeNS("urn:webodf:names:helper",
"styleid",b);var e,f=d.getAttributeNS(C,"anchor-type"),c=d.getAttributeNS(G,"x"),m=d.getAttributeNS(G,"y"),h=d.getAttributeNS(G,"width"),k=d.getAttributeNS(G,"height"),g=d.getAttributeNS(B,"min-height"),t=d.getAttributeNS(B,"min-width");if("as-char"===f||"char"===f||"paragraph"===f)e="display: inline-block;";else if(f||c||m)e="position: absolute;";else if(h||k||g||t)e="display: block;";var r=d.getAttributeNS(s,"transform"),p,l,n;r&&(f=function(b){(p=r.match(new RegExp(b+"(.*?)\\((.*?)\\)","i")))&&
p[2]&&(l=parseFloat(p[2]),isNaN(l)||(arr2=180/Math.PI*l*-1,-360<=arr2&&360>=arr2&&(n+=b+"("+arr2.toFixed(2)+"deg) ")))},n="",(p=r.match(/translate(.*?)\((.*?)\)/i))&&p[2]&&(l=p[2].trim().split(" "),2!=l.length&&(l=p[2].trim().split(",")),2==l.length&&(e="position: absolute;",n+="translate("+l[0]+","+l[1]+") ")),f("rotate"),f("skewX"),n&&(e+="transform: "+n+"; -webkit-transform: "+n+"; transform-origin: left top; -webkit-transform-origin: left top;"));"custom-shape"==d.localName&&(e+="border-width: 0.028cm; ",
!gdocumentType&&godfcontainer&&(gdocumentType=godfcontainer.getDocumentType()),"presentation"==gdocumentType&&w.getDirectChild(d,G,"title")&&(e+="background-color: transparent; "));c&&(e+="left: "+c+";");m&&(e+="top: "+m+";");h&&(e+="width: "+h+";");k&&(e+="height: "+k+";");g&&(e+="min-height: "+g+";");t&&(e+="min-width: "+t+";");e&&(e="draw|"+d.localName+'[webodfhelper|styleid="'+b+'"] {'+e+"}",a.insertRule(e,a.cssRules.length));!gdocumentType&&godfcontainer&&(gdocumentType=godfcontainer.getDocumentType());
m&&k&&"text"==gdocumentType&&(m=gstyleParseUtils.parseLength(m),k=gstyleParseUtils.parseLength(k),m=parseInt(m+k),!isNaN(m)&&document.getElementsByTagName("document")[0]&&m>document.getElementsByTagName("document")[0].clientHeight&&a.insertRule("office|document{height: "+(m+15)+"px;}",a.cssRules.length))}function h(b){for(b=b.firstChild;b;){if(b.namespaceURI===u&&"binary-data"===b.localName)return"data:image/png;base64,"+b.textContent.replace(/[\r\n\s]/g,"");b=b.nextSibling}return""}function q(b,
d,a,e){function f(d){d&&(d='draw|image[webodfhelper|styleid="'+b+'"] {'+("background-image: url("+d+");")+"}",e.insertRule(d,e.cssRules.length))}function c(b){f(b.url)}a.setAttributeNS("urn:webodf:names:helper","styleid",b);var m=a.getAttributeNS(E,"href"),k;if(m)try{k=d.getPart(m),k.onchange=c,k.load()}catch(g){runtime.log("slight problem: "+String(g))}else m=h(a),f(m)}function b(b){var d=b.ownerDocument;w.getElementsByTagNameNS(b,C,"line-break").forEach(function(b){b.hasChildNodes()||b.appendChild(d.createElement("br"))})}
function d(b){var d=b.ownerDocument;w.getElementsByTagNameNS(b,C,"s").forEach(function(b){for(var a,e;b.firstChild;)b.removeChild(b.firstChild);b.appendChild(d.createTextNode(" "));e=parseInt(b.getAttributeNS(C,"c"),10);if(1<e)for(b.removeAttributeNS(C,"c"),a=1;a<e;a+=1)b.parentNode.insertBefore(b.cloneNode(!0),b)})}function m(b){w.getElementsByTagNameNS(b,C,"tab").forEach(function(b){b.textContent="\t"})}function r(b,d){function a(b,e,m){e||(e="");var h=k.documentElement.namespaceURI;m||"video/"===
e.substr(0,6)?(f=k.createElementNS(h,"video"),f.setAttribute("controls","controls"),c=k.createElementNS(h,"source"),b&&c.setAttribute("src",b),e&&c.setAttribute("type",e),f.appendChild(c),d.parentNode.appendChild(f)):d.innerHTML="<br>&nbsp;Unrecognised Plugin"}function e(b,f){f&&0<=(f+"").indexOf("not found")?d.innerHTML="<br>&nbsp;Media File Not Found.":a(b.url,b.mimetype)}var f,c,m,k=d.ownerDocument,g;if(m=d.getAttributeNS(E,"href"))if(0==m.indexOf("http"))a(m,"",!0);else try{g=b.getPart(m),g.onchange=
e,g.load()}catch(t){runtime.log("slight problem: "+String(t))}else runtime.log("using MP4 data fallback"),m=h(d),a(m,"video/mp4")}function A(b){var d=b.getElementsByTagName("head")[0],a,e;a=b.styleSheets.length;for(e=d.firstElementChild;e&&("style"!==e.localName||!e.hasAttribute("webodfcss"));)e=e.nextElementSibling;if(e)return a=parseInt(e.getAttribute("webodfcss"),10),e.setAttribute("webodfcss",a+1),e;"string"===String(typeof webodf_css)?a=webodf_css:(e="webodf.css",runtime.currentDirectory&&(e=
runtime.currentDirectory(),0<e.length&&"/"!==e.substr(-1)&&(e+="/"),e+="../webodf.css"),a=runtime.readFileSync(e,"utf-8"));e=b.createElementNS(d.namespaceURI,"style");e.setAttribute("media","screen, print, handheld, projection");e.setAttribute("type","text/css");e.setAttribute("webodfcss","1");e.appendChild(b.createTextNode(a));d.appendChild(e);return e}function y(b){var d=parseInt(b.getAttribute("webodfcss"),10);1===d?b.parentNode.removeChild(b):b.setAttribute("count",d-1)}function v(b){var d=b.getElementsByTagName("head")[0],
a=b.createElementNS(d.namespaceURI,"style"),e="";a.setAttribute("type","text/css");a.setAttribute("media","screen, print, handheld, projection");odf.Namespaces.forEachPrefix(function(b,d){e+="@namespace "+b+" url("+d+");\n"});e+="@namespace webodfhelper url(urn:webodf:names:helper);\n";a.appendChild(b.createTextNode(e));d.appendChild(a);return a}var s=odf.Namespaces.drawns,B=odf.Namespaces.fons,u=odf.Namespaces.officens,z=odf.Namespaces.stylens,G=odf.Namespaces.svgns,H=odf.Namespaces.tablens,C=odf.Namespaces.textns,
E=odf.Namespaces.xlinkns,t=odf.Namespaces.presentationns,x=xmldom.XPath,w=core.DomUtils;odf.OdfCanvas=function(h,D){function I(b,d,a){function e(b,d,a,f){ma.addToQueue(function(){q(b,d,a,f)})}function f(){var b,d;document.body.getElementsByTagNameNS("http://www.w3.org/1998/Math/MathML","math")[0]&&(document.body.insertAdjacentHTML("afterbegin","<div style='border: 0; clip: rect(0 0 0 0); height: 1px; margin: -1px; overflow: hidden; padding: 0; position: absolute; width: 1px;'><math xmlns='http://www.w3.org/1998/Math/MathML'><mspace height='23px' width='77px'></mspace></math></div>"),
d=document.body.firstChild,b=d.firstChild.firstChild.getBoundingClientRect(),document.body.removeChild(d),1<Math.abs(b.height-23)||1<Math.abs(b.width-77))&&(b=document.createElement("link"),b.href="//iblogbox.github.io/js/odfviewer/mathml.css",b.rel="stylesheet",document.head.appendChild(b))}function c(d){d>h.length-1?M&&f():(g=h.item(d),(r=g.getAttributeNS(E,"href"))?b.getPartData2(r+"/content.xml",function(f,m){m&&0<=m.indexOf("</math>")?(M=!0,m=m.replace(/<\?xml(.*?)\?>/gi,""),w=document.createElement("span"),
w.setAttribute("style","white-space:nowrap;"),w.innerHTML=m,g.parentNode.insertBefore(w,g)):(k=g.parentNode.getElementsByTagNameNS(s,"image"))&&k[0]&&(r=k[0].getAttributeNS(E,"href")||"",0!=r.indexOf("ObjectReplacements/")&&0!=r.indexOf("./ObjectReplacements/")||e("image2"+String(d),b,k[0],a));c(d+1)}):c(d+1))}var m,h,k,g,r;h=d.getElementsByTagNameNS(s,"image");for(m=0;m<h.length;m+=1)g=h.item(m),r=g.getAttributeNS(E,"href")||"",0!=r.indexOf("ObjectReplacements/")&&0!=r.indexOf("./ObjectReplacements/")&&
e("image"+String(m),b,g,a);var p,l,w,M=!1;h=d.getElementsByTagNameNS(s,"object");c(0);!gdocumentType&&godfcontainer&&(gdocumentType=godfcontainer.getDocumentType());if("presentation"==gdocumentType&&document.getElementsByTagName("document")[0]&&2E3>document.getElementsByTagName("document")[0].clientWidth){var n=function(b){w=document.createElement("canvas");w.setAttribute("style","border:0px solid red; left:0px; top:0px; position: absolute; background: transparent;");w.width=z;w.height=z+Math.floor(.4*
z);b.parentNode.insertBefore(w,b.nextSibling);u=w.getContext("2d");console.log("Canvas Created.")},u,A,x,D,I,z=document.getElementsByTagName("document")[0].clientWidth;h=d.getElementsByTagNameNS(s,"g");for(m=0;m<h.length;m+=1)for(u="",g=h.item(m),p=findChildNode(g,s,"line"),l=0;l<p.length;l+=1)0!=l||u||n(g),A=p[l].getAttributeNS(G,"x1"),x=p[l].getAttributeNS(G,"y1"),D=p[l].getAttributeNS(G,"x2"),I=p[l].getAttributeNS(G,"y2"),A=parseInt(gstyleParseUtils.parseLength(A)),x=parseInt(gstyleParseUtils.parseLength(x)),
D=parseInt(gstyleParseUtils.parseLength(D)),I=parseInt(gstyleParseUtils.parseLength(I)),u.beginPath(),u.moveTo(A,x),u.lineTo(D,I),u.stroke()}if("presentation"==gdocumentType){ghyperlinkTooltipView||(ghyperlinkTooltipView=new gui.HyperlinkTooltipView(ba));h=d.getElementsByTagNameNS(C,"a");for(m=0;m<h.length;m+=1)if(g=h.item(m),p=(g.getAttributeNS(E,"href")||"").toLowerCase().trim())g.addEventListener("click",function(){window.open(this.getAttributeNS(E,"href"))}),g.addEventListener("mousemove",function(b){ghyperlinkTooltipView&&
ghyperlinkTooltipView.showTooltip(b)}),g.addEventListener("mouseout",function(){ghyperlinkTooltipView&&ghyperlinkTooltipView.hideTooltip()});h=d.getElementsByTagNameNS(t,"date-time-decl");for(m=0;m<h.length;m+=1)g=h.item(m),g.parentNode.removeChild(g)}}function B(b,d){function a(b,d){ma.addToQueue(function(){r(b,d)})}var e,f,c;f=d.getElementsByTagNameNS(s,"plugin");for(e=0;e<f.length;e+=1)c=f.item(e),a(b,c)}function K(){var b;b=W.firstChild;var d=ga.getZoomLevel();b&&(W.style.WebkitTransformOrigin=
"0% 0%",W.style.MozTransformOrigin="0% 0%",W.style.msTransformOrigin="0% 0%",W.style.OTransformOrigin="0% 0%",W.style.transformOrigin="0% 0%",S&&((b=S.getMinimumHeightForAnnotationPane())?W.style.minHeight=b:W.style.removeProperty("min-height")),h.style.width=Math.round(d*W.offsetWidth)+"px",h.style.height=Math.round(d*W.offsetHeight)+"px",h.style.display="inline-block")}function F(a,f){var c=R.sheet;g(h);W=ca.createElementNS(h.namespaceURI,"div");W.style.display="inline-block";W.style.background=
"white";W.style.setProperty("float","left","important");W.appendChild(f);h.appendChild(W);fa=ca.createElementNS(h.namespaceURI,"div");fa.id="annotationsPane";Z=ca.createElementNS(h.namespaceURI,"div");Z.id="shadowContent";Z.style.position="absolute";Z.style.top=0;Z.style.left=0;a.getContentElement().appendChild(Z);var k=f.body,r,l=[],q;for(r=k.firstElementChild;r&&r!==k;)if(r.namespaceURI===s&&(l[l.length]=r),r.firstElementChild)r=r.firstElementChild;else{for(;r&&r!==k&&!r.nextElementSibling;)r=r.parentNode;
r&&r.nextElementSibling&&(r=r.nextElementSibling)}for(q=0;q<l.length;q+=1)r=l[q],n("frame"+String(q),r,c);l=x.getODFElementsWithXPath(k,".//*[*[@text:anchor-type='paragraph']]",odf.Namespaces.lookupNamespaceURI);for(r=0;r<l.length;r+=1)k=l[r],k.setAttributeNS&&k.setAttributeNS("urn:webodf:names:helper","containsparagraphanchor",!0);k=Y;r=Z;var A,D,y,E,v=0,Q;q=a.rootElement.ownerDocument;if((l=f.body.firstElementChild)&&l.namespaceURI===u&&("presentation"===l.localName||"drawing"===l.localName))for(l=
l.firstElementChild;l;){if(A=(A=l.getAttributeNS(s,"master-page-name"))?k.getMasterPageElement(A):null){D=l.getAttributeNS("urn:webodf:names:helper","styleid");y=q.createElementNS(s,"draw:page");Q=A.firstElementChild;for(v=0;Q;)"true"!==Q.getAttributeNS(t,"placeholder")&&(E=Q.cloneNode(!0),y.appendChild(E)),Q=Q.nextElementSibling,v+=1;Q=E=v=void 0;for(var K=w.getElementsByTagNameNS(y,s,"frame"),v=0;v<K.length;v+=1)E=K[v],(Q=E.getAttributeNS(t,"class"))&&!/^(date-time|footer|header|page-number)$/.test(Q)&&
E.parentNode.removeChild(E);E=w.getElementsByTagNameNS(y,s,"*");for(v=0;v<E.length;v+=1)n(D+"_"+v,E[v],c);r.appendChild(y);v=String(r.getElementsByTagNameNS(s,"page").length);p(y,C,"page-number",v);p(y,t,"header",e(a,l,"header"));p(y,t,"footer",e(a,l,"footer"));n(D,y,c);y.setAttributeNS("urn:webodf:names:helper","page-style-name",l.getAttributeNS(s,"style-name"));y.setAttributeNS(s,"draw:master-page-name",A.getAttributeNS(z,"name"))}l=l.nextElementSibling}k=f.body;q=w.getElementsByTagNameNS(k,H,"table-cell");
for(r=0;r<q.length;r+=1)if(A=q[r],A.hasAttributeNS(H,"number-columns-repeated")&&(D=A.getAttributeNS(H,"number-columns-repeated"),!(100<D)))for(l=1;l<D;l++)A.parentNode.insertBefore(A.cloneNode(!0),A.nextSibling);q=w.getElementsByTagNameNS(k,H,"covered-table-cell");for(r=0;r<q.length;r+=1)if(A=q[r],D=A.hasAttributeNS(H,"number-columns-repeated")?A.getAttributeNS(H,"number-columns-repeated"):1,!(100<D)){for(l=0;l<D;l++)y=document.createElementNS(H,"table:table-cell"),A.parentNode.insertBefore(y,A);
A.parentNode.removeChild(A)}q=w.getElementsByTagNameNS(k,s,"control");for(r=0;r<q.length;r+=1)A=q[r],A.parentNode.removeChild(A);b(f.body);d(f.body);m(f.body);I(a,f.body,c);B(a,f.body);W.insertBefore(Z,W.firstChild);ga.setZoomableElement(W)}function U(b){ha?(fa.parentNode||W.appendChild(fa),S&&S.forgetAnnotations(),S=new gui.AnnotationViewManager(ba,b.body,fa,X),w.getElementsByTagNameNS(b.body,u,"annotation").forEach(S.addAnnotation),S.rerenderAnnotations(),K()):fa.parentNode&&(W.removeChild(fa),
S.forgetAnnotations(),K())}function $(b){function d(){a(N);a(aa);a(R);g(h);h.style.display="inline-block";var e=L.rootElement;h.ownerDocument.importNode(e,!0);Y.setOdfContainer(L);k(L,N);f(L,Y,aa);F(L,e);U(e);b||ma.addToQueue(function(){var b=[L];if(da.hasOwnProperty("statereadychange")){var d=da.statereadychange,a;for(a=0;a<d.length;a+=1)d[a].apply(null,b)}})}L.state===odf.OdfContainer.DONE?d():(runtime.log("WARNING: refreshOdf called but ODF was not DONE."),pa=runtime.setTimeout(function V(){L.state===
odf.OdfContainer.DONE?d():(g_errmsg(),pa=runtime.setTimeout(V,1E3))},300))}function Q(b){ma.clearQueue();h.innerHTML=runtime.tr("Loading")+"...";h.removeAttribute("style");godfcontainer=L=new odf.OdfContainer(b,function(b){L=b;$(!1)})}runtime.assert(null!==h&&void 0!==h,"odf.OdfCanvas constructor needs DOM element");runtime.assert(null!==h.ownerDocument&&void 0!==h.ownerDocument,"odf.OdfCanvas constructor needs DOM");var ba=this,ca=h.ownerDocument,L,Y=new odf.Formatting,ea,W=null,fa=null,ha=!1,X=
!1,S=null,T,N,aa,R,Z,da={},pa,ka,ia=!1,la=!1,ma=new l,ga=new gui.ZoomHelper,ja=D||new gui.SingleScrollViewport(h.parentNode);this.refreshCSS=function(){ia=!0;ka.trigger()};this.refreshSize=function(){ka.trigger()};this.odfContainer=function(){return L};this.setOdfContainer=function(b,d){L=b;$(!0===d)};this.load=this.load=Q;this.save=function(b){L.save(b)};this.addListener=function(b,d){switch(b){case "click":var a=b;h.addEventListener?h.addEventListener(a,d,!1):h.attachEvent?h.attachEvent("on"+a,
d):h["on"+a]=d;break;default:a=da.hasOwnProperty(b)?da[b]:da[b]=[],d&&-1===a.indexOf(d)&&a.push(d)}};this.getFormatting=function(){return Y};this.getAnnotationViewManager=function(){return S};this.refreshAnnotations=function(){U(L.rootElement)};this.rerenderAnnotations=function(){S&&(la=!0,ka.trigger())};this.getSizer=function(){return W};this.enableAnnotations=function(b,d){b!==ha&&(ha=b,X=d,L&&U(L.rootElement))};this.addAnnotation=function(b){S&&(S.addAnnotation(b),K())};this.forgetAnnotations=
function(){S&&(S.forgetAnnotations(),K())};this.getZoomHelper=function(){return ga};this.setZoomLevel=function(b){ga.setZoomLevel(b)};this.getZoomLevel=function(){return ga.getZoomLevel()};this.fitToContainingElement=function(b,d){var a=ga.getZoomLevel(),e=h.offsetHeight/a,a=b/(h.offsetWidth/a);d/e<a&&(a=d/e);ga.setZoomLevel(a)};this.fitToWidth=function(b){var d=h.offsetWidth/ga.getZoomLevel();ga.setZoomLevel(b/d)};this.fitSmart=function(b,d){var a,e;e=ga.getZoomLevel();a=h.offsetWidth/e;e=h.offsetHeight/
e;a=b/a;void 0!==d&&d/e<a&&(a=d/e);ga.setZoomLevel(Math.min(1,a))};this.fitToHeight=function(b){var d=h.offsetHeight/ga.getZoomLevel();ga.setZoomLevel(b/d)};this.showFirstPage=function(){ea.showFirstPage()};this.showNextPage=function(){ea.showNextPage()};this.showPreviousPage=function(){ea.showPreviousPage()};this.showPage=function(b){ea.showPage(b);godfcontainer&&"spreadsheet"==godfcontainer.getDocumentType()||K()};this.getElement=function(){return h};this.getViewport=function(){return ja};this.addCssForFrameWithImage=
function(b){var d=b.getAttributeNS(s,"name"),a=b.firstElementChild;n(d,b,R.sheet);a&&q(d+"img",L,a,R.sheet)};this.destroy=function(b){var d=ca.getElementsByTagName("head")[0],a=[ea.destroy,ka.destroy];runtime.clearTimeout(pa);fa&&fa.parentNode&&fa.parentNode.removeChild(fa);ga.destroy(function(){W&&(h.removeChild(W),W=null)});y(T);d.removeChild(N);d.removeChild(aa);d.removeChild(R);core.Async.destroyAll(a,b)};T=A(ca);ea=new c(v(ca));N=v(ca);aa=v(ca);R=v(ca);ka=core.Task.createRedrawTask(function(){ia&&
(f(L,Y,aa),ia=!1);la&&(S&&S.rerenderAnnotations(),la=!1);K()});ga.subscribe(gui.ZoomHelper.signalZoomChanged,K)}})();
odf.StepUtils=function(){this.getContentBounds=function(l){var c=l.container(),g,a;runtime.assert(l.isStep(),"Step iterator must be on a step");c.nodeType===Node.TEXT_NODE&&0<l.offset()?g=l.offset():(c=l.leftNode())&&c.nodeType===Node.TEXT_NODE&&(g=c.length);c&&(c.nodeType===Node.TEXT_NODE?(runtime.assert(0<g,"Empty text node found"),a={container:c,startOffset:g-1,endOffset:g}):a={container:c,startOffset:0,endOffset:c.childNodes.length});return a}};
ops.MemberProperties=function(){this.fullName;this.color;this.imageUrl};
ops.Member=function(l,c){var g=new ops.MemberProperties;this.getMemberId=function(){return l};this.getProperties=function(){return g};this.setProperties=function(a){Object.keys(a).forEach(function(f){g[f]=a[f]})};this.removeProperties=function(a){Object.keys(a).forEach(function(a){"fullName"!==a&&"color"!==a&&"imageUrl"!==a&&g.hasOwnProperty(a)&&delete g[a]})};runtime.assert(Boolean(l),"No memberId was supplied!");c.fullName||(c.fullName=runtime.tr("Unknown Author"));c.color||(c.color="black");c.imageUrl||
(c.imageUrl="avatar-joe.png");g=c};ops.Document=function(){};ops.Document.prototype.getMemberIds=function(){};ops.Document.prototype.removeCursor=function(l){};ops.Document.prototype.getDocumentElement=function(){};ops.Document.prototype.getRootNode=function(){};ops.Document.prototype.getDOMDocument=function(){};ops.Document.prototype.cloneDocumentElement=function(){};ops.Document.prototype.setDocumentElement=function(l){};ops.Document.prototype.subscribe=function(l,c){};
ops.Document.prototype.unsubscribe=function(l,c){};ops.Document.prototype.getCanvas=function(){};ops.Document.prototype.createRootFilter=function(l){};ops.Document.prototype.createPositionIterator=function(l){};ops.Document.signalCursorAdded="cursor/added";ops.Document.signalCursorRemoved="cursor/removed";ops.Document.signalCursorMoved="cursor/moved";ops.Document.signalMemberAdded="member/added";ops.Document.signalMemberUpdated="member/updated";ops.Document.signalMemberRemoved="member/removed";
ops.OdtCursor=function(l,c){var g=this,a={},f,k,e=new core.EventNotifier([ops.OdtCursor.signalCursorUpdated]);this.removeFromDocument=function(){k.remove()};this.subscribe=function(a,f){e.subscribe(a,f)};this.unsubscribe=function(a,f){e.unsubscribe(a,f)};this.getMemberId=function(){return l};this.getNode=function(){return k.getNode()};this.getAnchorNode=function(){return k.getAnchorNode()};this.getSelectedRange=function(){return k.getSelectedRange()};this.setSelectedRange=function(a,f){k.setSelectedRange(a,
f);e.emit(ops.OdtCursor.signalCursorUpdated,g)};this.hasForwardSelection=function(){return k.hasForwardSelection()};this.getDocument=function(){return c};this.getSelectionType=function(){return f};this.setSelectionType=function(e){a.hasOwnProperty(e)?f=e:runtime.log("Invalid selection type: "+e)};this.resetSelectionType=function(){g.setSelectionType(ops.OdtCursor.RangeSelection)};k=new core.Cursor(c.getDOMDocument(),l);a[ops.OdtCursor.RangeSelection]=!0;a[ops.OdtCursor.RegionSelection]=!0;g.resetSelectionType()};
ops.OdtCursor.RangeSelection="Range";ops.OdtCursor.RegionSelection="Region";ops.OdtCursor.signalCursorUpdated="cursorUpdated";
(function(){var l=0;ops.StepsCache=function(c,g,a){function f(b,d){var e=this;this.nodeId=b;this.steps=-1;this.node=d;this.previousBookmark=this.nextBookmark=null;this.setIteratorPosition=function(b){b.setPositionBeforeElement(d);a(e.steps,b)}}function k(b,d,e){var f=this;this.nodeId=b;this.steps=d;this.node=e;this.previousBookmark=this.nextBookmark=null;this.setIteratorPosition=function(b){b.setUnfilteredPosition(e,0);a(f.steps,b)}}function e(b,d){var a="["+b.nodeId;d&&(a+=" => "+d.nodeId);return a+
"]"}function p(){for(var b=y,d,a,f,h=new core.LoopWatchDog(0,1E5),k={};b;){h.check();(d=b.previousBookmark)?runtime.assert(d.nextBookmark===b,"Broken bookmark link to previous @"+e(d,b)):(runtime.assert(b===y,"Broken bookmark link @"+e(b)),runtime.assert(void 0===v||y===y||y.steps<=v,"Base point is damaged @"+e(b)));(a=b.nextBookmark)&&runtime.assert(a.previousBookmark===b,"Broken bookmark link to next @"+e(b,a));if(void 0===v||b===y||b.steps<=v)runtime.assert(A.containsNode(c,b.node),"Disconnected node is being reported as undamaged @"+
e(b)),d&&(f=b.node.compareDocumentPosition(d.node),runtime.assert(0===f||0!==(f&B),"Bookmark order with previous does not reflect DOM order @"+e(d,b))),a&&A.containsNode(c,a.node)&&(f=b.node.compareDocumentPosition(a.node),runtime.assert(0===f||0!==(f&s),"Bookmark order with next does not reflect DOM order @"+e(b,a)));b=b.nextBookmark}Object.keys(m).forEach(function(b){var d=m[b];(void 0===v||b<=v)&&runtime.assert(d.steps<=b,"Bookmark step of "+d.steps+" exceeds cached step lookup for "+b+" @"+e(d));
runtime.assert(!1===k.hasOwnProperty(d.nodeId),"Bookmark "+e(d)+" appears twice in cached step lookup at steps "+k[d.nodeId]+" and "+b);k[d.nodeId]=b})}function n(b){var d="";b.nodeType===Node.ELEMENT_NODE&&(d=b.getAttributeNS("urn:webodf:names:steps","nodeId")||"");return d}function h(b){var d=l.toString();b.setAttributeNS("urn:webodf:names:steps","nodeId",d);l+=1;return d}function q(b){var d,a,f=new core.LoopWatchDog(0,1E4);void 0!==v&&b>v&&(b=v);for(d=Math.floor(b/g)*g;!a&&0<=d;)a=m[d],d-=g;for(a=
a||y;a.nextBookmark&&a.nextBookmark.steps<=b;)f.check(),a=a.nextBookmark;runtime.assert(-1===b||a.steps<=b,"Bookmark @"+e(a)+" at step "+a.steps+" exceeds requested step of "+b);return a}function b(b){b.previousBookmark&&(b.previousBookmark.nextBookmark=b.nextBookmark);b.nextBookmark&&(b.nextBookmark.previousBookmark=b.previousBookmark)}function d(b){for(var d,a=null;!a&&b&&b!==c;)(d=n(b))&&(a=r[d])&&a.node!==b&&(runtime.log("Cloned node detected. Creating new bookmark"),a=null,b.removeAttributeNS("urn:webodf:names:steps",
"nodeId")),b=b.parentNode;return a}var m={},r={},A=core.DomUtils,y,v,s=Node.DOCUMENT_POSITION_FOLLOWING,B=Node.DOCUMENT_POSITION_PRECEDING,u;this.updateBookmark=function(d,a){var e,k=Math.ceil(d/g)*g,l,t,p;if(void 0!==v&&v<d){l=q(v);for(t=l.nextBookmark;t&&t.steps<=d;)e=t.nextBookmark,p=Math.ceil(t.steps/g)*g,m[p]===t&&delete m[p],A.containsNode(c,t.node)?t.steps=d+1:(b(t),delete r[t.nodeId]),t=e;v=d}else l=q(d);t=n(a)||h(a);e=r[t];e?e.node!==a&&(runtime.log("Cloned node detected. Creating new bookmark"),
t=h(a),e=r[t]=new f(t,a)):e=r[t]=new f(t,a);t=e;t.steps!==d&&(e=Math.ceil(t.steps/g)*g,e!==k&&m[e]===t&&delete m[e],t.steps=d);if(l!==t&&l.nextBookmark!==t){if(l.steps===t.steps)for(;0!==(t.node.compareDocumentPosition(l.node)&s)&&l!==y;)l=l.previousBookmark;l!==t&&l.nextBookmark!==t&&(b(t),e=l.nextBookmark,t.nextBookmark=l.nextBookmark,t.previousBookmark=l,l.nextBookmark=t,e&&(e.previousBookmark=t))}l=m[k];if(!l||t.steps>l.steps)m[k]=t;u()};this.setToClosestStep=function(b,d){var a;u();a=q(b);a.setIteratorPosition(d);
return a.steps};this.setToClosestDomPoint=function(b,a,e){var f,h;u();if(b===c&&0===a)f=y;else if(b===c&&a===c.childNodes.length)for(h in f=y,m)m.hasOwnProperty(h)&&(b=m[h],b.steps>f.steps&&(f=b));else if(f=d(b.childNodes.item(a)||b),!f)for(e.setUnfilteredPosition(b,a);!f&&e.previousNode();)f=d(e.getCurrentNode());f=f||y;void 0!==v&&f.steps>v&&(f=q(v));f.setIteratorPosition(e);return f.steps};this.damageCacheAfterStep=function(b){0>b&&(b=-1);void 0===v?v=b:b<v&&(v=b);u()};(function(){var b=n(c)||
h(c);y=new k(b,0,c);u=ops.StepsCache.ENABLE_CACHE_VERIFICATION?p:function(){}})()};ops.StepsCache.ENABLE_CACHE_VERIFICATION=!1;ops.StepsCache.Bookmark=function(){};ops.StepsCache.Bookmark.prototype.nodeId;ops.StepsCache.Bookmark.prototype.node;ops.StepsCache.Bookmark.prototype.steps;ops.StepsCache.Bookmark.prototype.previousBookmark;ops.StepsCache.Bookmark.prototype.nextBookmark;ops.StepsCache.Bookmark.prototype.setIteratorPosition=function(c){}})();
(function(){ops.OdtStepsTranslator=function(l,c,g,a){function f(b,d,a){var e=d.getCurrentNode();d.isBeforeNode()&&q.isParagraph(e)&&(a||(b+=1),h.updateBookmark(b,e))}function k(b,d){do{if(g.acceptPosition(d)===m){f(b,d,!0);break}f(b-1,d,!1)}while(d.nextPosition())}function e(){var b=l();b!==n&&(n&&runtime.log("Undo detected. Resetting steps cache"),n=b,h=new ops.StepsCache(n,a,k),d=c(n))}function p(b,d){if(!d||g.acceptPosition(b)===m)return!0;for(;b.previousPosition();)if(g.acceptPosition(b)===m){if(d(r,
b.container(),b.unfilteredDomOffset()))return!0;break}for(;b.nextPosition();)if(g.acceptPosition(b)===m){if(d(A,b.container(),b.unfilteredDomOffset()))return!0;break}return!1}var n,h,q=odf.OdfUtils,b=core.DomUtils,d,m=core.PositionFilter.FilterResult.FILTER_ACCEPT,r=core.StepDirection.PREVIOUS,A=core.StepDirection.NEXT;this.convertStepsToDomPoint=function(b){var a,c;if(isNaN(b))throw new TypeError("Requested steps is not numeric ("+b+")");if(0>b)throw new RangeError("Requested steps is negative ("+
b+")");e();for(a=h.setToClosestStep(b,d);a<b&&d.nextPosition();)(c=g.acceptPosition(d)===m)&&(a+=1),f(a,d,c);if(a!==b)throw new RangeError("Requested steps ("+b+") exceeds available steps ("+a+")");return{node:d.container(),offset:d.unfilteredDomOffset()}};this.convertDomPointToSteps=function(a,c,k){var r;e();b.containsNode(n,a)||(c=0>b.comparePoints(n,0,a,c),a=n,c=c?0:n.childNodes.length);d.setUnfilteredPosition(a,c);p(d,k)||d.setUnfilteredPosition(a,c);k=d.container();c=d.unfilteredDomOffset();
a=h.setToClosestDomPoint(k,c,d);if(0>b.comparePoints(d.container(),d.unfilteredDomOffset(),k,c))return 0<a?a-1:a;for(;(d.container()!==k||d.unfilteredDomOffset()!==c)&&d.nextPosition();)(r=g.acceptPosition(d)===m)&&(a+=1),f(a,d,r);return a+0};this.prime=function(){var b,a;e();for(b=h.setToClosestStep(0,d);d.nextPosition();)(a=g.acceptPosition(d)===m)&&(b+=1),f(b,d,a)};this.handleStepsInserted=function(b){e();h.damageCacheAfterStep(b.position)};this.handleStepsRemoved=function(b){e();h.damageCacheAfterStep(b.position-
1)};e()}})();ops.Operation=function(){};ops.Operation.prototype.init=function(l){};ops.Operation.prototype.isEdit;ops.Operation.prototype.group;ops.Operation.prototype.execute=function(l){};ops.Operation.prototype.spec=function(){};
ops.TextPositionFilter=function(){function l(a,g,l){var h,q;if(g){if(c.isInlineRoot(g)&&c.isGroupingElement(l))return k;h=c.lookLeftForCharacter(g);if(1===h||2===h&&(c.scanRightForAnyCharacter(l)||c.scanRightForAnyCharacter(c.nextNode(a))))return f}else if(c.isInlineRoot(a.previousSibling)&&c.isGroupingElement(a))return f;h=null===g&&c.isParagraph(a);q=c.lookRightForCharacter(l);if(h)return q?f:c.scanRightForAnyCharacter(l)?k:f;if(!q)return k;g=g||c.previousNode(a);return c.scanLeftForAnyCharacter(g)?
k:f}var c=odf.OdfUtils,g=Node.ELEMENT_NODE,a=Node.TEXT_NODE,f=core.PositionFilter.FilterResult.FILTER_ACCEPT,k=core.PositionFilter.FilterResult.FILTER_REJECT;this.acceptPosition=function(e){var p=e.container(),n=p.nodeType,h,q,b;if(n!==g&&n!==a)return k;if(n===a){n=e.unfilteredDomOffset();h=p.data;runtime.assert(n!==h.length,"Unexpected offset.");if(0<n){e=h[n-1];if(!c.isODFWhitespace(e))return f;if(1<n)if(e=h[n-2],!c.isODFWhitespace(e))q=f;else{if(!c.isODFWhitespace(h.substr(0,n)))return k}else b=
c.previousNode(p),c.scanLeftForNonSpace(b)&&(q=f);if(q===f)return c.isTrailingWhitespace(p,n)?k:f;q=h[n];return c.isODFWhitespace(q)?k:c.scanLeftForAnyCharacter(c.previousNode(p))?k:f}b=e.leftNode();q=p;p=p.parentNode;q=l(p,b,q)}else c.isGroupingElement(p)?(b=e.leftNode(),q=e.rightNode(),q=l(p,b,q)):q=k;return q}};
ops.OdtDocument=function(l){function c(b){return new core.PositionIterator(b,C,x,!1)}function g(){var b=l.odfContainer().getContentElement(),d=b&&b.localName;runtime.assert("text"===d,"Unsupported content element type '"+d+"' for OdtDocument");return b}function a(){return b.getDocumentElement().ownerDocument}function f(b){for(;b&&!(b.namespaceURI===odf.Namespaces.officens&&"text"===b.localName||b.namespaceURI===odf.Namespaces.officens&&"annotation"===b.localName);)b=b.parentNode;return b}function k(b){this.acceptPosition=
function(d){d=d.container();var a;a="string"===typeof b?A[b].getNode():b;return f(d)===f(a)?s:B}}function e(b,d,a,e){e=c(e);var f;1===a.length?f=a[0]:(f=new core.PositionFilterChain,a.forEach(f.addFilter));a=new core.StepIterator(f,e);a.setPosition(b,d);return a}function p(b){var d=c(g());b=G.convertStepsToDomPoint(b);d.setUnfilteredPosition(b.node,b.offset);return d}function n(b){return b===u}function h(b){var a,e=[],f,c=2;runtime.assert(b.isStep(),"positionIterator is not at a step");do{if(a=d.getContentBounds(b))if(a=
a.container,m.isDowngradableSpaceElement(a)){for(f=a.lastChild;a.firstChild;)e.push(a.firstChild),a.parentNode.insertBefore(a.firstChild,a);a.parentNode.removeChild(a);b.setPosition(f,f.nodeType===Node.TEXT_NODE?f.length:f.childNodes.length);b.roundToPreviousStep()}c-=1}while(0<c&&b.nextStep());e.forEach(r.normalizeTextNodes)}function q(b,d,a){b=b.childNodes.item(d)||b;return(b=m.getParagraphElement(b))&&r.containsNode(a,b)?b:a}var b=this,d,m=odf.OdfUtils,r=core.DomUtils,A={},y={},v=new core.EventNotifier([ops.Document.signalMemberAdded,
ops.Document.signalMemberUpdated,ops.Document.signalMemberRemoved,ops.Document.signalCursorAdded,ops.Document.signalCursorRemoved,ops.Document.signalCursorMoved,ops.OdtDocument.signalParagraphChanged,ops.OdtDocument.signalParagraphStyleModified,ops.OdtDocument.signalCommonStyleCreated,ops.OdtDocument.signalCommonStyleDeleted,ops.OdtDocument.signalTableAdded,ops.OdtDocument.signalOperationStart,ops.OdtDocument.signalOperationEnd,ops.OdtDocument.signalProcessingBatchStart,ops.OdtDocument.signalProcessingBatchEnd,
ops.OdtDocument.signalUndoStackChanged,ops.OdtDocument.signalStepsInserted,ops.OdtDocument.signalStepsRemoved,ops.OdtDocument.signalMetadataUpdated,ops.OdtDocument.signalAnnotationAdded]),s=core.PositionFilter.FilterResult.FILTER_ACCEPT,B=core.PositionFilter.FilterResult.FILTER_REJECT,u=core.StepDirection.NEXT,z,G,H,C=NodeFilter.SHOW_ALL,E=new gui.BlacklistNamespaceNodeFilter(["urn:webodf:names:cursor","urn:webodf:names:editinfo"]),t=new gui.OdfTextBodyNodeFilter,x=new core.NodeFilterChain([E,t]);
this.createPositionIterator=c;this.getDocumentElement=function(){return l.odfContainer().rootElement};this.getDOMDocument=function(){return this.getDocumentElement().ownerDocument};this.cloneDocumentElement=function(){var d=b.getDocumentElement(),a=l.getAnnotationViewManager();a&&a.forgetAnnotations();d=d.cloneNode(!0);l.refreshAnnotations();return d};this.setDocumentElement=function(b){var d=l.odfContainer();d.setRootElement(b);l.setOdfContainer(d,!0);l.refreshCSS()};this.getDOMDocument=a;this.getRootElement=
f;this.createStepIterator=e;this.getIteratorAtPosition=p;this.convertCursorStepToDomPoint=function(b){return G.convertStepsToDomPoint(b)};this.convertDomPointToCursorStep=function(b,d,a){var e;a===u&&(e=n);return G.convertDomPointToSteps(b,d,e)};this.convertDomToCursorRange=function(b){var d;d=G.convertDomPointToSteps(b.anchorNode,b.anchorOffset);b=b.anchorNode===b.focusNode&&b.anchorOffset===b.focusOffset?d:G.convertDomPointToSteps(b.focusNode,b.focusOffset);return{position:d,length:b-d}};this.convertCursorToDomRange=
function(b,d){var e=a().createRange(),f,c;f=G.convertStepsToDomPoint(b);d?(c=G.convertStepsToDomPoint(b+d),0<d?(e.setStart(f.node,f.offset),e.setEnd(c.node,c.offset)):(e.setStart(c.node,c.offset),e.setEnd(f.node,f.offset))):e.setStart(f.node,f.offset);return e};this.upgradeWhitespacesAtPosition=function(b){var a=p(b),a=new core.StepIterator(z,a),e,f=2;runtime.assert(a.isStep(),"positionIterator is not at a step (requested step: "+b+")");do{if(e=d.getContentBounds(a))if(b=e.container,e=e.startOffset,
b.nodeType===Node.TEXT_NODE&&m.isSignificantWhitespace(b,e)){runtime.assert(" "===b.data[e],"upgradeWhitespaceToElement: textNode.data[offset] should be a literal space");var c=b.ownerDocument.createElementNS(odf.Namespaces.textns,"text:s"),h=b.parentNode,k=b;c.appendChild(b.ownerDocument.createTextNode(" "));1===b.length?h.replaceChild(c,b):(b.deleteData(e,1),0<e&&(e<b.length&&b.splitText(e),k=b.nextSibling),h.insertBefore(c,k));b=c;a.setPosition(b,b.childNodes.length);a.roundToPreviousStep()}f-=
1}while(0<f&&a.nextStep())};this.downgradeWhitespaces=h;this.downgradeWhitespacesAtPosition=function(b){b=p(b);b=new core.StepIterator(z,b);h(b)};this.getTextNodeAtStep=function(d,e){var f=p(d),c=f.container(),m,h=0,k=null;c.nodeType===Node.TEXT_NODE?(m=c,h=f.unfilteredDomOffset(),0<m.length&&(0<h&&(m=m.splitText(h)),m.parentNode.insertBefore(a().createTextNode(""),m),m=m.previousSibling,h=0)):(m=a().createTextNode(""),h=0,c.insertBefore(m,f.rightNode()));if(e){if(A[e]&&b.getCursorPosition(e)===d){for(k=
A[e].getNode();k.nextSibling&&"cursor"===k.nextSibling.localName;)k.parentNode.insertBefore(k.nextSibling,k);0<m.length&&m.nextSibling!==k&&(m=a().createTextNode(""),h=0);k.parentNode.insertBefore(m,k)}}else for(;m.nextSibling&&"cursor"===m.nextSibling.localName;)m.parentNode.insertBefore(m.nextSibling,m);for(;m.previousSibling&&m.previousSibling.nodeType===Node.TEXT_NODE;)f=m.previousSibling,f.appendData(m.data),h=f.length,m=f,m.parentNode.removeChild(m.nextSibling);for(;m.nextSibling&&m.nextSibling.nodeType===
Node.TEXT_NODE;)f=m.nextSibling,m.appendData(f.data),m.parentNode.removeChild(f);return{textNode:m,offset:h}};this.fixCursorPositions=function(){Object.keys(A).forEach(function(d){var a=A[d],c=f(a.getNode()),m=b.createRootFilter(c),h,k,g,r=!1;g=a.getSelectedRange();h=q(g.startContainer,g.startOffset,c);k=e(g.startContainer,g.startOffset,[z,m],h);g.collapsed?c=k:(h=q(g.endContainer,g.endOffset,c),c=e(g.endContainer,g.endOffset,[z,m],h));k.isStep()&&c.isStep()?k.container()!==c.container()||k.offset()!==
c.offset()||g.collapsed&&a.getAnchorNode()===a.getNode()||(r=!0,g.setStart(k.container(),k.offset()),g.collapse(!0)):(r=!0,runtime.assert(k.roundToClosestStep(),"No walkable step found for cursor owned by "+d),g.setStart(k.container(),k.offset()),runtime.assert(c.roundToClosestStep(),"No walkable step found for cursor owned by "+d),g.setEnd(c.container(),c.offset()));r&&(a.setSelectedRange(g,a.hasForwardSelection()),b.emit(ops.Document.signalCursorMoved,a))})};this.getCursorPosition=function(b){return(b=
A[b])?G.convertDomPointToSteps(b.getNode(),0):0};this.getCursorSelection=function(b){b=A[b];var d=0,a=0;b&&(d=G.convertDomPointToSteps(b.getNode(),0),a=G.convertDomPointToSteps(b.getAnchorNode(),0));return{position:a,length:d-a}};this.getPositionFilter=function(){return z};this.getOdfCanvas=function(){return l};this.getCanvas=function(){return l};this.getRootNode=g;this.addMember=function(b){runtime.assert(void 0===y[b.getMemberId()],"This member already exists");y[b.getMemberId()]=b};this.getMember=
function(b){return y.hasOwnProperty(b)?y[b]:null};this.removeMember=function(b){delete y[b]};this.getCursor=function(b){return A[b]};this.getMemberIds=function(){var b=[],d;for(d in A)A.hasOwnProperty(d)&&b.push(A[d].getMemberId());return b};this.addCursor=function(d){runtime.assert(Boolean(d),"OdtDocument::addCursor without cursor");var a=d.getMemberId(),e=b.convertCursorToDomRange(0,0);runtime.assert("string"===typeof a,"OdtDocument::addCursor has cursor without memberid");runtime.assert(!A[a],
"OdtDocument::addCursor is adding a duplicate cursor with memberid "+a);d.setSelectedRange(e,!0);A[a]=d};this.removeCursor=function(d){var a=A[d];return a?(a.removeFromDocument(),delete A[d],b.emit(ops.Document.signalCursorRemoved,d),!0):!1};this.moveCursor=function(d,a,e,f){d=A[d];a=b.convertCursorToDomRange(a,e);d&&(d.setSelectedRange(a,0<=e),d.setSelectionType(f||ops.OdtCursor.RangeSelection))};this.getFormatting=function(){return l.getFormatting()};this.emit=function(b,d){v.emit(b,d)};this.subscribe=
function(b,d){v.subscribe(b,d)};this.unsubscribe=function(b,d){v.unsubscribe(b,d)};this.createRootFilter=function(b){return new k(b)};this.close=function(b){b()};this.destroy=function(b){b()};z=new ops.TextPositionFilter;d=new odf.StepUtils;G=new ops.OdtStepsTranslator(g,c,z,500);v.subscribe(ops.OdtDocument.signalStepsInserted,G.handleStepsInserted);v.subscribe(ops.OdtDocument.signalStepsRemoved,G.handleStepsRemoved);v.subscribe(ops.OdtDocument.signalOperationEnd,function(d){var a=d.spec(),e=a.memberid,
f=(new Date(a.timestamp)).toISOString(),c=l.odfContainer(),m={setProperties:{},removedProperties:[]};d.isEdit&&("UpdateMetadata"===a.optype&&(m.setProperties=JSON.parse(JSON.stringify(a.setProperties)),a.removedProperties&&(m.removedProperties=a.removedProperties.attributes.split(","))),a=b.getMember(e).getProperties().fullName,c.setMetadata({"dc:creator":a,"dc:date":f},null),m.setProperties["dc:creator"]=a,m.setProperties["dc:date"]=f,H||(m.setProperties["meta:editing-cycles"]=c.incrementEditingCycles(),
c.setMetadata(null,["meta:editing-duration","meta:document-statistic"])),H=d,b.emit(ops.OdtDocument.signalMetadataUpdated,m))});v.subscribe(ops.OdtDocument.signalProcessingBatchEnd,core.Task.processTasks)};ops.OdtDocument.signalParagraphChanged="paragraph/changed";ops.OdtDocument.signalTableAdded="table/added";ops.OdtDocument.signalCommonStyleCreated="style/created";ops.OdtDocument.signalCommonStyleDeleted="style/deleted";ops.OdtDocument.signalParagraphStyleModified="paragraphstyle/modified";
ops.OdtDocument.signalOperationStart="operation/start";ops.OdtDocument.signalOperationEnd="operation/end";ops.OdtDocument.signalProcessingBatchStart="router/batchstart";ops.OdtDocument.signalProcessingBatchEnd="router/batchend";ops.OdtDocument.signalUndoStackChanged="undo/changed";ops.OdtDocument.signalStepsInserted="steps/inserted";ops.OdtDocument.signalStepsRemoved="steps/removed";ops.OdtDocument.signalMetadataUpdated="metadata/updated";ops.OdtDocument.signalAnnotationAdded="annotation/added";
ops.OpAddAnnotation=function(){function l(a,e,f){var k=a.getTextNodeAtStep(f,c);k&&(a=k.textNode,f=a.parentNode,k.offset!==a.length&&a.splitText(k.offset),f.insertBefore(e,a.nextSibling),0===a.length&&f.removeChild(a))}var c,g,a,f,k,e;this.init=function(e){c=e.memberid;g=parseInt(e.timestamp,10);a=parseInt(e.position,10);f=parseInt(e.length,10)||0;k=e.name};this.isEdit=!0;this.group=void 0;this.execute=function(p){var n=p.getCursor(c),h,q;e=p.getDOMDocument();var b=new Date(g),d,m,r;d=e.createElementNS(odf.Namespaces.officens,
"office:annotation");d.setAttributeNS(odf.Namespaces.officens,"office:name",k);h=e.createElementNS(odf.Namespaces.dcns,"dc:creator");h.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",c);h.textContent=p.getMember(c).getProperties().fullName;q=e.createElementNS(odf.Namespaces.dcns,"dc:date");q.appendChild(e.createTextNode(b.toISOString()));b=e.createElementNS(odf.Namespaces.textns,"text:list");m=e.createElementNS(odf.Namespaces.textns,"text:list-item");r=e.createElementNS(odf.Namespaces.textns,
"text:p");m.appendChild(r);b.appendChild(m);d.appendChild(h);d.appendChild(q);d.appendChild(b);f&&(h=e.createElementNS(odf.Namespaces.officens,"office:annotation-end"),h.setAttributeNS(odf.Namespaces.officens,"office:name",k),d.annotationEndElement=h,l(p,h,a+f));l(p,d,a);p.emit(ops.OdtDocument.signalStepsInserted,{position:a});n&&(h=e.createRange(),q=d.getElementsByTagNameNS(odf.Namespaces.textns,"p")[0],h.selectNodeContents(q),n.setSelectedRange(h,!1),n.setSelectionType(ops.OdtCursor.RangeSelection),
p.emit(ops.Document.signalCursorMoved,n));p.getOdfCanvas().addAnnotation(d);p.fixCursorPositions();p.emit(ops.OdtDocument.signalAnnotationAdded,{memberId:c,annotation:d});return!0};this.spec=function(){return{optype:"AddAnnotation",memberid:c,timestamp:g,position:a,length:f,name:k}}};ops.OpAddAnnotation.Spec;ops.OpAddAnnotation.InitSpec;
ops.OpAddCursor=function(){var l,c;this.init=function(g){l=g.memberid;c=g.timestamp};this.isEdit=!1;this.group=void 0;this.execute=function(c){var a=c.getCursor(l);if(a)return!1;a=new ops.OdtCursor(l,c);c.addCursor(a);c.emit(ops.Document.signalCursorAdded,a);return!0};this.spec=function(){return{optype:"AddCursor",memberid:l,timestamp:c}}};ops.OpAddCursor.Spec;ops.OpAddCursor.InitSpec;
ops.OpAddMember=function(){var l,c,g;this.init=function(a){l=a.memberid;c=parseInt(a.timestamp,10);g=a.setProperties};this.isEdit=!1;this.group=void 0;this.execute=function(a){var f;if(a.getMember(l))return!1;f=new ops.Member(l,g);a.addMember(f);a.emit(ops.Document.signalMemberAdded,f);return!0};this.spec=function(){return{optype:"AddMember",memberid:l,timestamp:c,setProperties:g}}};ops.OpAddMember.Spec;ops.OpAddMember.InitSpec;
ops.OpAddStyle=function(){var l,c,g,a,f,k,e=odf.Namespaces.stylens;this.init=function(e){l=e.memberid;c=e.timestamp;g=e.styleName;a=e.styleFamily;f="true"===e.isAutomaticStyle||!0===e.isAutomaticStyle;k=e.setProperties};this.isEdit=!0;this.group=void 0;this.execute=function(c){var l=c.getOdfCanvas().odfContainer(),h=c.getFormatting(),q=c.getDOMDocument().createElementNS(e,"style:style");if(!q)return!1;k&&h.updateStyle(q,k);q.setAttributeNS(e,"style:family",a);q.setAttributeNS(e,"style:name",g);f?
l.rootElement.automaticStyles.appendChild(q):l.rootElement.styles.appendChild(q);c.getOdfCanvas().refreshCSS();f||c.emit(ops.OdtDocument.signalCommonStyleCreated,{name:g,family:a});return!0};this.spec=function(){return{optype:"AddStyle",memberid:l,timestamp:c,styleName:g,styleFamily:a,isAutomaticStyle:f,setProperties:k}}};ops.OpAddStyle.Spec;ops.OpAddStyle.InitSpec;
odf.ObjectNameGenerator=function(l,c){function g(b,d){var a={};this.generateName=function(){var e=d(),f=0,c;do c=b+f,f+=1;while(a[c]||e[c]);a[c]=!0;return c}}function a(){var b={};[l.rootElement.automaticStyles,l.rootElement.styles].forEach(function(d){for(d=d.firstElementChild;d;)d.namespaceURI===f&&"style"===d.localName&&(b[d.getAttributeNS(f,"name")]=!0),d=d.nextElementSibling});return b}var f=odf.Namespaces.stylens,k=odf.Namespaces.drawns,e=odf.Namespaces.xlinkns,p=(new core.Utils).hashString(c),
n=null,h=null,q=null,b={},d={};this.generateStyleName=function(){null===n&&(n=new g("auto"+p+"_",function(){return a()}));return n.generateName()};this.generateFrameName=function(){var d,a,e;if(null===h){a=l.rootElement.body.getElementsByTagNameNS(k,"frame");for(d=0;d<a.length;d+=1)e=a.item(d),b[e.getAttributeNS(k,"name")]=!0;h=new g("fr"+p+"_",function(){return b})}return h.generateName()};this.generateImageName=function(){var b,a,f;if(null===q){f=l.rootElement.body.getElementsByTagNameNS(k,"image");
for(b=0;b<f.length;b+=1)a=f.item(b),a=a.getAttributeNS(e,"href"),a=a.substring(9,a.lastIndexOf(".")),d[a]=!0;q=new g("img"+p+"_",function(){return d})}return q.generateName()}};
odf.TextStyleApplicator=function(l,c,g){function a(a){function e(b,a){return"object"===typeof b&&"object"===typeof a?Object.keys(b).every(function(f){return e(b[f],a[f])}):b===a}var b={};this.isStyleApplied=function(d){d=c.getAppliedStylesForElement(d,b).styleProperties;return e(a,d)}}function f(a){var e={};this.applyStyleToContainer=function(b){var d;d=b.getAttributeNS(p,"style-name");var f=b.ownerDocument;d=d||"";if(!e.hasOwnProperty(d)){var k=d,A;A=d?c.createDerivedStyleObject(d,"text",a):a;f=
f.createElementNS(n,"style:style");c.updateStyle(f,A);f.setAttributeNS(n,"style:name",l.generateStyleName());f.setAttributeNS(n,"style:family","text");f.setAttributeNS("urn:webodf:names:scope","scope","document-content");g.appendChild(f);e[k]=f}d=e[d].getAttributeNS(n,"name");b.setAttributeNS(p,"text:style-name",d)}}function k(a,f){var b=a.ownerDocument,d=a.parentNode,c,k,g,l=new core.LoopWatchDog(1E4);k=[];k.push(a);for(g=a.nextSibling;g&&e.rangeContainsNode(f,g);)l.check(),k.push(g),g=g.nextSibling;
"span"!==d.localName||d.namespaceURI!==p?(c=b.createElementNS(p,"text:span"),d.insertBefore(c,a),b=!1):(a.previousSibling&&!e.rangeContainsNode(f,d.firstChild)?(c=d.cloneNode(!1),d.parentNode.insertBefore(c,d.nextSibling)):c=d,b=!0);k.forEach(function(b){b.parentNode!==c&&c.appendChild(b)});if(g&&b)for(k=c.cloneNode(!1),c.parentNode.insertBefore(k,c.nextSibling);g;)l.check(),b=g.nextSibling,k.appendChild(g),g=b;return c}var e=core.DomUtils,p=odf.Namespaces.textns,n=odf.Namespaces.stylens;this.applyStyle=
function(e,c,b){var d={},m,g,l,p;runtime.assert(b&&b.hasOwnProperty("style:text-properties"),"applyStyle without any text properties");d["style:text-properties"]=b["style:text-properties"];l=new f(d);p=new a(d);e.forEach(function(b){m=p.isStyleApplied(b);!1===m&&(g=k(b,c),l.applyStyleToContainer(g))})}};
ops.OpApplyDirectStyling=function(){function l(a,f,k){var b=a.getOdfCanvas().odfContainer(),d=p.splitBoundaries(f),m=e.getTextNodes(f,!1);(new odf.TextStyleApplicator(new odf.ObjectNameGenerator(b,c),a.getFormatting(),b.rootElement.automaticStyles)).applyStyle(m,f,k);d.forEach(p.normalizeTextNodes)}var c,g,a,f,k,e=odf.OdfUtils,p=core.DomUtils;this.init=function(e){c=e.memberid;g=e.timestamp;a=parseInt(e.position,10);f=parseInt(e.length,10);k=e.setProperties};this.isEdit=!0;this.group=void 0;this.execute=
function(p){var h=p.convertCursorToDomRange(a,f),q=e.getParagraphElements(h);l(p,h,k);h.detach();p.getOdfCanvas().refreshCSS();p.fixCursorPositions();q.forEach(function(b){p.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:b,memberId:c,timeStamp:g})});p.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"ApplyDirectStyling",memberid:c,timestamp:g,position:a,length:f,setProperties:k}}};ops.OpApplyDirectStyling.Spec;ops.OpApplyDirectStyling.InitSpec;
ops.OpApplyHyperlink=function(){function l(a){for(;a;){if(p.isHyperlink(a))return!0;a=a.parentNode}return!1}var c,g,a,f,k,e=core.DomUtils,p=odf.OdfUtils;this.init=function(e){c=e.memberid;g=e.timestamp;a=e.position;f=e.length;k=e.hyperlink};this.isEdit=!0;this.group=void 0;this.execute=function(n){var h=n.getDOMDocument(),q=n.convertCursorToDomRange(a,f),b=e.splitBoundaries(q),d=[],m=p.getTextNodes(q,!1);if(0===m.length)return!1;m.forEach(function(b){var a=p.getParagraphElement(b);runtime.assert(!1===
l(b),"The given range should not contain any link.");var e=k,f=h.createElementNS(odf.Namespaces.textns,"text:a");f.setAttributeNS(odf.Namespaces.xlinkns,"xlink:type","simple");f.setAttributeNS(odf.Namespaces.xlinkns,"xlink:href",e);b.parentNode.insertBefore(f,b);f.appendChild(b);-1===d.indexOf(a)&&d.push(a)});b.forEach(e.normalizeTextNodes);q.detach();n.fixCursorPositions();n.getOdfCanvas().refreshSize();n.getOdfCanvas().rerenderAnnotations();d.forEach(function(b){n.emit(ops.OdtDocument.signalParagraphChanged,
{paragraphElement:b,memberId:c,timeStamp:g})});return!0};this.spec=function(){return{optype:"ApplyHyperlink",memberid:c,timestamp:g,position:a,length:f,hyperlink:k}}};ops.OpApplyHyperlink.Spec;ops.OpApplyHyperlink.InitSpec;
ops.OpInsertImage=function(){var l,c,g,a,f,k,e,p,n=odf.Namespaces.drawns,h=odf.Namespaces.svgns,q=odf.Namespaces.textns,b=odf.Namespaces.xlinkns,d=odf.OdfUtils;this.init=function(b){l=b.memberid;c=b.timestamp;g=b.position;a=b.filename;f=b.frameWidth;k=b.frameHeight;e=b.frameStyleName;p=b.frameName};this.isEdit=!0;this.group=void 0;this.execute=function(m){var r=m.getOdfCanvas(),A=m.getTextNodeAtStep(g,l),y,v;if(!A)return!1;y=A.textNode;v=d.getParagraphElement(y);var A=A.offset!==y.length?y.splitText(A.offset):
y.nextSibling,s=m.getDOMDocument(),B=s.createElementNS(n,"draw:image"),s=s.createElementNS(n,"draw:frame");B.setAttributeNS(b,"xlink:href",a);B.setAttributeNS(b,"xlink:type","simple");B.setAttributeNS(b,"xlink:show","embed");B.setAttributeNS(b,"xlink:actuate","onLoad");s.setAttributeNS(n,"draw:style-name",e);s.setAttributeNS(n,"draw:name",p);s.setAttributeNS(q,"text:anchor-type","as-char");s.setAttributeNS(h,"svg:width",f);s.setAttributeNS(h,"svg:height",k);s.appendChild(B);y.parentNode.insertBefore(s,
A);m.emit(ops.OdtDocument.signalStepsInserted,{position:g});0===y.length&&y.parentNode.removeChild(y);r.addCssForFrameWithImage(s);r.refreshCSS();m.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:v,memberId:l,timeStamp:c});r.rerenderAnnotations();return!0};this.spec=function(){return{optype:"InsertImage",memberid:l,timestamp:c,filename:a,position:g,frameWidth:f,frameHeight:k,frameStyleName:e,frameName:p}}};ops.OpInsertImage.Spec;ops.OpInsertImage.InitSpec;
ops.OpInsertTable=function(){function l(b,d){var e;if(1===h.length)e=h[0];else if(3===h.length)switch(b){case 0:e=h[0];break;case a-1:e=h[2];break;default:e=h[1]}else e=h[b];if(1===e.length)return e[0];if(3===e.length)switch(d){case 0:return e[0];case f-1:return e[2];default:return e[1]}return e[d]}var c,g,a,f,k,e,p,n,h,q=odf.OdfUtils;this.init=function(b){c=b.memberid;g=b.timestamp;k=b.position;a=b.initialRows;f=b.initialColumns;e=b.tableName;p=b.tableStyleName;n=b.tableColumnStyleName;h=b.tableCellStyleMatrix};
this.isEdit=!0;this.group=void 0;this.execute=function(b){var d=b.getTextNodeAtStep(k),m=b.getRootNode();if(d){var h=b.getDOMDocument(),A=h.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table"),y=h.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-column"),v,s,B,u;p&&A.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",p);e&&A.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:name",e);y.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0",
"table:number-columns-repeated",f);n&&y.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",n);A.appendChild(y);for(B=0;B<a;B+=1){y=h.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-row");for(u=0;u<f;u+=1)v=h.createElementNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:table-cell"),(s=l(B,u))&&v.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:table:1.0","table:style-name",s),s=h.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0",
"text:p"),v.appendChild(s),y.appendChild(v);A.appendChild(y)}d=q.getParagraphElement(d.textNode);m.insertBefore(A,d.nextSibling);b.emit(ops.OdtDocument.signalStepsInserted,{position:k});b.getOdfCanvas().refreshSize();b.emit(ops.OdtDocument.signalTableAdded,{tableElement:A,memberId:c,timeStamp:g});b.getOdfCanvas().rerenderAnnotations();return!0}return!1};this.spec=function(){return{optype:"InsertTable",memberid:c,timestamp:g,position:k,initialRows:a,initialColumns:f,tableName:e,tableStyleName:p,tableColumnStyleName:n,
tableCellStyleMatrix:h}}};ops.OpInsertTable.Spec;ops.OpInsertTable.InitSpec;
ops.OpInsertText=function(){function l(a){return"\t"!==a&&e.isODFWhitespace(a)}var c,g,a,f,k,e=odf.OdfUtils;this.init=function(e){c=e.memberid;g=e.timestamp;a=e.position;k=e.text;f="true"===e.moveCursor||!0===e.moveCursor};this.isEdit=!0;this.group=void 0;this.execute=function(p){var n,h,q,b=null,d=p.getDOMDocument(),m,r=0,A,y=p.getCursor(c),v;p.upgradeWhitespacesAtPosition(a);if(n=p.getTextNodeAtStep(a)){h=n.textNode;b=h.nextSibling;q=h.parentNode;m=e.getParagraphElement(h);for(v=0;v<k.length;v+=
1){if(!(A="\t"===k[v])){A=k;var s=v;A=l(A[s])&&(0===s||s===A.length-1||l(A[s-1]))}A&&(0===r?(n.offset!==h.length&&(b=h.splitText(n.offset)),0<v&&h.appendData(k.substring(0,v))):r<v&&(r=k.substring(r,v),q.insertBefore(d.createTextNode(r),b)),r=v+1,"\t"===k[v]?(A=d.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:tab"),A.appendChild(d.createTextNode("\t"))):(" "!==k[v]&&runtime.log("WARN: InsertText operation contains non-tab, non-space whitespace character (character code "+k.charCodeAt(v)+
")"),A=d.createElementNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:s"),A.appendChild(d.createTextNode(" "))),q.insertBefore(A,b))}0===r?h.insertData(n.offset,k):r<k.length&&(n=k.substring(r),q.insertBefore(d.createTextNode(n),b));q=h.parentNode;b=h.nextSibling;q.removeChild(h);q.insertBefore(h,b);0===h.length&&h.parentNode.removeChild(h);p.emit(ops.OdtDocument.signalStepsInserted,{position:a});y&&f&&(p.moveCursor(c,a+k.length,0),p.emit(ops.Document.signalCursorMoved,y));p.downgradeWhitespacesAtPosition(a);
p.downgradeWhitespacesAtPosition(a+k.length);p.getOdfCanvas().refreshSize();p.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:m,memberId:c,timeStamp:g});p.getOdfCanvas().rerenderAnnotations();return!0}return!1};this.spec=function(){return{optype:"InsertText",memberid:c,timestamp:g,position:a,text:k,moveCursor:f}}};ops.OpInsertText.Spec;ops.OpInsertText.InitSpec;
odf.CollapsingRules=function(l){function c(f){return a.isODFNode(f)||"br"===f.localName&&a.isLineBreak(f.parentNode)||f.nodeType===Node.TEXT_NODE&&a.isODFNode(f.parentNode)}function g(k){var e;k.nodeType===Node.TEXT_NODE?(e=k.parentNode,e.removeChild(k)):e=f.removeUnwantedNodes(k,c);if(k=e)k=e,k=!a.isParagraph(k)&&k!==l&&a.hasNoODFContent(k);return k?g(e):e}var a=odf.OdfUtils,f=core.DomUtils;this.mergeChildrenIntoParent=g};
ops.OpMergeParagraph=function(){function l(b){return q.isGroupingElement(b)&&q.hasNoODFContent(b)}function c(b){if(b.nodeType===Node.TEXT_NODE){if(0===b.length)return runtime.log("WARN: Empty text node found during merge operation"),!0;if(q.isODFWhitespace(b.data)&&!1===q.isSignificantWhitespace(b,0))return!0;b="#text"}else b=(b.prefix?b.prefix+":":"")+b.localName;runtime.log("WARN: Unexpected text element found near paragraph boundary ["+b+"]");return!1}function g(d){d.collapsed||(b.splitBoundaries(d),
d=q.getTextElements(d,!1,!0).filter(c),d.forEach(function(b){b.parentNode.removeChild(b)}))}function a(b,d,a){b=b.convertCursorStepToDomPoint(d);var e=q.getParagraphElement(b.node,b.offset);runtime.assert(Boolean(e),"Paragraph not found at step "+d);a&&a.setPosition(b.node,b.offset);return e}var f,k,e,p,n,h,q=odf.OdfUtils,b=core.DomUtils,d=odf.Namespaces.textns;this.init=function(b){f=b.memberid;k=b.timestamp;e=b.moveCursor;p=b.paragraphStyleName;n=parseInt(b.sourceStartPosition,10);h=parseInt(b.destinationStartPosition,
10)};this.isEdit=!0;this.group=void 0;this.execute=function(c){var r,q,y=c.getCursor(f);r=c.getRootNode();var v=new odf.CollapsingRules(r),s=c.createStepIterator(r,0,[c.getPositionFilter()],r),B;runtime.assert(h<n,"Destination paragraph ("+h+") must be before source paragraph ("+n+")");q=a(c,h);r=a(c,n,s);s.previousStep();runtime.assert(b.containsNode(q,s.container()),"Destination paragraph must be adjacent to the source paragraph");B=q.ownerDocument.createRange();s.setPosition(q,q.childNodes.length);
s.roundToPreviousStep();B.setStart(s.container(),s.offset());B.setEnd(q,q.childNodes.length);g(B);B=q.childNodes.length;var u=r.ownerDocument.createRange();s.setPosition(r,0);s.roundToNextStep();u.setStart(r,0);u.setEnd(s.container(),s.offset());g(u);for(u=r.firstChild;u;)"editinfo"===u.localName?r.removeChild(u):(q.appendChild(u),b.removeUnwantedNodes(u,l)),u=r.firstChild;runtime.assert(0===r.childNodes.length,"Source paragraph should be empty before it is removed");v.mergeChildrenIntoParent(r);
c.emit(ops.OdtDocument.signalStepsRemoved,{position:n-1});s.setPosition(q,B);s.roundToClosestStep();s.previousStep()||s.roundToNextStep();c.downgradeWhitespaces(s);p?q.setAttributeNS(d,"text:style-name",p):q.removeAttributeNS(d,"style-name");y&&e&&(c.moveCursor(f,n-1,0),c.emit(ops.Document.signalCursorMoved,y));c.fixCursorPositions();c.getOdfCanvas().refreshSize();c.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:q,memberId:f,timeStamp:k});c.getOdfCanvas().rerenderAnnotations();return!0};
this.spec=function(){return{optype:"MergeParagraph",memberid:f,timestamp:k,moveCursor:e,paragraphStyleName:p,sourceStartPosition:n,destinationStartPosition:h}}};ops.OpMergeParagraph.Spec;ops.OpMergeParagraph.InitSpec;
ops.OpMoveCursor=function(){var l,c,g,a,f;this.init=function(k){l=k.memberid;c=k.timestamp;g=k.position;a=k.length||0;f=k.selectionType||ops.OdtCursor.RangeSelection};this.isEdit=!1;this.group=void 0;this.execute=function(c){var e=c.getCursor(l),p;if(!e)return!1;p=c.convertCursorToDomRange(g,a);e.setSelectedRange(p,0<=a);e.setSelectionType(f);c.emit(ops.Document.signalCursorMoved,e);return!0};this.spec=function(){return{optype:"MoveCursor",memberid:l,timestamp:c,position:g,length:a,selectionType:f}}};
ops.OpMoveCursor.Spec;ops.OpMoveCursor.InitSpec;
ops.OpRemoveAnnotation=function(){var l,c,g,a,f=core.DomUtils;this.init=function(f){l=f.memberid;c=f.timestamp;g=parseInt(f.position,10);a=parseInt(f.length,10)};this.isEdit=!0;this.group=void 0;this.execute=function(a){function e(a){l.parentNode.insertBefore(a,l)}for(var c=a.getIteratorAtPosition(g).container(),l;c.namespaceURI!==odf.Namespaces.officens||"annotation"!==c.localName;)c=c.parentNode;if(null===c)return!1;l=c;c=l.annotationEndElement;a.getOdfCanvas().forgetAnnotations();f.getElementsByTagNameNS(l,
"urn:webodf:names:cursor","cursor").forEach(e);f.getElementsByTagNameNS(l,"urn:webodf:names:cursor","anchor").forEach(e);l.parentNode.removeChild(l);c&&c.parentNode.removeChild(c);a.emit(ops.OdtDocument.signalStepsRemoved,{position:0<g?g-1:g});a.fixCursorPositions();a.getOdfCanvas().refreshAnnotations();return!0};this.spec=function(){return{optype:"RemoveAnnotation",memberid:l,timestamp:c,position:g,length:a}}};ops.OpRemoveAnnotation.Spec;ops.OpRemoveAnnotation.InitSpec;
ops.OpRemoveBlob=function(){var l,c,g;this.init=function(a){l=a.memberid;c=a.timestamp;g=a.filename};this.isEdit=!0;this.group=void 0;this.execute=function(a){a.getOdfCanvas().odfContainer().removeBlob(g);return!0};this.spec=function(){return{optype:"RemoveBlob",memberid:l,timestamp:c,filename:g}}};ops.OpRemoveBlob.Spec;ops.OpRemoveBlob.InitSpec;
ops.OpRemoveCursor=function(){var l,c;this.init=function(g){l=g.memberid;c=g.timestamp};this.isEdit=!1;this.group=void 0;this.execute=function(c){return c.removeCursor(l)?!0:!1};this.spec=function(){return{optype:"RemoveCursor",memberid:l,timestamp:c}}};ops.OpRemoveCursor.Spec;ops.OpRemoveCursor.InitSpec;
ops.OpRemoveHyperlink=function(){var l,c,g,a,f=core.DomUtils,k=odf.OdfUtils;this.init=function(e){l=e.memberid;c=e.timestamp;g=e.position;a=e.length};this.isEdit=!0;this.group=void 0;this.execute=function(e){var p=e.convertCursorToDomRange(g,a),n=k.getHyperlinkElements(p);runtime.assert(1===n.length,"The given range should only contain a single link.");n=f.mergeIntoParent(n[0]);p.detach();e.fixCursorPositions();e.getOdfCanvas().refreshSize();e.getOdfCanvas().rerenderAnnotations();e.emit(ops.OdtDocument.signalParagraphChanged,
{paragraphElement:k.getParagraphElement(n),memberId:l,timeStamp:c});return!0};this.spec=function(){return{optype:"RemoveHyperlink",memberid:l,timestamp:c,position:g,length:a}}};ops.OpRemoveHyperlink.Spec;ops.OpRemoveHyperlink.InitSpec;
ops.OpRemoveMember=function(){var l,c;this.init=function(g){l=g.memberid;c=parseInt(g.timestamp,10)};this.isEdit=!1;this.group=void 0;this.execute=function(c){if(!c.getMember(l))return!1;c.removeMember(l);c.emit(ops.Document.signalMemberRemoved,l);return!0};this.spec=function(){return{optype:"RemoveMember",memberid:l,timestamp:c}}};ops.OpRemoveMember.Spec;ops.OpRemoveMember.InitSpec;
ops.OpRemoveStyle=function(){var l,c,g,a;this.init=function(f){l=f.memberid;c=f.timestamp;g=f.styleName;a=f.styleFamily};this.isEdit=!0;this.group=void 0;this.execute=function(f){var c=f.getFormatting().getStyleElement(g,a);if(!c)return!1;c.parentNode.removeChild(c);f.getOdfCanvas().refreshCSS();f.emit(ops.OdtDocument.signalCommonStyleDeleted,{name:g,family:a});return!0};this.spec=function(){return{optype:"RemoveStyle",memberid:l,timestamp:c,styleName:g,styleFamily:a}}};ops.OpRemoveStyle.Spec;ops.OpRemoveStyle.InitSpec;
ops.OpRemoveText=function(){var l,c,g,a,f=odf.OdfUtils,k=core.DomUtils;this.init=function(e){runtime.assert(0<=e.length,"OpRemoveText only supports positive lengths");l=e.memberid;c=e.timestamp;g=parseInt(e.position,10);a=parseInt(e.length,10)};this.isEdit=!0;this.group=void 0;this.execute=function(e){var p,n,h,q=e.getCursor(l),b=new odf.CollapsingRules(e.getRootNode());e.upgradeWhitespacesAtPosition(g);e.upgradeWhitespacesAtPosition(g+a);p=e.convertCursorToDomRange(g,a);k.splitBoundaries(p);n=f.getTextElements(p,
!1,!0);h=f.getParagraphElement(p.startContainer,p.startOffset);runtime.assert(void 0!==h,"Attempting to remove text outside a paragraph element");p.detach();n.forEach(function(d){d.parentNode?(runtime.assert(k.containsNode(h,d),"RemoveText only supports removing elements within the same paragraph"),b.mergeChildrenIntoParent(d)):runtime.log("WARN: text element has already been removed from it's container")});e.emit(ops.OdtDocument.signalStepsRemoved,{position:g});e.downgradeWhitespacesAtPosition(g);
e.fixCursorPositions();e.getOdfCanvas().refreshSize();e.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:h,memberId:l,timeStamp:c});q&&(q.resetSelectionType(),e.emit(ops.Document.signalCursorMoved,q));e.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"RemoveText",memberid:l,timestamp:c,position:g,length:a}}};ops.OpRemoveText.Spec;ops.OpRemoveText.InitSpec;
ops.OpSetBlob=function(){var l,c,g,a,f;this.init=function(k){l=k.memberid;c=k.timestamp;g=k.filename;a=k.mimetype;f=k.content};this.isEdit=!0;this.group=void 0;this.execute=function(c){c.getOdfCanvas().odfContainer().setBlob(g,a,f);return!0};this.spec=function(){return{optype:"SetBlob",memberid:l,timestamp:c,filename:g,mimetype:a,content:f}}};ops.OpSetBlob.Spec;ops.OpSetBlob.InitSpec;
ops.OpSetParagraphStyle=function(){function l(a,f,c){var h=[a.getPositionFilter()],k=c.container();c=c.unfilteredDomOffset();return!1===a.createStepIterator(k,c,h,f).previousStep()}var c,g,a,f,k=odf.OdfUtils;this.init=function(e){c=e.memberid;g=e.timestamp;a=e.position;f=e.styleName};this.isEdit=!0;this.group=void 0;this.execute=function(e){var p,n;p=e.getIteratorAtPosition(a);return(n=k.getParagraphElement(p.container()))?(runtime.assert(l(e,n,p),"SetParagraphStyle position should be the first position in the paragraph"),
f?n.setAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","text:style-name",f):n.removeAttributeNS("urn:oasis:names:tc:opendocument:xmlns:text:1.0","style-name"),e.getOdfCanvas().refreshSize(),e.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:n,timeStamp:g,memberId:c}),e.getOdfCanvas().rerenderAnnotations(),!0):!1};this.spec=function(){return{optype:"SetParagraphStyle",memberid:c,timestamp:g,position:a,styleName:f}}};ops.OpSetParagraphStyle.Spec;ops.OpSetParagraphStyle.InitSpec;
ops.OpSplitParagraph=function(){var l,c,g,a,f,k,e=odf.OdfUtils,p=odf.Namespaces.textns;this.init=function(e){l=e.memberid;c=e.timestamp;a=e.position;g=e.sourceParagraphPosition;k=e.paragraphStyleName;f="true"===e.moveCursor||!0===e.moveCursor};this.isEdit=!0;this.group=void 0;this.execute=function(g){var h,q,b,d,m,r,A,y=g.getCursor(l);g.upgradeWhitespacesAtPosition(a);h=g.getTextNodeAtStep(a);if(!h)return!1;q=e.getParagraphElement(h.textNode);if(!q)return!1;b=e.isListItem(q.parentNode)?q.parentNode:
q;0===h.offset?(A=h.textNode.previousSibling,r=null):(A=h.textNode,r=h.offset>=h.textNode.length?null:h.textNode.splitText(h.offset));for(d=h.textNode;d!==b;){d=d.parentNode;m=d.cloneNode(!1);r&&m.appendChild(r);if(A)for(;A&&A.nextSibling;)m.appendChild(A.nextSibling);else for(;d.firstChild;)m.appendChild(d.firstChild);d.parentNode.insertBefore(m,d.nextSibling);A=d;r=m}e.isListItem(r)&&(r=r.childNodes.item(0));k?r.setAttributeNS(p,"text:style-name",k):r.removeAttributeNS(p,"style-name");0===h.textNode.length&&
h.textNode.parentNode.removeChild(h.textNode);g.emit(ops.OdtDocument.signalStepsInserted,{position:a});y&&f&&(g.moveCursor(l,a+1,0),g.emit(ops.Document.signalCursorMoved,y));g.fixCursorPositions();g.getOdfCanvas().refreshSize();g.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:q,memberId:l,timeStamp:c});g.emit(ops.OdtDocument.signalParagraphChanged,{paragraphElement:r,memberId:l,timeStamp:c});g.getOdfCanvas().rerenderAnnotations();return!0};this.spec=function(){return{optype:"SplitParagraph",
memberid:l,timestamp:c,position:a,sourceParagraphPosition:g,paragraphStyleName:k,moveCursor:f}}};ops.OpSplitParagraph.Spec;ops.OpSplitParagraph.InitSpec;
ops.OpUpdateMember=function(){function l(f){var e="//dc:creator[@editinfo:memberid='"+c+"']";f=xmldom.XPath.getODFElementsWithXPath(f.getRootNode(),e,function(a){return"editinfo"===a?"urn:webodf:names:editinfo":odf.Namespaces.lookupNamespaceURI(a)});for(e=0;e<f.length;e+=1)f[e].textContent=a.fullName}var c,g,a,f;this.init=function(k){c=k.memberid;g=parseInt(k.timestamp,10);a=k.setProperties;f=k.removedProperties};this.isEdit=!1;this.group=void 0;this.execute=function(k){var e=k.getMember(c);if(!e)return!1;
f&&e.removeProperties(f);a&&(e.setProperties(a),a.fullName&&l(k));k.emit(ops.Document.signalMemberUpdated,e);return!0};this.spec=function(){return{optype:"UpdateMember",memberid:c,timestamp:g,setProperties:a,removedProperties:f}}};ops.OpUpdateMember.Spec;ops.OpUpdateMember.InitSpec;
ops.OpUpdateMetadata=function(){var l,c,g,a;this.init=function(f){l=f.memberid;c=parseInt(f.timestamp,10);g=f.setProperties;a=f.removedProperties};this.isEdit=!0;this.group=void 0;this.execute=function(f){f=f.getOdfCanvas().odfContainer();var c=null;a&&(c=a.attributes.split(","));f.setMetadata(g,c);return!0};this.spec=function(){return{optype:"UpdateMetadata",memberid:l,timestamp:c,setProperties:g,removedProperties:a}}};ops.OpUpdateMetadata.Spec;ops.OpUpdateMetadata.InitSpec;
ops.OpUpdateParagraphStyle=function(){function l(a,e){var f,c,b=e?e.split(","):[];for(f=0;f<b.length;f+=1)c=b[f].split(":"),a.removeAttributeNS(odf.Namespaces.lookupNamespaceURI(c[0]),c[1])}var c,g,a,f,k,e=odf.Namespaces.stylens;this.init=function(e){c=e.memberid;g=e.timestamp;a=e.styleName;f=e.setProperties;k=e.removedProperties};this.isEdit=!0;this.group=void 0;this.execute=function(c){var g=c.getFormatting(),h,q,b;return(h=""!==a?g.getStyleElement(a,"paragraph"):g.getDefaultStyleElement("paragraph"))?
(q=h.getElementsByTagNameNS(e,"paragraph-properties").item(0),b=h.getElementsByTagNameNS(e,"text-properties").item(0),f&&g.updateStyle(h,f),k&&(g=k["style:paragraph-properties"],q&&g&&(l(q,g.attributes),0===q.attributes.length&&h.removeChild(q)),g=k["style:text-properties"],b&&g&&(l(b,g.attributes),0===b.attributes.length&&h.removeChild(b)),l(h,k.attributes)),c.getOdfCanvas().refreshCSS(),c.emit(ops.OdtDocument.signalParagraphStyleModified,a),c.getOdfCanvas().rerenderAnnotations(),!0):!1};this.spec=
function(){return{optype:"UpdateParagraphStyle",memberid:c,timestamp:g,styleName:a,setProperties:f,removedProperties:k}}};ops.OpUpdateParagraphStyle.Spec;ops.OpUpdateParagraphStyle.InitSpec;
ops.OperationFactory=function(){function l(c){return function(a){return new c}}var c;this.register=function(g,a){c[g]=a};this.create=function(g){var a=null,f=c[g.optype];f&&(a=f(g),a.init(g));return a};c={AddMember:l(ops.OpAddMember),UpdateMember:l(ops.OpUpdateMember),RemoveMember:l(ops.OpRemoveMember),AddCursor:l(ops.OpAddCursor),ApplyDirectStyling:l(ops.OpApplyDirectStyling),SetBlob:l(ops.OpSetBlob),RemoveBlob:l(ops.OpRemoveBlob),InsertImage:l(ops.OpInsertImage),InsertTable:l(ops.OpInsertTable),
InsertText:l(ops.OpInsertText),RemoveText:l(ops.OpRemoveText),MergeParagraph:l(ops.OpMergeParagraph),SplitParagraph:l(ops.OpSplitParagraph),SetParagraphStyle:l(ops.OpSetParagraphStyle),UpdateParagraphStyle:l(ops.OpUpdateParagraphStyle),AddStyle:l(ops.OpAddStyle),RemoveStyle:l(ops.OpRemoveStyle),MoveCursor:l(ops.OpMoveCursor),RemoveCursor:l(ops.OpRemoveCursor),AddAnnotation:l(ops.OpAddAnnotation),RemoveAnnotation:l(ops.OpRemoveAnnotation),UpdateMetadata:l(ops.OpUpdateMetadata),ApplyHyperlink:l(ops.OpApplyHyperlink),
RemoveHyperlink:l(ops.OpRemoveHyperlink)}};ops.OperationFactory.SpecConstructor;ops.OperationRouter=function(){};ops.OperationRouter.prototype.setOperationFactory=function(l){};ops.OperationRouter.prototype.setPlaybackFunction=function(l){};ops.OperationRouter.prototype.push=function(l){};ops.OperationRouter.prototype.close=function(l){};ops.OperationRouter.prototype.subscribe=function(l,c){};ops.OperationRouter.prototype.unsubscribe=function(l,c){};
ops.OperationRouter.prototype.hasLocalUnsyncedOps=function(){};ops.OperationRouter.prototype.hasSessionHostConnection=function(){};ops.OperationRouter.signalProcessingBatchStart="router/batchstart";ops.OperationRouter.signalProcessingBatchEnd="router/batchend";
ops.TrivialOperationRouter=function(){var l=new core.EventNotifier([ops.OperationRouter.signalProcessingBatchStart,ops.OperationRouter.signalProcessingBatchEnd]),c,g,a=0;this.setOperationFactory=function(a){c=a};this.setPlaybackFunction=function(a){g=a};this.push=function(f){a+=1;l.emit(ops.OperationRouter.signalProcessingBatchStart,{});f.forEach(function(f){f=f.spec();f.timestamp=Date.now();f=c.create(f);f.group="g"+a;g(f)});l.emit(ops.OperationRouter.signalProcessingBatchEnd,{})};this.close=function(a){a()};
this.subscribe=function(a,c){l.subscribe(a,c)};this.unsubscribe=function(a,c){l.unsubscribe(a,c)};this.hasLocalUnsyncedOps=function(){return!1};this.hasSessionHostConnection=function(){return!0}};
ops.Session=function(l){function c(a){f.emit(ops.OdtDocument.signalProcessingBatchStart,a)}function g(a){f.emit(ops.OdtDocument.signalProcessingBatchEnd,a)}var a=new ops.OperationFactory,f=new ops.OdtDocument(l),k=null;this.setOperationFactory=function(e){a=e;k&&k.setOperationFactory(a)};this.setOperationRouter=function(e){k&&(k.unsubscribe(ops.OperationRouter.signalProcessingBatchStart,c),k.unsubscribe(ops.OperationRouter.signalProcessingBatchEnd,g));k=e;k.subscribe(ops.OperationRouter.signalProcessingBatchStart,
c);k.subscribe(ops.OperationRouter.signalProcessingBatchEnd,g);e.setPlaybackFunction(function(a){f.emit(ops.OdtDocument.signalOperationStart,a);return a.execute(f)?(f.emit(ops.OdtDocument.signalOperationEnd,a),!0):!1});e.setOperationFactory(a)};this.getOperationFactory=function(){return a};this.getOdtDocument=function(){return f};this.enqueue=function(a){k.push(a)};this.close=function(a){k.close(function(c){c?a(c):f.close(a)})};this.destroy=function(a){f.destroy(a)};this.setOperationRouter(new ops.TrivialOperationRouter)};
gui.AnnotationController=function(l,c,g){function a(){var b=p.getCursor(g),b=b&&b.getNode(),a=!1;b&&(a=!q.isWithinAnnotation(b,p.getRootNode()));a!==n&&(n=a,h.emit(gui.AnnotationController.annotatableChanged,n))}function f(b){b.getMemberId()===g&&a()}function k(b){b===g&&a()}function e(b){b.getMemberId()===g&&a()}var p=l.getOdtDocument(),n=!1,h=new core.EventNotifier([gui.AnnotationController.annotatableChanged]),q=odf.OdfUtils,b=core.StepDirection.NEXT;this.isAnnotatable=function(){return n};this.addAnnotation=
function(){var b=new ops.OpAddAnnotation,a=p.getCursorSelection(g),e=a.length,a=a.position;n&&(a=0<=e?a:a+e,e=Math.abs(e),b.init({memberid:g,position:a,length:e,name:g+Date.now()}),l.enqueue([b]))};this.removeAnnotation=function(a){var e,f;e=p.getMember(g).getProperties().fullName;if(!0!==c.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)||e===q.getAnnotationCreator(a))e=p.convertDomPointToCursorStep(a,0,b),f=p.convertDomPointToCursorStep(a,a.childNodes.length),a=new ops.OpRemoveAnnotation,
a.init({memberid:g,position:e,length:f-e}),f=new ops.OpMoveCursor,f.init({memberid:g,position:0<e?e-1:e,length:0}),l.enqueue([a,f])};this.subscribe=function(b,a){h.subscribe(b,a)};this.unsubscribe=function(b,a){h.unsubscribe(b,a)};this.destroy=function(b){p.unsubscribe(ops.Document.signalCursorAdded,f);p.unsubscribe(ops.Document.signalCursorRemoved,k);p.unsubscribe(ops.Document.signalCursorMoved,e);b()};c.registerConstraint(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN);p.subscribe(ops.Document.signalCursorAdded,
f);p.subscribe(ops.Document.signalCursorRemoved,k);p.subscribe(ops.Document.signalCursorMoved,e);a()};gui.AnnotationController.annotatableChanged="annotatable/changed";
gui.Avatar=function(l,c){var g=this,a,f,k;this.setColor=function(a){f.style.borderColor=a};this.setImageUrl=function(a){g.isVisible()?f.src=a:k=a};this.isVisible=function(){return"block"===a.style.display};this.show=function(){k&&(f.src=k,k=void 0);a.style.display="block"};this.hide=function(){a.style.display="none"};this.markAsFocussed=function(e){e?a.classList.add("active"):a.classList.remove("active")};this.destroy=function(e){l.removeChild(a);e()};(function(){var e=l.ownerDocument;a=e.createElement("div");
f=e.createElement("img");a.appendChild(f);a.style.display=c?"block":"none";a.className="handle";l.appendChild(a)})()};gui.StepInfo=function(){};gui.StepInfo.VisualDirection={LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1};gui.StepInfo.prototype.token;gui.StepInfo.prototype.container=function(){};gui.StepInfo.prototype.offset=function(){};gui.StepInfo.prototype.direction;gui.StepInfo.prototype.visualDirection;gui.VisualStepScanner=function(){};gui.VisualStepScanner.prototype.token;
gui.VisualStepScanner.prototype.process=function(l,c,g){};
gui.GuiStepUtils=function(){function l(e){e=g.getContentBounds(e);var f,h=null;if(e)if(e.container.nodeType===Node.TEXT_NODE)f=e.container.ownerDocument.createRange(),f.setStart(e.container,e.startOffset),f.setEnd(e.container,e.endOffset),(h=0<f.getClientRects().length?f.getBoundingClientRect():null)&&" "===e.container.data.substring(e.startOffset,e.endOffset)&&1>=h.width&&(h=null),f.detach();else if(c.isCharacterElement(e.container)||c.isCharacterFrame(e.container))h=a.getBoundingClientRect(e.container);
return h}var c=odf.OdfUtils,g=new odf.StepUtils,a=core.DomUtils,f=core.StepDirection.NEXT,k=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT,e=gui.StepInfo.VisualDirection.RIGHT_TO_LEFT;this.getContentRect=l;this.moveToFilteredStep=function(a,c,h){function g(b,a){a.process(s,r,A)&&(b=!0,!y&&a.token&&(y=a.token));return b}var b=c===f,d,m,r,A,y,v=a.snapshot();d=!1;var s;do d=l(a),s={token:a.snapshot(),container:a.container,offset:a.offset,direction:c,visualDirection:c===f?k:e},m=a.nextStep()?l(a):null,a.restore(s.token),
b?(r=d,A=m):(r=m,A=d),d=h.reduce(g,!1);while(!d&&a.advanceStep(c));d||h.forEach(function(b){!y&&b.token&&(y=b.token)});a.restore(y||v);return Boolean(y)}};
gui.Caret=function(l,c,g,a){function f(){b.style.opacity="0"===b.style.opacity?"1":"0";z.trigger()}function k(){A.selectNodeContents(r);return A.getBoundingClientRect()}function e(b){return t[b]!==E[b]}function p(){Object.keys(E).forEach(function(b){t[b]=E[b]})}function n(){if(!1===E.isShown||l.getSelectionType()!==ops.OdtCursor.RangeSelection||!a&&!l.getSelectedRange().collapsed)E.visibility="hidden",b.style.visibility="hidden",z.cancel();else if(E.visibility="visible",b.style.visibility="visible",
!1===E.isFocused)b.style.opacity="1",z.cancel();else{if(G||e("visibility"))b.style.opacity="1",z.cancel();z.trigger()}if(C||H){var f;f=l.getNode();var h,g,t=v.getBoundingClientRect(y.getSizer()),r=!1,u=0;f.removeAttributeNS("urn:webodf:names:cursor","caret-sizer-active");if(0<f.getClientRects().length)g=k(),u=g.left-v.getBoundingClientRect(f).left,r=!0;else if(B.setPosition(f,0),g=s.getContentRect(B),!g&&B.nextStep()&&(h=s.getContentRect(B))&&(g=h,r=!0),g||(f.setAttributeNS("urn:webodf:names:cursor",
"caret-sizer-active","true"),g=k(),r=!0),!g)for(runtime.log("WARN: No suitable client rectangle found for visual caret for "+l.getMemberId());f;){if(0<f.getClientRects().length){g=v.getBoundingClientRect(f);r=!0;break}f=f.parentNode}g=v.translateRect(g,t,y.getZoomLevel());f={top:g.top,height:g.height,right:r?g.left:g.right,width:v.adaptRangeDifferenceToZoomLevel(u,y.getZoomLevel())};8>f.height&&(f={top:f.top-(8-f.height)/2,height:8,right:f.right});q.style.height=f.height+"px";q.style.top=f.top+"px";
q.style.left=f.right-f.width+"px";q.style.width=f.width?f.width+"px":"";m&&(f=runtime.getWindow().getComputedStyle(l.getNode(),null),f.font?m.style.font=f.font:(m.style.fontStyle=f.fontStyle,m.style.fontVariant=f.fontVariant,m.style.fontWeight=f.fontWeight,m.style.fontSize=f.fontSize,m.style.lineHeight=f.lineHeight,m.style.fontFamily=f.fontFamily))}E.isShown&&H&&c.scrollIntoView(b.getBoundingClientRect());e("isFocused")&&d.markAsFocussed(E.isFocused);p();C=H=G=!1}function h(b){q.parentNode.removeChild(q);
r.parentNode.removeChild(r);b()}var q,b,d,m,r,A,y=l.getDocument().getCanvas(),v=core.DomUtils,s=new gui.GuiStepUtils,B,u,z,G=!1,H=!1,C=!1,E={isFocused:!1,isShown:!0,visibility:"hidden"},t={isFocused:!E.isFocused,isShown:!E.isShown,visibility:"hidden"};this.handleUpdate=function(){C=!0;u.trigger()};this.refreshCursorBlinking=function(){G=!0;u.trigger()};this.setFocus=function(){E.isFocused=!0;u.trigger()};this.removeFocus=function(){E.isFocused=!1;u.trigger()};this.show=function(){E.isShown=!0;u.trigger()};
this.hide=function(){E.isShown=!1;u.trigger()};this.setAvatarImageUrl=function(b){d.setImageUrl(b)};this.setColor=function(a){b.style.borderColor=a;d.setColor(a)};this.getCursor=function(){return l};this.getFocusElement=function(){return b};this.toggleHandleVisibility=function(){d.isVisible()?d.hide():d.show()};this.showHandle=function(){d.show()};this.hideHandle=function(){d.hide()};this.setOverlayElement=function(b){m=b;q.appendChild(b);C=!0;u.trigger()};this.ensureVisible=function(){H=!0;u.trigger()};
this.getBoundingClientRect=function(){return v.getBoundingClientRect(q)};this.destroy=function(b){core.Async.destroyAll([u.destroy,z.destroy,d.destroy,h],b)};(function(){var a=l.getDocument(),e=[a.createRootFilter(l.getMemberId()),a.getPositionFilter()],c=a.getDOMDocument();A=c.createRange();r=c.createElement("span");r.className="webodf-caretSizer";r.textContent="|";l.getNode().appendChild(r);q=c.createElement("div");q.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",l.getMemberId());
q.className="webodf-caretOverlay";b=c.createElement("div");b.className="caret";q.appendChild(b);d=new gui.Avatar(q,g);y.getSizer().appendChild(q);B=a.createStepIterator(l.getNode(),0,e,a.getRootNode());u=core.Task.createRedrawTask(n);z=core.Task.createTimeoutTask(f,500);u.triggerImmediate()})()};
odf.TextSerializer=function(){function l(a){var f="",k=c.filter?c.filter.acceptNode(a):NodeFilter.FILTER_ACCEPT,e=a.nodeType,p;if((k===NodeFilter.FILTER_ACCEPT||k===NodeFilter.FILTER_SKIP)&&g.isTextContentContainingNode(a))for(p=a.firstChild;p;)f+=l(p),p=p.nextSibling;k===NodeFilter.FILTER_ACCEPT&&(e===Node.ELEMENT_NODE&&g.isParagraph(a)?f+="\n":e===Node.TEXT_NODE&&a.textContent&&(f+=a.textContent));return f}var c=this,g=odf.OdfUtils;this.filter=null;this.writeToString=function(a){if(!a)return"";
a=l(a);"\n"===a[a.length-1]&&(a=a.substr(0,a.length-1));return a}};gui.MimeDataExporter=function(){var l;this.exportRangeToDataTransfer=function(c,g){var a;a=g.startContainer.ownerDocument.createElement("span");a.appendChild(g.cloneContents());a=l.writeToString(a);try{c.setData("text/plain",a)}catch(f){c.setData("Text",a)}};l=new odf.TextSerializer;l.filter=new odf.OdfNodeFilter};
gui.Clipboard=function(l){this.setDataFromRange=function(c,g){var a,f=c.clipboardData;a=runtime.getWindow();!f&&a&&(f=a.clipboardData);f?(a=!0,l.exportRangeToDataTransfer(f,g),c.preventDefault()):a=!1;return a}};
gui.SessionContext=function(l,c){var g=l.getOdtDocument(),a=odf.OdfUtils;this.isLocalCursorWithinOwnAnnotation=function(){var f=g.getCursor(c),k;if(!f)return!1;k=f&&f.getNode();f=g.getMember(c).getProperties().fullName;return(k=a.getParentAnnotation(k,g.getRootNode()))&&a.getAnnotationCreator(k)===f?!0:!1}};
gui.StyleSummary=function(l){function c(a,e){var c=a+"|"+e,g;f.hasOwnProperty(c)||(g=[],l.forEach(function(f){f=(f=f.styleProperties[a])&&f[e];-1===g.indexOf(f)&&g.push(f)}),f[c]=g);return f[c]}function g(a,e,f){return function(){var g=c(a,e);return f.length>=g.length&&g.every(function(a){return-1!==f.indexOf(a)})}}function a(a,e){var f=c(a,e);return 1===f.length?f[0]:void 0}var f={};this.getPropertyValues=c;this.getCommonValue=a;this.isBold=g("style:text-properties","fo:font-weight",["bold"]);this.isItalic=
g("style:text-properties","fo:font-style",["italic"]);this.hasUnderline=g("style:text-properties","style:text-underline-style",["solid"]);this.hasStrikeThrough=g("style:text-properties","style:text-line-through-style",["solid"]);this.fontSize=function(){var f=a("style:text-properties","fo:font-size");return f&&parseFloat(f)};this.fontName=function(){return a("style:text-properties","style:font-name")};this.isAlignedLeft=g("style:paragraph-properties","fo:text-align",["left","start"]);this.isAlignedCenter=
g("style:paragraph-properties","fo:text-align",["center"]);this.isAlignedRight=g("style:paragraph-properties","fo:text-align",["right","end"]);this.isAlignedJustified=g("style:paragraph-properties","fo:text-align",["justify"]);this.text={isBold:this.isBold,isItalic:this.isItalic,hasUnderline:this.hasUnderline,hasStrikeThrough:this.hasStrikeThrough,fontSize:this.fontSize,fontName:this.fontName};this.paragraph={isAlignedLeft:this.isAlignedLeft,isAlignedCenter:this.isAlignedCenter,isAlignedRight:this.isAlignedRight,
isAlignedJustified:this.isAlignedJustified}};
gui.DirectFormattingController=function(l,c,g,a,f,k,e){function p(){return Y.value().styleSummary}function n(){return Y.value().enabledFeatures}function h(b){var a;b.collapsed?(a=b.startContainer,a.hasChildNodes()&&b.startOffset<a.childNodes.length&&(a=a.childNodes.item(b.startOffset)),b=[a]):b=U.getTextElements(b,!0,!1);return b}function q(){var b=K.getCursor(a),d=b&&b.getSelectedRange(),e=[],e=[],f=!0,m={directTextStyling:!0,directParagraphStyling:!0};d&&(e=h(d),0===e.length&&(e=[d.startContainer,
d.endContainer],f=!1),e=K.getFormatting().getAppliedStyles(e));void 0!==e[0]&&ca&&(e[0].styleProperties=F.mergeObjects(e[0].styleProperties,ca));!0===c.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(m.directTextStyling=m.directParagraphStyling=g.isLocalCursorWithinOwnAnnotation());m.directTextStyling&&(m.directTextStyling=f&&void 0!==b&&b.getSelectionType()===ops.OdtCursor.RangeSelection);return{enabledFeatures:m,appliedStyles:e,styleSummary:new gui.StyleSummary(e)}}function b(b,a){var d={};Object.keys(b).forEach(function(e){var f=
b[e](),c=a[e]();f!==c&&(d[e]=c)});return d}function d(){var a,d;d=L.styleSummary;var e=Y.value(),f=e.styleSummary,c=L.enabledFeatures,h=e.enabledFeatures;a=b(d.text,f.text);d=b(d.paragraph,f.paragraph);c=!(h.directTextStyling===c.directTextStyling&&h.directParagraphStyling===c.directParagraphStyling);L=e;c&&$.emit(gui.DirectFormattingController.enabledChanged,h);0<Object.keys(a).length&&$.emit(gui.DirectFormattingController.textStylingChanged,a);0<Object.keys(d).length&&$.emit(gui.DirectFormattingController.paragraphStylingChanged,
d)}function m(){Y.reset();d()}function r(b){("string"===typeof b?b:b.getMemberId())===a&&Y.reset()}function A(){Y.reset()}function y(b){var d=K.getCursor(a);b=b.paragraphElement;d&&U.getParagraphElement(d.getNode())===b&&Y.reset()}function v(b,a){a(!b());return!0}function s(b){if(n().directTextStyling){var d=K.getCursorSelection(a),e={"style:text-properties":b};0!==d.length?(b=new ops.OpApplyDirectStyling,b.init({memberid:a,position:d.position,length:d.length,setProperties:e}),l.enqueue([b])):(ca=
F.mergeObjects(ca||{},e),Y.reset())}}function B(b,a){var d={};d[b]=a;s(d)}function u(b){b=b.spec();ca&&b.memberid===a&&"SplitParagraph"!==b.optype&&(ca=null,Y.reset())}function z(b){B("fo:font-weight",b?"bold":"normal")}function G(b){B("fo:font-style",b?"italic":"normal")}function H(b){B("style:text-underline-style",b?"solid":"none")}function C(b){B("style:text-line-through-style",b?"solid":"none")}function E(b){if(n().directParagraphStyling){var d=K.getCursor(a).getSelectedRange(),d=U.getParagraphElements(d),
e=K.getFormatting(),c=[],h={},m;d.forEach(function(d){var g=K.convertDomPointToCursorStep(d,0,ba),k=d.getAttributeNS(odf.Namespaces.textns,"style-name"),t;d=k?h.hasOwnProperty(k)?h[k]:void 0:m;d||(d=f.generateStyleName(),k?(h[k]=d,t=e.createDerivedStyleObject(k,"paragraph",{})):(m=d,t={}),t=b(t),k=new ops.OpAddStyle,k.init({memberid:a,styleName:d.toString(),styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:t}),c.push(k));k=new ops.OpSetParagraphStyle;k.init({memberid:a,styleName:d.toString(),
position:g});c.push(k)});l.enqueue(c)}}function t(b){E(function(a){return F.mergeObjects(a,b)})}function x(b){t({"style:paragraph-properties":{"fo:text-align":b}})}function w(b,a){var d=K.getFormatting().getDefaultTabStopDistance(),e=a["style:paragraph-properties"],f;e&&(e=e["fo:margin-left"],f=U.parseLength(e));return F.mergeObjects(a,{"style:paragraph-properties":{"fo:margin-left":f&&f.unit===d.unit?f.value+b*d.value+f.unit:b*d.value+d.unit}})}function M(b,a){var d=h(b),d=0===d.length?[b.startContainer]:
d,d=K.getFormatting().getAppliedStyles(d),e=0<d.length?d[0].styleProperties:void 0,f=K.getFormatting().getAppliedStylesForElement(a).styleProperties;if(!e||"text"!==e["style:family"]||!e["style:text-properties"])return!1;if(!f||!f["style:text-properties"])return!0;e=e["style:text-properties"];f=f["style:text-properties"];return!Object.keys(e).every(function(b){return e[b]===f[b]})}function D(){}function I(){return!1}var J=this,K=l.getOdtDocument(),F=new core.Utils,U=odf.OdfUtils,$=new core.EventNotifier([gui.DirectFormattingController.enabledChanged,
gui.DirectFormattingController.textStylingChanged,gui.DirectFormattingController.paragraphStylingChanged]),Q=odf.Namespaces.textns,ba=core.StepDirection.NEXT,ca=null,L,Y;this.enabledFeatures=n;this.formatTextSelection=s;this.createCursorStyleOp=function(b,d,e){var f=null,c=ca;e&&(c=(e=Y.value().appliedStyles[0])&&e.styleProperties);c&&c["style:text-properties"]&&(f=new ops.OpApplyDirectStyling,f.init({memberid:a,position:b,length:d,setProperties:{"style:text-properties":c["style:text-properties"]}}),
ca=null,Y.reset());return f};this.setBold=z;this.setItalic=G;this.setHasUnderline=H;this.setHasStrikethrough=C;this.setFontSize=function(b){B("fo:font-size",b+"pt")};this.setFontName=function(b){B("style:font-name",b)};this.getAppliedStyles=function(){return Y.value().appliedStyles};this.toggleBold=v.bind(J,function(){return p().isBold()},z);this.toggleItalic=v.bind(J,function(){return p().isItalic()},G);this.toggleUnderline=v.bind(J,function(){return p().hasUnderline()},H);this.toggleStrikethrough=
v.bind(J,function(){return p().hasStrikeThrough()},C);this.isBold=function(){return p().isBold()};this.isItalic=function(){return p().isItalic()};this.hasUnderline=function(){return p().hasUnderline()};this.hasStrikeThrough=function(){return p().hasStrikeThrough()};this.fontSize=function(){return p().fontSize()};this.fontName=function(){return p().fontName()};this.isAlignedLeft=function(){return p().isAlignedLeft()};this.isAlignedCenter=function(){return p().isAlignedCenter()};this.isAlignedRight=
function(){return p().isAlignedRight()};this.isAlignedJustified=function(){return p().isAlignedJustified()};this.alignParagraphLeft=function(){x("left");return!0};this.alignParagraphCenter=function(){x("center");return!0};this.alignParagraphRight=function(){x("right");return!0};this.alignParagraphJustified=function(){x("justify");return!0};this.indent=function(){E(w.bind(null,1));return!0};this.outdent=function(){E(w.bind(null,-1));return!0};this.createParagraphStyleOps=function(b){if(!n().directParagraphStyling)return[];
var d=K.getCursor(a),e=d.getSelectedRange(),c=[],h,m;d.hasForwardSelection()?(h=d.getAnchorNode(),m=d.getNode()):(h=d.getNode(),m=d.getAnchorNode());d=U.getParagraphElement(m);runtime.assert(Boolean(d),"DirectFormattingController: Cursor outside paragraph");var k=d,g=[K.getPositionFilter(),K.createRootFilter(a)];if(!1!==K.createStepIterator(e.endContainer,e.endOffset,g,k).nextStep())return c;m!==h&&(d=U.getParagraphElement(h));if(!ca&&!M(e,d))return c;e=(e=Y.value().appliedStyles[0])&&e.styleProperties;
if(!e)return c;if(d=d.getAttributeNS(Q,"style-name"))e={"style:text-properties":e["style:text-properties"]},e=K.getFormatting().createDerivedStyleObject(d,"paragraph",e);h=f.generateStyleName();d=new ops.OpAddStyle;d.init({memberid:a,styleName:h,styleFamily:"paragraph",isAutomaticStyle:!0,setProperties:e});c.push(d);d=new ops.OpSetParagraphStyle;d.init({memberid:a,styleName:h,position:b});c.push(d);return c};this.subscribe=function(b,a){$.subscribe(b,a)};this.unsubscribe=function(b,a){$.unsubscribe(b,
a)};this.destroy=function(b){K.unsubscribe(ops.Document.signalCursorAdded,r);K.unsubscribe(ops.Document.signalCursorRemoved,r);K.unsubscribe(ops.Document.signalCursorMoved,r);K.unsubscribe(ops.OdtDocument.signalParagraphStyleModified,A);K.unsubscribe(ops.OdtDocument.signalParagraphChanged,y);K.unsubscribe(ops.OdtDocument.signalOperationEnd,u);K.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,d);c.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,m);b()};(function(){K.subscribe(ops.Document.signalCursorAdded,
r);K.subscribe(ops.Document.signalCursorRemoved,r);K.subscribe(ops.Document.signalCursorMoved,r);K.subscribe(ops.OdtDocument.signalParagraphStyleModified,A);K.subscribe(ops.OdtDocument.signalParagraphChanged,y);K.subscribe(ops.OdtDocument.signalOperationEnd,u);K.subscribe(ops.OdtDocument.signalProcessingBatchEnd,d);c.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,m);Y=new core.LazyProperty(q);L=Y.value();k||(J.formatTextSelection=D,J.setBold=D,J.setItalic=D,J.setHasUnderline=D,J.setHasStrikethrough=
D,J.setFontSize=D,J.setFontName=D,J.toggleBold=I,J.toggleItalic=I,J.toggleUnderline=I,J.toggleStrikethrough=I);e||(J.alignParagraphCenter=D,J.alignParagraphJustified=D,J.alignParagraphLeft=D,J.alignParagraphRight=D,J.createParagraphStyleOps=function(){return[]},J.indent=D,J.outdent=D)})()};gui.DirectFormattingController.enabledChanged="enabled/changed";gui.DirectFormattingController.textStylingChanged="textStyling/changed";gui.DirectFormattingController.paragraphStylingChanged="paragraphStyling/changed";
gui.DirectFormattingController.SelectionInfo=function(){this.enabledFeatures;this.appliedStyles;this.styleSummary};
gui.KeyboardHandler=function(){function l(a,k){k||(k=c.None);switch(a){case gui.KeyboardHandler.KeyCode.LeftMeta:case gui.KeyboardHandler.KeyCode.RightMeta:case gui.KeyboardHandler.KeyCode.MetaInMozilla:k|=c.Meta;break;case gui.KeyboardHandler.KeyCode.Ctrl:k|=c.Ctrl;break;case gui.KeyboardHandler.KeyCode.Alt:k|=c.Alt;break;case gui.KeyboardHandler.KeyCode.Shift:k|=c.Shift}return a+":"+k}var c=gui.KeyboardHandler.Modifier,g=null,a={};this.setDefault=function(a){g=a};this.bind=function(f,c,e,g){f=l(f,
c);runtime.assert(g||!1===a.hasOwnProperty(f),"tried to overwrite the callback handler of key combo: "+f);a[f]=e};this.unbind=function(f,c){var e=l(f,c);delete a[e]};this.reset=function(){g=null;a={}};this.handleEvent=function(f){var k=f.keyCode,e=c.None;f.metaKey&&(e|=c.Meta);f.ctrlKey&&(e|=c.Ctrl);f.altKey&&(e|=c.Alt);f.shiftKey&&(e|=c.Shift);k=l(k,e);k=a[k];e=!1;k?e=k():null!==g&&(e=g(f));e&&(f.preventDefault?f.preventDefault():f.returnValue=!1)}};
gui.KeyboardHandler.Modifier={None:0,Meta:1,Ctrl:2,Alt:4,CtrlAlt:6,Shift:8,MetaShift:9,CtrlShift:10,AltShift:12};gui.KeyboardHandler.KeyCode={Backspace:8,Tab:9,Clear:12,Enter:13,Shift:16,Ctrl:17,Alt:18,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Delete:46,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LeftMeta:91,RightMeta:93,MetaInMozilla:224};
gui.HyperlinkClickHandler=function(l,c,g){function a(a){for(;null!==a;){if(b.isHyperlink(a))return a;if(b.isParagraph(a))break;a=a.parentNode}return null}function f(){var b=l();runtime.assert(Boolean(b.classList),"Document container has no classList element");b.classList.remove("webodf-inactiveLinks")}function k(){var b=l();runtime.assert(Boolean(b.classList),"Document container has no classList element");b.classList.add("webodf-inactiveLinks")}function e(){d.removeEventListener("focus",k,!1);r.forEach(function(b){c.unbind(b.keyCode,
b.modifier);g.unbind(b.keyCode,b.modifier)});r.length=0}function p(b){e();if(b!==n.None){d.addEventListener("focus",k,!1);switch(b){case n.Ctrl:r.push({keyCode:h.Ctrl,modifier:n.None});break;case n.Meta:r.push({keyCode:h.LeftMeta,modifier:n.None}),r.push({keyCode:h.RightMeta,modifier:n.None}),r.push({keyCode:h.MetaInMozilla,modifier:n.None})}r.forEach(function(b){c.bind(b.keyCode,b.modifier,f);g.bind(b.keyCode,b.modifier,k)})}}var n=gui.KeyboardHandler.Modifier,h=gui.KeyboardHandler.KeyCode,q=xmldom.XPath,
b=odf.OdfUtils,d=runtime.getWindow(),m=n.None,r=[];runtime.assert(null!==d,"Expected to be run in an environment which has a global window, like a browser.");this.handleClick=function(e){var f=e.target||e.srcElement,c,h,g;e.ctrlKey?c=n.Ctrl:e.metaKey&&(c=n.Meta);if(m===n.None||m===c)if(c=a(f))h=b.getHyperlinkTarget(c),""!==h&&("#"===h[0]?(h=h.substring(1),c=l(),g=q.getODFElementsWithXPath(c,"//text:bookmark-start[@text:name='"+h+"']",odf.Namespaces.lookupNamespaceURI),0===g.length&&(g=q.getODFElementsWithXPath(c,
"//text:bookmark[@text:name='"+h+"']",odf.Namespaces.lookupNamespaceURI)),0<g.length&&(clearTimeout(clicktimer),clicktimer=setTimeout(function(){function b(a){for(var d=0;d<=historylist.length-1;d++)if(historylist[d].url==a.url)return;historylist.push(a)}b({url:"#S"+h,node:f});b({url:"#"+h,node:g[0]});history.pushState(null,null,"#S"+h);history.pushState(null,null,"#"+h);g[0].scrollIntoView(!0)},100))):d.open(h),e.preventDefault?e.preventDefault():e.returnValue=!1)};this.setModifier=function(b){m!==
b&&(runtime.assert(b===n.None||b===n.Ctrl||b===n.Meta,"Unsupported KeyboardHandler.Modifier value: "+b),m=b,m!==n.None?k():f(),p(m))};this.getModifier=function(){return m};this.destroy=function(b){k();e();b()}};
gui.EventManager=function(l){function c(b){function a(b,d,e){var f,c=!1;f="on"+d;b.attachEvent&&(b.attachEvent(f,e),c=!0);!c&&b.addEventListener&&(b.addEventListener(d,e,!1),c=!0);c&&!u[d]||!b.hasOwnProperty(f)||(b[f]=e)}function d(b,a,e){var f="on"+a;b.detachEvent&&b.detachEvent(f,e);b.removeEventListener&&b.removeEventListener(a,e,!1);b[f]===e&&(b[f]=null)}function e(a){if(-1===c.indexOf(a)){c.push(a);if(f.filters.every(function(b){return b(a)}))try{h.emit(b,a)}catch(d){runtime.log("Error occurred while processing "+
b+":\n"+d.message+"\n"+d.stack)}runtime.setTimeout(function(){c.splice(c.indexOf(a),1)},0)}}var f=this,c=[],h=new core.EventNotifier([b]);this.filters=[];this.subscribe=function(a){h.subscribe(b,a)};this.unsubscribe=function(a){h.unsubscribe(b,a)};this.destroy=function(){d(B,b,e);d(C,b,e);d(E,b,e)};z[b]&&a(B,b,e);a(C,b,e);a(E,b,e)}function g(b,a,d){function e(a){d(a,f,function(a){a.type=b;c.emit(b,a)})}var f={},c=new core.EventNotifier([b]);this.subscribe=function(a){c.subscribe(b,a)};this.unsubscribe=
function(a){c.unsubscribe(b,a)};this.destroy=function(){a.forEach(function(b){t.unsubscribe(b,e)})};(function(){a.forEach(function(b){t.subscribe(b,e)})})()}function a(b){runtime.clearTimeout(b);delete x[b]}function f(b,d){var e=runtime.setTimeout(function(){b();a(e)},d);x[e]=!0;return e}function k(b,d,e){var c=b.touches.length,h=b.touches[0],m=d.timer;"touchmove"===b.type||"touchend"===b.type?m&&a(m):"touchstart"===b.type&&(1!==c?runtime.clearTimeout(m):m=f(function(){e({clientX:h.clientX,clientY:h.clientY,
pageX:h.pageX,pageY:h.pageY,target:b.target||b.srcElement||null,detail:1})},400));d.timer=m}function e(b,a,d){var e=b.touches[0],f=b.target||b.srcElement||null,c=a.target;1!==b.touches.length||"touchend"===b.type?c=null:"touchstart"===b.type&&"webodf-draggable"===f.getAttribute("class")?c=f:"touchmove"===b.type&&c&&(b.preventDefault(),b.stopPropagation(),d({clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY,target:c,detail:1}));a.target=c}function p(b,a,d){var e=b.target||b.srcElement||
null,f=a.dragging;"drag"===b.type?f=!0:"touchend"===b.type&&f&&(f=!1,b=b.changedTouches[0],d({clientX:b.clientX,clientY:b.clientY,pageX:b.pageX,pageY:b.pageY,target:e,detail:1}));a.dragging=f}function n(){E.classList.add("webodf-touchEnabled");t.unsubscribe("touchstart",n)}function h(b){var a=b.scrollX,d=b.scrollY;this.restore=function(){b.scrollX===a&&b.scrollY===d||b.scrollTo(a,d)}}function q(b){var a=b.scrollTop,d=b.scrollLeft;this.restore=function(){if(b.scrollTop!==a||b.scrollLeft!==d)b.scrollTop=
a,b.scrollLeft=d}}function b(b,a){var d=H[b]||G[b]||null;!d&&a&&(d=H[b]=new c(b));return d}function d(a,d){b(a,!0).subscribe(d)}function m(a,d){var e=b(a,!1);e&&e.unsubscribe(d)}function r(){return l.getDOMDocument().activeElement===C}function A(){r()&&C.blur();C.setAttribute("disabled","true")}function y(){C.removeAttribute("disabled")}function v(b){for(var a=[];b;)(b.scrollWidth>b.clientWidth||b.scrollHeight>b.clientHeight)&&a.push(new q(b)),b=b.parentNode;a.push(new h(B));return a}function s(){var b;
r()||(b=v(C),y(),C.focus(),b.forEach(function(b){b.restore()}))}var B=runtime.getWindow(),u={beforecut:!0,beforepaste:!0,longpress:!0,drag:!0,dragstop:!0},z={mousedown:!0,mouseup:!0,focus:!0},G={},H={},C,E=l.getCanvas().getElement(),t=this,x={};this.addFilter=function(a,d){b(a,!0).filters.push(d)};this.removeFilter=function(a,d){var e=b(a,!0),f=e.filters.indexOf(d);-1!==f&&e.filters.splice(f,1)};this.subscribe=d;this.unsubscribe=m;this.hasFocus=r;this.focus=s;this.getEventTrap=function(){return C};
this.setEditing=function(b){var a=r();a&&C.blur();b?C.removeAttribute("readOnly"):C.setAttribute("readOnly","true");a&&s()};this.destroy=function(b){m("touchstart",n);Object.keys(x).forEach(function(b){a(parseInt(b,10))});x.length=0;Object.keys(G).forEach(function(b){G[b].destroy()});G={};m("mousedown",A);m("mouseup",y);m("contextmenu",y);Object.keys(H).forEach(function(b){H[b].destroy()});H={};C.parentNode.removeChild(C);b()};(function(){var b=l.getOdfCanvas().getSizer(),a=b.ownerDocument;runtime.assert(Boolean(B),
"EventManager requires a window object to operate correctly");C=a.createElement("textarea");C.id="eventTrap";C.setAttribute("tabindex","-1");C.setAttribute("readOnly","true");C.setAttribute("rows","1");b.appendChild(C);d("mousedown",A);d("mouseup",y);d("contextmenu",y);G.longpress=new g("longpress",["touchstart","touchmove","touchend"],k);G.drag=new g("drag",["touchstart","touchmove","touchend"],e);G.dragstop=new g("dragstop",["drag","touchend"],p);d("touchstart",n)})()};
gui.IOSSafariSupport=function(l){function c(){g.innerHeight!==g.outerHeight&&(a.style.display="none",runtime.requestAnimationFrame(function(){a.style.display="block"}))}var g=runtime.getWindow(),a=l.getEventTrap();this.destroy=function(f){l.unsubscribe("focus",c);a.removeAttribute("autocapitalize");a.style.WebkitTransform="";f()};l.subscribe("focus",c);a.setAttribute("autocapitalize","off");a.style.WebkitTransform="translateX(-10000px)"};
gui.HyperlinkController=function(l,c,g,a){function f(){var a=!0;!0===c.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(a=g.isLocalCursorWithinOwnAnnotation());a!==h&&(h=a,n.emit(gui.HyperlinkController.enabledChanged,h))}function k(e){e.getMemberId()===a&&f()}var e=odf.OdfUtils,p=l.getOdtDocument(),n=new core.EventNotifier([gui.HyperlinkController.enabledChanged]),h=!1;this.isEnabled=function(){return h};this.subscribe=function(a,b){n.subscribe(a,b)};this.unsubscribe=function(a,b){n.unsubscribe(a,
b)};this.addHyperlink=function(e,b){if(h){var d=p.getCursorSelection(a),f=new ops.OpApplyHyperlink,c=[];if(0===d.length||b)b=b||e,f=new ops.OpInsertText,f.init({memberid:a,position:d.position,text:b}),d.length=b.length,c.push(f);f=new ops.OpApplyHyperlink;f.init({memberid:a,position:d.position,length:d.length,hyperlink:e});c.push(f);l.enqueue(c)}};this.removeHyperlinks=function(){if(h){var f=p.createPositionIterator(p.getRootNode()),b=p.getCursor(a).getSelectedRange(),d=e.getHyperlinkElements(b),
c=b.collapsed&&1===d.length,g=p.getDOMDocument().createRange(),k=[],n,v;0!==d.length&&(d.forEach(function(b){g.selectNodeContents(b);n=p.convertDomToCursorRange({anchorNode:g.startContainer,anchorOffset:g.startOffset,focusNode:g.endContainer,focusOffset:g.endOffset});v=new ops.OpRemoveHyperlink;v.init({memberid:a,position:n.position,length:n.length});k.push(v)}),c||(c=d[0],-1===b.comparePoint(c,0)&&(g.setStart(c,0),g.setEnd(b.startContainer,b.startOffset),n=p.convertDomToCursorRange({anchorNode:g.startContainer,
anchorOffset:g.startOffset,focusNode:g.endContainer,focusOffset:g.endOffset}),0<n.length&&(v=new ops.OpApplyHyperlink,v.init({memberid:a,position:n.position,length:n.length,hyperlink:e.getHyperlinkTarget(c)}),k.push(v))),d=d[d.length-1],f.moveToEndOfNode(d),f=f.unfilteredDomOffset(),1===b.comparePoint(d,f)&&(g.setStart(b.endContainer,b.endOffset),g.setEnd(d,f),n=p.convertDomToCursorRange({anchorNode:g.startContainer,anchorOffset:g.startOffset,focusNode:g.endContainer,focusOffset:g.endOffset}),0<n.length&&
(v=new ops.OpApplyHyperlink,v.init({memberid:a,position:n.position,length:n.length,hyperlink:e.getHyperlinkTarget(d)}),k.push(v)))),l.enqueue(k),g.detach())}};this.destroy=function(a){p.unsubscribe(ops.Document.signalCursorMoved,k);c.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,f);a()};p.subscribe(ops.Document.signalCursorMoved,k);c.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,f);f()};gui.HyperlinkController.enabledChanged="enabled/changed";
gui.ImageController=function(l,c,g,a,f){function k(){var b=!0;!0===c.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)&&(b=g.isLocalCursorWithinOwnAnnotation());b!==m&&(m=b,d.emit(gui.ImageController.enabledChanged,m))}function e(b){b.getMemberId()===a&&k()}var p={"image/gif":".gif","image/jpeg":".jpg","image/png":".png"},n=odf.Namespaces.textns,h=l.getOdtDocument(),q=odf.OdfUtils,b=h.getFormatting(),d=new core.EventNotifier([gui.HyperlinkController.enabledChanged]),m=!1;this.isEnabled=function(){return m};
this.subscribe=function(b,a){d.subscribe(b,a)};this.unsubscribe=function(b,a){d.unsubscribe(b,a)};this.insertImage=function(d,e,c,g){if(m){runtime.assert(0<c&&0<g,"Both width and height of the image should be greater than 0px.");g={width:c,height:g};if(c=q.getParagraphElement(h.getCursor(a).getNode()).getAttributeNS(n,"style-name")){c=b.getContentSize(c,"paragraph");var k=1,B=1;g.width>c.width&&(k=c.width/g.width);g.height>c.height&&(B=c.height/g.height);c=Math.min(k,B);g={width:g.width*c,height:g.height*
c}}c=g.width+"px";g=g.height+"px";var u=h.getOdfCanvas().odfContainer().rootElement.styles,k=d.toLowerCase(),B=p.hasOwnProperty(k)?p[k]:null,z,k=[];runtime.assert(null!==B,"Image type is not supported: "+d);B="Pictures/"+f.generateImageName()+B;z=new ops.OpSetBlob;z.init({memberid:a,filename:B,mimetype:d,content:e});k.push(z);b.getStyleElement("Graphics","graphic",[u])||(d=new ops.OpAddStyle,d.init({memberid:a,styleName:"Graphics",styleFamily:"graphic",isAutomaticStyle:!1,setProperties:{"style:graphic-properties":{"text:anchor-type":"paragraph",
"svg:x":"0cm","svg:y":"0cm","style:wrap":"dynamic","style:number-wrapped-paragraphs":"no-limit","style:wrap-contour":"false","style:vertical-pos":"top","style:vertical-rel":"paragraph","style:horizontal-pos":"center","style:horizontal-rel":"paragraph"}}}),k.push(d));d=f.generateStyleName();e=new ops.OpAddStyle;e.init({memberid:a,styleName:d,styleFamily:"graphic",isAutomaticStyle:!0,setProperties:{"style:parent-style-name":"Graphics","style:graphic-properties":{"style:vertical-pos":"top","style:vertical-rel":"baseline",
"style:horizontal-pos":"center","style:horizontal-rel":"paragraph","fo:background-color":"transparent","style:background-transparency":"100%","style:shadow":"none","style:mirror":"none","fo:clip":"rect(0cm, 0cm, 0cm, 0cm)","draw:luminance":"0%","draw:contrast":"0%","draw:red":"0%","draw:green":"0%","draw:blue":"0%","draw:gamma":"100%","draw:color-inversion":"false","draw:image-opacity":"100%","draw:color-mode":"standard"}}});k.push(e);z=new ops.OpInsertImage;z.init({memberid:a,position:h.getCursorPosition(a),
filename:B,frameWidth:c,frameHeight:g,frameStyleName:d,frameName:f.generateFrameName()});k.push(z);l.enqueue(k)}};this.destroy=function(b){h.unsubscribe(ops.Document.signalCursorMoved,e);c.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,k);b()};h.subscribe(ops.Document.signalCursorMoved,e);c.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,k);k()};gui.ImageController.enabledChanged="enabled/changed";
gui.ImageSelector=function(l){function c(){var e=l.getSizer(),c=f.createElement("div");c.id="imageSelector";c.style.borderWidth="1px";e.appendChild(c);a.forEach(function(a){var e=f.createElement("div");e.className=a;c.appendChild(e)});return c}var g=odf.Namespaces.svgns,a="topLeft topRight bottomRight bottomLeft topMiddle rightMiddle bottomMiddle leftMiddle".split(" "),f=l.getElement().ownerDocument,k=!1;this.select=function(a){var p,n,h=f.getElementById("imageSelector");h||(h=c());k=!0;p=h.parentNode;
n=a.getBoundingClientRect();var q=p.getBoundingClientRect(),b=l.getZoomLevel();p=(n.left-q.left)/b-1;n=(n.top-q.top)/b-1;h.style.display="block";h.style.left=p+"px";h.style.top=n+"px";h.style.width=a.getAttributeNS(g,"width");h.style.height=a.getAttributeNS(g,"height")};this.clearSelection=function(){var a;k&&(a=f.getElementById("imageSelector"))&&(a.style.display="none");k=!1};this.isSelectorElement=function(a){var c=f.getElementById("imageSelector");return c?a===c||a.parentNode===c:!1}};
(function(){function l(c){function g(a){e=a.which&&String.fromCharCode(a.which)===k;k=void 0;return!1===e}function a(){e=!1}function f(a){k=a.data;e=!1}var k,e=!1;this.destroy=function(e){c.unsubscribe("textInput",a);c.unsubscribe("compositionend",f);c.removeFilter("keypress",g);e()};c.subscribe("textInput",a);c.subscribe("compositionend",f);c.addFilter("keypress",g)}gui.InputMethodEditor=function(c,g){function a(a){b&&(a?b.getNode().setAttributeNS("urn:webodf:names:cursor","composing","true"):(b.getNode().removeAttributeNS("urn:webodf:names:cursor",
"composing"),r.textContent=""))}function f(){y&&(y=!1,a(!1),s.emit(gui.InputMethodEditor.signalCompositionEnd,{data:v}),v="")}function k(){H||(H=!0,f(),b&&b.getSelectedRange().collapsed?d.value="":d.value=u.writeToString(b.getSelectedRange().cloneContents()),d.setSelectionRange(0,d.value.length),H=!1)}function e(){g.hasFocus()&&A.trigger()}function p(){B=void 0;A.cancel();a(!0);y||s.emit(gui.InputMethodEditor.signalCompositionStart,{data:""})}function n(b){b=B=b.data;y=!0;v+=b;A.trigger()}function h(b){b.data!==
B&&(b=b.data,y=!0,v+=b,A.trigger());B=void 0}function q(){r.textContent=d.value}var b=null,d=g.getEventTrap(),m=d.ownerDocument,r,A,y=!1,v="",s=new core.EventNotifier([gui.InputMethodEditor.signalCompositionStart,gui.InputMethodEditor.signalCompositionEnd]),B,u,z=[],G,H=!1;this.subscribe=s.subscribe;this.unsubscribe=s.unsubscribe;this.registerCursor=function(a){a.getMemberId()===c&&(b=a,b.getNode().appendChild(r),a.subscribe(ops.OdtCursor.signalCursorUpdated,e),g.subscribe("input",q),g.subscribe("compositionupdate",
q))};this.removeCursor=function(a){b&&a===c&&(b.getNode().removeChild(r),b.unsubscribe(ops.OdtCursor.signalCursorUpdated,e),g.unsubscribe("input",q),g.unsubscribe("compositionupdate",q),b=null)};this.destroy=function(b){g.unsubscribe("compositionstart",p);g.unsubscribe("compositionend",n);g.unsubscribe("textInput",h);g.unsubscribe("keypress",f);g.unsubscribe("focus",k);core.Async.destroyAll(G,b)};(function(){u=new odf.TextSerializer;u.filter=new odf.OdfNodeFilter;g.subscribe("compositionstart",p);
g.subscribe("compositionend",n);g.subscribe("textInput",h);g.subscribe("keypress",f);g.subscribe("focus",k);z.push(new l(g));G=z.map(function(b){return b.destroy});r=m.createElement("span");r.setAttribute("id","composer");A=core.Task.createTimeoutTask(k,1);G.push(A.destroy)})()};gui.InputMethodEditor.signalCompositionStart="input/compositionstart";gui.InputMethodEditor.signalCompositionEnd="input/compositionend"})();
gui.MetadataController=function(l,c){function g(a){k.emit(gui.MetadataController.signalMetadataChanged,a)}function a(a){var f=-1===e.indexOf(a);f||runtime.log("Setting "+a+" is restricted.");return f}var f=l.getOdtDocument(),k=new core.EventNotifier([gui.MetadataController.signalMetadataChanged]),e=["dc:creator","dc:date","meta:editing-cycles","meta:editing-duration","meta:document-statistic"];this.setMetadata=function(e,f){var h={},g="",b;e&&Object.keys(e).filter(a).forEach(function(b){h[b]=e[b]});
f&&(g=f.filter(a).join(","));if(0<g.length||0<Object.keys(h).length)b=new ops.OpUpdateMetadata,b.init({memberid:c,setProperties:h,removedProperties:0<g.length?{attributes:g}:null}),l.enqueue([b])};this.getMetadata=function(a){var e;runtime.assert("string"===typeof a,"Property must be a string");e=a.split(":");runtime.assert(2===e.length,"Property must be a namespace-prefixed string");a=odf.Namespaces.lookupNamespaceURI(e[0]);runtime.assert(Boolean(a),"Prefix must be for an ODF namespace.");return f.getOdfCanvas().odfContainer().getMetadata(a,
e[1])};this.subscribe=function(a,e){k.subscribe(a,e)};this.unsubscribe=function(a,e){k.unsubscribe(a,e)};this.destroy=function(a){f.unsubscribe(ops.OdtDocument.signalMetadataUpdated,g);a()};f.subscribe(ops.OdtDocument.signalMetadataUpdated,g)};gui.MetadataController.signalMetadataChanged="metadata/changed";
gui.PasteController=function(l,c,g,a){function f(){p=!0===c.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)?g.isLocalCursorWithinOwnAnnotation():!0}function k(b){b.getMemberId()===a&&f()}var e=l.getOdtDocument(),p=!1,n=odf.Namespaces.textns,h=core.StepDirection.NEXT,q=odf.OdfUtils;this.isEnabled=function(){return p};this.paste=function(b){if(p){var d=e.getCursorPosition(a),f=e.getCursor(a).getNode(),f=q.getParagraphElement(f),c=f.getAttributeNS(n,"style-name")||"",g=d,k=[],v=e.convertDomPointToCursorStep(f,
0,h);b.replace(/\r/g,"").split("\n").forEach(function(b){var d=new ops.OpInsertText,e=new ops.OpSplitParagraph;d.init({memberid:a,position:g,text:b,moveCursor:!0});k.push(d);g+=b.length;e.init({memberid:a,position:g,paragraphStyleName:c,sourceParagraphPosition:v,moveCursor:!0});k.push(e);v=g+=1});k.pop();l.enqueue(k)}};this.destroy=function(b){e.unsubscribe(ops.Document.signalCursorMoved,k);c.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,f);b()};e.subscribe(ops.Document.signalCursorMoved,k);
c.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,f);f()};gui.ClosestXOffsetScanner=function(l){function c(a){return null!==a&&void 0!==f?Math.abs(a-l)>f:!1}function g(a){null!==a&&!1===c(a)&&(f=Math.abs(a-l))}var a=this,f,k=gui.StepInfo.VisualDirection.LEFT_TO_RIGHT;this.token=void 0;this.process=function(e,f,l){var h,q;e.visualDirection===k?(h=f&&f.right,q=l&&l.left):(h=f&&f.left,q=l&&l.right);if(c(h)||c(q))return!0;if(f||l)g(h),g(q),a.token=e.token;return!1}};
gui.LineBoundaryScanner=function(){var l=this,c=null;this.token=void 0;this.process=function(g,a,f){var k;if(k=f)if(c){var e=c;k=Math.min(e.bottom-e.top,f.bottom-f.top);var p=Math.max(e.top,f.top),e=Math.min(e.bottom,f.bottom)-p;k=.4>=(0<k?e/k:0)}else k=!1;!a||f&&!k||(l.token=g.token);if(k)return!0;c=(g=c)&&a?{left:Math.min(g.left,a.left),right:Math.max(g.right,a.right),top:Math.min(g.top,a.top),bottom:Math.min(g.bottom,a.bottom)}:g||a;return!1}};
gui.ParagraphBoundaryScanner=function(){var l=this,c=!1,g,a=odf.OdfUtils;this.token=void 0;this.process=function(f){var k=a.getParagraphElement(f.container());c||(g=k,c=!0);if(g!==k)return!0;l.token=f.token;return!1}};
odf.WordBoundaryFilter=function(l,c){function g(b,a,d){for(var e=null,f=l.getRootNode(),c;b!==f&&null!==b&&null===e;)c=0>a?b.previousSibling:b.nextSibling,d(c)===NodeFilter.FILTER_ACCEPT&&(e=c),b=b.parentNode;return e}function a(b,a){var d;return null===b?m.NO_NEIGHBOUR:e.isCharacterElement(b)?m.SPACE_CHAR:b.nodeType===f||e.isTextSpan(b)||e.isHyperlink(b)?(d=b.textContent.charAt(a()),n.test(d)?m.SPACE_CHAR:p.test(d)?m.PUNCTUATION_CHAR:m.WORD_CHAR):m.OTHER}var f=Node.TEXT_NODE,k=Node.ELEMENT_NODE,
e=odf.OdfUtils,p=/[!-#%-*,-\/:-;?-@\[-\]_{}\u00a1\u00ab\u00b7\u00bb\u00bf;\u00b7\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0700-\u070d\u07f7-\u07f9\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u169b-\u169c\u16eb-\u16ed\u1735-\u1736\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u1944-\u1945\u19de-\u19df\u1a1e-\u1a1f\u1b5a-\u1b60\u1c3b-\u1c3f\u1c7e-\u1c7f\u2000-\u206e\u207d-\u207e\u208d-\u208e\u3008-\u3009\u2768-\u2775\u27c5-\u27c6\u27e6-\u27ef\u2983-\u2998\u29d8-\u29db\u29fc-\u29fd\u2cf9-\u2cfc\u2cfe-\u2cff\u2e00-\u2e7e\u3000-\u303f\u30a0\u30fb\ua60d-\ua60f\ua673\ua67e\ua874-\ua877\ua8ce-\ua8cf\ua92e-\ua92f\ua95f\uaa5c-\uaa5f\ufd3e-\ufd3f\ufe10-\ufe19\ufe30-\ufe52\ufe54-\ufe61\ufe63\ufe68\ufe6a-\ufe6b\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|\ud800[\udd00-\udd01\udf9f\udfd0]|\ud802[\udd1f\udd3f\ude50-\ude58]|\ud809[\udc00-\udc7e]/,
n=/\s/,h=core.PositionFilter.FilterResult.FILTER_ACCEPT,q=core.PositionFilter.FilterResult.FILTER_REJECT,b=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,d=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,m={NO_NEIGHBOUR:0,SPACE_CHAR:1,PUNCTUATION_CHAR:2,WORD_CHAR:3,OTHER:4};this.acceptPosition=function(e){var f=e.container(),l=e.leftNode(),p=e.rightNode(),n=e.unfilteredDomOffset,B=function(){return e.unfilteredDomOffset()-1};f.nodeType===k&&(null===p&&(p=g(f,1,e.getNodeFilter())),null===l&&(l=
g(f,-1,e.getNodeFilter())));f!==p&&(n=function(){return 0});f!==l&&null!==l&&(B=function(){return l.textContent.length-1});f=a(l,B);p=a(p,n);return f===m.WORD_CHAR&&p===m.WORD_CHAR||f===m.PUNCTUATION_CHAR&&p===m.PUNCTUATION_CHAR||c===b&&f!==m.NO_NEIGHBOUR&&p===m.SPACE_CHAR||c===d&&f===m.SPACE_CHAR&&p!==m.NO_NEIGHBOUR?q:h}};odf.WordBoundaryFilter.IncludeWhitespace={None:0,TRAILING:1,LEADING:2};
gui.SelectionController=function(l,c){function g(b){var a=b.spec();if(b.isEdit||a.memberid===c)H=void 0,C.cancel()}function a(){var b=y.getCursor(c).getNode();return y.createStepIterator(b,0,[B,z],y.getRootElement(b))}function f(b,a,d){d=new odf.WordBoundaryFilter(y,d);var e=y.getRootElement(b)||y.getRootNode(),f=y.createRootFilter(e);return y.createStepIterator(b,a,[B,f,d],e)}function k(b,a){return a?{anchorNode:b.startContainer,anchorOffset:b.startOffset,focusNode:b.endContainer,focusOffset:b.endOffset}:
{anchorNode:b.endContainer,anchorOffset:b.endOffset,focusNode:b.startContainer,focusOffset:b.startOffset}}function e(b,a,d){var e=new ops.OpMoveCursor;e.init({memberid:c,position:b,length:a||0,selectionType:d});return e}function p(b,a,d){var f;f=y.getCursor(c);f=k(f.getSelectedRange(),f.hasForwardSelection());f.focusNode=b;f.focusOffset=a;d||(f.anchorNode=f.focusNode,f.anchorOffset=f.focusOffset);b=y.convertDomToCursorRange(f);l.enqueue([e(b.position,b.length)])}function n(b){var a;a=f(b.startContainer,
b.startOffset,E);a.roundToPreviousStep()&&b.setStart(a.container(),a.offset());a=f(b.endContainer,b.endOffset,t);a.roundToNextStep()&&b.setEnd(a.container(),a.offset())}function h(b){var a=s.getParagraphElements(b),d=a[0],a=a[a.length-1];d&&b.setStart(d,0);a&&(s.isParagraph(b.endContainer)&&0===b.endOffset?b.setEndBefore(a):b.setEnd(a,a.childNodes.length))}function q(b,a,d,e){var f,c;e?(f=d.startContainer,c=d.startOffset):(f=d.endContainer,c=d.endOffset);v.containsNode(b,f)||(c=0>v.comparePoints(b,
0,f,c)?0:b.childNodes.length,f=b);b=y.createStepIterator(f,c,a,s.getParagraphElement(f)||b);b.roundToClosestStep()||runtime.assert(!1,"No step found in requested range");e?d.setStart(b.container(),b.offset()):d.setEnd(b.container(),b.offset())}function b(b,d){var e=a();e.advanceStep(b)&&p(e.container(),e.offset(),d)}function d(b,d){var e,f=H,c=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];void 0===f&&G&&(f=G());isNaN(f)||(e=a(),u.moveToFilteredStep(e,b,c)&&e.advanceStep(b)&&(c=[new gui.ClosestXOffsetScanner(f),
new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner],u.moveToFilteredStep(e,b,c)&&(p(e.container(),e.offset(),d),H=f,C.restart())))}function m(b,d){var e=a(),f=[new gui.LineBoundaryScanner,new gui.ParagraphBoundaryScanner];u.moveToFilteredStep(e,b,f)&&p(e.container(),e.offset(),d)}function r(b,a){var d=y.getCursor(c),d=k(d.getSelectedRange(),d.hasForwardSelection()),d=f(d.focusNode,d.focusOffset,E);d.advanceStep(b)&&p(d.container(),d.offset(),a)}function A(b,a,d){var e=!1,f=y.getCursor(c),
f=k(f.getSelectedRange(),f.hasForwardSelection()),e=y.getRootElement(f.focusNode);runtime.assert(Boolean(e),"SelectionController: Cursor outside root");f=y.createStepIterator(f.focusNode,f.focusOffset,[B,z],e);f.roundToClosestStep();f.advanceStep(b)&&(d=d(f.container()))&&(b===x?(f.setPosition(d,0),e=f.roundToNextStep()):(f.setPosition(d,d.childNodes.length),e=f.roundToPreviousStep()),e&&p(f.container(),f.offset(),a))}var y=l.getOdtDocument(),v=core.DomUtils,s=odf.OdfUtils,B=y.getPositionFilter(),
u=new gui.GuiStepUtils,z=y.createRootFilter(c),G=null,H,C,E=odf.WordBoundaryFilter.IncludeWhitespace.TRAILING,t=odf.WordBoundaryFilter.IncludeWhitespace.LEADING,x=core.StepDirection.PREVIOUS,w=core.StepDirection.NEXT;this.selectionToRange=function(b){var a=0<=v.comparePoints(b.anchorNode,b.anchorOffset,b.focusNode,b.focusOffset),d=b.focusNode.ownerDocument.createRange();a?(d.setStart(b.anchorNode,b.anchorOffset),d.setEnd(b.focusNode,b.focusOffset)):(d.setStart(b.focusNode,b.focusOffset),d.setEnd(b.anchorNode,
b.anchorOffset));return{range:d,hasForwardSelection:a}};this.rangeToSelection=k;this.selectImage=function(b){var a=y.getRootElement(b),d=y.createRootFilter(a),a=y.createStepIterator(b,0,[d,y.getPositionFilter()],a),f;a.roundToPreviousStep()||runtime.assert(!1,"No walkable position before frame");d=a.container();f=a.offset();a.setPosition(b,b.childNodes.length);a.roundToNextStep()||runtime.assert(!1,"No walkable position after frame");b=y.convertDomToCursorRange({anchorNode:d,anchorOffset:f,focusNode:a.container(),
focusOffset:a.offset()});b=e(b.position,b.length,ops.OdtCursor.RegionSelection);l.enqueue([b])};this.expandToWordBoundaries=n;this.expandToParagraphBoundaries=h;this.selectRange=function(b,a,d){var f=y.getOdfCanvas().getElement(),g,m=[B];g=v.containsNode(f,b.startContainer);f=v.containsNode(f,b.endContainer);if(g||f)if(g&&f&&(2===d?n(b):3<=d&&h(b)),(d=a?y.getRootElement(b.startContainer):y.getRootElement(b.endContainer))||(d=y.getRootNode()),m.push(y.createRootFilter(d)),q(d,m,b,!0),q(d,m,b,!1),b=
k(b,a),a=y.convertDomToCursorRange(b),b=y.getCursorSelection(c),a.position!==b.position||a.length!==b.length)b=e(a.position,a.length,ops.OdtCursor.RangeSelection),l.enqueue([b])};this.moveCursorToLeft=function(){b(x,!1);return!0};this.moveCursorToRight=function(){b(w,!1);return!0};this.extendSelectionToLeft=function(){b(x,!0);return!0};this.extendSelectionToRight=function(){b(w,!0);return!0};this.setCaretXPositionLocator=function(b){G=b};this.moveCursorUp=function(){d(x,!1);return!0};this.moveCursorDown=
function(){d(w,!1);return!0};this.extendSelectionUp=function(){d(x,!0);return!0};this.extendSelectionDown=function(){d(w,!0);return!0};this.moveCursorBeforeWord=function(){r(x,!1);return!0};this.moveCursorPastWord=function(){r(w,!1);return!0};this.extendSelectionBeforeWord=function(){r(x,!0);return!0};this.extendSelectionPastWord=function(){r(w,!0);return!0};this.moveCursorToLineStart=function(){m(x,!1);return!0};this.moveCursorToLineEnd=function(){m(w,!1);return!0};this.extendSelectionToLineStart=
function(){m(x,!0);return!0};this.extendSelectionToLineEnd=function(){m(w,!0);return!0};this.extendSelectionToParagraphStart=function(){A(x,!0,s.getParagraphElement);return!0};this.extendSelectionToParagraphEnd=function(){A(w,!0,s.getParagraphElement);return!0};this.moveCursorToParagraphStart=function(){A(x,!1,s.getParagraphElement);return!0};this.moveCursorToParagraphEnd=function(){A(w,!1,s.getParagraphElement);return!0};this.moveCursorToDocumentStart=function(){A(x,!1,y.getRootElement);return!0};
this.moveCursorToDocumentEnd=function(){A(w,!1,y.getRootElement);return!0};this.extendSelectionToDocumentStart=function(){A(x,!0,y.getRootElement);return!0};this.extendSelectionToDocumentEnd=function(){A(w,!0,y.getRootElement);return!0};this.extendSelectionToEntireDocument=function(){var b=y.getCursor(c),b=y.getRootElement(b.getNode()),a,d,f;runtime.assert(Boolean(b),"SelectionController: Cursor outside root");f=y.createStepIterator(b,0,[B,z],b);f.roundToClosestStep();a=f.container();d=f.offset();
f.setPosition(b,b.childNodes.length);f.roundToClosestStep();b=y.convertDomToCursorRange({anchorNode:a,anchorOffset:d,focusNode:f.container(),focusOffset:f.offset()});l.enqueue([e(b.position,b.length)]);return!0};this.destroy=function(b){y.unsubscribe(ops.OdtDocument.signalOperationStart,g);core.Async.destroyAll([C.destroy],b)};(function(){C=core.Task.createTimeoutTask(function(){H=void 0},2E3);y.subscribe(ops.OdtDocument.signalOperationStart,g)})()};
gui.TextController=function(l,c,g,a,f,k){function e(){A=!0===c.getState(gui.CommonConstraints.EDIT.REVIEW_MODE)?g.isLocalCursorWithinOwnAnnotation():!0}function p(b){b.getMemberId()===a&&e()}function n(b,a,e){var f=[d.getPositionFilter()];e&&f.push(d.createRootFilter(b.startContainer));e=d.createStepIterator(b.startContainer,b.startOffset,f,a);e.roundToClosestStep()||runtime.assert(!1,"No walkable step found in paragraph element at range start");a=d.convertDomPointToCursorStep(e.container(),e.offset());
b.collapsed?b=a:(e.setPosition(b.endContainer,b.endOffset),e.roundToClosestStep()||runtime.assert(!1,"No walkable step found in paragraph element at range end"),b=d.convertDomPointToCursorStep(e.container(),e.offset()));return{position:a,length:b-a}}function h(b){var d,e,f,c=m.getParagraphElements(b),h=b.cloneRange(),g=[];d=c[0];1<c.length&&(m.hasNoODFContent(d)&&(d=c[c.length-1]),e=d.getAttributeNS(odf.Namespaces.textns,"style-name")||"");c.forEach(function(d,c){var m,k;h.setStart(d,0);h.collapse(!0);
m=n(h,d,!1).position;0<c&&(k=new ops.OpMergeParagraph,k.init({memberid:a,paragraphStyleName:e,destinationStartPosition:f,sourceStartPosition:m,moveCursor:1===c}),g.unshift(k));f=m;h.selectNodeContents(d);if(m=r.rangeIntersection(h,b))m=n(m,d,!0),0<m.length&&(k=new ops.OpRemoveText,k.init({memberid:a,position:m.position,length:m.length}),g.unshift(k))});return g}function q(b){0>b.length&&(b.position+=b.length,b.length=-b.length);return b}function b(b){if(!A)return!1;var e,f=d.getCursor(a).getSelectedRange().cloneRange(),
c=q(d.getCursorSelection(a)),m;if(0===c.length){c=void 0;e=d.getCursor(a).getNode();m=d.getRootElement(e);var g=[d.getPositionFilter(),d.createRootFilter(m)];m=d.createStepIterator(e,0,g,m);m.roundToClosestStep()&&(b?m.nextStep():m.previousStep())&&(c=q(d.convertDomToCursorRange({anchorNode:e,anchorOffset:0,focusNode:m.container(),focusOffset:m.offset()})),b?(f.setStart(e,0),f.setEnd(m.container(),m.offset())):(f.setStart(m.container(),m.offset()),f.setEnd(e,0)))}c&&l.enqueue(h(f));return void 0!==
c}var d=l.getOdtDocument(),m=odf.OdfUtils,r=core.DomUtils,A=!1,y=odf.Namespaces.textns,v=core.StepDirection.NEXT;this.isEnabled=function(){return A};this.enqueueParagraphSplittingOps=function(){if(!A)return!1;var b=d.getCursor(a),e=b.getSelectedRange(),f=q(d.getCursorSelection(a)),c=[],b=m.getParagraphElement(b.getNode()),g=b.getAttributeNS(y,"style-name")||"";0<f.length&&(c=c.concat(h(e)));e=new ops.OpSplitParagraph;e.init({memberid:a,position:f.position,paragraphStyleName:g,sourceParagraphPosition:d.convertDomPointToCursorStep(b,
0,v),moveCursor:!0});c.push(e);k&&(f=k(f.position+1),c=c.concat(f));l.enqueue(c);return!0};this.removeTextByBackspaceKey=function(){return b(!1)};this.removeTextByDeleteKey=function(){return b(!0)};this.removeCurrentSelection=function(){if(!A)return!1;var b=d.getCursor(a).getSelectedRange();l.enqueue(h(b));return!0};this.insertText=function(b){if(A){var e=d.getCursor(a).getSelectedRange(),c=q(d.getCursorSelection(a)),m=[],g=!1;0<c.length&&(m=m.concat(h(e)),g=!0);e=new ops.OpInsertText;e.init({memberid:a,
position:c.position,text:b,moveCursor:!0});m.push(e);f&&(b=f(c.position,b.length,g))&&m.push(b);l.enqueue(m)}};this.destroy=function(b){d.unsubscribe(ops.Document.signalCursorMoved,p);c.unsubscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,e);b()};d.subscribe(ops.Document.signalCursorMoved,p);c.subscribe(gui.CommonConstraints.EDIT.REVIEW_MODE,e);e()};gui.UndoManager=function(){};gui.UndoManager.prototype.subscribe=function(l,c){};gui.UndoManager.prototype.unsubscribe=function(l,c){};
gui.UndoManager.prototype.setDocument=function(l){};gui.UndoManager.prototype.setInitialState=function(){};gui.UndoManager.prototype.initialize=function(){};gui.UndoManager.prototype.purgeInitialState=function(){};gui.UndoManager.prototype.setPlaybackFunction=function(l){};gui.UndoManager.prototype.hasUndoStates=function(){};gui.UndoManager.prototype.hasRedoStates=function(){};gui.UndoManager.prototype.moveForward=function(l){};gui.UndoManager.prototype.moveBackward=function(l){};
gui.UndoManager.prototype.onOperationExecuted=function(l){};gui.UndoManager.signalUndoStackChanged="undoStackChanged";gui.UndoManager.signalUndoStateCreated="undoStateCreated";gui.UndoManager.signalUndoStateModified="undoStateModified";gui.SessionControllerOptions=function(){this.annotationsEnabled=this.directParagraphStylingEnabled=this.directTextStylingEnabled=!1};
(function(){var l=core.PositionFilter.FilterResult.FILTER_ACCEPT;gui.SessionController=function(c,g,a,f){function k(b){return b.target||b.srcElement||null}function e(b,a){var d=K.getDOMDocument(),e=null;d.caretRangeFromPoint?(d=d.caretRangeFromPoint(b,a),e={container:d.startContainer,offset:d.startOffset}):d.caretPositionFromPoint&&(d=d.caretPositionFromPoint(b,a))&&d.offsetNode&&(e={container:d.offsetNode,offset:d.offset});return e}function p(b){var a=K.getCursor(g).getSelectedRange();a.collapsed?
b.preventDefault():ca.setDataFromRange(b,a)?da.removeCurrentSelection():runtime.log("Cut operation failed")}function n(){return!1!==K.getCursor(g).getSelectedRange().collapsed}function h(b){var a=K.getCursor(g).getSelectedRange();a.collapsed?b.preventDefault():ca.setDataFromRange(b,a)||runtime.log("Copy operation failed")}function q(b){var a;J.clipboardData&&J.clipboardData.getData?a=J.clipboardData.getData("Text"):b.clipboardData&&b.clipboardData.getData&&(a=b.clipboardData.getData("text/plain"));
a&&(da.removeCurrentSelection(),ga.paste(a));b.preventDefault?b.preventDefault():b.returnValue=!1}function b(){return!1}function d(b){if(T)T.onOperationExecuted(b)}function m(b){K.emit(ops.OdtDocument.signalUndoStackChanged,b)}function r(){var b;return T?(b=N.hasFocus(),T.moveBackward(1),b&&N.focus(),!0):!1}function A(){var b;return T?(b=N.hasFocus(),T.moveForward(1),b&&N.focus(),!0):!1}function y(b){var d=K.getCursor(g).getSelectedRange(),f=k(b).getAttribute("end");d&&f&&(b=e(b.clientX,b.clientY))&&
(ia.setUnfilteredPosition(b.container,b.offset),X.acceptPosition(ia)===l&&(d=d.cloneRange(),"left"===f?d.setStart(ia.container(),ia.unfilteredDomOffset()):d.setEnd(ia.container(),ia.unfilteredDomOffset()),a.setSelectedRange(d,"right"===f),K.emit(ops.Document.signalCursorMoved,a)))}function v(){V.selectRange(a.getSelectedRange(),a.hasForwardSelection(),1)}function s(){var b=J.getSelection(),d=0<b.rangeCount&&V.selectionToRange(b);W&&d&&(ha=!0,ka.clearSelection(),ia.setUnfilteredPosition(b.focusNode,
b.focusOffset),X.acceptPosition(ia)===l&&(2===na?V.expandToWordBoundaries(d.range):3<=na&&V.expandToParagraphBoundaries(d.range),a.setSelectedRange(d.range,d.hasForwardSelection),K.emit(ops.Document.signalCursorMoved,a)))}function B(b){var a=k(b),d=K.getCursor(g);if(W=null!==a&&$.containsNode(K.getOdfCanvas().getElement(),a))ha=!1,a=K.getRootElement(a)||K.getRootNode(),X=K.createRootFilter(a),na=0===b.button?b.detail:0,d&&b.shiftKey?J.getSelection().collapse(d.getAnchorNode(),0):(b=J.getSelection(),
a=d.getSelectedRange(),b.extend?d.hasForwardSelection()?(b.collapse(a.startContainer,a.startOffset),b.extend(a.endContainer,a.endOffset)):(b.collapse(a.endContainer,a.endOffset),b.extend(a.startContainer,a.startOffset)):(b.removeAllRanges(),b.addRange(a.cloneRange()))),1<na&&s()}function u(b){var a=K.getRootElement(b),d=K.createRootFilter(a),a=K.createStepIterator(b,0,[d,K.getPositionFilter()],a);a.setPosition(b,b.childNodes.length);return a.roundToNextStep()?{container:a.container(),offset:a.offset()}:
null}function z(b){var a;a=(a=J.getSelection())?{anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}:null;var d=J.getSelection().isCollapsed,f,c;a.anchorNode||a.focusNode||!(f=e(b.clientX,b.clientY))||(a.anchorNode=f.container,a.anchorOffset=f.offset,a.focusNode=a.anchorNode,a.focusOffset=a.anchorOffset);if(Q.isImage(a.focusNode)&&0===a.focusOffset&&Q.isCharacterFrame(a.focusNode.parentNode)){if(c=a.focusNode.parentNode,f=c.getBoundingClientRect(),
b.clientX>f.left&&(f=u(c)))a.focusNode=f.container,a.focusOffset=f.offset,d&&(a.anchorNode=a.focusNode,a.anchorOffset=a.focusOffset)}else Q.isImage(a.focusNode.firstChild)&&1===a.focusOffset&&Q.isCharacterFrame(a.focusNode)&&(f=u(a.focusNode))&&(a.anchorNode=a.focusNode=f.container,a.anchorOffset=a.focusOffset=f.offset);a.anchorNode&&a.focusNode&&(a=V.selectionToRange(a),V.selectRange(a.range,a.hasForwardSelection,0===b.button?b.detail:0));N.focus()}function G(b){var a;if(a=e(b.clientX,b.clientY))b=
a.container,a=a.offset,b={anchorNode:b,anchorOffset:a,focusNode:b,focusOffset:a},b=V.selectionToRange(b),V.selectRange(b.range,b.hasForwardSelection,2),N.focus()}function H(b){var d=k(b),e,f,c;la.processRequests();W&&(Q.isImage(d)&&Q.isCharacterFrame(d.parentNode)&&J.getSelection().isCollapsed?(V.selectImage(d.parentNode),N.focus()):ka.isSelectorElement(d)?N.focus():ha?(d=a.getSelectedRange(),f=d.collapsed,Q.isImage(d.endContainer)&&0===d.endOffset&&Q.isCharacterFrame(d.endContainer.parentNode)&&
(c=d.endContainer.parentNode,c=u(c))&&(d.setEnd(c.container,c.offset),f&&d.collapse(!1)),V.selectRange(d,a.hasForwardSelection(),0===b.button?b.detail:0),N.focus()):ua?z(b):(e=$.cloneEvent(b),S=runtime.setTimeout(function(){z(e)},0)),na=0,ha=W=!1)}function C(b){var a=K.getCursor(g).getSelectedRange();a.collapsed||ba.exportRangeToDataTransfer(b.dataTransfer,a)}function E(){W&&N.focus();na=0;ha=W=!1}function t(b){H(b)}function x(b){var a=k(b),d=null;"annotationRemoveButton"===a.className?(runtime.assert(aa,
"Remove buttons are displayed on annotations while annotation editing is disabled in the controller."),d=a.parentNode.getElementsByTagNameNS(odf.Namespaces.officens,"annotation").item(0),R.removeAnnotation(d),N.focus()):"webodf-draggable"!==a.getAttribute("class")&&H(b)}function w(b){(b=b.data)&&(-1===b.indexOf("\n")?da.insertText(b):ga.paste(b))}function M(b){return function(){b();return!0}}function D(b){return function(a){return K.getCursor(g).getSelectionType()===ops.OdtCursor.RangeSelection?b(a):
!0}}function I(b){N.unsubscribe("keydown",L.handleEvent);N.unsubscribe("keypress",Y.handleEvent);N.unsubscribe("keyup",ea.handleEvent);N.unsubscribe("copy",h);N.unsubscribe("mousedown",B);N.unsubscribe("mousemove",la.trigger);N.unsubscribe("mouseup",x);N.unsubscribe("contextmenu",t);N.unsubscribe("dragstart",C);N.unsubscribe("dragend",E);N.unsubscribe("click",oa.handleClick);N.unsubscribe("longpress",G);N.unsubscribe("drag",y);N.unsubscribe("dragstop",v);K.unsubscribe(ops.OdtDocument.signalOperationEnd,
ma.trigger);K.unsubscribe(ops.Document.signalCursorAdded,ja.registerCursor);K.unsubscribe(ops.Document.signalCursorRemoved,ja.removeCursor);K.unsubscribe(ops.OdtDocument.signalOperationEnd,d);b()}var J=runtime.getWindow(),K=c.getOdtDocument(),F=new gui.SessionConstraints,U=new gui.SessionContext(c,g),$=core.DomUtils,Q=odf.OdfUtils,ba=new gui.MimeDataExporter,ca=new gui.Clipboard(ba),L=new gui.KeyboardHandler,Y=new gui.KeyboardHandler,ea=new gui.KeyboardHandler,W=!1,fa=new odf.ObjectNameGenerator(K.getOdfCanvas().odfContainer(),
g),ha=!1,X=null,S,T=null,N=new gui.EventManager(K),aa=f.annotationsEnabled,R=new gui.AnnotationController(c,F,g),Z=new gui.DirectFormattingController(c,F,U,g,fa,f.directTextStylingEnabled,f.directParagraphStylingEnabled),da=new gui.TextController(c,F,U,g,Z.createCursorStyleOp,Z.createParagraphStyleOps),pa=new gui.ImageController(c,F,U,g,fa),ka=new gui.ImageSelector(K.getOdfCanvas()),ia=K.createPositionIterator(K.getRootNode()),la,ma,ga=new gui.PasteController(c,F,U,g),ja=new gui.InputMethodEditor(g,
N),na=0,oa=new gui.HyperlinkClickHandler(K.getOdfCanvas().getElement,L,ea),sa=new gui.HyperlinkController(c,F,U,g),V=new gui.SelectionController(c,g),ta=new gui.MetadataController(c,g),O=gui.KeyboardHandler.Modifier,P=gui.KeyboardHandler.KeyCode,qa=-1!==J.navigator.appVersion.toLowerCase().indexOf("mac"),ua=-1!==["iPad","iPod","iPhone"].indexOf(J.navigator.platform),ra;runtime.assert(null!==J,"Expected to be run in an environment which has a global window, like a browser.");this.undo=r;this.redo=
A;this.insertLocalCursor=function(){runtime.assert(void 0===c.getOdtDocument().getCursor(g),"Inserting local cursor a second time.");var b=new ops.OpAddCursor;b.init({memberid:g});c.enqueue([b]);N.focus()};this.removeLocalCursor=function(){runtime.assert(void 0!==c.getOdtDocument().getCursor(g),"Removing local cursor without inserting before.");var b=new ops.OpRemoveCursor;b.init({memberid:g});c.enqueue([b])};this.startEditing=function(){ja.subscribe(gui.InputMethodEditor.signalCompositionStart,da.removeCurrentSelection);
ja.subscribe(gui.InputMethodEditor.signalCompositionEnd,w);N.subscribe("beforecut",n);N.subscribe("cut",p);N.subscribe("beforepaste",b);N.subscribe("paste",q);T&&T.initialize();N.setEditing(!0);oa.setModifier(qa?O.Meta:O.Ctrl);L.bind(P.Backspace,O.None,M(da.removeTextByBackspaceKey),!0);L.bind(P.Delete,O.None,da.removeTextByDeleteKey);L.bind(P.Tab,O.None,D(function(){da.insertText("\t");return!0}));qa?(L.bind(P.Clear,O.None,da.removeCurrentSelection),L.bind(P.B,O.Meta,D(Z.toggleBold)),L.bind(P.I,
O.Meta,D(Z.toggleItalic)),L.bind(P.U,O.Meta,D(Z.toggleUnderline)),L.bind(P.L,O.MetaShift,D(Z.alignParagraphLeft)),L.bind(P.E,O.MetaShift,D(Z.alignParagraphCenter)),L.bind(P.R,O.MetaShift,D(Z.alignParagraphRight)),L.bind(P.J,O.MetaShift,D(Z.alignParagraphJustified)),aa&&L.bind(P.C,O.MetaShift,R.addAnnotation),L.bind(P.Z,O.Meta,r),L.bind(P.Z,O.MetaShift,A)):(L.bind(P.B,O.Ctrl,D(Z.toggleBold)),L.bind(P.I,O.Ctrl,D(Z.toggleItalic)),L.bind(P.U,O.Ctrl,D(Z.toggleUnderline)),L.bind(P.L,O.CtrlShift,D(Z.alignParagraphLeft)),
L.bind(P.E,O.CtrlShift,D(Z.alignParagraphCenter)),L.bind(P.R,O.CtrlShift,D(Z.alignParagraphRight)),L.bind(P.J,O.CtrlShift,D(Z.alignParagraphJustified)),aa&&L.bind(P.C,O.CtrlAlt,R.addAnnotation),L.bind(P.Z,O.Ctrl,r),L.bind(P.Z,O.CtrlShift,A));Y.setDefault(D(function(b){var a;a=null===b.which||void 0===b.which?String.fromCharCode(b.keyCode):0!==b.which&&0!==b.charCode?String.fromCharCode(b.which):null;return!a||b.altKey||b.ctrlKey||b.metaKey?!1:(da.insertText(a),!0)}));Y.bind(P.Enter,O.None,D(da.enqueueParagraphSplittingOps))};
this.endEditing=function(){ja.unsubscribe(gui.InputMethodEditor.signalCompositionStart,da.removeCurrentSelection);ja.unsubscribe(gui.InputMethodEditor.signalCompositionEnd,w);N.unsubscribe("cut",p);N.unsubscribe("beforecut",n);N.unsubscribe("paste",q);N.unsubscribe("beforepaste",b);N.setEditing(!1);oa.setModifier(O.None);L.bind(P.Backspace,O.None,function(){return!0},!0);L.unbind(P.Delete,O.None);L.unbind(P.Tab,O.None);qa?(L.unbind(P.Clear,O.None),L.unbind(P.B,O.Meta),L.unbind(P.I,O.Meta),L.unbind(P.U,
O.Meta),L.unbind(P.L,O.MetaShift),L.unbind(P.E,O.MetaShift),L.unbind(P.R,O.MetaShift),L.unbind(P.J,O.MetaShift),aa&&L.unbind(P.C,O.MetaShift),L.unbind(P.Z,O.Meta),L.unbind(P.Z,O.MetaShift)):(L.unbind(P.B,O.Ctrl),L.unbind(P.I,O.Ctrl),L.unbind(P.U,O.Ctrl),L.unbind(P.L,O.CtrlShift),L.unbind(P.E,O.CtrlShift),L.unbind(P.R,O.CtrlShift),L.unbind(P.J,O.CtrlShift),aa&&L.unbind(P.C,O.CtrlAlt),L.unbind(P.Z,O.Ctrl),L.unbind(P.Z,O.CtrlShift));Y.setDefault(null);Y.unbind(P.Enter,O.None)};this.getInputMemberId=
function(){return g};this.getSession=function(){return c};this.getSessionConstraints=function(){return F};this.setUndoManager=function(b){T&&T.unsubscribe(gui.UndoManager.signalUndoStackChanged,m);if(T=b)T.setDocument(K),T.setPlaybackFunction(c.enqueue),T.subscribe(gui.UndoManager.signalUndoStackChanged,m)};this.getUndoManager=function(){return T};this.getMetadataController=function(){return ta};this.getAnnotationController=function(){return R};this.getDirectFormattingController=function(){return Z};
this.getHyperlinkClickHandler=function(){return oa};this.getHyperlinkController=function(){return sa};this.getImageController=function(){return pa};this.getSelectionController=function(){return V};this.getTextController=function(){return da};this.getEventManager=function(){return N};this.getKeyboardHandlers=function(){return{keydown:L,keypress:Y}};this.destroy=function(b){var a=[la.destroy,ma.destroy,Z.destroy,ja.destroy,N.destroy,oa.destroy,sa.destroy,ta.destroy,V.destroy,da.destroy,I];ra&&a.unshift(ra.destroy);
runtime.clearTimeout(S);core.Async.destroyAll(a,b)};la=core.Task.createRedrawTask(s);ma=core.Task.createRedrawTask(function(){var b=K.getCursor(g);if(b&&b.getSelectionType()===ops.OdtCursor.RegionSelection&&(b=Q.getImageElements(b.getSelectedRange())[0])){ka.select(b.parentNode);return}ka.clearSelection()});L.bind(P.Left,O.None,D(V.moveCursorToLeft));L.bind(P.Right,O.None,D(V.moveCursorToRight));L.bind(P.Up,O.None,D(V.moveCursorUp));L.bind(P.Down,O.None,D(V.moveCursorDown));L.bind(P.Left,O.Shift,
D(V.extendSelectionToLeft));L.bind(P.Right,O.Shift,D(V.extendSelectionToRight));L.bind(P.Up,O.Shift,D(V.extendSelectionUp));L.bind(P.Down,O.Shift,D(V.extendSelectionDown));L.bind(P.Home,O.None,D(V.moveCursorToLineStart));L.bind(P.End,O.None,D(V.moveCursorToLineEnd));L.bind(P.Home,O.Ctrl,D(V.moveCursorToDocumentStart));L.bind(P.End,O.Ctrl,D(V.moveCursorToDocumentEnd));L.bind(P.Home,O.Shift,D(V.extendSelectionToLineStart));L.bind(P.End,O.Shift,D(V.extendSelectionToLineEnd));L.bind(P.Up,O.CtrlShift,
D(V.extendSelectionToParagraphStart));L.bind(P.Down,O.CtrlShift,D(V.extendSelectionToParagraphEnd));L.bind(P.Home,O.CtrlShift,D(V.extendSelectionToDocumentStart));L.bind(P.End,O.CtrlShift,D(V.extendSelectionToDocumentEnd));qa?(L.bind(P.Left,O.Alt,D(V.moveCursorBeforeWord)),L.bind(P.Right,O.Alt,D(V.moveCursorPastWord)),L.bind(P.Left,O.Meta,D(V.moveCursorToLineStart)),L.bind(P.Right,O.Meta,D(V.moveCursorToLineEnd)),L.bind(P.Home,O.Meta,D(V.moveCursorToDocumentStart)),L.bind(P.End,O.Meta,D(V.moveCursorToDocumentEnd)),
L.bind(P.Left,O.AltShift,D(V.extendSelectionBeforeWord)),L.bind(P.Right,O.AltShift,D(V.extendSelectionPastWord)),L.bind(P.Left,O.MetaShift,D(V.extendSelectionToLineStart)),L.bind(P.Right,O.MetaShift,D(V.extendSelectionToLineEnd)),L.bind(P.Up,O.AltShift,D(V.extendSelectionToParagraphStart)),L.bind(P.Down,O.AltShift,D(V.extendSelectionToParagraphEnd)),L.bind(P.Up,O.MetaShift,D(V.extendSelectionToDocumentStart)),L.bind(P.Down,O.MetaShift,D(V.extendSelectionToDocumentEnd)),L.bind(P.A,O.Meta,D(V.extendSelectionToEntireDocument))):
(L.bind(P.Left,O.Ctrl,D(V.moveCursorBeforeWord)),L.bind(P.Right,O.Ctrl,D(V.moveCursorPastWord)),L.bind(P.Left,O.CtrlShift,D(V.extendSelectionBeforeWord)),L.bind(P.Right,O.CtrlShift,D(V.extendSelectionPastWord)),L.bind(P.A,O.Ctrl,D(V.extendSelectionToEntireDocument)));ua&&(ra=new gui.IOSSafariSupport(N));N.subscribe("keydown",L.handleEvent);N.subscribe("keypress",Y.handleEvent);N.subscribe("keyup",ea.handleEvent);N.subscribe("copy",h);N.subscribe("mousedown",B);N.subscribe("mousemove",la.trigger);
N.subscribe("mouseup",x);N.subscribe("contextmenu",t);N.subscribe("dragstart",C);N.subscribe("dragend",E);N.subscribe("click",oa.handleClick);N.subscribe("longpress",G);N.subscribe("drag",y);N.subscribe("dragstop",v);K.subscribe(ops.OdtDocument.signalOperationEnd,ma.trigger);K.subscribe(ops.Document.signalCursorAdded,ja.registerCursor);K.subscribe(ops.Document.signalCursorRemoved,ja.removeCursor);K.subscribe(ops.OdtDocument.signalOperationEnd,d)}})();
gui.CaretManager=function(l,c){function g(a){return k.hasOwnProperty(a)?k[a]:null}function a(){return Object.keys(k).map(function(a){return k[a]})}function f(a){var f=k[a];f&&(delete k[a],a===l.getInputMemberId()?(p.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,f.ensureVisible),p.unsubscribe(ops.Document.signalCursorMoved,f.refreshCursorBlinking),n.unsubscribe("compositionupdate",f.handleUpdate),n.unsubscribe("compositionend",f.handleUpdate),n.unsubscribe("focus",f.setFocus),n.unsubscribe("blur",
f.removeFocus),e.removeEventListener("focus",f.show,!1),e.removeEventListener("blur",f.hide,!1)):p.unsubscribe(ops.OdtDocument.signalProcessingBatchEnd,f.handleUpdate),f.destroy(function(){}))}var k={},e=runtime.getWindow(),p=l.getSession().getOdtDocument(),n=l.getEventManager();this.registerCursor=function(a,f,b){var d=a.getMemberId();a=new gui.Caret(a,c,f,b);k[d]=a;d===l.getInputMemberId()?(runtime.log("Starting to track input on new cursor of "+d),p.subscribe(ops.OdtDocument.signalProcessingBatchEnd,
a.ensureVisible),p.subscribe(ops.Document.signalCursorMoved,a.refreshCursorBlinking),n.subscribe("compositionupdate",a.handleUpdate),n.subscribe("compositionend",a.handleUpdate),n.subscribe("focus",a.setFocus),n.subscribe("blur",a.removeFocus),e.addEventListener("focus",a.show,!1),e.addEventListener("blur",a.hide,!1),a.setOverlayElement(n.getEventTrap())):p.subscribe(ops.OdtDocument.signalProcessingBatchEnd,a.handleUpdate);return a};this.getCaret=g;this.getCarets=a;this.destroy=function(e){var c=
a().map(function(b){return b.destroy});l.getSelectionController().setCaretXPositionLocator(null);p.unsubscribe(ops.Document.signalCursorRemoved,f);k={};core.Async.destroyAll(c,e)};l.getSelectionController().setCaretXPositionLocator(function(){var a=g(l.getInputMemberId()),e;a&&(e=a.getBoundingClientRect());return e?e.right:void 0});p.subscribe(ops.Document.signalCursorRemoved,f)};
gui.EditInfoHandle=function(l){var c=[],g,a=l.ownerDocument,f=a.documentElement.namespaceURI;this.setEdits=function(k){c=k;var e,l,n,h;g.innerHTML="";for(k=0;k<c.length;k+=1)e=a.createElementNS(f,"div"),e.className="editInfo",l=a.createElementNS(f,"span"),l.className="editInfoColor",l.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",c[k].memberid),n=a.createElementNS(f,"span"),n.className="editInfoAuthor",n.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",c[k].memberid),
h=a.createElementNS(f,"span"),h.className="editInfoTime",h.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",c[k].memberid),h.innerHTML=c[k].time,e.appendChild(l),e.appendChild(n),e.appendChild(h),g.appendChild(e)};this.show=function(){g.style.display="block"};this.hide=function(){g.style.display="none"};this.destroy=function(a){l.removeChild(g);a()};g=a.createElementNS(f,"div");g.setAttribute("class","editInfoHandle");g.style.display="none";l.appendChild(g)};
ops.EditInfo=function(l,c){function g(){var a=[],e;for(e in f)f.hasOwnProperty(e)&&a.push({memberid:e,time:f[e].time});a.sort(function(a,e){return a.time-e.time});return a}var a,f={};this.getNode=function(){return a};this.getOdtDocument=function(){return c};this.getEdits=function(){return f};this.getSortedEdits=function(){return g()};this.addEdit=function(a,e){f[a]={time:e}};this.clearEdits=function(){f={}};this.destroy=function(f){l.parentNode&&l.removeChild(a);f()};a=c.getDOMDocument().createElementNS("urn:webodf:names:editinfo",
"editinfo");l.insertBefore(a,l.firstChild)};
gui.EditInfoMarker=function(l,c){function g(a,b){return runtime.setTimeout(function(){e.style.opacity=a},b)}var a=this,f,k,e,p,n,h;this.addEdit=function(a,b){var d=Date.now()-b;l.addEdit(a,b);k.setEdits(l.getSortedEdits());e.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",a);runtime.clearTimeout(n);runtime.clearTimeout(h);1E4>d?(p=g(1,0),n=g(.5,1E4-d),h=g(.2,2E4-d)):1E4<=d&&2E4>d?(p=g(.5,0),h=g(.2,2E4-d)):p=g(.2,0)};this.getEdits=function(){return l.getEdits()};this.clearEdits=function(){l.clearEdits();
k.setEdits([]);e.hasAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")&&e.removeAttributeNS("urn:webodf:names:editinfo","editinfo:memberid")};this.getEditInfo=function(){return l};this.show=function(){e.style.display="block"};this.hide=function(){a.hideHandle();e.style.display="none"};this.showHandle=function(){k.show()};this.hideHandle=function(){k.hide()};this.destroy=function(a){runtime.clearTimeout(p);runtime.clearTimeout(n);runtime.clearTimeout(h);f.removeChild(e);k.destroy(function(b){b?
a(b):l.destroy(a)})};(function(){var h=l.getOdtDocument().getDOMDocument();e=h.createElementNS(h.documentElement.namespaceURI,"div");e.setAttribute("class","editInfoMarker");e.onmouseover=function(){a.showHandle()};e.onmouseout=function(){a.hideHandle()};f=l.getNode();f.appendChild(e);k=new gui.EditInfoHandle(f);c||a.hide()})()};
gui.HyperlinkTooltipView=function(l,c){var g=core.DomUtils,a=odf.OdfUtils,f=runtime.getWindow(),k,e,p;runtime.assert(null!==f,"Expected to be run in an environment which has a global window, like a browser.");this.showTooltip=function(n){var h=n.target||n.srcElement,q=l.getSizer(),b=l.getZoomLevel(),d;a:{for(;h;){if(a.isHyperlink(h))break a;if(a.isParagraph(h)||a.isInlineRoot(h))break;h=h.parentNode}h=null}if(h){g.containsNode(q,p)||q.appendChild(p);d=e;var m;if(c)switch(c()){case gui.KeyboardHandler.Modifier.Ctrl:m=
runtime.tr("Ctrl-click to follow link");break;case gui.KeyboardHandler.Modifier.Meta:m=runtime.tr("\u2318-click to follow link");break;default:m=""}else m="";d.textContent=m;k.textContent=a.getHyperlinkTarget(h);p.style.display="block";d=f.innerWidth-p.offsetWidth-15;h=n.clientX>d?d:n.clientX+15;d=f.innerHeight-p.offsetHeight-10;n=n.clientY>d?d:n.clientY+10;q=q.getBoundingClientRect();h=(h-q.left)/b;n=(n-q.top)/b;p.style.left=h+"px";p.style.top=n+"px"}};this.hideTooltip=function(){p.style.display=
"none"};this.destroy=function(a){p.parentNode&&p.parentNode.removeChild(p);a()};(function(){var a=l.getElement().ownerDocument;k=a.createElement("span");e=a.createElement("span");k.className="webodf-hyperlinkTooltipLink";e.className="webodf-hyperlinkTooltipText";p=a.createElement("div");p.className="webodf-hyperlinkTooltip";p.appendChild(k);p.appendChild(e);l.getElement().appendChild(p)})()};
gui.OdfFieldView=function(l){function c(){var a=odf.OdfSchema.getFields().map(function(a){return a.replace(":","|")}),c=a.join(",\n")+"\n{ background-color: #D0D0D0; }\n",a=a.map(function(a){return a+":empty::after"}).join(",\n")+"\n{ content:' '; white-space: pre; }\n";return c+"\n"+a}var g,a=l.getElement().ownerDocument;this.showFieldHighlight=function(){g.appendChild(a.createTextNode(c()))};this.hideFieldHighlight=function(){for(var a=g.sheet,c=a.cssRules;c.length;)a.deleteRule(c.length-1)};this.destroy=
function(a){g.parentNode&&g.parentNode.removeChild(g);a()};g=function(){var f=a.getElementsByTagName("head").item(0),c=a.createElement("style"),e="";c.type="text/css";c.media="screen, print, handheld, projection";odf.Namespaces.forEachPrefix(function(a,f){e+="@namespace "+a+" url("+f+");\n"});c.appendChild(a.createTextNode(e));f.appendChild(c);return c}()};
gui.ShadowCursor=function(l){var c=l.getDOMDocument().createRange(),g=!0;this.removeFromDocument=function(){};this.getMemberId=function(){return gui.ShadowCursor.ShadowCursorMemberId};this.getSelectedRange=function(){return c};this.setSelectedRange=function(a,f){c=a;g=!1!==f};this.hasForwardSelection=function(){return g};this.getDocument=function(){return l};this.getSelectionType=function(){return ops.OdtCursor.RangeSelection};c.setStart(l.getRootNode(),0)};gui.ShadowCursor.ShadowCursorMemberId="";
gui.SelectionView=function(l){};gui.SelectionView.prototype.rerender=function(){};gui.SelectionView.prototype.show=function(){};gui.SelectionView.prototype.hide=function(){};gui.SelectionView.prototype.destroy=function(l){};
gui.SelectionViewManager=function(l){function c(){return Object.keys(g).map(function(a){return g[a]})}var g={};this.getSelectionView=function(a){return g.hasOwnProperty(a)?g[a]:null};this.getSelectionViews=c;this.removeSelectionView=function(a){g.hasOwnProperty(a)&&(g[a].destroy(function(){}),delete g[a])};this.hideSelectionView=function(a){g.hasOwnProperty(a)&&g[a].hide()};this.showSelectionView=function(a){g.hasOwnProperty(a)&&g[a].show()};this.rerenderSelectionViews=function(){Object.keys(g).forEach(function(a){g[a].rerender()})};
this.registerCursor=function(a,f){var c=a.getMemberId(),e=new l(a);f?e.show():e.hide();return g[c]=e};this.destroy=function(a){function f(e,c){c?a(c):e<g.length?g[e].destroy(function(a){f(e+1,a)}):a()}var g=c();f(0,void 0)}};gui.SessionViewOptions=function(){this.caretBlinksOnRangeSelect=this.caretAvatarsInitiallyVisible=this.editInfoMarkersInitiallyVisible=!0};
(function(){function l(c,g){return void 0!==c?Boolean(c):g}gui.SessionView=function(c,g,a,f,k,e){function p(b){b.memberId===g&&H.getViewport().scrollIntoView(b.annotation.getBoundingClientRect())}function n(){var b=document.getElementsByTagName("head").item(0),a=document.createElement("style");a.type="text/css";a.media="screen, print, handheld, projection";b.appendChild(a);return a}function h(b,a,d){function e(a,d,f){d=a+'[editinfo|memberid="'+b+'"]'+f+d;a:{var c=B.firstChild;for(a=a+'[editinfo|memberid="'+
b+'"]'+f+"{";c;){if(c.nodeType===Node.TEXT_NODE&&0===c.data.indexOf(a)){a=c;break a}c=c.nextSibling}a=null}a?a.data=d:B.appendChild(document.createTextNode(d))}e("div.editInfoMarker","{ background-color: "+d+"; }","");e("span.editInfoColor","{ background-color: "+d+"; }","");e("span.editInfoAuthor",'{ content: "'+a+'"; }',":before");e("dc|creator","{ background-color: "+d+"; }","");e(".webodf-selectionOverlay","{ fill: "+d+"; stroke: "+d+";}","");b===g&&(e(".webodf-touchEnabled .webodf-selectionOverlay",
"{ display: block; }"," > .webodf-draggable"),b=gui.ShadowCursor.ShadowCursorMemberId,e(".webodf-selectionOverlay","{ fill: "+d+"; stroke: "+d+";}",""),e(".webodf-touchEnabled .webodf-selectionOverlay","{ display: block; }"," > .webodf-draggable"))}function q(b){var a,d;for(d in z)z.hasOwnProperty(d)&&(a=z[d],b?a.show():a.hide())}function b(b){k.getCarets().forEach(function(a){b?a.showHandle():a.hideHandle()})}function d(b){var a=b.getMemberId();b=b.getProperties();h(a,b.fullName,b.color)}function m(b){var d=
b.getMemberId(),f=a.getOdtDocument().getMember(d).getProperties();k.registerCursor(b,t,x);e.registerCursor(b,!0);if(b=k.getCaret(d))b.setAvatarImageUrl(f.imageUrl),b.setColor(f.color);runtime.log("+++ View here +++ eagerly created an Caret for '"+d+"'! +++")}function r(b){b=b.getMemberId();var a=e.getSelectionView(g),d=e.getSelectionView(gui.ShadowCursor.ShadowCursorMemberId),f=k.getCaret(g);b===g?(d.hide(),a&&a.show(),f&&f.show()):b===gui.ShadowCursor.ShadowCursorMemberId&&(d.show(),a&&a.hide(),
f&&f.hide())}function A(b){e.removeSelectionView(b)}function y(b){var d=b.paragraphElement,e=b.memberId;b=b.timeStamp;var f,c="",h=d.getElementsByTagNameNS("urn:webodf:names:editinfo","editinfo").item(0);h?(c=h.getAttributeNS("urn:webodf:names:editinfo","id"),f=z[c]):(c=Math.random().toString(),f=new ops.EditInfo(d,a.getOdtDocument()),f=new gui.EditInfoMarker(f,E),h=d.getElementsByTagNameNS("urn:webodf:names:editinfo","editinfo").item(0),h.setAttributeNS("urn:webodf:names:editinfo","id",c),z[c]=f);
f.addEdit(e,new Date(b));C.trigger()}function v(){var b;""!==u.innerHTML&&(u.innerHTML="");!0===f.getState(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN)&&(b=a.getOdtDocument().getMember(g))&&(b=b.getProperties().fullName,u.appendChild(document.createTextNode(".annotationWrapper:not([creator = '"+b+"']) .annotationRemoveButton { display: none; }")))}function s(b){var a=Object.keys(z).map(function(b){return z[b]});G.unsubscribe(ops.Document.signalMemberAdded,d);G.unsubscribe(ops.Document.signalMemberUpdated,
d);G.unsubscribe(ops.Document.signalCursorAdded,m);G.unsubscribe(ops.Document.signalCursorRemoved,A);G.unsubscribe(ops.OdtDocument.signalParagraphChanged,y);G.unsubscribe(ops.Document.signalCursorMoved,r);G.unsubscribe(ops.OdtDocument.signalParagraphChanged,e.rerenderSelectionViews);G.unsubscribe(ops.OdtDocument.signalTableAdded,e.rerenderSelectionViews);G.unsubscribe(ops.OdtDocument.signalParagraphStyleModified,e.rerenderSelectionViews);f.unsubscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,
v);G.unsubscribe(ops.Document.signalMemberAdded,v);G.unsubscribe(ops.Document.signalMemberUpdated,v);B.parentNode.removeChild(B);u.parentNode.removeChild(u);(function I(d,e){e?b(e):d<a.length?a[d].destroy(function(b){I(d+1,b)}):b()})(0,void 0)}var B,u,z={},G,H,C,E=l(c.editInfoMarkersInitiallyVisible,!0),t=l(c.caretAvatarsInitiallyVisible,!0),x=l(c.caretBlinksOnRangeSelect,!0);this.showEditInfoMarkers=function(){E||(E=!0,q(E))};this.hideEditInfoMarkers=function(){E&&(E=!1,q(E))};this.showCaretAvatars=
function(){t||(t=!0,b(t))};this.hideCaretAvatars=function(){t&&(t=!1,b(t))};this.getSession=function(){return a};this.getCaret=function(b){return k.getCaret(b)};this.destroy=function(b){var a=[C.destroy,s];G.unsubscribe(ops.OdtDocument.signalAnnotationAdded,p);core.Async.destroyAll(a,b)};G=a.getOdtDocument();H=G.getOdfCanvas();G.subscribe(ops.OdtDocument.signalAnnotationAdded,p);G.subscribe(ops.Document.signalMemberAdded,d);G.subscribe(ops.Document.signalMemberUpdated,d);G.subscribe(ops.Document.signalCursorAdded,
m);G.subscribe(ops.Document.signalCursorRemoved,A);G.subscribe(ops.OdtDocument.signalParagraphChanged,y);G.subscribe(ops.Document.signalCursorMoved,r);G.subscribe(ops.OdtDocument.signalParagraphChanged,e.rerenderSelectionViews);G.subscribe(ops.OdtDocument.signalTableAdded,e.rerenderSelectionViews);G.subscribe(ops.OdtDocument.signalParagraphStyleModified,e.rerenderSelectionViews);f.subscribe(gui.CommonConstraints.EDIT.ANNOTATIONS.ONLY_DELETE_OWN,v);G.subscribe(ops.Document.signalMemberAdded,v);G.subscribe(ops.Document.signalMemberUpdated,
v);B=n();B.appendChild(document.createTextNode("@namespace editinfo url(urn:webodf:names:editinfo);"));B.appendChild(document.createTextNode("@namespace dc url(http://purl.org/dc/elements/1.1/);"));u=n();v();C=core.Task.createRedrawTask(function(){var b=H.getAnnotationViewManager();b&&(b.rehighlightAnnotations(),G.fixCursorPositions())})}})();
gui.SvgSelectionView=function(l){function c(){var b=d.getRootNode();m!==b&&(m=b,r=d.getCanvas().getSizer(),r.appendChild(y),y.setAttribute("class","webodf-selectionOverlay"),s.setAttribute("class","webodf-draggable"),B.setAttribute("class","webodf-draggable"),s.setAttribute("end","left"),B.setAttribute("end","right"),s.setAttribute("r",8),B.setAttribute("r",8),y.appendChild(v),y.appendChild(s),y.appendChild(B))}function g(b){b=b.getBoundingClientRect();return Boolean(b&&0!==b.height)}function a(b){var a=
u.getTextElements(b,!0,!1),d=b.cloneRange(),e=b.cloneRange();b=b.cloneRange();if(!a.length)return null;var f;a:{f=0;var c=a[f],h=d.startContainer===c?d.startOffset:0,m=h;d.setStart(c,h);for(d.setEnd(c,m);!g(d);){if(c.nodeType===Node.ELEMENT_NODE&&m<c.childNodes.length)m=c.childNodes.length;else if(c.nodeType===Node.TEXT_NODE&&m<c.length)m+=1;else if(a[f])c=a[f],f+=1,h=m=0;else{f=!1;break a}d.setStart(c,h);d.setEnd(c,m)}f=!0}if(!f)return null;a:{f=a.length-1;c=a[f];m=h=e.endContainer===c?e.endOffset:
c.nodeType===Node.TEXT_NODE?c.length:c.childNodes.length;e.setStart(c,h);for(e.setEnd(c,m);!g(e);){if(c.nodeType===Node.ELEMENT_NODE&&0<h)h=0;else if(c.nodeType===Node.TEXT_NODE&&0<h)h-=1;else if(a[f])c=a[f],f-=1,h=m=c.length||c.childNodes.length;else{a=!1;break a}e.setStart(c,h);e.setEnd(c,m)}a=!0}if(!a)return null;b.setStart(d.startContainer,d.startOffset);b.setEnd(e.endContainer,e.endOffset);return{firstRange:d,lastRange:e,fillerRange:b}}function f(b,a){var d={};d.top=Math.min(b.top,a.top);d.left=
Math.min(b.left,a.left);d.right=Math.max(b.right,a.right);d.bottom=Math.max(b.bottom,a.bottom);d.width=d.right-d.left;d.height=d.bottom-d.top;return d}function k(b,a){a&&0<a.width&&0<a.height&&(b=b?f(b,a):a);return b}function e(b){function a(b){C.setUnfilteredPosition(b,0);return s.acceptNode(b)===E&&x.acceptPosition(C)===E?E:t}function e(b){var d=null;a(b)===E&&(d=z.getBoundingClientRect(b));return d}var f=b.commonAncestorContainer,c=b.startContainer,h=b.endContainer,m=b.startOffset,g=b.endOffset,
l,r,p=null,n,q=A.createRange(),x,s=new odf.OdfNodeFilter,y;if(c===f||h===f)return q=b.cloneRange(),p=q.getBoundingClientRect(),q.detach(),p;for(b=c;b.parentNode!==f;)b=b.parentNode;for(r=h;r.parentNode!==f;)r=r.parentNode;x=d.createRootFilter(c);for(f=b.nextSibling;f&&f!==r;)n=e(f),p=k(p,n),f=f.nextSibling;if(u.isParagraph(b))p=k(p,z.getBoundingClientRect(b));else if(b.nodeType===Node.TEXT_NODE)f=b,q.setStart(f,m),q.setEnd(f,f===r?g:f.length),n=q.getBoundingClientRect(),p=k(p,n);else for(y=A.createTreeWalker(b,
NodeFilter.SHOW_TEXT,a,!1),f=y.currentNode=c;f&&f!==h;)q.setStart(f,m),q.setEnd(f,f.length),n=q.getBoundingClientRect(),p=k(p,n),l=f,m=0,f=y.nextNode();l||(l=c);if(u.isParagraph(r))p=k(p,z.getBoundingClientRect(r));else if(r.nodeType===Node.TEXT_NODE)f=r,q.setStart(f,f===b?m:0),q.setEnd(f,g),n=q.getBoundingClientRect(),p=k(p,n);else for(y=A.createTreeWalker(r,NodeFilter.SHOW_TEXT,a,!1),f=y.currentNode=h;f&&f!==l;)if(q.setStart(f,0),q.setEnd(f,g),n=q.getBoundingClientRect(),p=k(p,n),f=y.previousNode())g=
f.length;return p}function p(b,a){var d=b.getBoundingClientRect(),e={width:0};e.top=d.top;e.bottom=d.bottom;e.height=d.height;e.left=e.right=a?d.right:d.left;return e}function n(){var b=l.getSelectedRange(),d;if(d=H&&l.getSelectionType()===ops.OdtCursor.RangeSelection&&!b.collapsed){c();var h=z.getBoundingClientRect(r),m=G.getZoomLevel(),b=a(b),g,k,t,u,n,q;if(b){d=b.firstRange;g=b.lastRange;k=b.fillerRange;t=z.translateRect(p(d,!1),h,m);n=z.translateRect(p(g,!0),h,m);u=(u=e(k))?z.translateRect(u,
h,m):f(t,n);q=u.left;u=t.left+Math.max(0,u.width-(t.left-u.left));h=Math.min(t.top,n.top);m=n.top+n.height;q=[{x:t.left,y:h+t.height},{x:t.left,y:h},{x:u,y:h},{x:u,y:m-n.height},{x:n.right,y:m-n.height},{x:n.right,y:m},{x:q,y:m},{x:q,y:h+t.height},{x:t.left,y:h+t.height}];u="";var x;for(x=0;x<q.length;x+=1)u+=q[x].x+","+q[x].y+" ";v.setAttribute("points",u);s.setAttribute("cx",t.left);s.setAttribute("cy",h+t.height/2);B.setAttribute("cx",n.right);B.setAttribute("cy",m-n.height/2);d.detach();g.detach();
k.detach()}d=Boolean(b)}y.style.display=d?"block":"none"}function h(b){H&&b===l&&x.trigger()}function q(b){b=8/b;s.setAttribute("r",b);B.setAttribute("r",b)}function b(b){r.removeChild(y);r.classList.remove("webodf-virtualSelections");l.getDocument().unsubscribe(ops.Document.signalCursorMoved,h);G.unsubscribe(gui.ZoomHelper.signalZoomChanged,q);b()}var d=l.getDocument(),m,r,A=d.getDOMDocument(),y=A.createElementNS("http://www.w3.org/2000/svg","svg"),v=A.createElementNS("http://www.w3.org/2000/svg",
"polygon"),s=A.createElementNS("http://www.w3.org/2000/svg","circle"),B=A.createElementNS("http://www.w3.org/2000/svg","circle"),u=odf.OdfUtils,z=core.DomUtils,G=d.getCanvas().getZoomHelper(),H=!0,C=l.getDocument().createPositionIterator(d.getRootNode()),E=NodeFilter.FILTER_ACCEPT,t=NodeFilter.FILTER_REJECT,x;this.rerender=function(){H&&x.trigger()};this.show=function(){H=!0;x.trigger()};this.hide=function(){H=!1;x.trigger()};this.destroy=function(a){core.Async.destroyAll([x.destroy,b],a)};(function(){var b=
l.getMemberId();x=core.Task.createRedrawTask(n);c();y.setAttributeNS("urn:webodf:names:editinfo","editinfo:memberid",b);r.classList.add("webodf-virtualSelections");l.getDocument().subscribe(ops.Document.signalCursorMoved,h);G.subscribe(gui.ZoomHelper.signalZoomChanged,q);q(G.getZoomLevel())})()};
gui.UndoStateRules=function(){function l(a,c){var e=a.length;this.previous=function(){for(e-=1;0<=e;e-=1)if(c(a[e]))return a[e];return null}}function c(a){a=a.spec();var c;a.hasOwnProperty("position")&&(c=a.position);return c}function g(a){return a.isEdit}function a(a,g,e){if(!e)return e=c(a)-c(g),0===e||1===Math.abs(e);a=c(a);g=c(g);e=c(e);return a-g===g-e}this.isEditOperation=g;this.isPartOfOperationSet=function(f,c){var e=void 0!==f.group,p;if(!f.isEdit||0===c.length)return!0;p=c[c.length-1];if(e&&
f.group===p.group)return!0;a:switch(f.spec().optype){case "RemoveText":case "InsertText":p=!0;break a;default:p=!1}if(p&&c.some(g)){if(e){var n;e=f.spec().optype;p=new l(c,g);var h=p.previous(),q=null,b,d;runtime.assert(Boolean(h),"No edit operations found in state");d=h.group;runtime.assert(void 0!==d,"Operation has no group");for(b=1;h&&h.group===d;){if(e===h.spec().optype){n=h;break}h=p.previous()}if(n){for(h=p.previous();h;){if(h.group!==d){if(2===b)break;d=h.group;b+=1}if(e===h.spec().optype){q=
h;break}h=p.previous()}n=a(f,n,q)}else n=!1;return n}n=f.spec().optype;e=new l(c,g);p=e.previous();runtime.assert(Boolean(p),"No edit operations found in state");n=n===p.spec().optype?a(f,p,e.previous()):!1;return n}return!1}};
gui.TrivialUndoManager=function(l){function c(b){0<b.length&&(B=!0,d(b),B=!1)}function g(){v.emit(gui.UndoManager.signalUndoStackChanged,{undoAvailable:n.hasUndoStates(),redoAvailable:n.hasRedoStates()})}function a(){r!==b&&r!==A[A.length-1]&&A.push(r)}function f(b){var a=b.previousSibling||b.nextSibling;b.parentNode.removeChild(b);h.normalizeTextNodes(a)}function k(b){return Object.keys(b).map(function(a){return b[a]})}function e(b){function a(b){var h=b.spec();if(f[h.memberid])switch(h.optype){case "AddCursor":d[h.memberid]||
(d[h.memberid]=b,delete f[h.memberid],c-=1);break;case "MoveCursor":e[h.memberid]||(e[h.memberid]=b)}}var d={},e={},f={},c,h=b.pop();m.getMemberIds().forEach(function(b){f[b]=!0});for(c=Object.keys(f).length;h&&0<c;)h.reverse(),h.forEach(a),h=b.pop();return k(d).concat(k(e))}function p(){var d=q=m.cloneDocumentElement();h.getElementsByTagNameNS(d,"urn:webodf:names:cursor","cursor").forEach(f);h.getElementsByTagNameNS(d,"urn:webodf:names:cursor","anchor").forEach(f);a();r=b=e([b].concat(A));A.length=
0;y.length=0;g()}var n=this,h=core.DomUtils,q,b=[],d,m,r=[],A=[],y=[],v=new core.EventNotifier([gui.UndoManager.signalUndoStackChanged,gui.UndoManager.signalUndoStateCreated,gui.UndoManager.signalUndoStateModified,gui.TrivialUndoManager.signalDocumentRootReplaced]),s=l||new gui.UndoStateRules,B=!1;this.subscribe=function(b,a){v.subscribe(b,a)};this.unsubscribe=function(b,a){v.unsubscribe(b,a)};this.hasUndoStates=function(){return 0<A.length};this.hasRedoStates=function(){return 0<y.length};this.setDocument=
function(b){m=b};this.purgeInitialState=function(){A.length=0;y.length=0;b.length=0;r.length=0;q=null;g()};this.setInitialState=p;this.initialize=function(){q||p()};this.setPlaybackFunction=function(b){d=b};this.onOperationExecuted=function(d){B||(s.isEditOperation(d)&&(r===b||0<y.length)||!s.isPartOfOperationSet(d,r)?(y.length=0,a(),r=[d],A.push(r),v.emit(gui.UndoManager.signalUndoStateCreated,{operations:r}),g()):(r.push(d),v.emit(gui.UndoManager.signalUndoStateModified,{operations:r})))};this.moveForward=
function(b){for(var a=0,d;b&&y.length;)d=y.pop(),A.push(d),c(d),b-=1,a+=1;a&&(r=A[A.length-1],g());return a};this.moveBackward=function(a){for(var d=0;a&&A.length;)y.push(A.pop()),a-=1,d+=1;d&&(m.getMemberIds().forEach(function(b){m.removeCursor(b)}),m.setDocumentElement(q.cloneNode(!0)),v.emit(gui.TrivialUndoManager.signalDocumentRootReplaced,{}),c(b),A.forEach(c),r=A[A.length-1]||b,g());return d}};gui.TrivialUndoManager.signalDocumentRootReplaced="documentRootReplaced";
odf.GraphicProperties=function(l,c,g){var a=this,f=odf.Namespaces.stylens,k=odf.Namespaces.svgns;this.verticalPos=function(){return a.data.value("verticalPos")};this.verticalRel=function(){return a.data.value("verticalRel")};this.horizontalPos=function(){return a.data.value("horizontalPos")};this.horizontalRel=function(){return a.data.value("horizontalRel")};this.strokeWidth=function(){return a.data.value("strokeWidth")};this.data;a.data=new odf.LazyStyleProperties(void 0===g?void 0:g.data,{verticalPos:function(){var a=
l.getAttributeNS(f,"vertical-pos");return""===a?void 0:a},verticalRel:function(){var a=l.getAttributeNS(f,"vertical-rel");return""===a?void 0:a},horizontalPos:function(){var a=l.getAttributeNS(f,"horizontal-pos");return""===a?void 0:a},horizontalRel:function(){var a=l.getAttributeNS(f,"horizontal-rel");return""===a?void 0:a},strokeWidth:function(){var a=l.getAttributeNS(k,"stroke-width");return c.parseLength(a)}})};
odf.ComputedGraphicProperties=function(){var l;this.setGraphicProperties=function(c){l=c};this.verticalPos=function(){return l&&l.verticalPos()||"from-top"};this.verticalRel=function(){return l&&l.verticalRel()||"page"};this.horizontalPos=function(){return l&&l.horizontalPos()||"from-left"};this.horizontalRel=function(){return l&&l.horizontalRel()||"page"}};
odf.PageLayoutProperties=function(l,c,g){var a=this,f=odf.Namespaces.fons;this.pageHeight=function(){return a.data.value("pageHeight")||1123};this.pageWidth=function(){return a.data.value("pageWidth")||794};this.data;a.data=new odf.LazyStyleProperties(void 0===g?void 0:g.data,{pageHeight:function(){var a;l&&(a=l.getAttributeNS(f,"page-height"),a=c.parseLength(a));return a},pageWidth:function(){var a;l&&(a=l.getAttributeNS(f,"page-width"),a=c.parseLength(a));return a}})};
odf.PageLayout=function(l,c,g){this.pageLayout;var a=null;l&&(a=c.getPropertiesElement("page-layout-properties",l));this.pageLayout=new odf.PageLayoutProperties(a,c,g&&g.pageLayout)};odf.PageLayoutCache=function(){};odf.PageLayoutCache.prototype.getPageLayout=function(l){};odf.PageLayoutCache.prototype.getDefaultPageLayout=function(){};
odf.ParagraphProperties=function(l,c,g){var a=this,f=odf.Namespaces.fons;this.marginTop=function(){return a.data.value("marginTop")};this.data;a.data=new odf.LazyStyleProperties(void 0===g?void 0:g.data,{marginTop:function(){var a=l.getAttributeNS(f,"margin-top");return c.parsePositiveLengthOrPercent(a,"marginTop",g&&g.data)}})};
odf.ComputedParagraphProperties=function(){var l={},c=[];this.setStyleChain=function(g){c=g;l={}};this.marginTop=function(){var g,a;if(l.hasOwnProperty("marginTop"))g=l.marginTop;else{for(a=0;void 0===g&&a<c.length;a+=1)g=c[a].marginTop();l.marginTop=g}return g||0}};
odf.TextProperties=function(l,c,g){var a=this,f=odf.Namespaces.fons;this.fontSize=function(){return a.data.value("fontSize")};this.data;a.data=new odf.LazyStyleProperties(void 0===g?void 0:g.data,{fontSize:function(){var a=l.getAttributeNS(f,"font-size");return c.parsePositiveLengthOrPercent(a,"fontSize",g&&g.data)}})};
odf.ComputedTextProperties=function(){var l={},c=[];this.setStyleChain=function(g){c=g;l={}};this.fontSize=function(){var g,a;if(l.hasOwnProperty("fontSize"))g=l.fontSize;else{for(a=0;void 0===g&&a<c.length;a+=1)g=c[a].fontSize();l.fontSize=g}return g||12}};odf.MasterPage=function(l,c){this.pageLayout;var g;l?(g=l.getAttributeNS(odf.Namespaces.stylens,"page-layout-name"),this.pageLayout=c.getPageLayout(g)):this.pageLayout=c.getDefaultPageLayout()};odf.MasterPageCache=function(){};
odf.MasterPageCache.prototype.getMasterPage=function(l){};
odf.StylePileEntry=function(l,c,g,a){this.text;this.paragraph;this.graphic;this.masterPage=function(){var a=l.getAttributeNS(odf.Namespaces.stylens,"master-page-name"),c=null;a&&(c=g.getMasterPage(a));return c};(function(f){var g=l.getAttributeNS(odf.Namespaces.stylens,"family"),e=null;if("graphic"===g||"chart"===g)f.graphic=void 0===a?void 0:a.graphic,e=c.getPropertiesElement("graphic-properties",l,e),null!==e&&(f.graphic=new odf.GraphicProperties(e,c,f.graphic));if("paragraph"===g||"table-cell"===
g||"graphic"===g||"presentation"===g||"chart"===g)f.paragraph=void 0===a?void 0:a.paragraph,e=c.getPropertiesElement("paragraph-properties",l,e),null!==e&&(f.paragraph=new odf.ParagraphProperties(e,c,f.paragraph));if("text"===g||"paragraph"===g||"table-cell"===g||"graphic"===g||"presentation"===g||"chart"===g)f.text=void 0===a?void 0:a.text,e=c.getPropertiesElement("text-properties",l,e),null!==e&&(f.text=new odf.TextProperties(e,c,f.text))})(this)};
odf.StylePile=function(l,c){function g(e,b){var d,f;e.hasAttributeNS(a,"parent-style-name")&&(f=e.getAttributeNS(a,"parent-style-name"),-1===b.indexOf(f)&&(d=h(f,b)));return new odf.StylePileEntry(e,l,c,d)}var a=odf.Namespaces.stylens,f={},k={},e,p={},n={},h;h=function(a,b){var d=p[a],e;!d&&(e=f[a])&&(b.push(a),d=g(e,b),p[a]=d);return d};this.getStyle=function(a){var b=n[a]||p[a],d,e=[];b||(d=k[a],d||(d=f[a])&&e.push(a),d&&(b=g(d,e)));return b};this.addCommonStyle=function(e){var b;e.hasAttributeNS(a,
"name")&&(b=e.getAttributeNS(a,"name"),f.hasOwnProperty(b)||(f[b]=e))};this.addAutomaticStyle=function(e){var b;e.hasAttributeNS(a,"name")&&(b=e.getAttributeNS(a,"name"),k.hasOwnProperty(b)||(k[b]=e))};this.setDefaultStyle=function(a){void 0===e&&(e=g(a,[]))};this.getDefaultStyle=function(){return e}};odf.ComputedGraphicStyle=function(){this.text=new odf.ComputedTextProperties;this.paragraph=new odf.ComputedParagraphProperties;this.graphic=new odf.ComputedGraphicProperties};
odf.ComputedParagraphStyle=function(){this.text=new odf.ComputedTextProperties;this.paragraph=new odf.ComputedParagraphProperties};odf.ComputedTextStyle=function(){this.text=new odf.ComputedTextProperties};
odf.StyleCache=function(l){function c(b,a,d,e){a=d.getAttributeNS(a,"class-names");var f;if(a)for(a=a.split(" "),f=0;f<a.length;f+=1)if(d=a[f])e.push(b),e.push(d)}function g(b,a){var d=y.getStyleName("paragraph",b);void 0!==d&&(a.push("paragraph"),a.push(d));b.namespaceURI!==r||"h"!==b.localName&&"p"!==b.localName||c("paragraph",r,b,a);return a}function a(b,a,d){var e=[],f,c,h,m;for(f=0;f<b.length;f+=2)h=b[f],m=b[f+1],h=p[h],m=h.getStyle(m),void 0!==m&&(m=m[a],void 0!==m&&m!==c&&(e.push(m),c=m));
h=p[d];if(m=h.getDefaultStyle())m=m[a],void 0!==m&&m!==c&&e.push(m);return e}function f(b,a){var d=y.getStyleName("text",b),e=b.parentNode;void 0!==d&&(a.push("text"),a.push(d));"span"===b.localName&&b.namespaceURI===r&&c("text",r,b,a);if(!e||e===l)return a;e.namespaceURI!==r||"p"!==e.localName&&"h"!==e.localName?f(e,a):g(e,a);return a}function k(b){b=b.getAttributeNS(A,"family");return p[b]}var e=this,p,n,h,q,b,d,m,r=odf.Namespaces.textns,A=odf.Namespaces.stylens,y=new odf.StyleInfo,v=new odf.StyleParseUtils,
s,B,u,z,G,H;this.getComputedGraphicStyle=function(b){var d=[];b=y.getStyleName("graphic",b);void 0!==b&&(d.push("graphic"),d.push(b));b=d.join("/");var e=q[b];runtime.assert(0===d.length%2,"Invalid style chain.");void 0===e&&(e=new odf.ComputedGraphicStyle,e.graphic.setGraphicProperties(a(d,"graphic","graphic")[0]),e.text.setStyleChain(a(d,"text","graphic")),e.paragraph.setStyleChain(a(d,"paragraph","graphic")),q[b]=e);return e};this.getComputedParagraphStyle=function(b){b=g(b,[]);var d=b.join("/"),
e=h[d];runtime.assert(0===b.length%2,"Invalid style chain.");void 0===e&&(e=new odf.ComputedParagraphStyle,e.text.setStyleChain(a(b,"text","paragraph")),e.paragraph.setStyleChain(a(b,"paragraph","paragraph")),h[d]=e);return e};this.getComputedTextStyle=function(b){b=f(b,[]);var d=b.join("/"),e=n[d];runtime.assert(0===b.length%2,"Invalid style chain.");void 0===e&&(e=new odf.ComputedTextStyle,e.text.setStyleChain(a(b,"text","text")),n[d]=e);return e};this.getPageLayout=function(b){var a=H[b];a||((a=
G[b])?(a=new odf.PageLayout(a,v,z),H[b]=a):a=z);return a};this.getDefaultPageLayout=function(){return z};this.getMasterPage=function(b){var a=B[b];void 0===a&&((a=s[b])?(a=new odf.MasterPage(a,e),B[b]=a):a=null);return a};this.getDefaultMasterPage=function(){return u};this.update=function(){var a,f,c=null,g=null;n={};h={};q={};s={};B={};H={};G={};b=new odf.StylePile(v,e);d=new odf.StylePile(v,e);m=new odf.StylePile(v,e);p={text:b,paragraph:d,graphic:m};for(a=l.styles.firstElementChild;a;)a.namespaceURI===
A&&((f=k(a))?"style"===a.localName?f.addCommonStyle(a):"default-style"===a.localName&&f.setDefaultStyle(a):"default-page-layout"===a.localName&&(c=a)),a=a.nextElementSibling;z=new odf.PageLayout(c,v);for(a=l.automaticStyles.firstElementChild;a;)a.namespaceURI===A&&((f=k(a))&&"style"===a.localName?f.addAutomaticStyle(a):"page-layout"===a.localName&&(G[a.getAttributeNS(A,"name")]=a)),a=a.nextElementSibling;for(a=l.masterStyles.firstElementChild;a;)a.namespaceURI===A&&"master-page"===a.localName&&(g=
g||a,f=a,c=f.getAttributeNS(A,"name"),0<c.length&&!s.hasOwnProperty(c)&&(s[c]=f)),a=a.nextElementSibling;u=new odf.MasterPage(g,e)}};
ops.OperationTransformMatrix=function(){function l(b){b.position+=b.length;b.length*=-1}function c(b){var a=0>b.length;a&&l(b);return a}function g(b,a){function e(c){b[c]===a&&f.push(c)}var f=[];b&&["style:parent-style-name","style:next-style-name"].forEach(e);return f}function a(b,a){function e(f){b[f]===a&&delete b[f]}b&&["style:parent-style-name","style:next-style-name"].forEach(e)}function f(b){var a={};Object.keys(b).forEach(function(e){a[e]="object"===typeof b[e]?f(b[e]):b[e]});return a}function k(b,
a,e,f){var c,h=!1,g=!1,k,l=[];f&&f.attributes&&(l=f.attributes.split(","));b&&(e||0<l.length)&&Object.keys(b).forEach(function(a){var d=b[a],f;"object"!==typeof d&&(e&&(f=e[a]),void 0!==f?(delete b[a],g=!0,f===d&&(delete e[a],h=!0)):-1!==l.indexOf(a)&&(delete b[a],g=!0))});if(a&&a.attributes&&(e||0<l.length)){k=a.attributes.split(",");for(f=0;f<k.length;f+=1)if(c=k[f],e&&void 0!==e[c]||l&&-1!==l.indexOf(c))k.splice(f,1),f-=1,g=!0;0<k.length?a.attributes=k.join(","):delete a.attributes}return{majorChanged:h,
minorChanged:g}}function e(b){for(var a in b)if(b.hasOwnProperty(a))return!0;return!1}function p(b){for(var a in b)if(b.hasOwnProperty(a)&&("attributes"!==a||0<b.attributes.length))return!0;return!1}function n(b,a,f,c,h){var g=b?b[h]:null,l=a?a[h]:null,n=f?f[h]:null,q=c?c[h]:null,u;u=k(g,l,n,q);g&&!e(g)&&delete b[h];l&&!p(l)&&delete a[h];n&&!e(n)&&delete f[h];q&&!p(q)&&delete c[h];return u}function h(b,a){return{opSpecsA:[b],opSpecsB:[a]}}var q;q={AddCursor:{AddCursor:h,AddMember:h,AddStyle:h,ApplyDirectStyling:h,
InsertText:h,MergeParagraph:h,MoveCursor:h,RemoveCursor:h,RemoveMember:h,RemoveStyle:h,RemoveText:h,SetParagraphStyle:h,SplitParagraph:h,UpdateMember:h,UpdateMetadata:h,UpdateParagraphStyle:h},AddMember:{AddStyle:h,ApplyDirectStyling:h,InsertText:h,MergeParagraph:h,MoveCursor:h,RemoveCursor:h,RemoveStyle:h,RemoveText:h,SetParagraphStyle:h,SplitParagraph:h,UpdateMetadata:h,UpdateParagraphStyle:h},AddStyle:{AddStyle:h,ApplyDirectStyling:h,InsertText:h,MergeParagraph:h,MoveCursor:h,RemoveCursor:h,RemoveMember:h,
RemoveStyle:function(b,d){var e,f=[b],c=[d];b.styleFamily===d.styleFamily&&(e=g(b.setProperties,d.styleName),0<e.length&&(e={optype:"UpdateParagraphStyle",memberid:d.memberid,timestamp:d.timestamp,styleName:b.styleName,removedProperties:{attributes:e.join(",")}},c.unshift(e)),a(b.setProperties,d.styleName));return{opSpecsA:f,opSpecsB:c}},RemoveText:h,SetParagraphStyle:h,SplitParagraph:h,UpdateMember:h,UpdateMetadata:h,UpdateParagraphStyle:h},ApplyDirectStyling:{ApplyDirectStyling:function(b,a,c){var h,
g,k,l,p,q,u,z;l=[b];k=[a];if(!(b.position+b.length<=a.position||b.position>=a.position+a.length)){h=c?b:a;g=c?a:b;if(b.position!==a.position||b.length!==a.length)q=f(h),u=f(g);a=n(g.setProperties,null,h.setProperties,null,"style:text-properties");if(a.majorChanged||a.minorChanged)k=[],b=[],l=h.position+h.length,p=g.position+g.length,g.position<h.position?a.minorChanged&&(z=f(u),z.length=h.position-g.position,b.push(z),g.position=h.position,g.length=p-g.position):h.position<g.position&&a.majorChanged&&
(z=f(q),z.length=g.position-h.position,k.push(z),h.position=g.position,h.length=l-h.position),p>l?a.minorChanged&&(q=u,q.position=l,q.length=p-l,b.push(q),g.length=l-g.position):l>p&&a.majorChanged&&(q.position=p,q.length=l-p,k.push(q),h.length=p-h.position),h.setProperties&&e(h.setProperties)&&k.push(h),g.setProperties&&e(g.setProperties)&&b.push(g),c?(l=k,k=b):l=b}return{opSpecsA:l,opSpecsB:k}},InsertText:function(b,a){a.position<=b.position?b.position+=a.text.length:a.position<=b.position+b.length&&
(b.length+=a.text.length);return{opSpecsA:[b],opSpecsB:[a]}},MergeParagraph:function(b,a){var e=b.position,f=b.position+b.length;e>=a.sourceStartPosition&&(e-=1);f>=a.sourceStartPosition&&(f-=1);b.position=e;b.length=f-e;return{opSpecsA:[b],opSpecsB:[a]}},MoveCursor:h,RemoveCursor:h,RemoveMember:h,RemoveStyle:h,RemoveText:function(b,a){var e=b.position+b.length,f=a.position+a.length,c=[b],h=[a];f<=b.position?b.position-=a.length:a.position<e&&(b.position<a.position?b.length=f<e?b.length-a.length:
a.position-b.position:(b.position=a.position,f<e?b.length=e-f:c=[]));return{opSpecsA:c,opSpecsB:h}},SetParagraphStyle:h,SplitParagraph:function(b,a){a.position<b.position?b.position+=1:a.position<b.position+b.length&&(b.length+=1);return{opSpecsA:[b],opSpecsB:[a]}},UpdateMember:h,UpdateMetadata:h,UpdateParagraphStyle:h},InsertText:{InsertText:function(b,a,e){b.position<a.position?a.position+=b.text.length:b.position>a.position?b.position+=a.text.length:e?a.position+=b.text.length:b.position+=a.text.length;
return{opSpecsA:[b],opSpecsB:[a]}},MergeParagraph:function(b,a){b.position>=a.sourceStartPosition?b.position-=1:(b.position<a.sourceStartPosition&&(a.sourceStartPosition+=b.text.length),b.position<a.destinationStartPosition&&(a.destinationStartPosition+=b.text.length));return{opSpecsA:[b],opSpecsB:[a]}},MoveCursor:function(b,a){var e=c(a);b.position<a.position?a.position+=b.text.length:b.position<a.position+a.length&&(a.length+=b.text.length);e&&l(a);return{opSpecsA:[b],opSpecsB:[a]}},RemoveCursor:h,
RemoveMember:h,RemoveStyle:h,RemoveText:function(b,a){var e;e=a.position+a.length;var f=[b],c=[a];e<=b.position?b.position-=a.length:b.position<=a.position?a.position+=b.text.length:(a.length=b.position-a.position,e={optype:"RemoveText",memberid:a.memberid,timestamp:a.timestamp,position:b.position+b.text.length,length:e-b.position},c.unshift(e),b.position=a.position);return{opSpecsA:f,opSpecsB:c}},SetParagraphStyle:function(b,a){a.position>b.position&&(a.position+=b.text.length);return{opSpecsA:[b],
opSpecsB:[a]}},SplitParagraph:function(b,a){b.position<a.sourceParagraphPosition&&(a.sourceParagraphPosition+=b.text.length);b.position<=a.position?a.position+=b.text.length:b.position+=1;return{opSpecsA:[b],opSpecsB:[a]}},UpdateMember:h,UpdateMetadata:h,UpdateParagraphStyle:h},MergeParagraph:{MergeParagraph:function(b,a,e){var f=[b],c=[a],h;b.destinationStartPosition===a.destinationStartPosition?(f=[],c=[],b.moveCursor&&(h={optype:"MoveCursor",memberid:b.memberid,timestamp:b.timestamp,position:b.sourceStartPosition-
1},f.push(h)),a.moveCursor&&(h={optype:"MoveCursor",memberid:a.memberid,timestamp:a.timestamp,position:a.sourceStartPosition-1},c.push(h)),b=e?b:a,b={optype:"SetParagraphStyle",memberid:b.memberid,timestamp:b.timestamp,position:b.destinationStartPosition,styleName:b.paragraphStyleName},e?f.push(b):c.push(b)):a.sourceStartPosition===b.destinationStartPosition?(b.destinationStartPosition=a.destinationStartPosition,b.sourceStartPosition-=1,b.paragraphStyleName=a.paragraphStyleName):b.sourceStartPosition===
a.destinationStartPosition?(a.destinationStartPosition=b.destinationStartPosition,a.sourceStartPosition-=1,a.paragraphStyleName=b.paragraphStyleName):b.destinationStartPosition<a.destinationStartPosition?(a.destinationStartPosition-=1,a.sourceStartPosition-=1):(b.destinationStartPosition-=1,b.sourceStartPosition-=1);return{opSpecsA:f,opSpecsB:c}},MoveCursor:function(b,a){var e=a.position,f=a.position+a.length,c=Math.min(e,f),e=Math.max(e,f);c>=b.sourceStartPosition&&(c-=1);e>=b.sourceStartPosition&&
(e-=1);0<=a.length?(a.position=c,a.length=e-c):(a.position=e,a.length=c-e);return{opSpecsA:[b],opSpecsB:[a]}},RemoveCursor:h,RemoveMember:h,RemoveStyle:h,RemoveText:function(b,a){a.position>=b.sourceStartPosition?a.position-=1:(a.position<b.destinationStartPosition&&(b.destinationStartPosition-=a.length),a.position<b.sourceStartPosition&&(b.sourceStartPosition-=a.length));return{opSpecsA:[b],opSpecsB:[a]}},SetParagraphStyle:function(b,a){var e=[b],f=[a];if(a.position>b.sourceStartPosition)a.position-=
1;else if(a.position===b.destinationStartPosition||a.position===b.sourceStartPosition)a.position=b.destinationStartPosition,b.paragraphStyleName=a.styleName;return{opSpecsA:e,opSpecsB:f}},SplitParagraph:function(b,a){var e,f=[b],c=[a];a.position<b.destinationStartPosition?(b.destinationStartPosition+=1,b.sourceStartPosition+=1):a.position>=b.destinationStartPosition&&a.position<b.sourceStartPosition?(a.paragraphStyleName=b.paragraphStyleName,e={optype:"SetParagraphStyle",memberid:b.memberid,timestamp:b.timestamp,
position:b.destinationStartPosition,styleName:b.paragraphStyleName},f.push(e),a.position===b.sourceStartPosition-1&&b.moveCursor&&(e={optype:"MoveCursor",memberid:b.memberid,timestamp:b.timestamp,position:a.position,length:0},f.push(e)),b.destinationStartPosition=a.position+1,b.sourceStartPosition+=1):a.position>=b.sourceStartPosition&&(a.position-=1,a.sourceParagraphPosition-=1);return{opSpecsA:f,opSpecsB:c}},UpdateMember:h,UpdateMetadata:h,UpdateParagraphStyle:h},MoveCursor:{MoveCursor:h,RemoveCursor:function(b,
a){return{opSpecsA:b.memberid===a.memberid?[]:[b],opSpecsB:[a]}},RemoveMember:h,RemoveStyle:h,RemoveText:function(b,a){var e=c(b),f=b.position+b.length,h=a.position+a.length;h<=b.position?b.position-=a.length:a.position<f&&(b.position<a.position?b.length=h<f?b.length-a.length:a.position-b.position:(b.position=a.position,b.length=h<f?f-h:0));e&&l(b);return{opSpecsA:[b],opSpecsB:[a]}},SetParagraphStyle:h,SplitParagraph:function(b,a){var e=c(b);a.position<b.position?b.position+=1:a.position<b.position+
b.length&&(b.length+=1);e&&l(b);return{opSpecsA:[b],opSpecsB:[a]}},UpdateMember:h,UpdateMetadata:h,UpdateParagraphStyle:h},RemoveCursor:{RemoveCursor:function(b,a){var e=b.memberid===a.memberid;return{opSpecsA:e?[]:[b],opSpecsB:e?[]:[a]}},RemoveMember:h,RemoveStyle:h,RemoveText:h,SetParagraphStyle:h,SplitParagraph:h,UpdateMember:h,UpdateMetadata:h,UpdateParagraphStyle:h},RemoveMember:{RemoveStyle:h,RemoveText:h,SetParagraphStyle:h,SplitParagraph:h,UpdateMetadata:h,UpdateParagraphStyle:h},RemoveStyle:{RemoveStyle:function(b,
a){var e=b.styleName===a.styleName&&b.styleFamily===a.styleFamily;return{opSpecsA:e?[]:[b],opSpecsB:e?[]:[a]}},RemoveText:h,SetParagraphStyle:function(b,a){var e,f=[b],c=[a];"paragraph"===b.styleFamily&&b.styleName===a.styleName&&(e={optype:"SetParagraphStyle",memberid:b.memberid,timestamp:b.timestamp,position:a.position,styleName:""},f.unshift(e),a.styleName="");return{opSpecsA:f,opSpecsB:c}},SplitParagraph:h,UpdateMember:h,UpdateMetadata:h,UpdateParagraphStyle:function(b,d){var e,f=[b],c=[d];"paragraph"===
b.styleFamily&&(e=g(d.setProperties,b.styleName),0<e.length&&(e={optype:"UpdateParagraphStyle",memberid:b.memberid,timestamp:b.timestamp,styleName:d.styleName,removedProperties:{attributes:e.join(",")}},f.unshift(e)),b.styleName===d.styleName?c=[]:a(d.setProperties,b.styleName));return{opSpecsA:f,opSpecsB:c}}},RemoveText:{RemoveText:function(b,a){var e=b.position+b.length,f=a.position+a.length,c=[b],h=[a];f<=b.position?b.position-=a.length:e<=a.position?a.position-=b.length:a.position<e&&(b.position<
a.position?(b.length=f<e?b.length-a.length:a.position-b.position,e<f?(a.position=b.position,a.length=f-e):h=[]):(e<f?a.length-=b.length:a.position<b.position?a.length=b.position-a.position:h=[],f<e?(b.position=a.position,b.length=e-f):c=[]));return{opSpecsA:c,opSpecsB:h}},SetParagraphStyle:function(b,a){b.position<a.position&&(a.position-=b.length);return{opSpecsA:[b],opSpecsB:[a]}},SplitParagraph:function(b,a){var e=b.position+b.length,f=[b],c=[a];a.position<=b.position?b.position+=1:a.position<
e&&(b.length=a.position-b.position,e={optype:"RemoveText",memberid:b.memberid,timestamp:b.timestamp,position:a.position+1,length:e-a.position},f.unshift(e));b.position+b.length<=a.position?a.position-=b.length:b.position<a.position&&(a.position=b.position);b.position+b.length<a.sourceParagraphPosition&&(a.sourceParagraphPosition-=b.length);return{opSpecsA:f,opSpecsB:c}},UpdateMember:h,UpdateMetadata:h,UpdateParagraphStyle:h},SetParagraphStyle:{SetParagraphStyle:function(b,a,e){b.position===a.position&&
(e?a.styleName=b.styleName:b.styleName=a.styleName);return{opSpecsA:[b],opSpecsB:[a]}},SplitParagraph:function(b,a){var e=[b],c=[a],h;b.position>a.position?b.position+=1:b.position===a.sourceParagraphPosition&&(a.paragraphStyleName=b.styleName,h=f(b),h.position=a.position+1,e.push(h));return{opSpecsA:e,opSpecsB:c}},UpdateMember:h,UpdateMetadata:h,UpdateParagraphStyle:h},SplitParagraph:{SplitParagraph:function(b,a,e){var f,c;b.position<a.position?f=!0:a.position<b.position?c=!0:b.position===a.position&&
(e?f=!0:c=!0);f?(a.position+=1,a.sourceParagraphPosition=b.position<a.sourceParagraphPosition?a.sourceParagraphPosition+1:b.position+1):c&&(b.position+=1,b.sourceParagraphPosition=a.position<a.sourceParagraphPosition?b.sourceParagraphPosition+1:a.position+1);return{opSpecsA:[b],opSpecsB:[a]}},UpdateMember:h,UpdateMetadata:h,UpdateParagraphStyle:h},UpdateMember:{UpdateMetadata:h,UpdateParagraphStyle:h},UpdateMetadata:{UpdateMetadata:function(b,a,f){var c,h=[b],g=[a];c=f?b:a;b=f?a:b;k(b.setProperties||
null,b.removedProperties||null,c.setProperties||null,c.removedProperties||null);c.setProperties&&e(c.setProperties)||c.removedProperties&&p(c.removedProperties)||(f?h=[]:g=[]);b.setProperties&&e(b.setProperties)||b.removedProperties&&p(b.removedProperties)||(f?g=[]:h=[]);return{opSpecsA:h,opSpecsB:g}},UpdateParagraphStyle:h},UpdateParagraphStyle:{UpdateParagraphStyle:function(b,a,f){var c,h=[b],g=[a];b.styleName===a.styleName&&(c=f?b:a,b=f?a:b,n(b.setProperties,b.removedProperties,c.setProperties,
c.removedProperties,"style:paragraph-properties"),n(b.setProperties,b.removedProperties,c.setProperties,c.removedProperties,"style:text-properties"),k(b.setProperties||null,b.removedProperties||null,c.setProperties||null,c.removedProperties||null),c.setProperties&&e(c.setProperties)||c.removedProperties&&p(c.removedProperties)||(f?h=[]:g=[]),b.setProperties&&e(b.setProperties)||b.removedProperties&&p(b.removedProperties)||(f?g=[]:h=[]));return{opSpecsA:h,opSpecsB:g}}}};this.passUnchanged=h;this.extendTransformations=
function(b){Object.keys(b).forEach(function(a){var e=b[a],f,c=q.hasOwnProperty(a);runtime.log((c?"Extending":"Adding")+" map for optypeA: "+a);c||(q[a]={});f=q[a];Object.keys(e).forEach(function(b){var c=f.hasOwnProperty(b);runtime.assert(a<=b,"Wrong order:"+a+", "+b);runtime.log("  "+(c?"Overwriting":"Adding")+" entry for optypeB: "+b);f[b]=e[b]})})};this.transformOpspecVsOpspec=function(b,a){var e=b.optype<=a.optype,f;runtime.log("Crosstransforming:");runtime.log(runtime.toJson(b));runtime.log(runtime.toJson(a));
e||(f=b,b=a,a=f);(f=(f=q[b.optype])&&f[a.optype])?(f=f(b,a,!e),e||null===f||(f={opSpecsA:f.opSpecsB,opSpecsB:f.opSpecsA})):f=null;runtime.log("result:");f?(runtime.log(runtime.toJson(f.opSpecsA)),runtime.log(runtime.toJson(f.opSpecsB))):runtime.log("null");return f}};
ops.OperationTransformer=function(){function l(g,a){for(var f,k,e=[],p=[];0<g.length&&a;){f=g.shift();f=c.transformOpspecVsOpspec(f,a);if(!f)return null;e=e.concat(f.opSpecsA);if(0===f.opSpecsB.length){e=e.concat(g);a=null;break}for(;1<f.opSpecsB.length;){k=l(g,f.opSpecsB.shift());if(!k)return null;p=p.concat(k.opSpecsB);g=k.opSpecsA}a=f.opSpecsB.pop()}a&&p.push(a);return{opSpecsA:e,opSpecsB:p}}var c=new ops.OperationTransformMatrix;this.getOperationTransformMatrix=function(){return c};this.transform=
function(c,a){for(var f,k=[];0<a.length;){f=l(c,a.shift());if(!f)return null;c=f.opSpecsA;k=k.concat(f.opSpecsB)}return{opSpecsA:c,opSpecsB:k}}};var webodf_css='@namespace draw url(urn:oasis:names:tc:opendocument:xmlns:drawing:1.0);@namespace fo url(urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0);@namespace office url(urn:oasis:names:tc:opendocument:xmlns:office:1.0);@namespace presentation url(urn:oasis:names:tc:opendocument:xmlns:presentation:1.0);@namespace style url(urn:oasis:names:tc:opendocument:xmlns:style:1.0);@namespace svg url(urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0);@namespace table url(urn:oasis:names:tc:opendocument:xmlns:table:1.0);@namespace text url(urn:oasis:names:tc:opendocument:xmlns:text:1.0);@namespace webodfhelper url(urn:webodf:names:helper);@namespace cursor url(urn:webodf:names:cursor);@namespace editinfo url(urn:webodf:names:editinfo);@namespace annotation url(urn:webodf:names:annotation);@namespace dc url(http://purl.org/dc/elements/1.1/);@namespace svgns url(http://www.w3.org/2000/svg);office|document > *, office|document-content > * {display: none;}office|body, office|document {display: inline-block;position: relative;}text|p, text|h {display: block;padding: 0;margin: 0;line-height: normal;position: relative;}text|p::after, text|h::after {content: "\\200B";white-space: pre;}*[webodfhelper|containsparagraphanchor] {position: relative;}text|s {white-space: pre;}text|tab {display: inline;white-space: pre;}text|tracked-changes {display: none;}office|binary-data {display: none;}office|text {display: block;text-align: left;overflow: visible;word-wrap: break-word;}office|text::selection {background: transparent;}.webodf-virtualSelections *::selection {background: transparent;}.webodf-virtualSelections *::-moz-selection {background: transparent;}office|text * draw|text-box {display: block;border: 1px solid #d3d3d3;}office|text draw|frame {z-index: 1;}office|spreadsheet {display: block;border-collapse: collapse;empty-cells: show;font-family: sans-serif;font-size: 10pt;text-align: left;page-break-inside: avoid;overflow: hidden;}office|presentation {display: inline-block;text-align: left;}#shadowContent {display: inline-block;text-align: left;}draw|page {display: block;position: relative;overflow: hidden;}presentation|notes, presentation|footer-decl, presentation|date-time-decl {display: none;}@media print {draw|page {border: 1pt solid black;page-break-inside: avoid;}presentation|notes {}}office|spreadsheet text|p {border: 0px;padding: 1px;margin: 0px;}office|spreadsheet table|table {margin: 3px;}office|spreadsheet table|table:after {}office|spreadsheet table|table-row {counter-increment: row;}office|spreadsheet table|table-row:before {width: 3em;background: #cccccc;border: 1px solid black;text-align: center;content: counter(row);display: table-cell;}office|spreadsheet table|table-cell {border: 1px solid #cccccc;}table|table {display: table;}draw|frame table|table {width: 100%;height: 100%;background: white;}table|table-header-rows {display: table-header-group;}table|table-row {display: table-row;}table|table-column {display: table-column;}table|table-cell {width: 0.889in;display: table-cell;word-break: break-all;}draw|frame {display: block;}draw|image {display: block;width: 100%;height: 100%;top: 0px;left: 0px;background-repeat: no-repeat;background-size: 100% 100%;-moz-background-size: 100% 100%;}draw|frame > draw|image:nth-of-type(n+2) {display: none;}text|list:before {display: none;content:"";}text|list {display: block;}text|list-item {display: block;}text|number {display:none;}text|a {color: blue;text-decoration: underline;cursor: pointer;}.webodf-inactiveLinks text|a {cursor: text;}text|note-citation {vertical-align: super;font-size: smaller;}text|note-body {display: none;}text|note:hover text|note-citation {background: #dddddd;}text|note:hover text|note-body {display: block;left:1em;max-width: 80%;position: absolute;background: #ffffaa;}text|bibliography-source {display: none;}svg|title, svg|desc {display: none;}video {width: 100%;height: 100%}cursor|anchor {display: none;}cursor|cursor {display: none;}.webodf-caretOverlay {position: absolute;top: 5%;height: 1em;z-index: 10;padding-left: 1px;pointer-events: none;}.webodf-caretOverlay .caret {position: absolute;border-left: 2px solid black;top: 0;bottom: 0;right: 0;}.webodf-caretOverlay .handle {position: absolute;margin-top: 5px;padding-top: 3px;margin-left: auto;margin-right: auto;width: 64px;height: 68px;border-radius: 5px;opacity: 0.3;text-align: center;background-color: black;box-shadow: 0px 0px 5px rgb(90, 90, 90);border: 1px solid black;top: -85px;right: -32px;}.webodf-caretOverlay .handle > img {box-shadow: 0px 0px 5px rgb(90, 90, 90) inset;background-color: rgb(200, 200, 200);border-radius: 5px;border: 2px solid;height: 60px;width: 60px;display: block;margin: auto;}.webodf-caretOverlay .handle.active {opacity: 0.8;}.webodf-caretOverlay .handle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 43%;}.webodf-caretSizer {display: inline-block;width: 0;visibility: hidden;}#eventTrap {display: block;position: absolute;bottom: 0;left: 0;outline: none;opacity: 0;color: rgba(255, 255, 255, 0);pointer-events: none;white-space: pre;overflow: hidden;}cursor|cursor > #composer {text-decoration: underline;}cursor|cursor[cursor|caret-sizer-active="true"],cursor|cursor[cursor|composing="true"] {display: inline;}editinfo|editinfo {display: inline-block;}.editInfoMarker {position: absolute;width: 10px;height: 100%;left: -20px;opacity: 0.8;top: 0;border-radius: 5px;background-color: transparent;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);}.editInfoMarker:hover {box-shadow: 0px 0px 8px rgba(0, 0, 0, 1);}.editInfoHandle {position: absolute;background-color: black;padding: 5px;border-radius: 5px;opacity: 0.8;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);bottom: 100%;margin-bottom: 10px;z-index: 3;left: -25px;}.editInfoHandle:after {content: " ";position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: black transparent transparent transparent;top: 100%;left: 5px;}.editInfo {font-family: sans-serif;font-weight: normal;font-style: normal;text-decoration: none;color: white;width: 100%;height: 12pt;}.editInfoColor {float: left;width: 10pt;height: 10pt;border: 1px solid white;}.editInfoAuthor {float: left;margin-left: 5pt;font-size: 10pt;text-align: left;height: 12pt;line-height: 12pt;}.editInfoTime {float: right;margin-left: 30pt;font-size: 8pt;font-style: italic;color: yellow;height: 12pt;line-height: 12pt;}.annotationWrapper {display: inline;position: relative;}.annotationRemoveButton:before {content: "\u00d7";color: white;padding: 5px;line-height: 1em;}.annotationRemoveButton {width: 20px;height: 20px;border-radius: 10px;background-color: black;box-shadow: 0px 0px 5px rgba(50, 50, 50, 0.75);position: absolute;top: -10px;left: -10px;z-index: 3;text-align: center;font-family: sans-serif;font-style: normal;font-weight: normal;text-decoration: none;font-size: 15px;}.annotationRemoveButton:hover {cursor: pointer;box-shadow: 0px 0px 5px rgba(0, 0, 0, 1);}.annotationNote {width: 4cm;position: absolute;display: inline;z-index: 10;top: 0;}.annotationNote > office|annotation {display: block;text-align: left;}.annotationConnector {position: absolute;display: inline;top: 0;z-index: 2;border-top: 1px dashed brown;}.annotationConnector.angular {-moz-transform-origin: left top;-webkit-transform-origin: left top;-ms-transform-origin: left top;transform-origin: left top;}.annotationConnector.horizontal {left: 0;}.annotationConnector.horizontal:before {content: "";display: inline;position: absolute;width: 0px;height: 0px;border-style: solid;border-width: 8.7px 5px 0 5px;border-color: brown transparent transparent transparent;top: -1px;left: -5px;}office|annotation {width: 100%;height: 100%;display: none;background: rgb(198, 238, 184);background: -moz-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -webkit-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -o-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: -ms-linear-gradient(90deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);background: linear-gradient(180deg, rgb(198, 238, 184) 30%, rgb(180, 196, 159) 100%);box-shadow: 0 3px 4px -3px #ccc;}office|annotation > dc|creator {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;color: white;background-color: brown;padding: 4px;}office|annotation > dc|date {display: block;font-size: 10pt;font-weight: normal;font-style: normal;font-family: sans-serif;border: 4px solid transparent;color: black;}office|annotation > text|list {display: block;padding: 5px;}office|annotation text|p {font-size: 10pt;color: black;font-weight: normal;font-style: normal;text-decoration: none;font-family: sans-serif;}#annotationsPane {background-color: #EAEAEA;width: 4cm;height: 100%;display: none;position: absolute;outline: 1px solid #ccc;}.webodf-annotationHighlight {background-color: yellow;position: relative;}.webodf-selectionOverlay {position: absolute;pointer-events: none;top: 0;left: 0;top: 0;left: 0;width: 100%;height: 100%;z-index: 15;}.webodf-selectionOverlay > polygon {fill-opacity: 0.3;stroke-opacity: 0.8;stroke-width: 1;fill-rule: evenodd;}.webodf-selectionOverlay > .webodf-draggable {fill-opacity: 0.8;stroke-opacity: 0;stroke-width: 8;pointer-events: all;display: none;-moz-transform-origin: center center;-webkit-transform-origin: center center;-ms-transform-origin: center center;transform-origin: center center;}#imageSelector {display: none;position: absolute;border-style: solid;border-color: black;}#imageSelector > div {width: 5px;height: 5px;display: block;position: absolute;border: 1px solid black;background-color: #ffffff;}#imageSelector > .topLeft {top: -4px;left: -4px;}#imageSelector > .topRight {top: -4px;right: -4px;}#imageSelector > .bottomRight {right: -4px;bottom: -4px;}#imageSelector > .bottomLeft {bottom: -4px;left: -4px;}#imageSelector > .topMiddle {top: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .rightMiddle {top: 50%;right: -4px;margin-top: -2.5px;}#imageSelector > .bottomMiddle {bottom: -4px;left: 50%;margin-left: -2.5px;}#imageSelector > .leftMiddle {top: 50%;left: -4px;margin-top: -2.5px;}div.webodf-customScrollbars::-webkit-scrollbar{width: 8px;height: 8px;background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-track{background-color: transparent;}div.webodf-customScrollbars::-webkit-scrollbar-thumb{background-color: #444;border-radius: 4px;}.webodf-hyperlinkTooltip {display: none;color: white;background-color: black;border-radius: 5px;box-shadow: 2px 2px 5px gray;padding: 3px;position: absolute;max-width: 210px;text-align: left;word-break: break-all;z-index: 16;}.webodf-hyperlinkTooltipText {display: block;font-weight: bold;}';
!function(l){var c="undefined"!==typeof window?window:"undefined"!==typeof global?global:{};(c.externs||(c.externs={})).JSZip=l()}(function(){return function c(g,a,f){function k(p,h){if(!a[p]){if(!g[p]){var q="function"==typeof require&&require;if(!h&&q)return q(p,!0);if(e)return e(p,!0);throw Error("Cannot find module '"+p+"'");}q=a[p]={exports:{}};g[p][0].call(q.exports,function(b){var a=g[p][1][b];return k(a?a:b)},q,q.exports,c,g,a,f)}return a[p].exports}for(var e="function"==typeof require&&require,
p=0;p<f.length;p++)k(f[p]);return k}({1:[function(c,g,a){a.encode=function(a,c){for(var e="",g,n,h,q,b,d,m=0;m<a.length;)g=a.charCodeAt(m++),n=a.charCodeAt(m++),h=a.charCodeAt(m++),q=g>>2,g=(g&3)<<4|n>>4,b=(n&15)<<2|h>>6,d=h&63,isNaN(n)?b=d=64:isNaN(h)&&(d=64),e=e+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(q)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d);
return e};a.decode=function(a,c){var e="",g,n,h,q,b,d=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");d<a.length;)g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(d++)),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(d++)),q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(d++)),b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(d++)),g=g<<2|n>>4,n=(n&15)<<
4|q>>2,h=(q&3)<<6|b,e+=String.fromCharCode(g),64!=q&&(e+=String.fromCharCode(n)),64!=b&&(e+=String.fromCharCode(h));return e}},{}],2:[function(c,g,a){function f(){this.crc32=this.uncompressedSize=this.compressedSize=0;this.compressedContent=this.compressionMethod=null}f.prototype={getContent:function(){return null},getCompressedContent:function(){return null}};g.exports=f},{}],3:[function(c,g,a){a.STORE={magic:"\x00\x00",compress:function(a){return a},uncompress:function(a){return a},compressInputType:null,
uncompressInputType:null};a.DEFLATE=c("./flate")},{"./flate":8}],4:[function(c,g,a){var f=c("./utils"),k=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,
3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,
453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,
3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,
1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,
1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];g.exports=function(a,c){if("undefined"===typeof a||!a.length)return 0;var g="string"!==f.getTypeOf(a);"undefined"==typeof c&&(c=0);var h=0,h=h=0;c^=-1;for(var q=0,b=a.length;q<b;q++)h=
g?a[q]:a.charCodeAt(q),h=(c^h)&255,h=k[h],c=c>>>8^h;return c^-1}},{"./utils":21}],5:[function(c,g,a){function f(a){this.data=null;this.index=this.length=0}var k=c("./utils");f.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<a||0>a)throw Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?");},setIndex:function(a){this.checkIndex(a);this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(a){},
readInt:function(a){var f=0,c;this.checkOffset(a);for(c=this.index+a-1;c>=this.index;c--)f=(f<<8)+this.byteAt(c);this.index+=a;return f},readString:function(a){return k.transformTo("string",this.readData(a))},readData:function(a){},lastIndexOfSignature:function(a){},readDate:function(){var a=this.readInt(4);return new Date((a>>25&127)+1980,(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(a&31)<<1)}};g.exports=f},{"./utils":21}],6:[function(c,g,a){a.base64=!1;a.binary=!1;a.dir=!1;a.createFolders=!1;a.date=
null;a.compression=null;a.comment=null},{}],7:[function(c,g,a){var f=c("./utils");a.string2binary=function(a){return f.string2binary(a)};a.string2Uint8Array=function(a){return f.transformTo("uint8array",a)};a.uint8Array2String=function(a){return f.transformTo("string",a)};a.string2Blob=function(a){a=f.transformTo("arraybuffer",a);return f.arrayBuffer2Blob(a)};a.arrayBuffer2Blob=function(a){return f.arrayBuffer2Blob(a)};a.transformTo=function(a,e){return f.transformTo(a,e)};a.getTypeOf=function(a){return f.getTypeOf(a)};
a.checkSupport=function(a){return f.checkSupport(a)};a.MAX_VALUE_16BITS=f.MAX_VALUE_16BITS;a.MAX_VALUE_32BITS=f.MAX_VALUE_32BITS;a.pretty=function(a){return f.pretty(a)};a.findCompression=function(a){return f.findCompression(a)};a.isRegExp=function(a){return f.isRegExp(a)}},{"./utils":21}],8:[function(c,g,a){g="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array;var f=c("pako");a.uncompressInputType=g?"uint8array":"array";a.compressInputType=g?"uint8array":
"array";a.magic="\b\x00";a.compress=function(a){return f.deflateRaw(a)};a.uncompress=function(a){return f.inflateRaw(a)}},{pako:24}],9:[function(c,g,a){function f(a,c){if(!(this instanceof f))return new f(a,c);this.files={};this.comment=null;this.root="";a&&this.load(a,c);this.clone=function(){var a=new f,e;for(e in this)"function"!==typeof this[e]&&(a[e]=this[e]);return a}}var k=c("./base64");f.prototype=c("./object");f.prototype.load=c("./load");f.support=c("./support");f.defaults=c("./defaults");
f.utils=c("./deprecatedPublicUtils");f.base64={encode:function(a){return k.encode(a)},decode:function(a){return k.decode(a)}};f.compressions=c("./compressions");g.exports=f},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(c,g,a){var f=c("./base64"),k=c("./zipEntries");g.exports=function(a,c){var g,h,q,b;c=c||{};c.base64&&(a=f.decode(a));h=new k(a,c);g=h.files;for(q=0;q<g.length;q++)b=g[q],this.file(b.fileName,b.decompressed,
{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileComment.length?b.fileComment:null,createFolders:c.createFolders});h.zipComment.length&&(this.comment=h.zipComment);return this}},{"./base64":1,"./zipEntries":22}],11:[function(c,g,a){(function(a){g.exports=function(c,e){return new a(c,e)};g.exports.test=function(c){return a.isBuffer(c)}}).call(this,"undefined"!==typeof Buffer?Buffer:void 0)},{}],12:[function(c,g,a){function f(a){this.data=a;this.length=this.data.length;this.index=
0}c=c("./uint8ArrayReader");f.prototype=new c;f.prototype.readData=function(a){this.checkOffset(a);var e=this.data.slice(this.index,this.index+a);this.index+=a;return e};g.exports=f},{"./uint8ArrayReader":18}],13:[function(c,g,a){var f=c("./support"),k=c("./utils"),e=c("./crc32"),p=c("./signature"),n=c("./defaults"),h=c("./base64"),q=c("./compressions"),b=c("./compressedObject"),d=c("./nodeBuffer"),m=c("./utf8"),r=c("./stringWriter"),A=c("./uint8ArrayWriter"),y=function(a){if(a._data instanceof b&&
(a._data=a._data.getContent(),a.options.binary=!0,a.options.base64=!1,"uint8array"===k.getTypeOf(a._data))){var d=a._data;a._data=new Uint8Array(d.length);0!==d.length&&a._data.set(d,0)}return a._data},v=function(b){var a=y(b);return"string"===k.getTypeOf(a)?!b.options.binary&&f.nodebuffer?d(a,"utf-8"):b.asBinary():a},s=function(b){var a=y(this);if(null===a||"undefined"===typeof a)return"";this.options.base64&&(a=h.decode(a));a=b&&this.options.binary?C.utf8decode(a):k.transformTo("string",a);b||this.options.binary||
(a=k.transformTo("string",C.utf8encode(a)));return a},B=function(b,a,d){this.name=b;this.dir=d.dir;this.date=d.date;this.comment=d.comment;this._data=a;this.options=d;this._initialMetadata={dir:d.dir,date:d.date}};B.prototype={asText:function(){return s.call(this,!0)},asBinary:function(){return s.call(this,!1)},asNodeBuffer:function(){var b=v(this);return k.transformTo("nodebuffer",b)},asUint8Array:function(){var b=v(this);return k.transformTo("uint8array",b)},asArrayBuffer:function(){return this.asUint8Array().buffer}};
var u=function(b,a){var d="",e;for(e=0;e<a;e++)d+=String.fromCharCode(b&255),b>>>=8;return d},z=function(){var b={},a,d;for(a=0;a<arguments.length;a++)for(d in arguments[a])arguments[a].hasOwnProperty(d)&&"undefined"===typeof b[d]&&(b[d]=arguments[a][d]);return b},G=function(a,d,e){var f=k.getTypeOf(d),c;e=e||{};!0!==e.base64||null!==e.binary&&void 0!==e.binary||(e.binary=!0);e=z(e,n);e.date=e.date||new Date;null!==e.compression&&(e.compression=e.compression.toUpperCase());var h;if(h=e.createFolders)c=
a,"/"==c.slice(-1)&&(c=c.substring(0,c.length-1)),h=c.lastIndexOf("/"),h=c=0<h?c.substring(0,h):"";h&&H.call(this,c,!0);if(e.dir||null===d||"undefined"===typeof d)e.base64=!1,e.binary=!1,d=null;else if("string"===f)e.binary&&!e.base64&&!0!==e.optimizedBinaryString&&(d=k.string2binary(d));else{e.base64=!1;e.binary=!0;if(!(f||d instanceof b))throw Error("The data of '"+a+"' is in an unsupported format !");"arraybuffer"===f&&(d=k.transformTo("uint8array",d))}d=new B(a,d,e);return this.files[a]=d},H=
function(b,a){"/"!=b.slice(-1)&&(b+="/");this.files[b]||G.call(this,b,null,{dir:!0,createFolders:"undefined"!==typeof a?a:!1});return this.files[b]},C={load:function(b,a){throw Error("Load method is not defined. Is the file jszip-load.js included ?");},filter:function(b){var a=[],d,e,f;for(d in this.files)this.files.hasOwnProperty(d)&&(e=this.files[d],f=new B(e.name,e._data,z(e.options)),e=d.slice(this.root.length,d.length),d.slice(0,this.root.length)===this.root&&b(e,f)&&a.push(f));return a},file:function(b,
a,d){if(1===arguments.length){if(k.isRegExp(b)){var e=b;return this.filter(function(b,a){return!a.dir&&e.test(b)})}return this.filter(function(a,d){return!d.dir&&a===b})[0]||null}b=this.root+b;G.call(this,b,a,d);return this},folder:function(b){if(!b)return this;if(k.isRegExp(b))return this.filter(function(a,d){return d.dir&&b.test(a)});var a=H.call(this,this.root+b),d=this.clone();d.root=a.name;return d},remove:function(b){b=this.root+b;var a=this.files[b];a||("/"!=b.slice(-1)&&(b+="/"),a=this.files[b]);
if(a&&!a.dir)delete this.files[b];else for(var a=this.filter(function(a,d){return d.name.slice(0,b.length)===b}),d=0;d<a.length;d++)delete this.files[a[d].name];return this},generate:function(a){a=z(a||{},{base64:!0,compression:"STORE",type:"base64",comment:null});k.checkSupport(a.type);var d=[],f=0,c=0,g=k.transformTo("string",this.utf8encode(a.comment||this.comment||"")),n;for(n in this.files)if(this.files.hasOwnProperty(n)){var s=this.files[n],y=s.options.compression||a.compression.toUpperCase(),
B=q[y];if(!B)throw Error(y+" is not a valid compression method !");var y=s,F=new b,C=void 0;if(y._data instanceof b)F.uncompressedSize=y._data.uncompressedSize,F.crc32=y._data.crc32,0===F.uncompressedSize||y.dir?(B=q.STORE,F.compressedContent="",F.crc32=0):y._data.compressionMethod===B.magic?F.compressedContent=y._data.getCompressedContent():(C=y._data.getContent(),F.compressedContent=B.compress(k.transformTo(B.compressInputType,C)));else{C=v(y);if(!C||0===C.length||y.dir)B=q.STORE,C="";F.uncompressedSize=
C.length;F.crc32=e(C);F.compressedContent=B.compress(k.transformTo(B.compressInputType,C))}F.compressedSize=F.compressedContent.length;F.compressionMethod=B.magic;var y=F,H=s,s=y,B=f,F=k.transformTo("string",m.utf8encode(H.name)),Q=H.comment||"",C=k.transformTo("string",m.utf8encode(Q)),G=F.length!==H.name.length,ca=C.length!==Q.length,L=H.options,Y=void 0,ea=void 0,W=Q="",W="",fa=void 0,W=void 0,fa=H._initialMetadata.dir!==H.dir?H.dir:L.dir,W=H._initialMetadata.date!==H.date?H.date:L.date,Y=W.getHours(),
Y=Y<<6,Y=Y|W.getMinutes(),Y=Y<<5,Y=Y|W.getSeconds()/2,ea=W.getFullYear()-1980,ea=ea<<4,ea=ea|W.getMonth()+1,ea=ea<<5,ea=ea|W.getDate();G&&(W=u(1,1)+u(e(F),4)+F,Q+="up"+u(W.length,2)+W);ca&&(W=u(1,1)+u(this.crc32(C),4)+C,Q+="uc"+u(W.length,2)+W);H="";H+="\n\x00";H+=G||ca?"\x00\b":"\x00\x00";H+=s.compressionMethod;H+=u(Y,2);H+=u(ea,2);H+=u(s.crc32,4);H+=u(s.compressedSize,4);H+=u(s.uncompressedSize,4);H+=u(F.length,2);H+=u(Q.length,2);G=p.LOCAL_FILE_HEADER+H+F+Q;B=p.CENTRAL_FILE_HEADER+"\u0014\x00"+
H+u(C.length,2)+"\x00\x00\x00\x00"+(!0===fa?"\u0010\x00\x00\x00":"\x00\x00\x00\x00")+u(B,4)+F+Q+C;s={fileRecord:G,dirRecord:B,compressedObject:s};f+=s.fileRecord.length+y.compressedSize;c+=s.dirRecord.length;d.push(s)}n="";n=p.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+u(d.length,2)+u(d.length,2)+u(c,4)+u(f,4)+u(g.length,2)+g;g=a.type.toLowerCase();f="uint8array"===g||"arraybuffer"===g||"blob"===g||"nodebuffer"===g?new A(f+c+n.length):new r(f+c+n.length);for(c=0;c<d.length;c++)f.append(d[c].fileRecord),
f.append(d[c].compressedObject.compressedContent);for(c=0;c<d.length;c++)f.append(d[c].dirRecord);f.append(n);d=f.finalize();switch(a.type.toLowerCase()){case "uint8array":case "arraybuffer":case "nodebuffer":return k.transformTo(a.type.toLowerCase(),d);case "blob":return k.arrayBuffer2Blob(k.transformTo("arraybuffer",d));case "base64":return a.base64?h.encode(d):d;default:return d}},crc32:function(b,a){return e(b,a)},utf8encode:function(b){return k.transformTo("string",m.utf8encode(b))},utf8decode:function(b){return m.utf8decode(b)}};
g.exports=C},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(c,g,a){a.LOCAL_FILE_HEADER="PK\u0003\u0004";a.CENTRAL_FILE_HEADER="PK\u0001\u0002";a.CENTRAL_DIRECTORY_END="PK\u0005\u0006";a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\u0006\u0007";a.ZIP64_CENTRAL_DIRECTORY_END="PK\u0006\u0006";a.DATA_DESCRIPTOR="PK\u0007\b"},{}],15:[function(c,
g,a){function f(a,f){this.data=a;f||(this.data=k.string2binary(this.data));this.length=this.data.length;this.index=0}a=c("./dataReader");var k=c("./utils");f.prototype=new a;f.prototype.byteAt=function(a){return this.data.charCodeAt(a)};f.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)};f.prototype.readData=function(a){this.checkOffset(a);var f=this.data.slice(this.index,this.index+a);this.index+=a;return f};g.exports=f},{"./dataReader":5,"./utils":21}],16:[function(c,g,
a){var f=c("./utils");c=function(){this.data=[]};c.prototype={append:function(a){a=f.transformTo("string",a);this.data.push(a)},finalize:function(){return this.data.join("")}};g.exports=c},{"./utils":21}],17:[function(c,g,a){c="undefined"!==typeof Buffer?Buffer:void 0;a.base64=!0;a.array=!0;a.string=!0;a.arraybuffer="undefined"!==typeof ArrayBuffer&&"undefined"!==typeof Uint8Array;a.nodebuffer="undefined"!==typeof c;a.uint8array="undefined"!==typeof Uint8Array;if("undefined"===typeof ArrayBuffer)a.blob=
!1;else{c=new ArrayBuffer(0);try{a.blob=0===(new Blob([c],{type:"application/zip"})).size}catch(f){try{var k=new (window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);k.append(c);a.blob=0===k.getBlob("application/zip").size}catch(e){a.blob=!1}}}},{}],18:[function(c,g,a){function f(a){a&&(this.data=a,this.length=this.data.length,this.index=0)}c=c("./dataReader");f.prototype=new c;f.prototype.byteAt=function(a){return this.data[a]};f.prototype.lastIndexOfSignature=
function(a){var e=a.charCodeAt(0),f=a.charCodeAt(1),c=a.charCodeAt(2);a=a.charCodeAt(3);for(var h=this.length-4;0<=h;--h)if(this.data[h]===e&&this.data[h+1]===f&&this.data[h+2]===c&&this.data[h+3]===a)return h;return-1};f.prototype.readData=function(a){this.checkOffset(a);if(0===a)return new Uint8Array(0);var e=this.data.subarray(this.index,this.index+a);this.index+=a;return e};g.exports=f},{"./dataReader":5}],19:[function(c,g,a){var f=c("./utils");c=function(a){this.data=new Uint8Array(a);this.index=
0};c.prototype={append:function(a){0!==a.length&&(a=f.transformTo("uint8array",a),this.data.set(a,this.index),this.index+=a.length)},finalize:function(){return this.data}};g.exports=c},{"./utils":21}],20:[function(c,g,a){var f=c("./utils"),k=c("./support"),e=c("./nodeBuffer"),p=Array(256);for(c=0;256>c;c++)p[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;p[254]=p[254]=1;var n=function(a){var e,b,d,c,g=a.length,k=Array(2*g);for(e=b=0;e<g;)if(d=a[e++],128>d)k[b++]=d;else if(c=p[d],4<c)k[b++]=65533,
e+=c-1;else{for(d&=2===c?31:3===c?15:7;1<c&&e<g;)d=d<<6|a[e++]&63,c--;1<c?k[b++]=65533:65536>d?k[b++]=d:(d-=65536,k[b++]=55296|d>>10&1023,k[b++]=56320|d&1023)}k.length!==b&&(k.subarray?k=k.subarray(0,b):k.length=b);return f.applyFromCharCode(k)};a.utf8encode=function(a){if(k.nodebuffer)return e(a,"utf-8");var f,b,d,c,g,p=a.length,n=0;for(c=0;c<p;c++)b=a.charCodeAt(c),55296===(b&64512)&&c+1<p&&(d=a.charCodeAt(c+1),56320===(d&64512)&&(b=65536+(b-55296<<10)+(d-56320),c++)),n+=128>b?1:2048>b?2:65536>
b?3:4;f=k.uint8array?new Uint8Array(n):Array(n);for(c=g=0;g<n;c++)b=a.charCodeAt(c),55296===(b&64512)&&c+1<p&&(d=a.charCodeAt(c+1),56320===(d&64512)&&(b=65536+(b-55296<<10)+(d-56320),c++)),128>b?f[g++]=b:(2048>b?f[g++]=192|b>>>6:(65536>b?f[g++]=224|b>>>12:(f[g++]=240|b>>>18,f[g++]=128|b>>>12&63),f[g++]=128|b>>>6&63),f[g++]=128|b&63);return f};a.utf8decode=function(a){if(k.nodebuffer)return f.transformTo("nodebuffer",a).toString("utf-8");a=f.transformTo(k.uint8array?"uint8array":"array",a);for(var e=
[],b=0,d=a.length;b<d;){var c;c=Math.min(b+65536,d);var g=void 0;c=c||a.length;c>a.length&&(c=a.length);for(g=c-1;0<=g&&128===(a[g]&192);)g--;c=0>g?c:0===g?c:g+p[a[g]]>c?g:c;k.uint8array?e.push(n(a.subarray(b,c))):e.push(n(a.slice(b,c)));b=c}return e.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(c,g,a){function f(b){return b}function k(b,a){for(var e=0;e<b.length;++e)a[e]=b.charCodeAt(e)&255;return a}function e(b){var e=65536,f=[],c=b.length,g=a.getTypeOf(b),h=0,k=!0;try{switch(g){case "uint8array":String.fromCharCode.apply(null,
new Uint8Array(0));break;case "nodebuffer":String.fromCharCode.apply(null,q(0))}}catch(p){k=!1}if(!k){e="";for(f=0;f<b.length;f++)e+=String.fromCharCode(b[f]);return e}for(;h<c&&1<e;)try{"array"===g||"nodebuffer"===g?f.push(String.fromCharCode.apply(null,b.slice(h,Math.min(h+e,c)))):f.push(String.fromCharCode.apply(null,b.subarray(h,Math.min(h+e,c)))),h+=e}catch(u){e=Math.floor(e/2)}return f.join("")}function p(b,a){for(var e=0;e<b.length;e++)a[e]=b[e];return a}var n=c("./support"),h=c("./compressions"),
q=c("./nodeBuffer");a.string2binary=function(b){for(var a="",e=0;e<b.length;e++)a+=String.fromCharCode(b.charCodeAt(e)&255);return a};a.arrayBuffer2Blob=function(b){a.checkSupport("blob");try{return new Blob([b],{type:"application/zip"})}catch(e){try{var f=new (window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);f.append(b);return f.getBlob("application/zip")}catch(c){throw Error("Bug : can't construct the Blob.");}}};a.applyFromCharCode=e;var b={};b.string=
{string:f,array:function(b){return k(b,Array(b.length))},arraybuffer:function(a){return b.string.uint8array(a).buffer},uint8array:function(b){return k(b,new Uint8Array(b.length))},nodebuffer:function(b){return k(b,q(b.length))}};b.array={string:e,array:f,arraybuffer:function(b){return(new Uint8Array(b)).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return q(b)}};b.arraybuffer={string:function(b){return e(new Uint8Array(b))},array:function(b){return p(new Uint8Array(b),
Array(b.byteLength))},arraybuffer:f,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return q(new Uint8Array(b))}};b.uint8array={string:e,array:function(b){return p(b,Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:f,nodebuffer:function(b){return q(b)}};b.nodebuffer={string:e,array:function(b){return p(b,Array(b.length))},arraybuffer:function(a){return b.nodebuffer.uint8array(a).buffer},uint8array:function(b){return p(b,new Uint8Array(b.length))},nodebuffer:f};
a.transformTo=function(d,e){e||(e="");if(!d)return e;a.checkSupport(d);var f=a.getTypeOf(e);return b[f][d](e)};a.getTypeOf=function(b){if("string"===typeof b)return"string";if("[object Array]"===Object.prototype.toString.call(b))return"array";if(n.nodebuffer&&q.test(b))return"nodebuffer";if(n.uint8array&&b instanceof Uint8Array)return"uint8array";if(n.arraybuffer&&b instanceof ArrayBuffer)return"arraybuffer"};a.checkSupport=function(b){if(!n[b.toLowerCase()])throw Error(b+" is not supported by this browser");
};a.MAX_VALUE_16BITS=65535;a.MAX_VALUE_32BITS=-1;a.pretty=function(b){var a="",e,f;for(f=0;f<(b||"").length;f++)e=b.charCodeAt(f),a+="\\x"+(16>e?"0":"")+e.toString(16).toUpperCase();return a};a.findCompression=function(b){for(var a in h)if(h.hasOwnProperty(a)&&h[a].magic===b)return h[a];return null};a.isRegExp=function(b){return"[object RegExp]"===Object.prototype.toString.call(b)}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(c,g,a){function f(b,a){this.files=[];this.loadOptions=
a;b&&this.load(b)}var k=c("./stringReader"),e=c("./nodeBufferReader"),p=c("./uint8ArrayReader"),n=c("./utils"),h=c("./signature"),q=c("./zipEntry"),b=c("./support"),d=c("./object");f.prototype={checkSignature:function(b){var a=this.reader.readString(4);if(a!==b)throw Error("Corrupted zip or bug : unexpected signature ("+n.pretty(a)+", expected "+n.pretty(b)+")");},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=
this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);this.zipComment=this.reader.readString(this.zipCommentLength);this.zipComment=d.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.versionMadeBy=this.reader.readString(2);this.versionNeeded=this.reader.readInt(2);this.diskNumber=
this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData={};for(var b=this.zip64EndOfCentralSize-44,a,d,e;0<b;)a=this.reader.readInt(2),d=this.reader.readInt(4),e=this.reader.readString(d),this.zip64ExtensibleData[a]={id:a,length:d,value:e}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=
this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);this.disksCount=this.reader.readInt(4);if(1<this.disksCount)throw Error("Multi-volumes zip are not supported");},readLocalFiles:function(){var b,a;for(b=0;b<this.files.length;b++)a=this.files[b],this.reader.setIndex(a.localHeaderOffset),this.checkSignature(h.LOCAL_FILE_HEADER),a.readLocalPart(this.reader),a.handleUTF8()},readCentralDir:function(){var b;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===
h.CENTRAL_FILE_HEADER;)b=new q({zip64:this.zip64},this.loadOptions),b.readCentralPart(this.reader),this.files.push(b)},readEndOfCentral:function(){var b=this.reader.lastIndexOfSignature(h.CENTRAL_DIRECTORY_END);if(-1===b)throw Error("Corrupted zip : can't find end of central directory");this.reader.setIndex(b);this.checkSignature(h.CENTRAL_DIRECTORY_END);this.readBlockEndOfCentral();if(this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===
n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){this.zip64=!0;b=this.reader.lastIndexOfSignature(h.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(-1===b)throw Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(b);this.checkSignature(h.ZIP64_CENTRAL_DIRECTORY_LOCATOR);this.readBlockZip64EndOfCentralLocator();this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);
this.checkSignature(h.ZIP64_CENTRAL_DIRECTORY_END);this.readBlockZip64EndOfCentral()}},prepareReader:function(a){var d=n.getTypeOf(a);this.reader="string"!==d||b.uint8array?"nodebuffer"===d?new e(a):new p(n.transformTo("uint8array",a)):new k(a,this.loadOptions.optimizedBinaryString)},load:function(b){this.prepareReader(b);this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};g.exports=f},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,
"./utils":21,"./zipEntry":23}],23:[function(c,g,a){function f(a,e){this.options=a;this.loadOptions=e}var k=c("./stringReader"),e=c("./utils"),p=c("./compressedObject"),n=c("./object");f.prototype={isEncrypted:function(){return 1===(this.bitFlag&1)},useUTF8:function(){return 2048===(this.bitFlag&2048)},prepareCompressedContent:function(a,e,b){return function(){var d=a.index;a.setIndex(e);var f=a.readData(b);a.setIndex(d);return f}},prepareContent:function(a,f,b,d,c){return function(){var b=e.transformTo(d.uncompressInputType,
this.getCompressedContent()),b=d.uncompress(b);if(b.length!==c)throw Error("Bug : uncompressed data size mismatch");return b}},readLocalPart:function(a){var f;a.skip(22);this.fileNameLength=a.readInt(2);f=a.readInt(2);this.fileName=a.readString(this.fileNameLength);a.skip(f);if(-1==this.compressedSize||-1==this.uncompressedSize)throw Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");f=e.findCompression(this.compressionMethod);
if(null===f)throw Error("Corrupted zip : compression "+e.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");this.decompressed=new p;this.decompressed.compressedSize=this.compressedSize;this.decompressed.uncompressedSize=this.uncompressedSize;this.decompressed.crc32=this.crc32;this.decompressed.compressionMethod=this.compressionMethod;this.decompressed.getCompressedContent=this.prepareCompressedContent(a,a.index,this.compressedSize,f);this.decompressed.getContent=this.prepareContent(a,
a.index,this.compressedSize,f,this.uncompressedSize);if(this.loadOptions.checkCRC32&&(this.decompressed=e.transformTo("string",this.decompressed.getContent()),n.crc32(this.decompressed)!==this.crc32))throw Error("Corrupted zip : CRC32 mismatch");},readCentralPart:function(a){this.versionMadeBy=a.readString(2);this.versionNeeded=a.readInt(2);this.bitFlag=a.readInt(2);this.compressionMethod=a.readString(2);this.date=a.readDate();this.crc32=a.readInt(4);this.compressedSize=a.readInt(4);this.uncompressedSize=
a.readInt(4);this.fileNameLength=a.readInt(2);this.extraFieldsLength=a.readInt(2);this.fileCommentLength=a.readInt(2);this.diskNumberStart=a.readInt(2);this.internalFileAttributes=a.readInt(2);this.externalFileAttributes=a.readInt(4);this.localHeaderOffset=a.readInt(4);if(this.isEncrypted())throw Error("Encrypted zip are not supported");this.fileName=a.readString(this.fileNameLength);this.readExtraFields(a);this.parseZIP64ExtraField(a);this.fileComment=a.readString(this.fileCommentLength);this.dir=
this.externalFileAttributes&16?!0:!1},parseZIP64ExtraField:function(a){this.extraFields[1]&&(a=new k(this.extraFields[1].value),this.uncompressedSize===e.MAX_VALUE_32BITS&&(this.uncompressedSize=a.readInt(8)),this.compressedSize===e.MAX_VALUE_32BITS&&(this.compressedSize=a.readInt(8)),this.localHeaderOffset===e.MAX_VALUE_32BITS&&(this.localHeaderOffset=a.readInt(8)),this.diskNumberStart===e.MAX_VALUE_32BITS&&(this.diskNumberStart=a.readInt(4)))},readExtraFields:function(a){var e=a.index,b,d,f;for(this.extraFields=
this.extraFields||{};a.index<e+this.extraFieldsLength;)b=a.readInt(2),d=a.readInt(2),f=a.readString(d),this.extraFields[b]={id:b,length:d,value:f}},handleUTF8:function(){if(this.useUTF8())this.fileName=n.utf8decode(this.fileName),this.fileComment=n.utf8decode(this.fileComment);else{var a=this.findExtraFieldUnicodePath();null!==a&&(this.fileName=a);a=this.findExtraFieldUnicodeComment();null!==a&&(this.fileComment=a)}},findExtraFieldUnicodePath:function(){var a=this.extraFields[28789];if(a){var e=new k(a.value);
return 1!==e.readInt(1)||n.crc32(this.fileName)!==e.readInt(4)?null:n.utf8decode(e.readString(a.length-5))}return null},findExtraFieldUnicodeComment:function(){var a=this.extraFields[25461];if(a){var e=new k(a.value);return 1!==e.readInt(1)||n.crc32(this.fileComment)!==e.readInt(4)?null:n.utf8decode(e.readString(a.length-5))}return null}};g.exports=f},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(c,g,a){a=c("./lib/utils/common").assign;var f=c("./lib/deflate"),
k=c("./lib/inflate");c=c("./lib/zlib/constants");var e={};a(e,f,k,c);g.exports=e},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(c,g,a){function f(b,a){var e=new q(a);e.push(b,!0);if(e.err)throw e.msg;return e.result}var k=c("./zlib/deflate.js"),e=c("./utils/common"),p=c("./utils/strings"),n=c("./zlib/messages"),h=c("./zlib/zstream"),q=function(b){b=this.options=e.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,
to:""},b||{});b.raw&&0<b.windowBits?b.windowBits=-b.windowBits:b.gzip&&0<b.windowBits&&16>b.windowBits&&(b.windowBits+=16);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new h;this.strm.avail_out=0;var a=k.deflateInit2(this.strm,b.level,b.method,b.windowBits,b.memLevel,b.strategy);if(0!==a)throw Error(n[a]);b.header&&k.deflateSetHeader(this.strm,b.header)};q.prototype.push=function(b,a){var f=this.strm,c=this.options.chunkSize,g,h;if(this.ended)return!1;h=a===~~a?a:!0===a?4:0;f.input=
"string"===typeof b?p.string2buf(b):b;f.next_in=0;f.avail_in=f.input.length;do{0===f.avail_out&&(f.output=new e.Buf8(c),f.next_out=0,f.avail_out=c);g=k.deflate(f,h);if(1!==g&&0!==g)return this.onEnd(g),this.ended=!0,!1;if(0===f.avail_out||0===f.avail_in&&4===h)if("string"===this.options.to)this.onData(p.buf2binstring(e.shrinkBuf(f.output,f.next_out)));else this.onData(e.shrinkBuf(f.output,f.next_out))}while((0<f.avail_in||0===f.avail_out)&&1!==g);return 4===h?(g=k.deflateEnd(this.strm),this.onEnd(g),
this.ended=!0,0===g):!0};q.prototype.onData=function(b){this.chunks.push(b)};q.prototype.onEnd=function(b){0===b&&(this.result="string"===this.options.to?this.chunks.join(""):e.flattenChunks(this.chunks));this.chunks=[];this.err=b;this.msg=this.strm.msg};a.Deflate=q;a.deflate=f;a.deflateRaw=function(b,a){a=a||{};a.raw=!0;return f(b,a)};a.gzip=function(b,a){a=a||{};a.gzip=!0;return f(b,a)}},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],
26:[function(c,g,a){function f(b,a){var e=new d(a);e.push(b,!0);if(e.err)throw e.msg;return e.result}var k=c("./zlib/inflate.js"),e=c("./utils/common"),p=c("./utils/strings"),n=c("./zlib/constants"),h=c("./zlib/messages"),q=c("./zlib/zstream"),b=c("./zlib/gzheader"),d=function(a){var d=this.options=e.assign({chunkSize:16384,windowBits:0,to:""},a||{});d.raw&&0<=d.windowBits&&16>d.windowBits&&(d.windowBits=-d.windowBits,0===d.windowBits&&(d.windowBits=-15));!(0<=d.windowBits&&16>d.windowBits)||a&&a.windowBits||
(d.windowBits+=32);15<d.windowBits&&48>d.windowBits&&0===(d.windowBits&15)&&(d.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new q;this.strm.avail_out=0;a=k.inflateInit2(this.strm,d.windowBits);if(a!==n.Z_OK)throw Error(h[a]);this.header=new b;k.inflateGetHeader(this.strm,this.header)};d.prototype.push=function(b,a){var d=this.strm,f=this.options.chunkSize,c,g,h,u,q;if(this.ended)return!1;g=a===~~a?a:!0===a?n.Z_FINISH:n.Z_NO_FLUSH;d.input="string"===typeof b?p.binstring2buf(b):
b;d.next_in=0;d.avail_in=d.input.length;do{0===d.avail_out&&(d.output=new e.Buf8(f),d.next_out=0,d.avail_out=f);c=k.inflate(d,n.Z_NO_FLUSH);if(c!==n.Z_STREAM_END&&c!==n.Z_OK)return this.onEnd(c),this.ended=!0,!1;if(d.next_out&&(0===d.avail_out||c===n.Z_STREAM_END||0===d.avail_in&&g===n.Z_FINISH))if("string"===this.options.to)h=p.utf8border(d.output,d.next_out),u=d.next_out-h,q=p.buf2string(d.output,h),d.next_out=u,d.avail_out=f-u,u&&e.arraySet(d.output,d.output,h,u,0),this.onData(q);else this.onData(e.shrinkBuf(d.output,
d.next_out))}while(0<d.avail_in&&c!==n.Z_STREAM_END);c===n.Z_STREAM_END&&(g=n.Z_FINISH);return g===n.Z_FINISH?(c=k.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===n.Z_OK):!0};d.prototype.onData=function(b){this.chunks.push(b)};d.prototype.onEnd=function(b){b===n.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):e.flattenChunks(this.chunks));this.chunks=[];this.err=b;this.msg=this.strm.msg};a.Inflate=d;a.inflate=f;a.inflateRaw=function(b,a){a=a||{};a.raw=!0;return f(b,a)};a.ungzip=
f},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(c,g,a){c="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;a.assign=function(a){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var c=f.shift();if(c){if("object"!==typeof c)throw new TypeError(c+"must be non-object");for(var g in c)c.hasOwnProperty(g)&&(a[g]=c[g])}}return a};
a.shrinkBuf=function(a,f){if(a.length===f)return a;if(a.subarray)return a.subarray(0,f);a.length=f;return a};var f={arraySet:function(a,f,c,g,k){if(f.subarray&&a.subarray)a.set(f.subarray(c,c+g),k);else for(var b=0;b<g;b++)a[k+b]=f[c+b]},flattenChunks:function(a){var f,c,g,k,b;f=g=0;for(c=a.length;f<c;f++)g+=a[f].length;b=new Uint8Array(g);f=g=0;for(c=a.length;f<c;f++)k=a[f],b.set(k,g),g+=k.length;return b}},k={arraySet:function(a,f,c,g,k){for(var b=0;b<g;b++)a[k+b]=f[c+b]},flattenChunks:function(a){return[].concat.apply([],
a)}};a.setTyped=function(e){e?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,f)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,k))};a.setTyped(c)},{}],28:[function(c,g,a){function f(b,a){if(65537>a&&(b.subarray&&p||!b.subarray&&e))return String.fromCharCode.apply(null,k.shrinkBuf(b,a));for(var f="",c=0;c<a;c++)f+=String.fromCharCode(b[c]);return f}var k=c("./common"),e=!0,p=!0;try{String.fromCharCode.apply(null,[0])}catch(n){e=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(h){p=
!1}var q=new k.Buf8(256);for(c=0;256>c;c++)q[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;q[254]=q[254]=1;a.string2buf=function(b){var a,e,f,c,g,h=b.length,p=0;for(c=0;c<h;c++)e=b.charCodeAt(c),55296===(e&64512)&&c+1<h&&(f=b.charCodeAt(c+1),56320===(f&64512)&&(e=65536+(e-55296<<10)+(f-56320),c++)),p+=128>e?1:2048>e?2:65536>e?3:4;a=new k.Buf8(p);for(c=g=0;g<p;c++)e=b.charCodeAt(c),55296===(e&64512)&&c+1<h&&(f=b.charCodeAt(c+1),56320===(f&64512)&&(e=65536+(e-55296<<10)+(f-56320),c++)),128>e?a[g++]=
e:(2048>e?a[g++]=192|e>>>6:(65536>e?a[g++]=224|e>>>12:(a[g++]=240|e>>>18,a[g++]=128|e>>>12&63),a[g++]=128|e>>>6&63),a[g++]=128|e&63);return a};a.buf2binstring=function(b){return f(b,b.length)};a.binstring2buf=function(b){for(var a=new k.Buf8(b.length),e=0,f=a.length;e<f;e++)a[e]=b.charCodeAt(e);return a};a.buf2string=function(b,a){var e,c,g,h,k=a||b.length,p=Array(2*k);for(e=c=0;e<k;)if(g=b[e++],128>g)p[c++]=g;else if(h=q[g],4<h)p[c++]=65533,e+=h-1;else{for(g&=2===h?31:3===h?15:7;1<h&&e<k;)g=g<<6|
b[e++]&63,h--;1<h?p[c++]=65533:65536>g?p[c++]=g:(g-=65536,p[c++]=55296|g>>10&1023,p[c++]=56320|g&1023)}return f(p,c)};a.utf8border=function(b,a){var e;a=a||b.length;a>b.length&&(a=b.length);for(e=a-1;0<=e&&128===(b[e]&192);)e--;return 0>e||0===e?a:e+q[b[e]]>a?e:a}},{"./common":27}],29:[function(c,g,a){g.exports=function(a,c,e,g){var n=a&65535|0;a=a>>>16&65535|0;for(var h=0;0!==e;){h=2E3<e?2E3:e;e-=h;do n=n+c[g++]|0,a=a+n|0;while(--h);n%=65521;a%=65521}return n|a<<16|0}},{}],30:[function(c,g,a){g.exports=
{Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(c,g,a){var f=function(){for(var a,e=[],f=0;256>f;f++){a=f;for(var c=0;8>c;c++)a=a&1?3988292384^a>>>
1:a>>>1;e[f]=a}return e}();g.exports=function(a,e,c,g){c=g+c;for(a^=-1;g<c;g++)a=a>>>8^f[(a^e[g])&255];return a^-1}},{}],32:[function(c,g,a){function f(b,a){b.msg=C[a];return a}function k(b){for(var a=b.length;0<=--a;)b[a]=0}function e(b){var a=b.state,d=a.pending;d>b.avail_out&&(d=b.avail_out);0!==d&&(u.arraySet(b.output,a.pending_buf,a.pending_out,d,b.next_out),b.next_out+=d,a.pending_out+=d,b.total_out+=d,b.avail_out-=d,a.pending-=d,0===a.pending&&(a.pending_out=0))}function p(b,a){z._tr_flush_block(b,
0<=b.block_start?b.block_start:-1,b.strstart-b.block_start,a);b.block_start=b.strstart;e(b.strm)}function n(b,a){b.pending_buf[b.pending++]=a}function h(b,a){b.pending_buf[b.pending++]=a>>>8&255;b.pending_buf[b.pending++]=a&255}function q(b,a){var d=b.max_chain_length,e=b.strstart,f,c=b.prev_length,g=b.nice_match,h=b.strstart>b.w_size-262?b.strstart-(b.w_size-262):0,k=b.window,m=b.w_mask,p=b.prev,u=b.strstart+258,n=k[e+c-1],q=k[e+c];b.prev_length>=b.good_match&&(d>>=2);g>b.lookahead&&(g=b.lookahead);
do if(f=a,k[f+c]===q&&k[f+c-1]===n&&k[f]===k[e]&&k[++f]===k[e+1]){e+=2;for(f++;k[++e]===k[++f]&&k[++e]===k[++f]&&k[++e]===k[++f]&&k[++e]===k[++f]&&k[++e]===k[++f]&&k[++e]===k[++f]&&k[++e]===k[++f]&&k[++e]===k[++f]&&e<u;);f=258-(u-e);e=u-258;if(f>c){b.match_start=a;c=f;if(f>=g)break;n=k[e+c-1];q=k[e+c]}}while((a=p[a&m])>h&&0!==--d);return c<=b.lookahead?c:b.lookahead}function b(b){var a=b.w_size,d,e,f,c;do{c=b.window_size-b.lookahead-b.strstart;if(b.strstart>=a+(a-262)){u.arraySet(b.window,b.window,
a,a,0);b.match_start-=a;b.strstart-=a;b.block_start-=a;d=e=b.hash_size;do f=b.head[--d],b.head[d]=f>=a?f-a:0;while(--e);d=e=a;do f=b.prev[--d],b.prev[d]=f>=a?f-a:0;while(--e);c+=a}if(0===b.strm.avail_in)break;d=b.strm;e=b.window;f=b.strstart+b.lookahead;var g=d.avail_in;g>c&&(g=c);0===g?e=0:(d.avail_in-=g,u.arraySet(e,d.input,d.next_in,g,f),1===d.state.wrap?d.adler=G(d.adler,e,g,f):2===d.state.wrap&&(d.adler=H(d.adler,e,g,f)),d.next_in+=g,d.total_in+=g,e=g);b.lookahead+=e;if(3<=b.lookahead+b.insert)for(c=
b.strstart-b.insert,b.ins_h=b.window[c],b.ins_h=(b.ins_h<<b.hash_shift^b.window[c+1])&b.hash_mask;b.insert&&!(b.ins_h=(b.ins_h<<b.hash_shift^b.window[c+3-1])&b.hash_mask,b.prev[c&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=c,c++,b.insert--,3>b.lookahead+b.insert););}while(262>b.lookahead&&0!==b.strm.avail_in)}function d(a,d){for(var e;;){if(262>a.lookahead){b(a);if(262>a.lookahead&&0===d)return 1;if(0===a.lookahead)break}e=0;3<=a.lookahead&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&
a.hash_mask,e=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);0!==e&&a.strstart-e<=a.w_size-262&&(a.match_length=q(a,e));if(3<=a.match_length)if(e=z._tr_tally(a,a.strstart-a.match_start,a.match_length-3),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&3<=a.lookahead){a.match_length--;do a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart;while(0!==--a.match_length);
a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else e=z._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(e&&(p(a,!1),0===a.strm.avail_out))return 1}a.insert=2>a.strstart?a.strstart:2;return 4===d?(p(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(p(a,!1),0===a.strm.avail_out)?1:2}function m(a,d){for(var e,f;;){if(262>a.lookahead){b(a);if(262>a.lookahead&&0===d)return 1;if(0===
a.lookahead)break}e=0;3<=a.lookahead&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,e=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);a.prev_length=a.match_length;a.prev_match=a.match_start;a.match_length=2;0!==e&&a.prev_length<a.max_lazy_match&&a.strstart-e<=a.w_size-262&&(a.match_length=q(a,e),5>=a.match_length&&(1===a.strategy||3===a.match_length&&4096<a.strstart-a.match_start)&&(a.match_length=2));if(3<=a.prev_length&&a.match_length<=a.prev_length){f=
a.strstart+a.lookahead-3;e=z._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-3);a.lookahead-=a.prev_length-1;a.prev_length-=2;do++a.strstart<=f&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+3-1])&a.hash_mask,a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);while(0!==--a.prev_length);a.match_available=0;a.match_length=2;a.strstart++;if(e&&(p(a,!1),0===a.strm.avail_out))return 1}else if(a.match_available){if((e=z._tr_tally(a,0,a.window[a.strstart-1]))&&p(a,!1),a.strstart++,
a.lookahead--,0===a.strm.avail_out)return 1}else a.match_available=1,a.strstart++,a.lookahead--}a.match_available&&(z._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0);a.insert=2>a.strstart?a.strstart:2;return 4===d?(p(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(p(a,!1),0===a.strm.avail_out)?1:2}function r(a,d){for(var e,f,c,g=a.window;;){if(258>=a.lookahead){b(a);if(258>=a.lookahead&&0===d)return 1;if(0===a.lookahead)break}a.match_length=0;if(3<=a.lookahead&&0<a.strstart&&(f=a.strstart-
1,e=g[f],e===g[++f]&&e===g[++f]&&e===g[++f])){for(c=a.strstart+258;e===g[++f]&&e===g[++f]&&e===g[++f]&&e===g[++f]&&e===g[++f]&&e===g[++f]&&e===g[++f]&&e===g[++f]&&f<c;);a.match_length=258-(c-f);a.match_length>a.lookahead&&(a.match_length=a.lookahead)}3<=a.match_length?(e=z._tr_tally(a,1,a.match_length-3),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(e=z._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++);if(e&&(p(a,!1),0===a.strm.avail_out))return 1}a.insert=
0;return 4===d?(p(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(p(a,!1),0===a.strm.avail_out)?1:2}function A(a,d){for(var e;;){if(0===a.lookahead&&(b(a),0===a.lookahead)){if(0===d)return 1;break}a.match_length=0;e=z._tr_tally(a,0,a.window[a.strstart]);a.lookahead--;a.strstart++;if(e&&(p(a,!1),0===a.strm.avail_out))return 1}a.insert=0;return 4===d?(p(a,!0),0===a.strm.avail_out?3:4):a.last_lit&&(p(a,!1),0===a.strm.avail_out)?1:2}function y(){this.strm=null;this.status=0;this.pending_buf=null;this.wrap=
this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=8;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=
this.ins_h=0;this.dyn_ltree=new u.Buf16(1146);this.dyn_dtree=new u.Buf16(122);this.bl_tree=new u.Buf16(78);k(this.dyn_ltree);k(this.dyn_dtree);k(this.bl_tree);this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new u.Buf16(16);this.heap=new u.Buf16(573);k(this.heap);this.heap_max=this.heap_len=0;this.depth=new u.Buf16(573);k(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function v(a){var b;if(!a||
!a.state)return f(a,-2);a.total_in=a.total_out=0;a.data_type=2;b=a.state;b.pending=0;b.pending_out=0;0>b.wrap&&(b.wrap=-b.wrap);b.status=b.wrap?42:113;a.adler=2===b.wrap?0:1;b.last_flush=0;z._tr_init(b);return 0}function s(a){var b=v(a);0===b&&(a=a.state,a.window_size=2*a.w_size,k(a.head),a.max_lazy_match=E[a.level].max_lazy,a.good_match=E[a.level].good_length,a.nice_match=E[a.level].nice_length,a.max_chain_length=E[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=
a.prev_length=2,a.match_available=0,a.ins_h=0);return b}function B(a,b,d,e,c,g){if(!a)return-2;var h=1;-1===b&&(b=6);0>e?(h=0,e=-e):15<e&&(h=2,e-=16);if(1>c||9<c||8!==d||8>e||15<e||0>b||9<b||0>g||4<g)return f(a,-2);8===e&&(e=9);var k=new y;a.state=k;k.strm=a;k.wrap=h;k.gzhead=null;k.w_bits=e;k.w_size=1<<k.w_bits;k.w_mask=k.w_size-1;k.hash_bits=c+7;k.hash_size=1<<k.hash_bits;k.hash_mask=k.hash_size-1;k.hash_shift=~~((k.hash_bits+3-1)/3);k.window=new u.Buf8(2*k.w_size);k.head=new u.Buf16(k.hash_size);
k.prev=new u.Buf16(k.w_size);k.lit_bufsize=1<<c+6;k.pending_buf_size=4*k.lit_bufsize;k.pending_buf=new u.Buf8(k.pending_buf_size);k.d_buf=k.lit_bufsize>>1;k.l_buf=3*k.lit_bufsize;k.level=b;k.strategy=g;k.method=d;return s(a)}var u=c("../utils/common"),z=c("./trees"),G=c("./adler32"),H=c("./crc32"),C=c("./messages");c=function(a,b,d,e,f){this.good_length=a;this.max_lazy=b;this.nice_length=d;this.max_chain=e;this.func=f};var E;E=[new c(0,0,0,0,function(a,d){var e=65535;for(e>a.pending_buf_size-5&&(e=
a.pending_buf_size-5);;){if(1>=a.lookahead){b(a);if(0===a.lookahead&&0===d)return 1;if(0===a.lookahead)break}a.strstart+=a.lookahead;a.lookahead=0;var f=a.block_start+e;if(0===a.strstart||a.strstart>=f)if(a.lookahead=a.strstart-f,a.strstart=f,p(a,!1),0===a.strm.avail_out)return 1;if(a.strstart-a.block_start>=a.w_size-262&&(p(a,!1),0===a.strm.avail_out))return 1}a.insert=0;if(4===d)return p(a,!0),0===a.strm.avail_out?3:4;a.strstart>a.block_start&&p(a,!1);return 1}),new c(4,4,8,4,d),new c(4,5,16,8,
d),new c(4,6,32,32,d),new c(4,4,16,16,m),new c(8,16,32,32,m),new c(8,16,128,128,m),new c(8,32,128,256,m),new c(32,128,258,1024,m),new c(32,258,258,4096,m)];a.deflateInit=function(a,b){return B(a,b,8,15,8,0)};a.deflateInit2=B;a.deflateReset=s;a.deflateResetKeep=v;a.deflateSetHeader=function(a,b){if(!a||!a.state||2!==a.state.wrap)return-2;a.state.gzhead=b;return 0};a.deflate=function(a,b){var d,c,g,m;if(!a||!a.state||5<b||0>b)return a?f(a,-2):-2;c=a.state;if(!a.output||!a.input&&0!==a.avail_in||666===
c.status&&4!==b)return f(a,0===a.avail_out?-5:-2);c.strm=a;d=c.last_flush;c.last_flush=b;42===c.status&&(2===c.wrap?(a.adler=0,n(c,31),n(c,139),n(c,8),c.gzhead?(n(c,(c.gzhead.text?1:0)+(c.gzhead.hcrc?2:0)+(c.gzhead.extra?4:0)+(c.gzhead.name?8:0)+(c.gzhead.comment?16:0)),n(c,c.gzhead.time&255),n(c,c.gzhead.time>>8&255),n(c,c.gzhead.time>>16&255),n(c,c.gzhead.time>>24&255),n(c,9===c.level?2:2<=c.strategy||2>c.level?4:0),n(c,c.gzhead.os&255),c.gzhead.extra&&c.gzhead.extra.length&&(n(c,c.gzhead.extra.length&
255),n(c,c.gzhead.extra.length>>8&255)),c.gzhead.hcrc&&(a.adler=H(a.adler,c.pending_buf,c.pending,0)),c.gzindex=0,c.status=69):(n(c,0),n(c,0),n(c,0),n(c,0),n(c,0),n(c,9===c.level?2:2<=c.strategy||2>c.level?4:0),n(c,3),c.status=113)):(g=8+(c.w_bits-8<<4)<<8,m=-1,m=2<=c.strategy||2>c.level?0:6>c.level?1:6===c.level?2:3,g|=m<<6,0!==c.strstart&&(g|=32),c.status=113,h(c,g+(31-g%31)),0!==c.strstart&&(h(c,a.adler>>>16),h(c,a.adler&65535)),a.adler=1));if(69===c.status)if(c.gzhead.extra){for(g=c.pending;c.gzindex<
(c.gzhead.extra.length&65535)&&(c.pending!==c.pending_buf_size||(c.gzhead.hcrc&&c.pending>g&&(a.adler=H(a.adler,c.pending_buf,c.pending-g,g)),e(a),g=c.pending,c.pending!==c.pending_buf_size));)n(c,c.gzhead.extra[c.gzindex]&255),c.gzindex++;c.gzhead.hcrc&&c.pending>g&&(a.adler=H(a.adler,c.pending_buf,c.pending-g,g));c.gzindex===c.gzhead.extra.length&&(c.gzindex=0,c.status=73)}else c.status=73;if(73===c.status)if(c.gzhead.name){g=c.pending;do{if(c.pending===c.pending_buf_size&&(c.gzhead.hcrc&&c.pending>
g&&(a.adler=H(a.adler,c.pending_buf,c.pending-g,g)),e(a),g=c.pending,c.pending===c.pending_buf_size)){m=1;break}m=c.gzindex<c.gzhead.name.length?c.gzhead.name.charCodeAt(c.gzindex++)&255:0;n(c,m)}while(0!==m);c.gzhead.hcrc&&c.pending>g&&(a.adler=H(a.adler,c.pending_buf,c.pending-g,g));0===m&&(c.gzindex=0,c.status=91)}else c.status=91;if(91===c.status)if(c.gzhead.comment){g=c.pending;do{if(c.pending===c.pending_buf_size&&(c.gzhead.hcrc&&c.pending>g&&(a.adler=H(a.adler,c.pending_buf,c.pending-g,g)),
e(a),g=c.pending,c.pending===c.pending_buf_size)){m=1;break}m=c.gzindex<c.gzhead.comment.length?c.gzhead.comment.charCodeAt(c.gzindex++)&255:0;n(c,m)}while(0!==m);c.gzhead.hcrc&&c.pending>g&&(a.adler=H(a.adler,c.pending_buf,c.pending-g,g));0===m&&(c.status=103)}else c.status=103;103===c.status&&(c.gzhead.hcrc?(c.pending+2>c.pending_buf_size&&e(a),c.pending+2<=c.pending_buf_size&&(n(c,a.adler&255),n(c,a.adler>>8&255),a.adler=0,c.status=113)):c.status=113);if(0!==c.pending){if(e(a),0===a.avail_out)return c.last_flush=
-1,0}else if(0===a.avail_in&&(b<<1)-(4<b?9:0)<=(d<<1)-(4<d?9:0)&&4!==b)return f(a,-5);if(666===c.status&&0!==a.avail_in)return f(a,-5);if(0!==a.avail_in||0!==c.lookahead||0!==b&&666!==c.status){d=2===c.strategy?A(c,b):3===c.strategy?r(c,b):E[c.level].func(c,b);if(3===d||4===d)c.status=666;if(1===d||3===d)return 0===a.avail_out&&(c.last_flush=-1),0;if(2===d&&(1===b?z._tr_align(c):5!==b&&(z._tr_stored_block(c,0,0,!1),3===b&&(k(c.head),0===c.lookahead&&(c.strstart=0,c.block_start=0,c.insert=0))),e(a),
0===a.avail_out))return c.last_flush=-1,0}if(4!==b)return 0;if(0>=c.wrap)return 1;2===c.wrap?(n(c,a.adler&255),n(c,a.adler>>8&255),n(c,a.adler>>16&255),n(c,a.adler>>24&255),n(c,a.total_in&255),n(c,a.total_in>>8&255),n(c,a.total_in>>16&255),n(c,a.total_in>>24&255)):(h(c,a.adler>>>16),h(c,a.adler&65535));e(a);0<c.wrap&&(c.wrap=-c.wrap);return 0!==c.pending?0:1};a.deflateEnd=function(a){var b;if(!a||!a.state)return-2;b=a.state.status;if(42!==b&&69!==b&&73!==b&&91!==b&&103!==b&&113!==b&&666!==b)return f(a,
-2);a.state=null;return 113===b?f(a,-3):0};a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(c,g,a){g.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],34:[function(c,g,a){g.exports=function(a,c){var e,g,n,h,q,b,d,m,r,A,y,v,s,B,u,z,G,H,C,E,t,x,w,M;e=a.state;g=a.next_in;w=a.input;n=g+(a.avail_in-5);h=a.next_out;
M=a.output;q=h-(c-a.avail_out);b=h+(a.avail_out-257);d=e.dmax;m=e.wsize;r=e.whave;A=e.wnext;y=e.window;v=e.hold;s=e.bits;B=e.lencode;u=e.distcode;z=(1<<e.lenbits)-1;G=(1<<e.distbits)-1;a:do b:for(15>s&&(v+=w[g++]<<s,s+=8,v+=w[g++]<<s,s+=8),H=B[v&z];;){C=H>>>24;v>>>=C;s-=C;C=H>>>16&255;if(0===C)M[h++]=H&65535;else if(C&16){E=H&65535;if(C&=15)s<C&&(v+=w[g++]<<s,s+=8),E+=v&(1<<C)-1,v>>>=C,s-=C;15>s&&(v+=w[g++]<<s,s+=8,v+=w[g++]<<s,s+=8);H=u[v&G];c:for(;;){C=H>>>24;v>>>=C;s-=C;C=H>>>16&255;if(C&16){H&=
65535;C&=15;s<C&&(v+=w[g++]<<s,s+=8,s<C&&(v+=w[g++]<<s,s+=8));H+=v&(1<<C)-1;if(H>d){a.msg="invalid distance too far back";e.mode=30;break a}v>>>=C;s-=C;C=h-q;if(H>C){C=H-C;if(C>r&&e.sane){a.msg="invalid distance too far back";e.mode=30;break a}t=0;x=y;if(0===A){if(t+=m-C,C<E){E-=C;do M[h++]=y[t++];while(--C);t=h-H;x=M}}else if(A<C){if(t+=m+A-C,C-=A,C<E){E-=C;do M[h++]=y[t++];while(--C);t=0;if(A<E){C=A;E-=C;do M[h++]=y[t++];while(--C);t=h-H;x=M}}}else if(t+=A-C,C<E){E-=C;do M[h++]=y[t++];while(--C);
t=h-H;x=M}for(;2<E;)M[h++]=x[t++],M[h++]=x[t++],M[h++]=x[t++],E-=3;E&&(M[h++]=x[t++],1<E&&(M[h++]=x[t++]))}else{t=h-H;do M[h++]=M[t++],M[h++]=M[t++],M[h++]=M[t++],E-=3;while(2<E);E&&(M[h++]=M[t++],1<E&&(M[h++]=M[t++]))}}else if(0===(C&64)){H=u[(H&65535)+(v&(1<<C)-1)];continue c}else{a.msg="invalid distance code";e.mode=30;break a}break}}else if(0===(C&64)){H=B[(H&65535)+(v&(1<<C)-1)];continue b}else{C&32?e.mode=12:(a.msg="invalid literal/length code",e.mode=30);break a}break}while(g<n&&h<b);E=s>>
3;g-=E;s-=E<<3;a.next_in=g;a.next_out=h;a.avail_in=g<n?5+(n-g):5-(g-n);a.avail_out=h<b?257+(b-h):257-(h-b);e.hold=v&(1<<s)-1;e.bits=s}},{}],35:[function(c,g,a){function f(a){return(a>>>24&255)+(a>>>8&65280)+((a&65280)<<8)+((a&255)<<24)}function k(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=
null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new q.Buf16(320);this.work=new q.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function e(a){var b;if(!a||!a.state)return-2;b=a.state;a.total_in=a.total_out=b.total=0;a.msg="";b.wrap&&(a.adler=b.wrap&1);b.mode=1;b.last=0;b.havedict=0;b.dmax=32768;b.head=null;b.hold=0;b.bits=0;b.lencode=b.lendyn=new q.Buf32(852);b.distcode=b.distdyn=new q.Buf32(592);b.sane=1;b.back=-1;return 0}
function p(a){var b;if(!a||!a.state)return-2;b=a.state;b.wsize=0;b.whave=0;b.wnext=0;return e(a)}function n(a,b){var d,e;if(!a||!a.state)return-2;e=a.state;0>b?(d=0,b=-b):(d=(b>>4)+1,48>b&&(b&=15));if(b&&(8>b||15<b))return-2;null!==e.window&&e.wbits!==b&&(e.window=null);e.wrap=d;e.wbits=b;return p(a)}function h(a,b){var d;if(!a)return-2;d=new k;a.state=d;d.window=null;d=n(a,b);0!==d&&(a.state=null);return d}var q=c("../utils/common"),b=c("./adler32"),d=c("./crc32"),m=c("./inffast"),r=c("./inftrees"),
A=!0,y,v;a.inflateReset=p;a.inflateReset2=n;a.inflateResetKeep=e;a.inflateInit=function(a){return h(a,15)};a.inflateInit2=h;a.inflate=function(a,e){var c,g,h,k,p,n,t,x,w,M,D,I,J,K,F=0,U,$,Q,ba=new q.Buf8(4),ca=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!a||!a.state||!a.output||!a.input&&0!==a.avail_in)return-2;c=a.state;12===c.mode&&(c.mode=13);p=a.next_out;h=a.output;t=a.avail_out;k=a.next_in;g=a.input;n=a.avail_in;x=c.hold;w=c.bits;M=n;D=t;Q=0;a:for(;;)switch(c.mode){case 1:if(0===c.wrap){c.mode=
13;break}for(;16>w;){if(0===n)break a;n--;x+=g[k++]<<w;w+=8}if(c.wrap&2&&35615===x){c.check=0;ba[0]=x&255;ba[1]=x>>>8&255;c.check=d(c.check,ba,2,0);w=x=0;c.mode=2;break}c.flags=0;c.head&&(c.head.done=!1);if(!(c.wrap&1)||(((x&255)<<8)+(x>>8))%31){a.msg="incorrect header check";c.mode=30;break}if(8!==(x&15)){a.msg="unknown compression method";c.mode=30;break}x>>>=4;w-=4;J=(x&15)+8;if(0===c.wbits)c.wbits=J;else if(J>c.wbits){a.msg="invalid window size";c.mode=30;break}c.dmax=1<<J;a.adler=c.check=1;c.mode=
x&512?10:12;w=x=0;break;case 2:for(;16>w;){if(0===n)break a;n--;x+=g[k++]<<w;w+=8}c.flags=x;if(8!==(c.flags&255)){a.msg="unknown compression method";c.mode=30;break}if(c.flags&57344){a.msg="unknown header flags set";c.mode=30;break}c.head&&(c.head.text=x>>8&1);c.flags&512&&(ba[0]=x&255,ba[1]=x>>>8&255,c.check=d(c.check,ba,2,0));w=x=0;c.mode=3;case 3:for(;32>w;){if(0===n)break a;n--;x+=g[k++]<<w;w+=8}c.head&&(c.head.time=x);c.flags&512&&(ba[0]=x&255,ba[1]=x>>>8&255,ba[2]=x>>>16&255,ba[3]=x>>>24&255,
c.check=d(c.check,ba,4,0));w=x=0;c.mode=4;case 4:for(;16>w;){if(0===n)break a;n--;x+=g[k++]<<w;w+=8}c.head&&(c.head.xflags=x&255,c.head.os=x>>8);c.flags&512&&(ba[0]=x&255,ba[1]=x>>>8&255,c.check=d(c.check,ba,2,0));w=x=0;c.mode=5;case 5:if(c.flags&1024){for(;16>w;){if(0===n)break a;n--;x+=g[k++]<<w;w+=8}c.length=x;c.head&&(c.head.extra_len=x);c.flags&512&&(ba[0]=x&255,ba[1]=x>>>8&255,c.check=d(c.check,ba,2,0));w=x=0}else c.head&&(c.head.extra=null);c.mode=6;case 6:if(c.flags&1024&&(I=c.length,I>n&&
(I=n),I&&(c.head&&(J=c.head.extra_len-c.length,c.head.extra||(c.head.extra=Array(c.head.extra_len)),q.arraySet(c.head.extra,g,k,I,J)),c.flags&512&&(c.check=d(c.check,g,I,k)),n-=I,k+=I,c.length-=I),c.length))break a;c.length=0;c.mode=7;case 7:if(c.flags&2048){if(0===n)break a;I=0;do J=g[k+I++],c.head&&J&&65536>c.length&&(c.head.name+=String.fromCharCode(J));while(J&&I<n);c.flags&512&&(c.check=d(c.check,g,I,k));n-=I;k+=I;if(J)break a}else c.head&&(c.head.name=null);c.length=0;c.mode=8;case 8:if(c.flags&
4096){if(0===n)break a;I=0;do J=g[k+I++],c.head&&J&&65536>c.length&&(c.head.comment+=String.fromCharCode(J));while(J&&I<n);c.flags&512&&(c.check=d(c.check,g,I,k));n-=I;k+=I;if(J)break a}else c.head&&(c.head.comment=null);c.mode=9;case 9:if(c.flags&512){for(;16>w;){if(0===n)break a;n--;x+=g[k++]<<w;w+=8}if(x!==(c.check&65535)){a.msg="header crc mismatch";c.mode=30;break}w=x=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0);a.adler=c.check=0;c.mode=12;break;case 10:for(;32>w;){if(0===n)break a;n--;
x+=g[k++]<<w;w+=8}a.adler=c.check=f(x);w=x=0;c.mode=11;case 11:if(0===c.havedict)return a.next_out=p,a.avail_out=t,a.next_in=k,a.avail_in=n,c.hold=x,c.bits=w,2;a.adler=c.check=1;c.mode=12;case 12:if(5===e||6===e)break a;case 13:if(c.last){x>>>=w&7;w-=w&7;c.mode=27;break}for(;3>w;){if(0===n)break a;n--;x+=g[k++]<<w;w+=8}c.last=x&1;x>>>=1;w-=1;switch(x&3){case 0:c.mode=14;break;case 1:I=c;if(A){J=void 0;y=new q.Buf32(512);v=new q.Buf32(32);for(J=0;144>J;)I.lens[J++]=8;for(;256>J;)I.lens[J++]=9;for(;280>
J;)I.lens[J++]=7;for(;288>J;)I.lens[J++]=8;r(1,I.lens,0,288,y,0,I.work,{bits:9});for(J=0;32>J;)I.lens[J++]=5;r(2,I.lens,0,32,v,0,I.work,{bits:5});A=!1}I.lencode=y;I.lenbits=9;I.distcode=v;I.distbits=5;c.mode=20;if(6===e){x>>>=2;w-=2;break a}break;case 2:c.mode=17;break;case 3:a.msg="invalid block type",c.mode=30}x>>>=2;w-=2;break;case 14:x>>>=w&7;for(w-=w&7;32>w;){if(0===n)break a;n--;x+=g[k++]<<w;w+=8}if((x&65535)!==(x>>>16^65535)){a.msg="invalid stored block lengths";c.mode=30;break}c.length=x&
65535;w=x=0;c.mode=15;if(6===e)break a;case 15:c.mode=16;case 16:if(I=c.length){I>n&&(I=n);I>t&&(I=t);if(0===I)break a;q.arraySet(h,g,k,I,p);n-=I;k+=I;t-=I;p+=I;c.length-=I;break}c.mode=12;break;case 17:for(;14>w;){if(0===n)break a;n--;x+=g[k++]<<w;w+=8}c.nlen=(x&31)+257;x>>>=5;w-=5;c.ndist=(x&31)+1;x>>>=5;w-=5;c.ncode=(x&15)+4;x>>>=4;w-=4;if(286<c.nlen||30<c.ndist){a.msg="too many length or distance symbols";c.mode=30;break}c.have=0;c.mode=18;case 18:for(;c.have<c.ncode;){for(;3>w;){if(0===n)break a;
n--;x+=g[k++]<<w;w+=8}c.lens[ca[c.have++]]=x&7;x>>>=3;w-=3}for(;19>c.have;)c.lens[ca[c.have++]]=0;c.lencode=c.lendyn;c.lenbits=7;I={bits:c.lenbits};Q=r(0,c.lens,0,19,c.lencode,0,c.work,I);c.lenbits=I.bits;if(Q){a.msg="invalid code lengths set";c.mode=30;break}c.have=0;c.mode=19;case 19:for(;c.have<c.nlen+c.ndist;){for(;;){F=c.lencode[x&(1<<c.lenbits)-1];I=F>>>24;F&=65535;if(I<=w)break;if(0===n)break a;n--;x+=g[k++]<<w;w+=8}if(16>F)x>>>=I,w-=I,c.lens[c.have++]=F;else{if(16===F){for(J=I+2;w<J;){if(0===
n)break a;n--;x+=g[k++]<<w;w+=8}x>>>=I;w-=I;if(0===c.have){a.msg="invalid bit length repeat";c.mode=30;break}J=c.lens[c.have-1];I=3+(x&3);x>>>=2;w-=2}else if(17===F){for(J=I+3;w<J;){if(0===n)break a;n--;x+=g[k++]<<w;w+=8}x>>>=I;w-=I;J=0;I=3+(x&7);x>>>=3;w-=3}else{for(J=I+7;w<J;){if(0===n)break a;n--;x+=g[k++]<<w;w+=8}x>>>=I;w-=I;J=0;I=11+(x&127);x>>>=7;w-=7}if(c.have+I>c.nlen+c.ndist){a.msg="invalid bit length repeat";c.mode=30;break}for(;I--;)c.lens[c.have++]=J}}if(30===c.mode)break;if(0===c.lens[256]){a.msg=
"invalid code -- missing end-of-block";c.mode=30;break}c.lenbits=9;I={bits:c.lenbits};Q=r(1,c.lens,0,c.nlen,c.lencode,0,c.work,I);c.lenbits=I.bits;if(Q){a.msg="invalid literal/lengths set";c.mode=30;break}c.distbits=6;c.distcode=c.distdyn;I={bits:c.distbits};Q=r(2,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,I);c.distbits=I.bits;if(Q){a.msg="invalid distances set";c.mode=30;break}c.mode=20;if(6===e)break a;case 20:c.mode=21;case 21:if(6<=n&&258<=t){a.next_out=p;a.avail_out=t;a.next_in=k;a.avail_in=n;
c.hold=x;c.bits=w;m(a,D);p=a.next_out;h=a.output;t=a.avail_out;k=a.next_in;g=a.input;n=a.avail_in;x=c.hold;w=c.bits;12===c.mode&&(c.back=-1);break}for(c.back=0;;){F=c.lencode[x&(1<<c.lenbits)-1];I=F>>>24;J=F>>>16&255;F&=65535;if(I<=w)break;if(0===n)break a;n--;x+=g[k++]<<w;w+=8}if(J&&0===(J&240)){K=I;U=J;for($=F;;){F=c.lencode[$+((x&(1<<K+U)-1)>>K)];I=F>>>24;J=F>>>16&255;F&=65535;if(K+I<=w)break;if(0===n)break a;n--;x+=g[k++]<<w;w+=8}x>>>=K;w-=K;c.back+=K}x>>>=I;w-=I;c.back+=I;c.length=F;if(0===J){c.mode=
26;break}if(J&32){c.back=-1;c.mode=12;break}if(J&64){a.msg="invalid literal/length code";c.mode=30;break}c.extra=J&15;c.mode=22;case 22:if(c.extra){for(J=c.extra;w<J;){if(0===n)break a;n--;x+=g[k++]<<w;w+=8}c.length+=x&(1<<c.extra)-1;x>>>=c.extra;w-=c.extra;c.back+=c.extra}c.was=c.length;c.mode=23;case 23:for(;;){F=c.distcode[x&(1<<c.distbits)-1];I=F>>>24;J=F>>>16&255;F&=65535;if(I<=w)break;if(0===n)break a;n--;x+=g[k++]<<w;w+=8}if(0===(J&240)){K=I;U=J;for($=F;;){F=c.distcode[$+((x&(1<<K+U)-1)>>K)];
I=F>>>24;J=F>>>16&255;F&=65535;if(K+I<=w)break;if(0===n)break a;n--;x+=g[k++]<<w;w+=8}x>>>=K;w-=K;c.back+=K}x>>>=I;w-=I;c.back+=I;if(J&64){a.msg="invalid distance code";c.mode=30;break}c.offset=F;c.extra=J&15;c.mode=24;case 24:if(c.extra){for(J=c.extra;w<J;){if(0===n)break a;n--;x+=g[k++]<<w;w+=8}c.offset+=x&(1<<c.extra)-1;x>>>=c.extra;w-=c.extra;c.back+=c.extra}if(c.offset>c.dmax){a.msg="invalid distance too far back";c.mode=30;break}c.mode=25;case 25:if(0===t)break a;I=D-t;if(c.offset>I){I=c.offset-
I;if(I>c.whave&&c.sane){a.msg="invalid distance too far back";c.mode=30;break}I>c.wnext?(I-=c.wnext,J=c.wsize-I):J=c.wnext-I;I>c.length&&(I=c.length);K=c.window}else K=h,J=p-c.offset,I=c.length;I>t&&(I=t);t-=I;c.length-=I;do h[p++]=K[J++];while(--I);0===c.length&&(c.mode=21);break;case 26:if(0===t)break a;h[p++]=c.length;t--;c.mode=21;break;case 27:if(c.wrap){for(;32>w;){if(0===n)break a;n--;x|=g[k++]<<w;w+=8}D-=t;a.total_out+=D;c.total+=D;D&&(a.adler=c.check=c.flags?d(c.check,h,D,p-D):b(c.check,
h,D,p-D));D=t;if((c.flags?x:f(x))!==c.check){a.msg="incorrect data check";c.mode=30;break}w=x=0}c.mode=28;case 28:if(c.wrap&&c.flags){for(;32>w;){if(0===n)break a;n--;x+=g[k++]<<w;w+=8}if(x!==(c.total&4294967295)){a.msg="incorrect length check";c.mode=30;break}w=x=0}c.mode=29;case 29:Q=1;break a;case 30:Q=-3;break a;case 31:return-4;default:return-2}a.next_out=p;a.avail_out=t;a.next_in=k;a.avail_in=n;c.hold=x;c.bits=w;if(c.wsize||D!==a.avail_out&&30>c.mode&&(27>c.mode||4!==e))g=a.output,k=a.next_out,
p=D-a.avail_out,t=a.state,null===t.window&&(t.wsize=1<<t.wbits,t.wnext=0,t.whave=0,t.window=new q.Buf8(t.wsize)),p>=t.wsize?(q.arraySet(t.window,g,k-t.wsize,t.wsize,0),t.wnext=0,t.whave=t.wsize):(n=t.wsize-t.wnext,n>p&&(n=p),q.arraySet(t.window,g,k-p,n,t.wnext),(p-=n)?(q.arraySet(t.window,g,k-p,p,0),t.wnext=p,t.whave=t.wsize):(t.wnext+=n,t.wnext===t.wsize&&(t.wnext=0),t.whave<t.wsize&&(t.whave+=n)));M-=a.avail_in;D-=a.avail_out;a.total_in+=M;a.total_out+=D;c.total+=D;c.wrap&&D&&(a.adler=c.check=c.flags?
d(c.check,h,D,a.next_out-D):b(c.check,h,D,a.next_out-D));a.data_type=c.bits+(c.last?64:0)+(12===c.mode?128:0)+(20===c.mode||15===c.mode?256:0);(0===M&&0===D||4===e)&&0===Q&&(Q=-5);return Q};a.inflateEnd=function(a){if(!a||!a.state)return-2;var b=a.state;b.window&&(b.window=null);a.state=null;return 0};a.inflateGetHeader=function(a,b){var c;if(!a||!a.state)return-2;c=a.state;if(0===(c.wrap&2))return-2;c.head=b;b.done=!1;return 0};a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,
"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(c,g,a){var f=c("../utils/common"),k=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],e=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],n=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,
28,29,29,64,64];g.exports=function(a,c,b,d,g,r,A,y){for(var v=y.bits,s=0,B=0,u=0,z=0,G=0,H=0,C=0,E=0,t=0,x=0,w,M,D=null,I=0,J,K=new f.Buf16(16),H=new f.Buf16(16),F=null,U=0,$,Q,ba,s=0;15>=s;s++)K[s]=0;for(B=0;B<d;B++)K[c[b+B]]++;G=v;for(z=15;1<=z&&0===K[z];z--);G>z&&(G=z);if(0===z)return g[r++]=20971520,g[r++]=20971520,y.bits=1,0;for(u=1;u<z&&0===K[u];u++);G<u&&(G=u);for(s=E=1;15>=s;s++)if(E<<=1,E-=K[s],0>E)return-1;if(0<E&&(0===a||1!==z))return-1;H[1]=0;for(s=1;15>s;s++)H[s+1]=H[s]+K[s];for(B=0;B<
d;B++)0!==c[b+B]&&(A[H[c[b+B]]++]=B);0===a?(D=F=A,J=19):1===a?(D=k,I-=257,F=e,U-=257,J=256):(D=p,F=n,J=-1);B=x=0;s=u;v=r;H=G;C=0;M=-1;t=1<<G;d=t-1;if(1===a&&852<t||2===a&&592<t)return 1;for(var ca=0;;){ca++;$=s-C;A[B]<J?(Q=0,ba=A[B]):A[B]>J?(Q=F[U+A[B]],ba=D[I+A[B]]):(Q=96,ba=0);E=1<<s-C;u=w=1<<H;do w-=E,g[v+(x>>C)+w]=$<<24|Q<<16|ba|0;while(0!==w);for(E=1<<s-1;x&E;)E>>=1;0!==E?(x&=E-1,x+=E):x=0;B++;if(0===--K[s]){if(s===z)break;s=c[b+A[B]]}if(s>G&&(x&d)!==M){0===C&&(C=G);v+=u;H=s-C;for(E=1<<H;H+C<
z;){E-=K[H+C];if(0>=E)break;H++;E<<=1}t+=1<<H;if(1===a&&852<t||2===a&&592<t)return 1;M=x&d;g[M]=G<<24|H<<16|v-r|0}}0!==x&&(g[v+x]=s-C<<24|4194304);y.bits=G;return 0}},{"../utils/common":27}],37:[function(c,g,a){g.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(c,g,a){function f(a){for(var b=a.length;0<=--b;)a[b]=0}function k(a,b){a.pending_buf[a.pending++]=
b&255;a.pending_buf[a.pending++]=b>>>8&255}function e(a,b,c){a.bi_valid>16-c?(a.bi_buf|=b<<a.bi_valid&65535,k(a,a.bi_buf),a.bi_buf=b>>16-a.bi_valid,a.bi_valid+=c-16):(a.bi_buf|=b<<a.bi_valid&65535,a.bi_valid+=c)}function p(a,b,c){e(a,c[2*b],c[2*b+1])}function n(a,b){var c=0;do c|=a&1,a>>>=1,c<<=1;while(0<--b);return c>>>1}function h(a,b,c){var d=Array(16),e=0,f;for(f=1;15>=f;f++)d[f]=e=e+c[f-1]<<1;for(c=0;c<=b;c++)e=a[2*c+1],0!==e&&(a[2*c]=n(d[e]++,e))}function q(a){var b;for(b=0;286>b;b++)a.dyn_ltree[2*
b]=0;for(b=0;30>b;b++)a.dyn_dtree[2*b]=0;for(b=0;19>b;b++)a.bl_tree[2*b]=0;a.dyn_ltree[512]=1;a.opt_len=a.static_len=0;a.last_lit=a.matches=0}function b(a){8<a.bi_valid?k(a,a.bi_buf):0<a.bi_valid&&(a.pending_buf[a.pending++]=a.bi_buf);a.bi_buf=0;a.bi_valid=0}function d(a,b,c,d){var e=2*b,f=2*c;return a[e]<a[f]||a[e]===a[f]&&d[b]<=d[c]}function m(a,b,c){for(var e=a.heap[c],f=c<<1;f<=a.heap_len;){f<a.heap_len&&d(b,a.heap[f+1],a.heap[f],a.depth)&&f++;if(d(b,e,a.heap[f],a.depth))break;a.heap[c]=a.heap[f];
c=f;f<<=1}a.heap[c]=e}function r(a,b,c){var d,f,g=0,h,k;if(0!==a.last_lit){do d=a.pending_buf[a.d_buf+2*g]<<8|a.pending_buf[a.d_buf+2*g+1],f=a.pending_buf[a.l_buf+g],g++,0===d?p(a,f,b):(h=w[f],p(a,h+256+1,b),k=z[h],0!==k&&(f-=M[h],e(a,f,k)),d--,h=256>d?x[d]:x[256+(d>>>7)],p(a,h,c),k=G[h],0!==k&&(d-=D[h],e(a,d,k)));while(g<a.last_lit)}p(a,256,b)}function A(a,b){var c=b.dyn_tree,d=b.stat_desc.static_tree,e=b.stat_desc.has_stree,f=b.stat_desc.elems,g,k=-1,n;a.heap_len=0;a.heap_max=573;for(g=0;g<f;g++)0!==
c[2*g]?(a.heap[++a.heap_len]=k=g,a.depth[g]=0):c[2*g+1]=0;for(;2>a.heap_len;)n=a.heap[++a.heap_len]=2>k?++k:0,c[2*n]=1,a.depth[n]=0,a.opt_len--,e&&(a.static_len-=d[2*n+1]);b.max_code=k;for(g=a.heap_len>>1;1<=g;g--)m(a,c,g);n=f;do g=a.heap[1],a.heap[1]=a.heap[a.heap_len--],m(a,c,1),d=a.heap[1],a.heap[--a.heap_max]=g,a.heap[--a.heap_max]=d,c[2*n]=c[2*g]+c[2*d],a.depth[n]=(a.depth[g]>=a.depth[d]?a.depth[g]:a.depth[d])+1,c[2*g+1]=c[2*d+1]=n,a.heap[1]=n++,m(a,c,1);while(2<=a.heap_len);a.heap[--a.heap_max]=
a.heap[1];g=b.dyn_tree;n=b.max_code;for(var p=b.stat_desc.static_tree,q=b.stat_desc.has_stree,r=b.stat_desc.extra_bits,t=b.stat_desc.extra_base,s=b.stat_desc.max_length,u,v,w=0,f=0;15>=f;f++)a.bl_count[f]=0;g[2*a.heap[a.heap_max]+1]=0;for(d=a.heap_max+1;573>d;d++)e=a.heap[d],f=g[2*g[2*e+1]+1]+1,f>s&&(f=s,w++),g[2*e+1]=f,e>n||(a.bl_count[f]++,u=0,e>=t&&(u=r[e-t]),v=g[2*e],a.opt_len+=v*(f+u),q&&(a.static_len+=v*(p[2*e+1]+u)));if(0!==w){do{for(f=s-1;0===a.bl_count[f];)f--;a.bl_count[f]--;a.bl_count[f+
1]+=2;a.bl_count[s]--;w-=2}while(0<w);for(f=s;0!==f;f--)for(e=a.bl_count[f];0!==e;)p=a.heap[--d],p>n||(g[2*p+1]!==f&&(a.opt_len+=(f-g[2*p+1])*g[2*p],g[2*p+1]=f),e--)}h(c,k,a.bl_count)}function y(a,b,c){var d,e=-1,f,g=b[1],h=0,k=7,m=4;0===g&&(k=138,m=3);b[2*(c+1)+1]=65535;for(d=0;d<=c;d++)f=g,g=b[2*(d+1)+1],++h<k&&f===g||(h<m?a.bl_tree[2*f]+=h:0!==f?(f!==e&&a.bl_tree[2*f]++,a.bl_tree[32]++):10>=h?a.bl_tree[34]++:a.bl_tree[36]++,h=0,e=f,0===g?(k=138,m=3):f===g?(k=6,m=3):(k=7,m=4))}function v(a,b,c){var d,
f=-1,g,h=b[1],k=0,m=7,n=4;0===h&&(m=138,n=3);for(d=0;d<=c;d++)if(g=h,h=b[2*(d+1)+1],!(++k<m&&g===h)){if(k<n){do p(a,g,a.bl_tree);while(0!==--k)}else 0!==g?(g!==f&&(p(a,g,a.bl_tree),k--),p(a,16,a.bl_tree),e(a,k-3,2)):10>=k?(p(a,17,a.bl_tree),e(a,k-3,3)):(p(a,18,a.bl_tree),e(a,k-11,7));k=0;f=g;0===h?(m=138,n=3):g===h?(m=6,n=3):(m=7,n=4)}}function s(a){var b=4093624447,c;for(c=0;31>=c;c++,b>>>=1)if(b&1&&0!==a.dyn_ltree[2*c])return 0;if(0!==a.dyn_ltree[18]||0!==a.dyn_ltree[20]||0!==a.dyn_ltree[26])return 1;
for(c=32;256>c;c++)if(0!==a.dyn_ltree[2*c])return 1;return 0}function B(a,c,d,f){e(a,0+(f?1:0),3);b(a);k(a,d);k(a,~d);u.arraySet(a.pending_buf,a.window,c,d,a.pending);a.pending+=d}var u=c("../utils/common"),z=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],G=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],H=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],E=Array(576);f(E);var t=Array(60);f(t);var x=Array(512);f(x);var w=
Array(256);f(w);var M=Array(29);f(M);var D=Array(30);f(D);var I=function(a,b,c,d,e){this.static_tree=a;this.extra_bits=b;this.extra_base=c;this.elems=d;this.max_length=e;this.has_stree=a&&a.length},J,K,F,U=function(a,b){this.dyn_tree=a;this.max_code=0;this.stat_desc=b},$=!1;a._tr_init=function(a){if(!$){var b,c,d,e=Array(16);for(d=c=0;28>d;d++)for(M[d]=c,b=0;b<1<<z[d];b++)w[c++]=d;w[c-1]=d;for(d=c=0;16>d;d++)for(D[d]=c,b=0;b<1<<G[d];b++)x[c++]=d;for(c>>=7;30>d;d++)for(D[d]=c<<7,b=0;b<1<<G[d]-7;b++)x[256+
c++]=d;for(b=0;15>=b;b++)e[b]=0;for(b=0;143>=b;)E[2*b+1]=8,b++,e[8]++;for(;255>=b;)E[2*b+1]=9,b++,e[9]++;for(;279>=b;)E[2*b+1]=7,b++,e[7]++;for(;287>=b;)E[2*b+1]=8,b++,e[8]++;h(E,287,e);for(b=0;30>b;b++)t[2*b+1]=5,t[2*b]=n(b,5);J=new I(E,z,257,286,15);K=new I(t,G,0,30,15);F=new I([],H,0,19,7);$=!0}a.l_desc=new U(a.dyn_ltree,J);a.d_desc=new U(a.dyn_dtree,K);a.bl_desc=new U(a.bl_tree,F);a.bi_buf=0;a.bi_valid=0;q(a)};a._tr_stored_block=B;a._tr_flush_block=function(a,c,d,f){var g,h,k=0;if(0<a.level){2===
a.strm.data_type&&(a.strm.data_type=s(a));A(a,a.l_desc);A(a,a.d_desc);y(a,a.dyn_ltree,a.l_desc.max_code);y(a,a.dyn_dtree,a.d_desc.max_code);A(a,a.bl_desc);for(k=18;3<=k&&0===a.bl_tree[2*C[k]+1];k--);a.opt_len+=3*(k+1)+14;g=a.opt_len+3+7>>>3;h=a.static_len+3+7>>>3;h<=g&&(g=h)}else g=h=d+5;if(d+4<=g&&-1!==c)B(a,c,d,f);else if(4===a.strategy||h===g)e(a,2+(f?1:0),3),r(a,E,t);else{e(a,4+(f?1:0),3);c=a.l_desc.max_code+1;d=a.d_desc.max_code+1;k+=1;e(a,c-257,5);e(a,d-1,5);e(a,k-4,4);for(g=0;g<k;g++)e(a,a.bl_tree[2*
C[g]+1],3);v(a,a.dyn_ltree,c-1);v(a,a.dyn_dtree,d-1);r(a,a.dyn_ltree,a.dyn_dtree)}q(a);f&&b(a)};a._tr_tally=function(a,b,c){a.pending_buf[a.d_buf+2*a.last_lit]=b>>>8&255;a.pending_buf[a.d_buf+2*a.last_lit+1]=b&255;a.pending_buf[a.l_buf+a.last_lit]=c&255;a.last_lit++;0===b?a.dyn_ltree[2*c]++:(a.matches++,b--,a.dyn_ltree[2*(w[c]+256+1)]++,a.dyn_dtree[2*(256>b?x[b]:x[256+(b>>>7)])]++);return a.last_lit===a.lit_bufsize-1};a._tr_align=function(a){e(a,2,3);p(a,256,E);16===a.bi_valid?(k(a,a.bi_buf),a.bi_buf=
0,a.bi_valid=0):8<=a.bi_valid&&(a.pending_buf[a.pending++]=a.bi_buf&255,a.bi_buf>>=8,a.bi_valid-=8)}},{"../utils/common":27}],39:[function(c,g,a){g.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}},{}]},{},[9])(9)});
function number_format(l,c,g,a){l=(l+"").replace(/[^0-9+\-Ee.]/g,"");l=isFinite(+l)?+l:0;c=isFinite(+c)?Math.abs(c):0;a="undefined"===typeof a?",":a;g="undefined"===typeof g?".":g;var f="",f=function(a,c){var f=Math.pow(10,c);return""+Math.round(a*f)/f},f=(c?f(l,c):""+Math.round(l)).split(".");3<f[0].length&&(f[0]=f[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,a));(f[1]||"").length<c&&(f[1]=f[1]||"",f[1]+=Array(c-f[1].length+1).join("0"));return f.join(g)}
function findChildNode(l,c,g){var a=[];for(l=l?l.firstElementChild:null;l;)l.localName===g&&l.namespaceURI===c&&a.push(l),l=l.nextElementSibling;return a}function getWindowWidth(){var l=0;if("number"==typeof window.innerWidth)l=window.innerWidth;else var l=document.documentElement.clientWidth,c=document.body.clientWidth,l=0<l?l:c;l||(l=0);return l}
function getWindowHeight(){var l=0;if("number"==typeof window.innerHeight)l=window.innerHeight;else var l=document.documentElement.clientHeight,c=document.body.clientHeight,l=0<l?l:c;l||(l=0);return l}function getScrollLeft(){var l;document.body&&document.body.scrollLeft?l=document.body.scrollLeft:document.documentElement&&document.documentElement.scrollLeft&&(l=document.documentElement.scrollLeft);l||(l=0);return l}
function getScrollTop(){var l;document.body&&document.body.scrollTop?l=document.body.scrollTop:document.documentElement&&document.documentElement.scrollTop&&(l=document.documentElement.scrollTop);l||(l=0);return l}var messagetimer=null;
function show_message(l,c,g,a,f){c||(c=10);g||(g=10);a||(a=5);f||(f=2E3);for(var k=1,e=1;4>=e;e++){var p="layer_message";1<e&&(p="layer_message"+e);if(p=document.getElementById(p)){k=e;break}}p.style.left="1px";p.style.top="1px";p.innerHTML=l;p.style.display="";1==k?(c=getScrollLeft()+c,g=getScrollTop()+g):2==k?(c=getScrollLeft()+(getWindowWidth()-p.clientWidth)/2,g=getScrollTop()+(getWindowHeight()-p.clientHeight)/2):(c=3==k?document.body.offsetWidth-p.clientWidth-5:getScrollLeft()+(getWindowWidth()-
p.clientWidth)/2,g=getScrollTop()+g);c=parseInt(c);g=parseInt(g);p.style.border="1px solid #000000";p.style.padding=a+"px";p.style.left=c+"px";p.style.top=g+"px";messagetimer&&clearTimeout(messagetimer);messagetimer=setTimeout(hide_message,f)}function hide_message(){for(var l=1;4>=l;l++){var c="layer_message";1<l&&(c="layer_message"+l);if(c=document.getElementById(c))c.style.display="none"}}
var gformats2=[["svg","image/svg+xml"],["pdf","application/pdf"],["gif","image/gif"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["png","image/png"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["htm","text/html"],["html","text/html"],["txt","text/plain"],["text","text/plain"],["odt","application/vnd.oasis.opendocument.text"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],
["odp","application/vnd.oasis.opendocument.presentation"],["xls","application/vnd.ms-excel"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["csv","text/csv"],["tsv","text/tab-separated-values"]];function getmimetype2(l){l=(l||"").split(".");l=l[l.length-1].toLowerCase();for(var c=0;c<=gformats2.length-1;c++)if(gformats2[c][0]==l)return gformats2[c][1]};
